import{l as s,s as f}from"./page-fridge-Cp-W9isk.js";import{s as p,g as w,f as h}from"./date-utils-BlBdbPk_.js";import{j as g}from"./vendor-BefW7Bxj.js";import{g as I}from"./page-fridge-scan-C62RDC3k.js";import{m as v}from"./motion-BQvLDPOm.js";async function A(e,t=new Date){const i=p(t).toISOString(),r=w(t).toISOString();s.info("ACTIVITIES_REPO","Fetching activities for date",{userId:e,date:h(t,"yyyy-MM-dd"),startDate:i,endDate:r,timestamp:new Date().toISOString()});try{const{data:o,error:a}=await f.from("activities").select("*").eq("user_id",e).gte("timestamp",i).lte("timestamp",r).order("timestamp",{ascending:!1});if(a)throw s.error("ACTIVITIES_REPO","Failed to fetch activities",{error:a.message,errorCode:a.code,userId:e,date:h(t,"yyyy-MM-dd"),timestamp:new Date().toISOString()}),a;return s.info("ACTIVITIES_REPO","Activities fetched successfully",{userId:e,date:h(t,"yyyy-MM-dd"),activitiesCount:o?.length||0,timestamp:new Date().toISOString()}),o||[]}catch(o){throw s.error("ACTIVITIES_REPO","Exception during activities fetch",{error:o instanceof Error?o.message:"Unknown error",userId:e,date:h(t,"yyyy-MM-dd"),timestamp:new Date().toISOString()}),o}}function b(e){if(e.length===0)return{totalCalories:0,activitiesCount:0,totalDuration:0,averageIntensity:void 0,mostFrequentType:void 0,lastActivityTime:void 0};const t=e.reduce((l,u)=>l+u.calories_est,0),i=e.reduce((l,u)=>l+u.duration_min,0),r={low:1,medium:2,high:3,very_high:4},o={1:"low",2:"medium",3:"high",4:"very_high"},a=e.reduce((l,u)=>l+r[u.intensity],0)/e.length,m=o[Math.round(a)],n={};e.forEach(l=>{n[l.type]=(n[l.type]||0)+1});const d=Object.entries(n).sort(([,l],[,u])=>u-l)[0]?.[0],c=e.length>0?new Date(e[0].timestamp):void 0;return{totalCalories:t,activitiesCount:e.length,totalDuration:i,averageIntensity:m,mostFrequentType:d,lastActivityTime:c}}async function P(e,t=10){s.info("ACTIVITIES_REPO","Fetching recent activities",{userId:e,limit:t,timestamp:new Date().toISOString()});try{const{data:i,error:r}=await f.from("activities").select("*").eq("user_id",e).order("timestamp",{ascending:!1}).limit(t);if(r)throw s.error("ACTIVITIES_REPO","Failed to fetch recent activities",{error:r.message,errorCode:r.code,userId:e,limit:t,timestamp:new Date().toISOString()}),r;return s.info("ACTIVITIES_REPO","Recent activities fetched successfully",{userId:e,activitiesCount:i?.length||0,limit:t,timestamp:new Date().toISOString()}),i||[]}catch(i){throw s.error("ACTIVITIES_REPO","Exception during recent activities fetch",{error:i instanceof Error?i.message:"Unknown error",userId:e,limit:t,timestamp:new Date().toISOString()}),i}}async function R(e,t){s.info("ACTIVITIES_REPO","Deleting activity",{activityId:e,userId:t,timestamp:new Date().toISOString()});try{const{error:i}=await f.from("activities").delete().eq("id",e).eq("user_id",t);if(i)throw s.error("ACTIVITIES_REPO","Failed to delete activity",{error:i.message,errorCode:i.code,activityId:e,userId:t,timestamp:new Date().toISOString()}),i;s.info("ACTIVITIES_REPO","Activity deleted successfully",{activityId:e,userId:t,timestamp:new Date().toISOString()})}catch(i){throw s.error("ACTIVITIES_REPO","Exception during activity deletion",{error:i instanceof Error?i.message:"Unknown error",activityId:e,userId:t,timestamp:new Date().toISOString()}),i}}async function V(e,t,i,r=100){const o=t.toISOString(),a=i.toISOString();s.info("ACTIVITIES_REPO","Fetching user activities for date range",{userId:e,startDate:o,endDate:a,limit:r,timestamp:new Date().toISOString()});try{const{data:m,error:n}=await f.from("activities").select("*").eq("user_id",e).gte("timestamp",o).lte("timestamp",a).order("timestamp",{ascending:!1}).limit(r);if(n)throw s.error("ACTIVITIES_REPO","Failed to fetch user activities",{error:n.message,errorCode:n.code,userId:e,startDate:o,endDate:a,limit:r,timestamp:new Date().toISOString()}),n;return s.info("ACTIVITIES_REPO","User activities fetched successfully",{userId:e,activitiesCount:m?.length||0,startDate:o,endDate:a,limit:r,timestamp:new Date().toISOString()}),m||[]}catch(m){throw s.error("ACTIVITIES_REPO","Exception during user activities fetch",{error:m instanceof Error?m.message:"Unknown error",userId:e,startDate:o,endDate:a,limit:r,timestamp:new Date().toISOString()}),m}}function M(e){const t=[];return(!e.type||e.type.trim().length===0)&&t.push("Le type d'activité est requis"),(!e.duration_min||e.duration_min<=0)&&t.push("La durée doit être supérieure à 0 minutes"),e.duration_min&&e.duration_min>600&&t.push("La durée ne peut pas dépasser 10 heures (600 minutes)"),(!e.intensity||!["low","medium","high","very_high"].includes(e.intensity))&&t.push("L'intensité doit être low, medium, high ou very_high"),t.push("Les calories estimées doivent être supérieures ou égales à 0"),{isValid:t.length===0,errors:t}}const D=()=>{const e=I();return{mode:e.mode,enableAnimations:e.enableAnimations,enableComplexEffects:e.enableComplexEffects,animationDelay:e.animationDelay,calendarDays:e.calendarDays,enableRings:e.mode==="high",enableParticles:e.mode==="high",enableGlows:e.mode!=="low",enableShimmers:e.mode!=="low",enablePulseEffects:e.mode!=="low",enableRotations:e.mode==="high",maxActivitiesDisplayed:e.mode==="high"?30:e.mode==="medium"?20:10,chartPointsLimit:e.maxDataPoints,staggerDelay:e.mode==="high"?.15:e.mode==="medium"?.08:0,transitionDuration:e.mode==="high"?.5:e.mode==="medium"?.3:.15}},F=({children:e,fallback:t,forceStatic:i=!1,animationType:r="standard",initial:o,animate:a,exit:m,transition:n,...d})=>{const c=D();if(i||!c.enableAnimations||r==="complex"&&!c.enableComplexEffects||r==="ring"&&!c.enableRings||r==="particle"&&!c.enableParticles||r==="rotation"&&!c.enableRotations){const S=t||g.jsx("div",{...d,children:e});return g.jsx(g.Fragment,{children:S})}const u=n?{...n,duration:typeof n=="object"&&"duration"in n?Math.min(n.duration,c.transitionDuration*2):c.transitionDuration,delay:typeof n=="object"&&"delay"in n?Math.min(n.delay,c.staggerDelay*2):c.animationDelay}:{duration:c.transitionDuration,delay:c.animationDelay};return g.jsx(v.div,{initial:o,animate:a,exit:m,transition:u,...d,children:e})},y={course:{low:6,medium:8,high:10,very_high:12},marche:{low:2.5,medium:3.5,high:4.5,very_high:5},vélo:{low:4,medium:6,high:8,very_high:10},musculation:{low:3,medium:4,high:5,very_high:6},yoga:{low:2,medium:2.5,high:3,very_high:3.5},natation:{low:4,medium:6,high:8,very_high:10},football:{low:4,medium:6,high:8,very_high:10},tennis:{low:4,medium:5.5,high:7,very_high:8.5},danse:{low:3,medium:4.5,high:6,very_high:7.5},étirements:{low:2,medium:2.5,high:3,very_high:3.5},default:{low:3,medium:4,high:5,very_high:6}};function x(e,t,i,r){const o=e.toLowerCase();let a=y.default[t]||4;for(const[n,d]of Object.entries(y))if(o.includes(n)){a=d[t]||d.medium;break}const m=i/60;return Math.round(a*r*m)}function L(e){switch(e){case"low":return"#22C55E";case"medium":return"#F59E0B";case"high":return"#EF4444";case"very_high":return"#DC2626";default:return"#3B82F6"}}function j(e){const t=e.toLowerCase();return t.includes("course")||t.includes("running")||t.includes("marche")||t.includes("walk")||t.includes("vélo")||t.includes("bike")||t.includes("natation")||t.includes("swim")?"Activity":t.includes("musculation")?"Dumbbell":t.includes("yoga")?"Smile":t.includes("football")||t.includes("sport")||t.includes("tennis")?"Target":t.includes("danse")||t.includes("étirement")?"Smile":"Zap"}function k(e){switch(e){case"low":return"Faible";case"medium":return"Modérée";case"high":return"Intense";case"very_high":return"Très Intense";default:return"Modérée"}}export{F as C,P as a,L as b,b as c,R as d,j as e,A as f,V as g,k as h,x as i,D as u,M as v};
