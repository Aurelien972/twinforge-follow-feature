import{r as f,u as oe,j as e,X as gt,R as he,b as ut}from"./vendor-DX97-qL9.js";import{G as C,S as x,I as o,u as Ae,P as bt}from"./ui-components-DWjWyKd7.js";import{m as h,A as le}from"./motion-DLE-fuXv.js";import{f as Je,a as Ke}from"./date-utils-sCOX3Ksr.js";import{u as ye,a as ht,b as Be,c as ke,g as Qe,d as ft,e as Re}from"./stores-DcNfcD_j.js";import{c as vt}from"./supabase-C_rF2iqf.js";const Ze={development:{level:"info"},staging:{level:"info"},production:{level:"warn"}};function yt(){return Ze["production"]||Ze.development}let nt=null;function jt(t){nt=t}function wt(){try{return nt?.()||{}}catch(t){return console.warn("Failed to get context from provider:",t),{}}}function de(t){const s=yt(),r={trace:0,debug:1,info:2,warn:3,error:4},a=r[s.level];return r[t]>=a}function xe(t,s,r){const a=wt();r&&typeof r!="object"&&(s=`${s} — ${String(r)}`,r=void 0);const i={...a,...r||{}};return{level:t,message:s,timestamp:new Date().toISOString(),context:i}}function it(t,s){if(!de("trace"))return;const r=xe("trace",t,s);console.trace(JSON.stringify(r,null,2))}function lt(t,s){if(!de("debug"))return;const r=xe("debug",t,s);console.debug(JSON.stringify(r,null,2))}function ot(t,s){if(!de("info"))return;const r=xe("info",t,s);console.log(JSON.stringify(r,null,2))}function ct(t,s){if(!de("warn"))return;const r=xe("warn",t,s);console.warn(JSON.stringify(r,null,2))}function dt(t,s){if(!de("error"))return;const r=xe("error",t,s);console.error(JSON.stringify(r,null,2))}function Nt(t,s,r,a){if(!de("info"))return;const i=Number.isFinite(s)&&!Number.isNaN(s)?Math.max(0,Math.min(100,s)):0,n=xe("info",`${t}: ${i}% - ${r}`,{category:t,progress:i,message:r,...a&&{subMessage:a}});console.log(JSON.stringify(n,null,2))}function kt(t,s,r={}){if(!de("error"))return;const a=s,i=xe("error",t,{error:{name:a?.name||"Unknown",message:a?.message||"No message",stack:a?.stack||"No stack trace"},...r});console.error(JSON.stringify(i,null,2))}const y={trace:it,info:ot,warn:ct,debug:lt,error:dt,progress:Nt,logError:kt,logOnce:St,setContextProvider:jt,jsonLog:Ct},Xe=new Set;function St(t,s,r,a){if(!Xe.has(t))switch(Xe.add(t),s){case"trace":it(r,a);break;case"debug":lt(r,a);break;case"info":ot(r,a);break;case"warn":ct(r,a);break;case"error":dt(r,a);break}}function Ct(t,s,r){if(!de("info"))return;const a=xe("info",`${t}: ${s}`,{category:t,data:r,structured:!0});console.log(JSON.stringify(a,null,2))}const ee={supabaseUrl:(()=>{const t="https://kwipydbtjagypocpvbwn.supabase.co".trim()||"";return t&&(t.includes("supabase.co")||t.includes("supabase.in"))?t.replace(/^http:\/\//,"https://"):t})(),supabaseAnon:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt3aXB5ZGJ0amFneXBvY3B2YnduIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ2ODg0MjIsImV4cCI6MjA3MDI2NDQyMn0.IS5IdKbmnGtgU_AaGYtUgX3ewaNpsiSAui5kbFV31_U".trim()||""},It=()=>{const t=ee.supabaseUrl&&ee.supabaseUrl.length>0,s=ee.supabaseAnon&&ee.supabaseAnon.length>0,r=t&&(ee.supabaseUrl.includes("supabase.co")||ee.supabaseUrl.includes("supabase.in"));return t&&s&&r};function Et(){try{const t=new URL(ee.supabaseUrl).hostname.split(".")[0],s=window.location.hostname.toLowerCase();let r="default";if(s.includes("localhost")||s.includes("127.0.0.1"))r="dev";else if(s.includes("webcontainer")||s.includes("stackblitz"))r="preview";else{const i=s.split(".");i.length>2,r=i[0]}const a=r.replace(/[^a-z0-9-]/gi,"").toLowerCase();return`sb-${t}-${a}-auth-token`}catch(t){return console.warn("Failed to generate auth storage key:",t),"sb-auth-token-fallback"}}const Ft=()=>{if(!ee.supabaseUrl||!ee.supabaseAnon)throw console.error("Missing environment variables. Please check your .env file."),console.error("Required: VITE_SUPABASE_URL and VITE_SUPABASE_ANON_KEY"),new Error("Supabase configuration missing");const t=ee.supabaseUrl,s=ee.supabaseAnon,r=Et();try{return vt(t,s,{auth:{storage:window.localStorage,storageKey:r,persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,flowType:"pkce"},global:{headers:{"X-Client-Info":"fastlift-pwa@9.77"}}})}catch(a){throw console.error("SUPABASE","Failed to create client",{error:a}),a}},U=Ft();It();const cr=Object.freeze(Object.defineProperty({__proto__:null,supabase:U},Symbol.toStringTag,{value:"Module"}));let ge=null;function Dt(){return ge||(ge=new(window.AudioContext||window.webkitAudioContext)),ge.state==="suspended"&&ge.resume().catch(t=>{console.error("AUDIO_FEEDBACK_ERROR","Failed to resume AudioContext",{error:t instanceof Error?t.message:"Unknown error",contextState:ge?.state,timestamp:new Date().toISOString()})}),ge}function At(){return ge?.state==="running"}function Bt(t,s,r){const a=t.createOscillator(),i=t.createGain();a.frequency.setValueAtTime(s.frequency,r),a.type=s.waveform;let n=null;s.filter&&(n=t.createBiquadFilter(),n.type=s.filter.type,n.frequency.setValueAtTime(s.filter.frequency,r),s.filter.Q!==void 0&&n.Q.setValueAtTime(s.filter.Q,r)),n?(a.connect(n),n.connect(i)):a.connect(i);const{attack:l,decay:c,sustain:u,release:m}=s.adsr,p=s.gain,d=p*u,b=r+l,v=b+c,w=v+m,D=l+c+m;return i.gain.setValueAtTime(0,r),i.gain.linearRampToValueAtTime(p,b),u>0?i.gain.exponentialRampToValueAtTime(Math.max(.001,d),v):i.gain.exponentialRampToValueAtTime(.001,v),i.gain.exponentialRampToValueAtTime(.001,w),{oscillator:a,gainNode:i,duration:D}}function Se(t,s="click",r){try{const a=Dt();if(!At())return;const i=a.currentTime,n=a.createGain();n.connect(a.destination);const l=(t.masterGain||1)*.1;n.gain.setValueAtTime(l,i);const c=[];let u=0;t.layers.forEach(p=>{const d=Bt(a,p,i);c.push(d),d.gainNode.connect(n),u=Math.max(u,d.duration)}),c.forEach(({oscillator:p})=>{p.start(i)});const m=i+u;c.forEach(({oscillator:p})=>{p.stop(m)}),y.trace("TWINFORGE_AUDIO: Layered sound played",{layersCount:t.layers.length,totalDuration:(u*1e3).toFixed(1)+"ms",masterGain:l.toFixed(3),soundType:s,soundId:r})}catch(a){y.error("AUDIO_FEEDBACK_ERROR: Layered audio playback failed",{error:a instanceof Error?a.message:"Unknown error",layersCount:t.layers.length,soundType:s,audioContextSupported:!!(window.AudioContext||window.webkitAudioContext)})}}const M={frequency:290,waveform:"square",adsr:{attack:.003,decay:.085,sustain:0,release:.02},gain:.85,filter:{type:"lowpass",frequency:1600,Q:1.2}},ie={frequency:102,waveform:"sine",adsr:{attack:.008,decay:.055,sustain:0,release:.012},gain:.6,filter:{type:"highpass",frequency:60,Q:1}},te={frequency:1500,waveform:"triangle",adsr:{attack:.01,decay:.15,sustain:0,release:.03},gain:.4,filter:{type:"lowpass",frequency:6e3,Q:1}},ve={frequency:440,waveform:"sawtooth",adsr:{attack:.015,decay:.18,sustain:.1,release:.25},gain:.25,filter:{type:"bandpass",frequency:800,Q:3.5}},Fe={frequency:1800,waveform:"sawtooth",adsr:{attack:.002,decay:.05,sustain:0,release:.01},gain:.15,filter:{type:"highpass",frequency:1200,Q:1}},ue={enabled:!0,volume:1,reducedMotion:!1};function Rt(){return{...ue}}function et(t){Object.assign(ue,t)}function Te(){return ue.enabled}function _e(t){if(!ue.enabled)return t;const s={...t,masterGain:(t.masterGain||1)*ue.volume};return ue.reducedMotion&&s.layers&&(s.layers=s.layers.map(r=>({...r,adsr:r.adsr?{...r.adsr,attack:Math.max(r.adsr.attack,.01),release:Math.max(r.adsr.release,.01)}:r.adsr}))),s}function F(t,s=2){if(ue.reducedMotion)return t;const r=(Math.random()-.5)*2*(s/100);return t*(1+r)}function dr(t){Se(t)}const tt=new Map,Tt=50;function Pe(t,s){const r=s||t,a=Date.now(),i=tt.get(r);return i&&a-i<Tt?!1:(tt.set(r,a),!0)}function je(t,s="click",r){if(!Te()||!Pe(s,r))return;const a=_e(t);Se(a,s,r)}function _t(){const t={layers:[{...M,frequency:F(M.frequency),gain:M.gain*.7},{...ie,frequency:F(ie.frequency),gain:ie.gain*.3}],masterGain:1};je(t,"click")}function Pt(){const t={layers:[{...M,frequency:F(M.frequency),gain:M.gain*.7},{...ie,frequency:F(ie.frequency),gain:ie.gain*.3}],masterGain:1};je(t,"click")}function zt(){je({layers:[{frequency:800,waveform:"triangle",adsr:{attack:.005,decay:.02,sustain:0,release:.005},gain:.3,filter:{type:"lowpass",frequency:3e3,Q:.8}}],masterGain:.8},"click")}function Mt(){je({layers:[{frequency:520,waveform:"triangle",adsr:{attack:.01,decay:.05,sustain:0,release:.01},gain:.5,filter:{type:"lowpass",frequency:2500,Q:1.2}}],masterGain:1},"click")}function $t(){je({layers:[{frequency:740,waveform:"triangle",adsr:{attack:.015,decay:.105,sustain:0,release:.015},gain:.5,filter:{type:"lowpass",frequency:4e3,Q:1}}],masterGain:1},"click")}function Lt(){je({layers:[{frequency:800,waveform:"sine",adsr:{attack:.01,decay:.07,sustain:0,release:.01},gain:.4,filter:{type:"lowpass",frequency:3500,Q:1}}],masterGain:1},"click")}function be(t,s="success",r){if(!Te()||!Pe(s,r))return;const a=_e(t);Se(a,s,r)}function qt(){const t={layers:[{...M,frequency:F(M.frequency),gain:M.gain*.6},{...te,frequency:F(te.frequency),gain:te.gain*.4}],masterGain:1.26};be(t,"success")}function Gt(){const t={layers:[{...M,frequency:F(M.frequency),gain:M.gain*.6},{...te,frequency:F(te.frequency),gain:te.gain*.2}],masterGain:1.58};be(t,"success")}function Ot(){be({layers:[{frequency:220,waveform:"sine",adsr:{attack:.005,decay:.08,sustain:0,release:.01},gain:.6}],masterGain:.79},"error"),setTimeout(()=>{be({layers:[{frequency:180,waveform:"sine",adsr:{attack:.005,decay:.1,sustain:0,release:.01},gain:.6}],masterGain:.79},"error")},110)}function Ut(){const t={layers:[{...M,frequency:F(M.frequency),gain:M.gain*1,adsr:{attack:.005,decay:.11,sustain:0,release:.015}}],masterGain:2.51};be(t,"success"),setTimeout(()=>{const s={layers:[{...te,frequency:1400,gain:te.gain*.8,adsr:{attack:.01,decay:.15,sustain:0,release:.03},filter:{type:"bandpass",frequency:1400,Q:1.5}}],masterGain:2.51};be(s,"success")},120),setTimeout(()=>{be({layers:[{frequency:600,waveform:"sine",adsr:{attack:.02,decay:.14,sustain:0,release:.02},gain:.35,filter:{type:"lowpass",frequency:800,Q:1.2}}],masterGain:2.51},"success")},220)}function Ce(t,s){if(!Te()||!Pe("navigation",s))return;const r=_e(t);Se(r,"navigation",s)}function Vt(){const t={layers:[{...M,frequency:F(660),gain:M.gain*.5}],masterGain:1};Ce(t)}function Ht(){const t={layers:[{...M,frequency:F(350),gain:M.gain*.4},{...ie,frequency:F(ie.frequency),gain:ie.gain*.2}],masterGain:1};Ce(t)}function Wt(){Ce({layers:[{frequency:880,waveform:"sine",adsr:{attack:.006,decay:.026,sustain:0,release:.006},gain:.4}],masterGain:1})}function Yt(){const t={layers:[{...M,frequency:F(400),gain:M.gain*.4},{...te,frequency:F(1200),gain:te.gain*.3}],masterGain:1};Ce(t)}function Jt(){const t={layers:[{...M,frequency:F(350),gain:M.gain*.3}],masterGain:.9};Ce(t)}const Kt={light:{pattern:10,description:"Light tap"},medium:{pattern:20,description:"Medium tap"},heavy:{pattern:30,description:"Heavy tap"},success:{pattern:[10,50,10],description:"Success double tap"},warning:{pattern:[20,100,20,100,20],description:"Warning triple tap"},error:{pattern:[30,50,30],description:"Error alert pattern"},selection:{pattern:5,description:"Selection tick"}};function Qt(){return"vibrate"in navigator}function Zt(){if(window.matchMedia("(prefers-reduced-motion: reduce)").matches||!Qt())return!1;try{const t=localStorage.getItem("haptics-enabled");return t===null||t==="true"}catch{return!0}}function me(t="light"){if(Zt())try{const s=Kt[t];navigator.vibrate(s.pattern)||(y.debug("HAPTICS","Vibration pattern not supported, using fallback"),navigator.vibrate(10)),y.debug("HAPTICS","Triggered haptic feedback",{pattern:t,description:s.description})}catch(s){y.error("HAPTICS","Failed to trigger haptic feedback",s)}}const se={tap:()=>me("light"),press:()=>me("medium"),impact:()=>me("heavy"),success:()=>me("success"),warning:()=>me("warning"),error:()=>me("error"),selection:()=>me("selection")};function Le(t,s=1){const r=[.025,.045,.07],a=[.15,.1,.06].map(n=>n*s),i=t.layers.flatMap(n=>[n,...r.map((l,c)=>({...n,gain:n.gain*a[c],adsr:{...n.adsr,attack:n.adsr.attack+l}}))]);return{...t,layers:i,masterGain:t.masterGain*.9}}let st=0;function Xt(){const t=Date.now(),s=t-st;return st=t,s<200?.5:s<500?.7:s<1e3?1:1.3}function ce(t,s="click",r){if(!Te()||!Pe(s,r))return;const a=_e(t);Se(a,s,r)}function xr(){const t={layers:[{frequency:F(280),waveform:"triangle",adsr:{attack:.01,decay:.15,sustain:.3,release:.25},gain:.35},{frequency:F(440),waveform:"sine",adsr:{attack:.02,decay:.2,sustain:.25,release:.3},gain:.25},{frequency:F(660),waveform:"sine",adsr:{attack:.03,decay:.25,sustain:.2,release:.35},gain:.15}],masterGain:1.2};ce(t,"navigation","forge-strike"),se.press()}function pr(t){const s=qe(t),r={layers:[{frequency:F(s),waveform:"triangle",adsr:{attack:.008,decay:.12,sustain:.25,release:.18},gain:.28},{frequency:F(s*1.5),waveform:"sine",adsr:{attack:.01,decay:.15,sustain:.2,release:.22},gain:.18}],masterGain:1};ce(r,"click",`tile-${t}`),se.tap()}function mr(t){const s=qe(t),r={layers:[{frequency:F(s*1.2),waveform:"sine",adsr:{attack:.005,decay:.08,sustain:.15,release:.12},gain:.22},{frequency:F(s*2),waveform:"sine",adsr:{attack:.008,decay:.1,sustain:.12,release:.15},gain:.12}],masterGain:1};ce(r,"click",`pill-${t}`),se.selection()}function gr(){const t={layers:[{frequency:F(440),waveform:"sine",adsr:{attack:.01,decay:.12,sustain:.15,release:.2},gain:.18},{frequency:F(330),waveform:"sine",adsr:{attack:.02,decay:.15,sustain:.12,release:.25},gain:.15}],masterGain:.9};ce(t,"navigation","panel-close"),se.tap()}function ur(){const t={layers:[{frequency:F(261.63),waveform:"sine",adsr:{attack:.008,decay:.15,sustain:.32,release:.28},gain:.35},{frequency:F(329.63),waveform:"sine",adsr:{attack:.012,decay:.18,sustain:.28,release:.32},gain:.28},{frequency:F(523.25),waveform:"sine",adsr:{attack:.015,decay:.2,sustain:.25,release:.35},gain:.22}],masterGain:1.15};ce(t,"navigation","home-click"),se.press()}function br(t,s){const r=qe(t),a=s?1.2:1,i={layers:[{frequency:F(r),waveform:"sine",adsr:{attack:.008,decay:.12,sustain:.2,release:.18},gain:.25*a},{frequency:F(r*1.5),waveform:"sine",adsr:{attack:.012,decay:.15,sustain:.18,release:.22},gain:.15*a}],masterGain:1};ce(i,"navigation",`bottom-bar-${t}`),s?se.press():se.tap()}function qe(t){return{"#10B981":349.23,"#3B82F6":392,"#F59E0B":440,"#A855F7":493.88,"#18E3FF":523.25,"#3D13B3":329.63,"#EC4899":466.16,"#8B5CF6":493.88,"#F7931E":329.63,"#EF4444":261.63}[t]||440}function es(t=1){const s=Xt(),r={layers:[{frequency:F(180),waveform:"square",adsr:{attack:.001,decay:.04,sustain:0,release:.015},gain:.9*t},{...ve,frequency:F(ve.frequency),gain:ve.gain*t},{...Fe,frequency:F(2400),gain:Fe.gain*t*1.3}],masterGain:1.1},a=Le(r,s);ce(a,"click","hammer-strike"),se.press()}function ts(){const t={layers:[{frequency:F(340),waveform:"triangle",adsr:{attack:.01,decay:.12,sustain:.15,release:.18},gain:.45},{frequency:F(680),waveform:"sawtooth",adsr:{attack:.02,decay:.1,sustain:.08,release:.15},gain:.25,filter:{type:"bandpass",frequency:650,Q:4}},{...Fe,frequency:F(1600),gain:Fe.gain*.6}],masterGain:.9},s=Le(t,.8);ce(s,"click","hot-metal"),se.selection()}function ss(){const t={layers:[{frequency:F(220),waveform:"triangle",adsr:{attack:.005,decay:.2,sustain:.15,release:.35},gain:.5},{...ve,frequency:F(440),adsr:{...ve.adsr,decay:.3,release:.4},gain:ve.gain*1.2},{frequency:F(880),waveform:"sine",adsr:{attack:.015,decay:.25,sustain:.1,release:.3},gain:.18}],masterGain:1},s=Le(t,1.2);ce(s,"click","anvil-ring"),se.impact()}function K(){return f.useMemo(()=>({click:_t,glassClick:Pt,formInput:zt,toggle:Mt,notif:$t,timer:Lt,formSubmit:qt,success:Gt,error:Ot,successMajor:Ut,tabClick:Vt,sidebarClick:Ht,headerClick:Wt,navOpen:Yt,navClose:Jt,hammerStrike:es,hotMetalHiss:ts,anvilRing:ss,setAudioEnabled:t=>{et({enabled:t})},setDiscreteMode:t=>{et({discreteMode:t})},getAudioPreferences:Rt}),[])}const fe=[{key:"sex",label:"Genre",description:"Nécessaire pour calculer les besoins nutritionnels",profileTab:"identity",priority:"high"},{key:"weight_kg",label:"Poids",description:"Essentiel pour les portions et calories",profileTab:"identity",priority:"high"},{key:"height_cm",label:"Taille",description:"Nécessaire pour les calculs métaboliques",profileTab:"identity",priority:"high"},{key:"allergies",label:"Allergies",description:"Important pour la sécurité alimentaire",profileTab:"nutrition",priority:"medium"},{key:"householdDetails.adults",label:"Nombre d'adultes",description:"Pour adapter les portions des recettes",profileTab:"nutrition",priority:"high"},{key:"diet",label:"Régime alimentaire",description:"Pour des recettes adaptées à votre style",profileTab:"nutrition",priority:"medium"},{key:"mealPrepPreferences.cookingSkill",label:"Niveau de cuisine",description:"Pour adapter la complexité des recettes",profileTab:"nutrition",priority:"medium"},{key:"kitchenEquipment",label:"Équipement de cuisine",description:"Pour des recettes réalisables chez vous",profileTab:"nutrition",priority:"medium"},{key:"objective",label:"Objectif fitness",description:"Pour des recettes alignées sur vos objectifs",profileTab:"identity",priority:"medium"},{key:"intolerances",label:"Intolérances",description:"Pour éviter les inconforts digestifs",profileTab:"nutrition",priority:"low"},{key:"foodPreferences.cuisines",label:"Cuisines préférées",description:"Pour des recettes qui vous plaisent",profileTab:"nutrition",priority:"low"},{key:"macroTargets.kcal",label:"Objectif calories",description:"Pour des recettes équilibrées",profileTab:"fasting",priority:"low"}];function rs(t,s){if(s==="allergies"){const i=t?.nutrition?.allergies&&Array.isArray(t.nutrition.allergies)&&t.nutrition.allergies.length>0,n=t?.nutrition?.noKnownAllergies===!0;return i||n}const r=s.split(".");let a=t;for(const i of r){if(!a||a[i]===void 0||a[i]===null)return!1;a=a[i]}return!(typeof a=="string"&&a.trim()===""||Array.isArray(a)&&a.length===0||typeof a=="object"&&Object.keys(a).length===0||typeof a=="number"&&a<=0)}function ze(t){if(!t)return{isSufficient:!1,completionPercentage:0,missingCriticalFields:fe,missingHighPriorityFields:fe.filter(v=>v.priority==="high"),suggestedMessage:"Créez votre profil pour des recettes personnalisées",nextAction:{label:"Créer mon profil",route:"/profile#identity"}};y.debug("PROFILE_COMPLETION_SERVICE","Calculating Recipe Workshop completion",{userId:t.userId,hasBasicInfo:!!(t.sex&&t.weight_kg&&t.height_cm),hasNutritionInfo:!!t.nutrition,hasHouseholdInfo:!!t.householdDetails,timestamp:new Date().toISOString()});const s=[],r=[];fe.forEach(v=>{rs(t,v.key)||(s.push(v),v.priority==="high"&&r.push(v))});const a=fe.length,i=a-s.length,n=Math.round(i/a*100);fe.filter(v=>v.priority==="high");const l=fe.filter(v=>v.priority==="medium"),c=s.filter(v=>v.priority==="medium"),u=r.length===0,m=c.length<=Math.floor(l.length*.5),p=u&&m;let d,b=null;if(r.length>0){const v=r[0];d=`Complétez votre ${v.label.toLowerCase()} pour des recettes personnalisées`,b={label:`Ajouter ${v.label}`,route:`/profile#${v.profileTab}`}}else if(s.length>0){const v=s[0];d=`Ajoutez votre ${v.label.toLowerCase()} pour une meilleure personnalisation`,b={label:`Compléter ${v.label}`,route:`/profile#${v.profileTab}`}}else d="Profil complet ! Recettes ultra-personnalisées disponibles",b=null;return y.debug("PROFILE_COMPLETION_SERVICE","Recipe Workshop completion calculated",{userId:t.userId,isSufficient:p,completionPercentage:n,missingHighPriorityCount:r.length,missingTotalCount:s.length,hasAllHighPriority:u,hasEnoughMediumPriority:m,timestamp:new Date().toISOString()}),{isSufficient:p,completionPercentage:n,missingCriticalFields:s,missingHighPriorityFields:r,suggestedMessage:d,nextAction:b}}function xt(t,s){const r=ze(t),i={recipes:["sex","weight_kg","allergies","householdDetails.adults"],shopping:["householdDetails.adults","allergies","shoppingPreferences.frequencyPerWeek"],planning:["householdDetails.adults","mealPrepPreferences.cookingSkill","macroTargets.kcal"]}[s]||[],n=r.missingCriticalFields.filter(u=>i.includes(u.key)),l=n.length===0||r.isSufficient;let c="";return!l&&n.length>0&&(c=`Ajoutez votre ${n.slice(0,2).map(m=>m.label.toLowerCase()).join(" et ")} pour une ${s==="recipes"?"génération":s==="shopping"?"liste":"planification"} optimale`),{canProceed:l,warningMessage:c,missingForFeature:n}}function as(t){return t?!!(t.sex&&t.weight_kg&&t.height_cm):!1}const hr={checkCompleteness:ze,getFeatureGuidance:xt,hasMinimumData:as},ns=()=>{const t=oe(),{click:s}=K(),[r,a]=f.useState({scans:0,items:0,recipes:0});f.useEffect(()=>{(async()=>{try{const{data:{user:l}}=await U.auth.getUser();if(!l)return;const{data:c}=await U.from("recipe_sessions").select("inventory_final, selected_recipe_ids").eq("user_id",l.id).not("inventory_final","is",null);if(c&&c.length>0){const u=c.length,m=c.reduce((d,b)=>d+(Array.isArray(b.inventory_final)?b.inventory_final.length:0),0),p=c.reduce((d,b)=>d+(Array.isArray(b.selected_recipe_ids)?b.selected_recipe_ids.length:0),0);a({scans:u,items:m,recipes:p})}}catch(l){y.warn("FRIDGE_SCAN_MAIN_CTA","Failed to load stats",{error:l instanceof Error?l.message:"Unknown error"})}})()},[]);const i=()=>{s(),t("/fridge-scan")};return e.jsxs(C,{className:"relative overflow-hidden p-10 text-center",style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #EC4899 20%, transparent) 0%, transparent 60%),
          radial-gradient(circle at 70% 80%, color-mix(in srgb, #F472B6 18%, transparent) 0%, transparent 50%),
          radial-gradient(circle at 50% 50%, color-mix(in srgb, #DB2777 15%, transparent) 0%, transparent 70%),
          linear-gradient(145deg, rgba(255,255,255,0.15), rgba(255,255,255,0.10)),
          rgba(11, 14, 23, 0.85)
        `,borderColor:"color-mix(in srgb, #EC4899 45%, transparent)",boxShadow:`
          0 20px 60px rgba(0, 0, 0, 0.35),
          0 0 40px color-mix(in srgb, #EC4899 30%, transparent),
          0 0 80px color-mix(in srgb, #F472B6 25%, transparent),
          inset 0 2px 0 rgba(255, 255, 255, 0.2)
        `,backdropFilter:"blur(32px) saturate(170%)",WebkitBackdropFilter:"blur(32px) saturate(170%)"},children:[e.jsx("div",{className:"training-hero-corners","aria-hidden":"true",children:[0,1,2,3].map(n=>e.jsx(h.div,{className:"corner-particle",style:{position:"absolute",width:"12px",height:"12px",borderRadius:"2px",background:"linear-gradient(135deg, #EC4899, rgba(244, 114, 182, 0.8))",boxShadow:"0 0 20px #EC4899",top:n<2?"12px":"auto",bottom:n>=2?"12px":"auto",left:n%2===0?"12px":"auto",right:n%2===1?"12px":"auto",willChange:"transform, opacity"},initial:{rotate:n%2===0?45:-45},animate:{scale:[1,1.2,1],opacity:[.6,.9,.6],rotate:n%2===0?[45,55,45]:[-45,-55,-45]},transition:{duration:3.5,repeat:1/0,delay:n*.25,ease:[.45,.05,.55,.95]}},n))}),e.jsxs("div",{className:"relative z-10 space-y-8",children:[e.jsx("div",{className:"relative inline-block",children:e.jsxs(h.div,{className:"w-28 h-28 mx-auto rounded-full flex items-center justify-center relative",style:{background:`
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.4) 0%, transparent 60%),
                radial-gradient(circle at 70% 70%, color-mix(in srgb, #EC4899 35%, transparent) 0%, transparent 50%),
                linear-gradient(135deg, color-mix(in srgb, #EC4899 65%, transparent), color-mix(in srgb, #F472B6 55%, transparent))
              `,border:"4px solid color-mix(in srgb, #EC4899 75%, transparent)",boxShadow:`
                0 0 50px color-mix(in srgb, #EC4899 70%, transparent),
                0 0 100px color-mix(in srgb, #F472B6 50%, transparent),
                inset 0 4px 0 rgba(255,255,255,0.5)
              `,willChange:"transform"},animate:{scale:[1,1.06,1],boxShadow:["0 0 50px color-mix(in srgb, #EC4899 70%, transparent), 0 0 100px color-mix(in srgb, #F472B6 50%, transparent)","0 0 55px color-mix(in srgb, #EC4899 75%, transparent), 0 0 110px color-mix(in srgb, #F472B6 55%, transparent)","0 0 50px color-mix(in srgb, #EC4899 70%, transparent), 0 0 100px color-mix(in srgb, #F472B6 50%, transparent)"]},transition:{duration:3,repeat:1/0,ease:[.45,.05,.55,.95]},children:[e.jsx(x,{Icon:o.Refrigerator,size:56,color:"rgba(255, 255, 255, 0.95)",variant:"pure"}),e.jsx(h.div,{className:"absolute inset-0 rounded-full border-3",style:{borderColor:"color-mix(in srgb, #EC4899 70%, transparent)",willChange:"transform, opacity"},animate:{scale:[1,1.5,1.5],opacity:[.7,0,0]},transition:{duration:2.5,repeat:1/0,ease:"easeOut"}}),[{size:16,distance:70,angle:45,delay:0},{size:20,distance:80,angle:135,delay:.4},{size:14,distance:75,angle:225,delay:.8},{size:18,distance:85,angle:315,delay:1.2}].map((n,l)=>e.jsx(h.div,{className:"absolute rounded-full pointer-events-none",style:{width:`${n.size}px`,height:`${n.size}px`,left:"50%",top:"50%",marginLeft:`-${n.size/2}px`,marginTop:`-${n.size/2}px`,background:`
                    radial-gradient(circle at 30% 30%, rgba(255,255,255,0.6) 0%, transparent 70%),
                    linear-gradient(135deg,
                      color-mix(in srgb, #EC4899 70%, transparent),
                      color-mix(in srgb, #F472B6 50%, transparent)
                    )
                  `,border:"2px solid color-mix(in srgb, #EC4899 80%, transparent)",boxShadow:`
                    0 0 20px color-mix(in srgb, #EC4899 60%, transparent),
                    inset 0 2px 4px rgba(255,255,255,0.4)
                  `,willChange:"transform, opacity"},animate:{x:[0,Math.cos(n.angle*Math.PI/180)*n.distance],y:[0,Math.sin(n.angle*Math.PI/180)*n.distance],scale:[.6,1],opacity:[.9,0]},transition:{duration:2.5,repeat:1/0,ease:[.33,1,.68,1],delay:n.delay}},`bubble-${l}`))]})}),e.jsxs(h.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:[e.jsx("h2",{className:"text-3xl font-bold text-white mb-4",style:{textShadow:"0 0 25px color-mix(in srgb, #EC4899 50%, transparent)"},children:"Scanner Votre Frigo"}),e.jsx("p",{className:"text-white/85 text-lg leading-relaxed max-w-2xl mx-auto",children:"Capturez l'intérieur de votre réfrigérateur pour une analyse IA instantanée. Générez des recettes personnalisées et des plans repas adaptés à vos ingrédients."})]}),e.jsx(h.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.3},children:e.jsxs("button",{onClick:i,className:"relative overflow-hidden px-12 py-5 text-xl font-bold rounded-2xl transition-all duration-300 group",style:{background:`
                linear-gradient(135deg,
                  color-mix(in srgb, #EC4899 90%, transparent),
                  color-mix(in srgb, #F472B6 75%, transparent),
                  color-mix(in srgb, #DB2777 65%, transparent)
                )
              `,border:"3px solid color-mix(in srgb, #EC4899 80%, transparent)",boxShadow:`
                0 20px 65px color-mix(in srgb, #EC4899 65%, transparent),
                0 0 110px color-mix(in srgb, #F472B6 55%, transparent),
                inset 0 5px 0 rgba(255,255,255,0.6)
              `,color:"white"},onMouseEnter:n=>{window.matchMedia("(hover: hover)").matches&&(n.currentTarget.style.transform="translateY(-4px) scale(1.04)",n.currentTarget.style.boxShadow=`
                  0 26px 85px color-mix(in srgb, #EC4899 80%, transparent),
                  0 0 140px color-mix(in srgb, #F472B6 70%, transparent),
                  inset 0 5px 0 rgba(255,255,255,0.7)
                `)},onMouseLeave:n=>{window.matchMedia("(hover: hover)").matches&&(n.currentTarget.style.transform="translateY(0) scale(1)",n.currentTarget.style.boxShadow=`
                  0 20px 65px color-mix(in srgb, #EC4899 65%, transparent),
                  0 0 110px color-mix(in srgb, #F472B6 55%, transparent),
                  inset 0 5px 0 rgba(255,255,255,0.6)
                `)},children:[e.jsx(h.div,{className:"absolute inset-0 rounded-2xl pointer-events-none",style:{background:"linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.5) 50%, transparent 100%)"},animate:{x:["-200%","200%"]},transition:{duration:2.5,repeat:1/0,ease:"easeInOut"}}),e.jsxs("div",{className:"flex items-center gap-3 relative z-10",children:[e.jsx(x,{Icon:o.ScanLine,size:24,color:"white",variant:"pure"}),e.jsx("span",{children:"Lancer le Scan"})]})]})}),e.jsx(h.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},className:"flex flex-wrap items-center justify-center gap-6 pt-4",children:[{icon:o.ScanLine,label:`${r.scans} Scan${r.scans>1?"s":""}`,color:"#EC4899"},{icon:o.Package,label:`${r.items} Item${r.items>1?"s":""}`,color:"#F472B6"},{icon:o.ChefHat,label:`${r.recipes} Recette${r.recipes>1?"s":""}`,color:"#DB2777"}].map((n,l)=>e.jsxs(h.div,{className:"flex items-center gap-2.5 px-5 py-2.5 rounded-full",style:{background:`color-mix(in srgb, ${n.color} 18%, transparent)`,border:`2px solid color-mix(in srgb, ${n.color} 35%, transparent)`,backdropFilter:"blur(18px) saturate(150%)"},whileHover:{scale:1.05},transition:{duration:.2},children:[e.jsx(x,{Icon:n.icon,size:18,style:{color:n.color}}),e.jsx("span",{className:"text-white/90 text-sm font-semibold",children:n.label})]},l))})]})]})},is=()=>{const t=oe(),{click:s}=K(),[r,a]=f.useState([]);f.useEffect(()=>{(async()=>{try{const{data:{user:c}}=await U.auth.getUser();if(!c)return;const{data:u}=await U.from("recipe_sessions").select("id, created_at, inventory_final, status").eq("user_id",c.id).not("inventory_final","is",null).order("created_at",{ascending:!1}).limit(3);u&&a(u)}catch(c){y.warn("RECENT_SCANS_CARD","Failed to load recent sessions",{error:c instanceof Error?c.message:"Unknown error"})}})()},[]);const i=l=>{s(),t("/fridge#inventaire")},n=()=>{s(),t("/fridge#inventaire")};return e.jsxs(C,{className:"p-6",style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #EC4899 12%, transparent) 0%, transparent 60%),
          radial-gradient(circle at 70% 80%, color-mix(in srgb, #F472B6 10%, transparent) 0%, transparent 50%),
          linear-gradient(145deg, rgba(255,255,255,0.12), rgba(255,255,255,0.08)),
          rgba(11, 14, 23, 0.80)
        `,borderColor:"color-mix(in srgb, #EC4899 35%, transparent)",boxShadow:`
          0 12px 40px rgba(0, 0, 0, 0.25),
          0 0 30px color-mix(in srgb, #EC4899 20%, transparent),
          inset 0 2px 0 rgba(255, 255, 255, 0.15)
        `,backdropFilter:"blur(24px) saturate(150%)",WebkitBackdropFilter:"blur(24px) saturate(150%)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(h.div,{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:`
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.25) 0%, transparent 60%),
                linear-gradient(135deg, color-mix(in srgb, #EC4899 45%, transparent), color-mix(in srgb, #F472B6 35%, transparent))
              `,border:"2px solid color-mix(in srgb, #EC4899 60%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #EC4899 40%, transparent)"},animate:{scale:[1,1.05,1],boxShadow:["0 0 20px color-mix(in srgb, #EC4899 40%, transparent)","0 0 30px color-mix(in srgb, #EC4899 55%, transparent)","0 0 20px color-mix(in srgb, #EC4899 40%, transparent)"]},transition:{duration:2.5,repeat:1/0,ease:"easeInOut"},children:e.jsx(x,{Icon:o.History,size:20,className:"text-pink-300"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Scans Récents"}),e.jsx("p",{className:"text-sm text-white/70",children:"Vos derniers inventaires"})]})]}),e.jsx("button",{onClick:n,className:"px-4 py-2 rounded-xl text-sm font-semibold transition-all duration-300",style:{background:"color-mix(in srgb, #EC4899 15%, transparent)",border:"2px solid color-mix(in srgb, #EC4899 30%, transparent)",color:"#F472B6"},onMouseEnter:l=>{window.matchMedia("(hover: hover)").matches&&(l.currentTarget.style.background="color-mix(in srgb, #EC4899 25%, transparent)",l.currentTarget.style.borderColor="color-mix(in srgb, #EC4899 45%, transparent)")},onMouseLeave:l=>{window.matchMedia("(hover: hover)").matches&&(l.currentTarget.style.background="color-mix(in srgb, #EC4899 15%, transparent)",l.currentTarget.style.borderColor="color-mix(in srgb, #EC4899 30%, transparent)")},children:"Voir tout"})]}),e.jsx("div",{className:"space-y-4",children:r.length===0?e.jsxs(h.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"color-mix(in srgb, #EC4899 15%, transparent)",border:"2px solid color-mix(in srgb, #EC4899 25%, transparent)"},children:e.jsx(x,{Icon:o.Package,size:32,className:"text-pink-300 opacity-50"})}),e.jsx("p",{className:"text-white/60 text-sm",children:"Aucun scan effectué pour le moment"}),e.jsx("p",{className:"text-white/50 text-xs mt-2",children:"Lancez votre premier scan pour commencer"})]}):r.map((l,c)=>e.jsx(h.button,{onClick:()=>i(l.id),className:"w-full text-left rounded-xl p-4 transition-all duration-300",style:{background:"rgba(255, 255, 255, 0.03)",border:"2px solid rgba(255, 255, 255, 0.1)",backdropFilter:"blur(12px)"},initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:c*.1},whileHover:{scale:1.02,background:"rgba(236, 72, 153, 0.08)",borderColor:"color-mix(in srgb, #EC4899 30%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #EC4899 20%, transparent)"},children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-20 h-20 rounded-lg flex items-center justify-center flex-shrink-0",style:{background:`
                      radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                      linear-gradient(135deg, color-mix(in srgb, #EC4899 35%, transparent), color-mix(in srgb, #F472B6 25%, transparent))
                    `,border:"2px solid color-mix(in srgb, #EC4899 40%, transparent)",boxShadow:"0 4px 12px rgba(0,0,0,0.3), inset 0 2px 0 rgba(255,255,255,0.2)"},children:e.jsx(x,{Icon:o.Refrigerator,size:32,className:"text-pink-300"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:"text-white font-semibold text-base truncate",children:["Scan du ",Je(new Date(l.created_at),"d MMM yyyy",{locale:Ke})]}),l.status==="completed"&&e.jsx("div",{className:"px-2 py-0.5 rounded-full text-xs font-medium",style:{background:"color-mix(in srgb, #10B981 20%, transparent)",color:"#10B981",border:"1px solid color-mix(in srgb, #10B981 30%, transparent)"},children:"Terminé"})]}),e.jsx("div",{className:"flex items-center gap-4 text-sm text-white/70",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(x,{Icon:o.Package,size:14}),e.jsxs("span",{children:[Array.isArray(l.inventory_final)?l.inventory_final.length:0," items"]})]})}),e.jsx("p",{className:"text-xs text-white/50 mt-1",children:Je(new Date(l.created_at),"HH:mm",{locale:Ke})})]}),e.jsx(x,{Icon:o.ChevronRight,size:20,className:"text-white/40 flex-shrink-0"})]})},l.id))})]})},ls=()=>{const[t,s]=f.useState({}),[r,a]=f.useState(0),[i,n]=f.useState(0),[l,c]=f.useState([]);f.useEffect(()=>{(async()=>{try{const{data:{user:d}}=await U.auth.getUser();if(!d)return;const{data:b}=await U.from("recipe_sessions").select("inventory_final").eq("user_id",d.id).not("inventory_final","is",null);if(b&&b.length>0){const v=b.length,I=b.reduce((N,B)=>N+(Array.isArray(B.inventory_final)?B.inventory_final.length:0),0),w={};b.forEach(N=>{Array.isArray(N.inventory_final)&&N.inventory_final.forEach(B=>{const E=B.category||"Autre";w[E]=(w[E]||0)+1})});const D=Object.entries(w).sort(([,N],[,B])=>B-N).slice(0,3).map(([N,B],E)=>({name:N,count:B,color:["#10B981","#F59E0B","#EC4899"][E]}));a(v),n(I),c(D)}}catch(d){y.warn("SCANNER_STATS_CARD","Failed to load stats",{error:d instanceof Error?d.message:"Unknown error"})}})()},[]);const u=i>0?85:0,m=[{label:"Scans Effectués",value:r,icon:"Scan",color:"#EC4899",unit:""},{label:"Items Détectés",value:i,icon:"Package",color:"#F472B6",unit:""},{label:"Taux de Fraîcheur",value:u,icon:"Sparkles",color:"#10B981",unit:"%"}];return f.useEffect(()=>{m.forEach(p=>{const d=p.label;let b=0;const v=p.value/30,I=setInterval(()=>{b+=v,b>=p.value&&(b=p.value,clearInterval(I)),s(w=>({...w,[d]:Math.floor(b)}))},30);return()=>clearInterval(I)})},[r,i]),e.jsxs(C,{className:"p-6",style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #EC4899 12%, transparent) 0%, transparent 60%),
          radial-gradient(circle at 70% 80%, color-mix(in srgb, #F472B6 10%, transparent) 0%, transparent 50%),
          linear-gradient(145deg, rgba(255,255,255,0.12), rgba(255,255,255,0.08)),
          rgba(11, 14, 23, 0.80)
        `,borderColor:"color-mix(in srgb, #EC4899 35%, transparent)",boxShadow:`
          0 12px 40px rgba(0, 0, 0, 0.25),
          0 0 30px color-mix(in srgb, #EC4899 20%, transparent),
          inset 0 2px 0 rgba(255, 255, 255, 0.15)
        `,backdropFilter:"blur(24px) saturate(150%)",WebkitBackdropFilter:"blur(24px) saturate(150%)"},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(h.div,{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:`
              radial-gradient(circle at 30% 30%, rgba(255,255,255,0.25) 0%, transparent 60%),
              linear-gradient(135deg, color-mix(in srgb, #EC4899 45%, transparent), color-mix(in srgb, #F472B6 35%, transparent))
            `,border:"2px solid color-mix(in srgb, #EC4899 60%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #EC4899 40%, transparent)"},animate:{scale:[1,1.05,1],boxShadow:["0 0 20px color-mix(in srgb, #EC4899 40%, transparent)","0 0 30px color-mix(in srgb, #EC4899 55%, transparent)","0 0 20px color-mix(in srgb, #EC4899 40%, transparent)"]},transition:{duration:2.5,repeat:1/0,ease:"easeInOut"},children:e.jsx(x,{Icon:o.BarChart3,size:20,className:"text-pink-300"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Statistiques"}),e.jsx("p",{className:"text-sm text-white/70",children:"Vue d'ensemble de vos scans"})]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-4 mb-6",children:m.map((p,d)=>{const b=t[p.label]||0,v=p.unit==="%"?b:b/(p.value||1)*100;return e.jsxs(h.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,delay:d*.1},className:"text-center",children:[e.jsxs("div",{className:"relative w-24 h-24 mx-auto mb-3",children:[e.jsxs("svg",{className:"w-full h-full transform -rotate-90",children:[e.jsx("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"rgba(255, 255, 255, 0.1)",strokeWidth:"8"}),e.jsx(h.circle,{cx:"48",cy:"48",r:"40",fill:"none",stroke:p.color,strokeWidth:"8",strokeLinecap:"round",strokeDasharray:`${2*Math.PI*40}`,initial:{strokeDashoffset:2*Math.PI*40},animate:{strokeDashoffset:2*Math.PI*40*(1-(p.unit==="%"?b/100:Math.min(v/100,1)))},transition:{duration:1,ease:"easeOut"},style:{filter:`drop-shadow(0 0 8px ${p.color}80)`}})]}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[e.jsx(x,{Icon:o[p.icon],size:20,style:{color:p.color}}),e.jsxs("span",{className:"text-xl font-bold text-white mt-1",children:[b,p.unit]})]})]}),e.jsx("p",{className:"text-xs text-white/70 font-medium",children:p.label})]},p.label)})}),e.jsxs(h.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4},className:"rounded-xl p-4 mb-4",style:{background:"rgba(255, 255, 255, 0.03)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-semibold text-white",children:"Tendance des Scans"}),e.jsx("span",{className:"text-xs text-white/60",children:"7 derniers jours"})]}),e.jsx("div",{className:"flex items-end justify-between h-16 gap-1",children:[3,5,4,7,6,8,9].map((p,d)=>e.jsx(h.div,{className:"flex-1 rounded-t-lg",style:{background:`linear-gradient(180deg, ${o?"#EC4899":"#F472B6"}, ${o?"#F472B6":"#DB2777"})`,boxShadow:"0 0 10px color-mix(in srgb, #EC4899 40%, transparent)"},initial:{height:0},animate:{height:`${p/10*100}%`},transition:{duration:.5,delay:d*.05}},d))})]}),e.jsxs(h.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},children:[e.jsx("h4",{className:"text-sm font-semibold text-white mb-3",children:"Top Catégories"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:l.map((p,d)=>e.jsxs(h.div,{className:"px-4 py-2 rounded-full flex items-center gap-2",style:{background:`color-mix(in srgb, ${p.color} 15%, transparent)`,border:`2px solid color-mix(in srgb, ${p.color} 30%, transparent)`},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.6+d*.1},whileHover:{scale:1.05},children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:p.color}}),e.jsx("span",{className:"text-sm font-medium text-white",children:p.name}),e.jsx("span",{className:"text-xs font-bold px-2 py-0.5 rounded-full",style:{background:`color-mix(in srgb, ${p.color} 25%, transparent)`,color:p.color},children:p.count})]},p.name))})]}),r>0&&e.jsxs(h.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.7},className:"mt-4 p-3 rounded-xl flex items-start gap-3",style:{background:"color-mix(in srgb, #10B981 10%, transparent)",border:"2px solid color-mix(in srgb, #10B981 25%, transparent)"},children:[e.jsx(x,{Icon:o.Lightbulb,size:18,className:"text-green-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-green-300 mb-1",children:"Excellent Progrès!"}),e.jsxs("p",{className:"text-xs text-white/70",children:["Vous avez scanné ",r," frigo",r>1?"s":""," et détecté ",i," ingrédients. Continuez pour débloquer plus de recettes personnalisées."]})]})]})]})},fr=()=>{const{loadRecentSessions:t}=ye();return f.useEffect(()=>{t()},[t]),e.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"space-y-6",children:[e.jsx(ns,{}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(is,{}),e.jsx(ls,{})]})]})},os=()=>{const t=oe(),{click:s}=K(),{startScan:r}=ye(),a=()=>{s(),r(),t("/fridge/scan")};return e.jsx(C,{className:"p-8 text-center relative overflow-hidden rounded-3xl transform-gpu preserve-3d will-transform transition-all duration-300",style:{background:`
          radial-gradient(circle at 30% 20%, rgba(24, 227, 255, 0.25) 0%, transparent 60%),
          radial-gradient(circle at 70% 80%, rgba(103, 232, 249, 0.15) 0%, transparent 60%),
          rgba(255, 255, 255, 0.06)
        `,borderColor:"rgba(24, 227, 255, 0.4)",backdropFilter:"blur(20px) saturate(160%)",boxShadow:`
          0 12px 40px rgba(0, 0, 0, 0.25),
          0 0 30px rgba(24, 227, 255, 0.3),
          inset 0 2px 0 rgba(255, 255, 255, 0.15)
        `},children:e.jsxs("div",{className:"flex flex-col items-center space-y-6",children:[e.jsx("div",{className:"w-20 h-20 mx-auto rounded-full flex items-center justify-center relative",style:{background:`
              radial-gradient(circle at 30% 20%, rgba(24, 227, 255, 0.4) 0%, transparent 60%),
              radial-gradient(circle at 70% 80%, rgba(103, 232, 249, 0.25) 0%, transparent 60%),
              rgba(255, 255, 255, 0.1)
            `,border:"3px solid rgba(24, 227, 255, 0.6)",boxShadow:`
              0 12px 40px rgba(24, 227, 255, 0.4),
              0 0 60px rgba(103, 232, 249, 0.3),
              inset 0 4px 0 rgba(255, 255, 255, 0.25),
              inset 0 -2px 0 rgba(0, 0, 0, 0.1)
            `},children:e.jsx(x,{Icon:o.Refrigerator,size:36,style:{color:"#18E3FF",fill:"none",stroke:"#18E3FF",filter:"drop-shadow(0 0 12px rgba(24, 227, 255, 0.6))"},variant:"pure"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white",children:"Mon Inventaire"}),e.jsx("p",{className:"text-white/80 text-base md:text-lg leading-relaxed",children:"Gérez vos ingrédients, générez des recettes et des plans alimentaires"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 my-8",children:[e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-full flex items-center justify-center",style:{background:`
                  radial-gradient(circle at 30% 20%, rgba(24, 227, 255, 0.3) 0%, transparent 60%),
                  rgba(255, 255, 255, 0.08)
                `,border:"2px solid rgba(24, 227, 255, 0.5)",boxShadow:`
                  0 8px 24px rgba(24, 227, 255, 0.3),
                  inset 0 2px 0 rgba(255, 255, 255, 0.2)
                `},children:e.jsx(x,{Icon:o.Camera,size:24,style:{color:"#18E3FF",fill:"none",stroke:"#18E3FF",filter:"drop-shadow(0 0 8px rgba(24, 227, 255, 0.5))"},variant:"pure"})}),e.jsx("h4",{className:"text-lg font-semibold text-white",children:"Scan Rapide"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Photographiez votre frigo en quelques secondes pour un inventaire automatique"})]}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-full flex items-center justify-center",style:{background:`
                  radial-gradient(circle at 30% 20%, rgba(24, 227, 255, 0.3) 0%, transparent 60%),
                  rgba(255, 255, 255, 0.08)
                `,border:"2px solid rgba(24, 227, 255, 0.5)",boxShadow:`
                  0 8px 24px rgba(24, 227, 255, 0.3),
                  inset 0 2px 0 rgba(255, 255, 255, 0.2)
                `},children:e.jsx(x,{Icon:o.Utensils,size:24,style:{color:"#18E3FF",fill:"none",stroke:"#18E3FF",filter:"drop-shadow(0 0 8px rgba(24, 227, 255, 0.5))"},variant:"pure"})}),e.jsx("h4",{className:"text-lg font-semibold text-white",children:"Recettes Personnalisées"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Générez des recettes adaptées à vos ingrédients disponibles"})]}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-full flex items-center justify-center",style:{background:`
                  radial-gradient(circle at 30% 20%, rgba(24, 227, 255, 0.3) 0%, transparent 60%),
                  rgba(255, 255, 255, 0.08)
                `,border:"2px solid rgba(24, 227, 255, 0.5)",boxShadow:`
                  0 8px 24px rgba(24, 227, 255, 0.3),
                  inset 0 2px 0 rgba(255, 255, 255, 0.2)
                `},children:e.jsx(x,{Icon:o.Calendar,size:24,style:{color:"#18E3FF",fill:"none",stroke:"#18E3FF",filter:"drop-shadow(0 0 8px rgba(24, 227, 255, 0.5))"},variant:"pure"})}),e.jsx("h4",{className:"text-lg font-semibold text-white",children:"Plans de Repas"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Créez des plans alimentaires équilibrés pour toute la semaine"})]})]}),e.jsx("button",{onClick:a,className:"px-6 md:px-8 py-3 md:py-4 text-lg md:text-xl font-bold relative overflow-hidden rounded-full transition-all duration-200 hover:scale-105 active:scale-95",style:{background:`
              linear-gradient(135deg, #18E3FF 0%, #67E8F9 100%)
            `,border:"2px solid rgba(24, 227, 255, 0.6)",boxShadow:`
              0 8px 32px rgba(24, 227, 255, 0.4),
              0 0 40px rgba(103, 232, 249, 0.25),
              inset 0 2px 0 rgba(255, 255, 255, 0.25),
              inset 0 -2px 0 rgba(0, 0, 0, 0.1)
            `,backdropFilter:"blur(20px) saturate(160%)",color:"white"},children:e.jsxs("span",{className:"relative z-10 flex items-center gap-2",children:[e.jsx(x,{Icon:o.Camera,size:20,style:{color:"white",fill:"none",stroke:"white",filter:"drop-shadow(0 0 8px rgba(255, 255, 255, 0.4))"},variant:"pure"}),"Commencer - Scanner Mon Frigo"]})}),e.jsx("div",{className:"mt-8 p-4 rounded-lg w-full",style:{background:`
              radial-gradient(circle at 30% 20%, rgba(24, 227, 255, 0.15) 0%, transparent 60%),
              rgba(255, 255, 255, 0.04)
            `,border:"1px solid rgba(24, 227, 255, 0.3)"},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(x,{Icon:o.Lightbulb,size:20,style:{color:"#18E3FF",fill:"none",stroke:"#18E3FF",filter:"drop-shadow(0 0 6px rgba(24, 227, 255, 0.4))",marginTop:"2px"},variant:"pure"}),e.jsxs("div",{className:"text-left",children:[e.jsx("h5",{className:"text-sm font-semibold text-white/90 mb-1",children:"Astuce TwinForge"}),e.jsx("p",{className:"text-white/70 text-xs leading-relaxed",children:"Pour de meilleurs résultats, photographiez votre frigo avec un bon éclairage et organisez vos aliments de manière visible."})]})]})})]})})},cs=({session:t,onDeleteIndividualInventory:s})=>{const r=oe(),a=()=>{r("/fridge#recipes")},i=()=>{r("/fridge#plan")},n=()=>{s(t.id)};return e.jsxs("div",{className:"glass-card p-6 rounded-3xl",style:{background:`
          linear-gradient(135deg,
            color-mix(in srgb, var(--color-fridge-primary) 15%, transparent) 0%,
            color-mix(in srgb, var(--color-plasma-cyan) 12%, transparent) 50%,
            color-mix(in srgb, var(--color-fridge-primary) 8%, transparent) 100%
          )
        `,borderColor:"color-mix(in srgb, var(--color-fridge-primary) 40%, transparent)",borderRadius:"1.5rem",boxShadow:`
          0 12px 40px color-mix(in srgb, var(--color-fridge-primary) 25%, transparent),
          0 4px 16px rgba(0, 0, 0, 0.3),
          inset 0 2px 0 rgba(255, 255, 255, 0.15),
          inset 0 -2px 0 rgba(0, 0, 0, 0.1)
        `},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 rounded-xl",style:{background:`
              radial-gradient(circle at center, 
                color-mix(in srgb, var(--color-fridge-primary) 30%, transparent) 0%,
                color-mix(in srgb, var(--color-fridge-primary) 20%, transparent) 50%,
                color-mix(in srgb, var(--color-fridge-primary) 10%, transparent) 100%
              )
            `,border:"1px solid color-mix(in srgb, var(--color-fridge-primary) 50%, transparent)",boxShadow:`
              0 0 20px color-mix(in srgb, var(--color-fridge-primary) 40%, transparent),
              0 4px 12px rgba(0, 0, 0, 0.2),
              inset 0 1px 0 rgba(255, 255, 255, 0.2)
            `},children:e.jsx(x,{Icon:o.CheckCircle,size:20,className:"text-white"})}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Inventaire Sélectionné"})]}),e.jsxs("div",{className:"mb-4 p-4 bg-white/5 rounded-lg border border-white/10",children:[e.jsxs("p",{className:"text-gray-300 text-sm",children:["Inventaire du ",new Date(t.created_at).toLocaleDateString("fr-FR")]}),e.jsxs("p",{className:"text-white font-medium",children:[t.inventory_final?.length||0," articles détectés"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[e.jsx("button",{onClick:a,className:"btn-glass--primary px-4 py-3 text-sm font-medium rounded-2xl",style:{background:`
              linear-gradient(135deg,
                var(--color-fridge-primary) 0%,
                color-mix(in srgb, var(--color-fridge-primary) 80%, #ffffff) 100%
              )
            `,borderColor:"color-mix(in srgb, var(--color-fridge-primary) 70%, transparent)",borderRadius:"1rem",boxShadow:`
              0 8px 24px color-mix(in srgb, var(--color-fridge-primary) 35%, transparent),
              0 3px 12px rgba(0, 0, 0, 0.25),
              inset 0 2px 0 rgba(255, 255, 255, 0.2),
              inset 0 -2px 0 rgba(0, 0, 0, 0.1)
            `,color:"white",transform:"translateZ(0)",transition:"all 0.2s ease"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{Icon:o.ChefHat,size:16}),e.jsx("span",{children:"Générer Recettes"})]})}),e.jsx("button",{onClick:i,className:"btn-glass--primary px-4 py-3 text-sm font-medium rounded-2xl",style:{background:`
              linear-gradient(135deg,
                var(--color-plasma-cyan) 0%,
                color-mix(in srgb, var(--color-plasma-cyan) 80%, #ffffff) 100%
              )
            `,borderColor:"color-mix(in srgb, var(--color-plasma-cyan) 70%, transparent)",borderRadius:"1rem",boxShadow:`
              0 8px 24px color-mix(in srgb, var(--color-plasma-cyan) 35%, transparent),
              0 3px 12px rgba(0, 0, 0, 0.25),
              inset 0 2px 0 rgba(255, 255, 255, 0.2),
              inset 0 -2px 0 rgba(0, 0, 0, 0.1)
            `,color:"white",transform:"translateZ(0)",transition:"all 0.2s ease"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{Icon:o.Calendar,size:16}),e.jsx("span",{children:"Plan de Repas"})]})}),e.jsx("button",{onClick:n,className:"btn-glass--danger px-4 py-3 text-sm font-medium rounded-2xl",style:{borderRadius:"1rem"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{Icon:o.Trash2,size:16}),e.jsx("span",{children:"Supprimer cet inventaire"})]})})]})]})},ds=({onDeleteAllInventories:t})=>e.jsx("div",{className:"glass-card rounded-3xl",style:{background:"color-mix(in srgb, var(--color-plasma-cyan) 8%, transparent)",borderColor:"color-mix(in srgb, var(--color-plasma-cyan) 30%, transparent)",borderRadius:"1.5rem",boxShadow:`
          0 8px 32px color-mix(in srgb, var(--color-plasma-cyan) 15%, transparent),
          0 2px 8px rgba(0, 0, 0, 0.2),
          inset 0 1px 0 rgba(255, 255, 255, 0.1)
        `,overflow:"visible",isolation:"isolate",padding:0,paddingBottom:"1rem"},children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsx("div",{className:"flex-shrink-0",style:{width:"56px",height:"56px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",position:"relative",background:`
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.22) 0%, transparent 50%),
                radial-gradient(circle at 70% 70%, color-mix(in srgb, var(--color-plasma-cyan) 15%, transparent) 0%, transparent 60%),
                linear-gradient(135deg,
                  color-mix(in srgb, var(--color-plasma-cyan) 25%, transparent),
                  color-mix(in srgb, var(--color-plasma-cyan) 15%, transparent))
              `,border:"2px solid color-mix(in srgb, var(--color-plasma-cyan) 45%, transparent)",boxShadow:`
                0 8px 32px color-mix(in srgb, var(--color-plasma-cyan) 25%, transparent),
                0 0 40px color-mix(in srgb, var(--color-plasma-cyan) 18%, transparent),
                inset 0 2px 0 rgba(255, 255, 255, 0.25)
              `,backdropFilter:"blur(16px) saturate(150%)",WebkitBackdropFilter:"blur(16px) saturate(150%)",transform:"translateZ(0)",overflow:"visible"},children:e.jsx(x,{Icon:o.Archive,size:28,style:{color:"#06B6D4",filter:"drop-shadow(0 0 8px rgba(6, 182, 212, 0.6))"}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{className:"text-xl md:text-2xl font-bold text-white mb-1 tracking-tight",children:"Gestion des Inventaires"}),e.jsx("p",{className:"text-gray-400 text-sm md:text-base leading-relaxed",children:"Vos inventaires de frigo sauvegardés"})]})]})})}),xs=({sessions:t,selectedInventorySessionId:s,onInventorySelect:r,formatDate:a,getInventoryPreview:i})=>t.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-white/60",children:"Aucun inventaire disponible. Scannez votre frigo pour commencer !"})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.jsx(le,{children:t.map((n,l)=>e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{delay:l*.1},children:e.jsx(C,{className:`p-6 h-full cursor-pointer group relative overflow-hidden rounded-3xl transform-gpu preserve-3d will-transform transition-all duration-300 hover:scale-[1.02] active:scale-[0.98] ${s===n.id?"ring-2 ring-indigo-400/50":""}`,style:{background:`
                  radial-gradient(circle at 30% 20%, color-mix(in srgb, #06B6D4 ${s===n.id?"15%":"8%"}, transparent) 0%, transparent 60%),
                  radial-gradient(circle at 70% 80%, color-mix(in srgb, #06B6D4 ${s===n.id?"10%":"6%"}, transparent) 0%, transparent 60%),
                  rgba(255, 255, 255, 0.06)
                `,borderColor:s===n.id?"color-mix(in srgb, #06B6D4 40%, transparent)":"color-mix(in srgb, #06B6D4 20%, transparent)",borderRadius:"1.5rem",backdropFilter:"blur(20px) saturate(160%)",boxShadow:s===n.id?`
                    0 12px 40px rgba(0, 0, 0, 0.25),
                    0 0 40px color-mix(in srgb, #06B6D4 25%, transparent),
                    inset 0 2px 0 rgba(255, 255, 255, 0.2)
                  `:`
                    0 8px 32px rgba(0, 0, 0, 0.2),
                    0 0 20px color-mix(in srgb, #06B6D4 10%, transparent),
                    inset 0 2px 0 rgba(255, 255, 255, 0.15)
                  `},onClick:()=>r(n),children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center relative",style:{background:`
                          radial-gradient(circle at 30% 20%, color-mix(in srgb, #06B6D4 20%, transparent) 0%, transparent 60%),
                          rgba(255, 255, 255, 0.1)
                        `,border:"2px solid color-mix(in srgb, #06B6D4 40%, transparent)",boxShadow:`
                          0 4px 16px color-mix(in srgb, #06B6D4 20%, transparent),
                          inset 0 1px 0 rgba(255, 255, 255, 0.2)
                        `},children:e.jsx(x,{Icon:o.Package,size:18,style:{color:"#06B6D4",filter:"drop-shadow(0 0 6px color-mix(in srgb, #06B6D4 30%, transparent))"},variant:"pure"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-white text-sm",children:"Inventaire"}),e.jsx("p",{className:"text-white/60 text-xs",children:a(n.created_at)})]})]}),e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 rounded-lg",style:{background:"color-mix(in srgb, #10B981 20%, transparent)",border:"1px solid color-mix(in srgb, #10B981 30%, transparent)"},children:[e.jsx(x,{Icon:o.Package,size:12,style:{color:"#10B981",filter:"drop-shadow(0 0 4px color-mix(in srgb, #10B981 30%, transparent))"},variant:"pure"}),e.jsx("span",{className:"text-emerald-300 text-xs font-medium",children:n.inventory_final?.length||0})]})]}),e.jsx("div",{className:"flex-1 mb-4",children:e.jsx("p",{className:"text-white/80 text-sm leading-relaxed",children:i(n.inventory_final)})}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:`px-3 py-1 rounded-lg text-xs font-medium transition-all duration-200 ${s===n.id?"text-cyan-300":"text-white/60"}`,style:{background:s===n.id?"color-mix(in srgb, #06B6D4 30%, transparent)":"rgba(255, 255, 255, 0.1)",border:s===n.id?"1px solid color-mix(in srgb, #06B6D4 40%, transparent)":"1px solid rgba(255, 255, 255, 0.1)"},children:s===n.id?"Sélectionné":"Cliquer pour sélectionner"})})]})})},n.id))})}),ps=({loading:t,error:s})=>t?e.jsx(C,{className:"p-8 text-center relative overflow-hidden rounded-3xl transform-gpu preserve-3d will-transform transition-all duration-300",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #06B6D4 12%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, #06B6D4 8%, transparent) 0%, transparent 60%),
            rgba(255, 255, 255, 0.06)
          `,borderColor:"color-mix(in srgb, #06B6D4 25%, transparent)",backdropFilter:"blur(20px) saturate(160%)",boxShadow:`
            0 12px 40px rgba(0, 0, 0, 0.25),
            0 0 30px color-mix(in srgb, #06B6D4 15%, transparent),
            inset 0 2px 0 rgba(255, 255, 255, 0.15)
          `},children:e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center relative",style:{background:`
                radial-gradient(circle at 30% 20%, color-mix(in srgb, #06B6D4 20%, transparent) 0%, transparent 60%),
                rgba(255, 255, 255, 0.1)
              `,border:"2px solid color-mix(in srgb, #06B6D4 50%, transparent)",boxShadow:`
                0 8px 32px color-mix(in srgb, #06B6D4 25%, transparent),
                inset 0 2px 0 rgba(255, 255, 255, 0.2)
              `},children:e.jsx(x,{Icon:o.Loader2,size:24,className:"animate-spin",style:{color:"#06B6D4",filter:"drop-shadow(0 0 8px color-mix(in srgb, #06B6D4 40%, transparent))"},variant:"pure"})}),e.jsx("span",{className:"text-white text-lg font-medium",children:"Chargement de vos inventaires..."})]})}):s?e.jsx(C,{className:"p-6 relative overflow-hidden rounded-3xl transform-gpu preserve-3d will-transform transition-all duration-300",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #EF4444 12%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, #F97316 8%, transparent) 0%, transparent 60%),
            rgba(255, 255, 255, 0.06)
          `,borderColor:"color-mix(in srgb, #EF4444 25%, transparent)",backdropFilter:"blur(20px) saturate(160%)",boxShadow:`
            0 12px 40px rgba(0, 0, 0, 0.25),
            0 0 30px color-mix(in srgb, #EF4444 15%, transparent),
            inset 0 2px 0 rgba(255, 255, 255, 0.15)
          `},children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center relative",style:{background:`
                radial-gradient(circle at 30% 20%, color-mix(in srgb, #EF4444 20%, transparent) 0%, transparent 60%),
                rgba(255, 255, 255, 0.1)
              `,border:"2px solid color-mix(in srgb, #EF4444 50%, transparent)",boxShadow:`
                0 8px 32px color-mix(in srgb, #EF4444 25%, transparent),
                inset 0 2px 0 rgba(255, 255, 255, 0.2)
              `},children:e.jsx(x,{Icon:o.AlertCircle,size:24,style:{color:"#EF4444",filter:"drop-shadow(0 0 8px color-mix(in srgb, #EF4444 40%, transparent))"},variant:"pure"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-1",children:"Erreur de Chargement"}),e.jsx("p",{className:"text-white/70",children:s})]})]})}):null,ms=({loading:t,sessions:s})=>t||s.length===0?null:e.jsx(C,{className:"p-4 relative overflow-hidden rounded-3xl transform-gpu preserve-3d will-transform transition-all duration-300",style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #06B6D4 8%, transparent) 0%, transparent 60%),
          rgba(255, 255, 255, 0.06)
        `,borderColor:"color-mix(in srgb, #06B6D4 20%, transparent)",backdropFilter:"blur(20px) saturate(160%)",boxShadow:`
          0 8px 32px rgba(0, 0, 0, 0.2),
          0 0 20px color-mix(in srgb, #06B6D4 10%, transparent),
          inset 0 2px 0 rgba(255, 255, 255, 0.15)
        `},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(x,{Icon:o.Info,size:16,style:{color:"#06B6D4",filter:"drop-shadow(0 0 6px color-mix(in srgb, #06B6D4 30%, transparent))"},variant:"pure"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-cyan-300 font-medium",children:"Inventaires disponibles : "}),e.jsxs("span",{className:"text-white/80",children:[s.length," inventaire",s.length>1?"s":""," sauvegardé",s.length>1?"s":""]})]})]})}),gs=t=>{const[s,r]=f.useState(!1),[a,i]=f.useState([]),[n,l]=f.useState(null);return f.useEffect(()=>{let c=!0;async function u(){if(!t){i([]);return}r(!0),l(null);try{y.info("FRIDGES_TAB","Loading fridge sessions",{userId:t,timestamp:new Date().toISOString()});const{data:m,error:p}=await U.from("recipe_sessions").select("id, created_at, inventory_final, status").eq("user_id",t).not("inventory_final","is",null).order("created_at",{ascending:!1});if(p)throw new Error(`Failed to fetch fridge sessions: ${p.message}`);if(!c)return;const d=(m||[]).filter(b=>b.inventory_final&&Array.isArray(b.inventory_final)&&b.inventory_final.length>0);i(d),y.info("FRIDGES_TAB","Loaded fridge sessions",{sessionsCount:d.length,timestamp:new Date().toISOString()})}catch(m){if(y.error("FRIDGES_TAB","Failed to load fridge sessions",{error:m instanceof Error?m.message:"Unknown error",userId:t,timestamp:new Date().toISOString()}),!c)return;l("Erreur lors du chargement des inventaires")}finally{c&&r(!1)}}return u(),()=>{c=!1}},[t]),{loading:s,sessions:a,error:n,setSessions:i,setLoading:r}},us=(t,s,r,a,i)=>{const{showToast:n}=Ae(),{showModal:l}=ht(),c=f.useCallback(()=>{!t||s.length===0||l({title:"Supprimer tous les inventaires",message:"Êtes-vous sûr de vouloir supprimer tous vos inventaires de frigo ? Cette action est irréversible.",confirmText:"Supprimer tout",cancelText:"Annuler",onConfirm:async()=>{a(!0);try{const m=s.map(p=>p.id);if(m.length>0){const{error:p}=await U.from("recipes").delete().in("session_id",m);if(p)throw console.error("Error deleting recipes:",p),p;const{error:d}=await U.from("recipe_sessions").delete().eq("user_id",t);if(d)throw console.error("Error deleting recipe sessions:",d),d}r([]),i(null),n("Tous les inventaires ont été supprimés avec succès","success")}catch(m){console.error("Error deleting all inventories:",m),n("Erreur lors de la suppression des inventaires","error")}finally{a(!1)}}})},[t,s,r,a,i,l,n]),u=f.useCallback(m=>{if(!t)return;const p=s.find(d=>d.id===m);p&&l({title:"Supprimer cet inventaire",message:`Êtes-vous sûr de vouloir supprimer l'inventaire du ${new Date(p.created_at).toLocaleDateString("fr-FR")} ? Cette action est irréversible.`,confirmText:"Supprimer",cancelText:"Annuler",onConfirm:async()=>{a(!0);try{const{error:d}=await U.from("recipes").delete().eq("session_id",m);if(d)throw console.error("Error deleting recipes:",d),d;const{error:b}=await U.from("recipe_sessions").delete().eq("id",m).eq("user_id",t);if(b)throw console.error("Error deleting recipe session:",b),b;const v=s.filter(I=>I.id!==m);r(v),i(null),n("Inventaire supprimé avec succès","success")}catch(d){console.error("Error deleting individual inventory:",d),n("Erreur lors de la suppression de l'inventaire","error")}finally{a(!1)}}})},[t,s,r,a,i,l,n]);return{handleDeleteAllInventories:c,handleDeleteIndividualInventory:u}},bs=()=>{const{click:t}=K(),[s,r]=f.useState(null);return{selectedInventorySessionId:s,handleInventorySelect:i=>{t(),r(i.id),setTimeout(()=>{const n=document.getElementById("selected-inventory-actions");n&&n.scrollIntoView({behavior:"smooth",block:"center"})},100)},setSelectedInventorySessionId:r}},hs=t=>new Date(t).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}),fs=t=>{if(!t||t.length===0)return"Inventaire vide";const s=t.slice(0,3).map(a=>a.name||a.item||"Article").join(", "),r=t.length-3;return r>0?`${s} et ${r} autre${r>1?"s":""}`:s},vr=()=>{const t=oe(),{showToast:s}=Ae(),{session:r}=Be(),{startRecipeGenerationFromInventory:a}=ye(),{generateMealPlan:i}=ke(),n=r?.user?.id,{loading:l,sessions:c,error:u,setSessions:m,setLoading:p}=gs(n),{selectedInventorySessionId:d,handleInventorySelect:b,setSelectedInventorySessionId:v}=bs(),{handleDeleteAllInventories:I,handleDeleteIndividualInventory:w}=us(n,c,m,p,v),D=c.find(N=>N.id===d);return e.jsxs("div",{className:"space-y-6",children:[!l&&c.length===0&&e.jsx(os,{}),c.length>0&&e.jsx(ds,{onDeleteAllInventories:I}),e.jsx(ps,{loading:l,error:u}),!l&&!u&&e.jsx(xs,{sessions:c,selectedInventorySessionId:d,onInventorySelect:b,formatDate:hs,getInventoryPreview:fs}),D&&e.jsx(cs,{session:D,onGenerateRecipes:a,onGenerateMealPlan:i,onDeleteIndividualInventory:w,navigate:t,showToast:s}),e.jsx(ms,{loading:l,sessions:c}),c.length>0&&e.jsx("div",{className:"flex justify-center pt-4",children:e.jsx("button",{onClick:I,className:"btn-glass--danger px-8 py-3 text-base font-medium rounded-2xl",style:{borderRadius:"1rem"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(x,{Icon:o.AlertTriangle,size:20}),e.jsx("span",{children:"Supprimer tous les inventaires"})]})})})]})},pt=({recipe:t,isOpen:s,onClose:r})=>t?e.jsx(le,{children:s&&e.jsxs(e.Fragment,{children:[e.jsx(h.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100]",onClick:r}),e.jsx("div",{className:"fixed inset-0 z-[101] flex items-center justify-center p-4 pointer-events-none",children:e.jsx(h.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"w-full max-w-4xl max-h-[90vh] overflow-auto pointer-events-auto",children:e.jsxs(C,{className:"p-6 relative",children:[e.jsx("button",{onClick:r,className:"absolute top-4 right-4 p-2 rounded-xl bg-white/10 hover:bg-white/20 transition-colors","aria-label":"Fermer",children:e.jsx(gt,{size:20,className:"text-white"})}),t.imageUrl&&e.jsx("img",{src:t.imageUrl,alt:t.title,className:"w-full h-64 object-cover rounded-xl mb-6"}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:t.title}),t.description&&e.jsx("p",{className:"text-white/70 mb-6",children:t.description}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"glass-card p-4 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(x,{Icon:o.Clock,size:16,className:"text-cyan-400"}),e.jsx("span",{className:"text-xs text-white/60",children:"Préparation"})]}),e.jsxs("p",{className:"text-white font-semibold",children:[t.prepTimeMin," min"]})]}),e.jsxs("div",{className:"glass-card p-4 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(x,{Icon:o.Flame,size:16,className:"text-orange-400"}),e.jsx("span",{className:"text-xs text-white/60",children:"Cuisson"})]}),e.jsxs("p",{className:"text-white font-semibold",children:[t.cookTimeMin," min"]})]}),e.jsxs("div",{className:"glass-card p-4 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(x,{Icon:o.Users,size:16,className:"text-pink-400"}),e.jsx("span",{className:"text-xs text-white/60",children:"Portions"})]}),e.jsx("p",{className:"text-white font-semibold",children:t.servings})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Ingrédients"}),e.jsx("div",{className:"space-y-2",children:t.ingredients.map((a,i)=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-cyan-400 mt-1",children:"•"}),e.jsxs("span",{className:"text-white/80",children:[a.quantity," ",a.unit&&a.unit," ",a.name]})]},i))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Instructions"}),e.jsx("div",{className:"space-y-4",children:t.instructions.map(a=>e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-cyan-500/20 flex items-center justify-center",children:e.jsx("span",{className:"text-cyan-400 font-semibold text-sm",children:a.step})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-white/80",children:a.instruction}),a.timeMin&&e.jsxs("p",{className:"text-white/50 text-sm mt-1",children:["⏱️ ",a.timeMin," min"]})]})]},a.step))})]}),t.nutritionalInfo&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Informations nutritionnelles"}),e.jsxs("div",{className:"glass-card p-4 rounded-xl grid grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-xs mb-1",children:"Calories"}),e.jsxs("p",{className:"text-white font-semibold",children:[t.nutritionalInfo.calories," kcal"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-xs mb-1",children:"Protéines"}),e.jsxs("p",{className:"text-white font-semibold",children:[t.nutritionalInfo.protein,"g"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-xs mb-1",children:"Glucides"}),e.jsxs("p",{className:"text-white font-semibold",children:[t.nutritionalInfo.carbs,"g"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-xs mb-1",children:"Lipides"}),e.jsxs("p",{className:"text-white font-semibold",children:[t.nutritionalInfo.fat,"g"]})]})]})]})]})})})]})}):null,vs=({recipe:t,index:s,isSaved:r,isNewlyGenerated:a=!1,isLoading:i=!1,onToggleSaveStatus:n,onView:l})=>{const{click:c}=K();if(i)return e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:s*.1},className:"h-full",children:e.jsxs(C,{className:"p-6 h-full flex flex-col",children:[e.jsx("div",{className:"relative mb-4 h-48 rounded-lg overflow-hidden",children:e.jsx("div",{className:"w-full h-full skeleton-glass"})}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsx("div",{className:"h-6 skeleton-glass rounded w-4/5"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 skeleton-glass rounded w-full"}),e.jsx("div",{className:"h-4 skeleton-glass rounded w-3/4"}),e.jsx("div",{className:"h-4 skeleton-glass rounded w-1/2"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"h-4 w-12 skeleton-glass rounded"}),e.jsx("div",{className:"h-4 w-16 skeleton-glass rounded"}),e.jsx("div",{className:"h-4 w-8 skeleton-glass rounded"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.jsx("div",{className:"h-6 w-16 skeleton-glass rounded-full"}),e.jsx("div",{className:"h-6 w-20 skeleton-glass rounded-full"}),e.jsx("div",{className:"h-6 w-14 skeleton-glass rounded-full"})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("div",{className:"h-3 w-32 skeleton-glass rounded"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"h-3 skeleton-glass rounded w-full"}),e.jsx("div",{className:"h-3 skeleton-glass rounded w-4/5"})]})]})]})});const u=p=>{p.stopPropagation(),c(),n()},m=()=>{l&&(c(),l(t))};return e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:s*.1},className:"relative",children:e.jsxs(C,{className:`p-6 transition-all duration-300 cursor-pointer ${a?"ring-1 ring-yellow-400 bg-yellow-500/10":r?"ring-1 ring-green-400/50 bg-green-500/5":"hover:bg-white/5"}`,onClick:m,children:[a&&e.jsx(h.div,{initial:{scale:0},animate:{scale:1},className:"absolute top-4 left-4 z-10",children:e.jsx("div",{className:"px-3 py-1 text-xs font-bold rounded-full backdrop-blur-md border",style:{background:"color-mix(in srgb, #eab308 20%, rgba(255,255,255,0.1))",borderColor:"color-mix(in srgb, #eab308 40%, transparent)",boxShadow:"0 4px 12px rgba(234, 179, 8, 0.3), inset 0 1px 0 rgba(255,255,255,0.2)",color:"#fbbf24"},children:"NOUVEAU"})}),e.jsx("div",{className:"absolute top-4 right-4 z-10",children:e.jsx(h.div,{onClick:u,className:"w-14 h-14 rounded-full flex items-center justify-center cursor-pointer transition-all duration-300 backdrop-blur-md border hover:scale-110",style:{background:r?"color-mix(in srgb, #ef4444 20%, rgba(255,255,255,0.1))":"color-mix(in srgb, #22c55e 20%, rgba(255,255,255,0.1))",borderColor:r?"color-mix(in srgb, #ef4444 40%, transparent)":"color-mix(in srgb, #22c55e 40%, transparent)"},whileHover:{scale:1.1},whileTap:{scale:.95},children:e.jsx(x,{Icon:r?o.Trash2:o.Plus,size:18,className:r?"text-red-300":"text-green-300"})})}),e.jsx("div",{className:"relative mb-4 h-48 rounded-lg overflow-hidden bg-gradient-to-br from-green-500/20 to-emerald-500/20",children:i||t.isGeneratingImage?e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-white/5 to-white/10 backdrop-blur-sm border border-white/10 rounded-lg flex items-center justify-center",children:e.jsxs("div",{className:"space-y-3 text-center",children:[e.jsx("div",{className:"w-12 h-12 mx-auto bg-white/10 rounded-full animate-pulse"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-white/20 rounded animate-pulse"}),e.jsx("div",{className:"h-2 bg-white/15 rounded animate-pulse w-3/4 mx-auto"})]})]})}):t.imageGenerationError?e.jsxs("div",{className:"w-full h-full bg-gradient-to-br from-red-500/10 to-red-600/5 backdrop-blur-sm border border-red-400/20 rounded-lg flex flex-col items-center justify-center text-center p-4",children:[e.jsx(x,{Icon:o.Image,size:32,className:"text-red-400 mb-2"}),e.jsx("p",{className:"text-xs text-red-300",children:"Image indisponible"})]}):t.imageUrl?e.jsx("img",{src:t.imageUrl,alt:t.title,className:"w-full h-full object-cover",loading:"lazy"}):e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-white/5 to-white/10 backdrop-blur-sm border border-white/10 rounded-lg flex items-center justify-center",children:e.jsx(x,{Icon:o.ChefHat,size:48,className:"text-white/40"})})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-xl font-bold text-white line-clamp-2",children:t.title}),t.description&&e.jsx("p",{className:"text-white/80 text-sm line-clamp-3",children:t.description})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-4 flex-wrap",children:[t.prepTimeMin&&e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 rounded-full backdrop-blur-md border text-xs",style:{background:"color-mix(in srgb, #3b82f6 15%, rgba(255,255,255,0.1))",borderColor:"color-mix(in srgb, #3b82f6 30%, transparent)",boxShadow:"0 2px 8px rgba(59, 130, 246, 0.2)"},children:[e.jsx(x,{Icon:o.Clock,size:12,className:"text-blue-300"}),e.jsxs("span",{className:"text-blue-200 font-medium",children:[t.prepTimeMin,"min"]})]}),t.cookTimeMin&&e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 rounded-full backdrop-blur-md border text-xs",style:{background:"color-mix(in srgb, #f59e0b 15%, rgba(255,255,255,0.1))",borderColor:"color-mix(in srgb, #f59e0b 30%, transparent)",boxShadow:"0 2px 8px rgba(245, 158, 11, 0.2)"},children:[e.jsx(x,{Icon:o.Flame,size:12,className:"text-amber-300"}),e.jsxs("span",{className:"text-amber-200 font-medium",children:[t.cookTimeMin,"min"]})]}),t.servings&&e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 rounded-full backdrop-blur-md border text-xs",style:{background:"color-mix(in srgb, #8b5cf6 15%, rgba(255,255,255,0.1))",borderColor:"color-mix(in srgb, #8b5cf6 30%, transparent)",boxShadow:"0 2px 8px rgba(139, 92, 246, 0.2)"},children:[e.jsx(x,{Icon:o.Users,size:12,className:"text-violet-300"}),e.jsx("span",{className:"text-violet-200 font-medium",children:t.servings})]}),t.nutritionalInfo?.calories&&e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 rounded-full backdrop-blur-md border text-xs",style:{background:"color-mix(in srgb, #ef4444 15%, rgba(255,255,255,0.1))",borderColor:"color-mix(in srgb, #ef4444 30%, transparent)",boxShadow:"0 2px 8px rgba(239, 68, 68, 0.2)"},children:[e.jsx(x,{Icon:o.Flame,size:12,className:"text-red-300"}),e.jsxs("span",{className:"text-red-200 font-medium",children:[t.nutritionalInfo.calories," kcal"]})]})]}),t.dietaryTags&&t.dietaryTags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-2 mt-4",children:[t.dietaryTags.slice(0,3).map((p,d)=>e.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-white/10 text-white/80",children:p},d)),t.dietaryTags.length>3&&e.jsxs("span",{className:"px-2 py-1 text-xs rounded-full bg-white/10 text-white/60",children:["+",t.dietaryTags.length-3]})]}),t.reasons&&t.reasons.length>0&&e.jsxs("div",{className:"mt-3 space-y-1",children:[e.jsx("p",{className:"text-xs text-white/60 font-medium",children:"Pourquoi cette recette :"}),e.jsx("ul",{className:"text-xs text-white/70 space-y-1",children:t.reasons.slice(0,2).map((p,d)=>e.jsxs("li",{className:"flex items-start gap-1",children:[e.jsx("span",{className:"text-green-400 mt-0.5",children:"•"}),e.jsx("span",{children:p})]},d))})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{Icon:r?o.BookOpen:o.Book,size:14,className:r?"text-green-400":"text-white/50"}),e.jsx("span",{className:`text-xs ${r?"text-green-400":"text-white/50"}`,children:r?"Dans votre bibliothèque":"Non sauvegardée"})]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${r?"bg-green-500/20 text-green-400":"bg-white/10 text-white/60"}`,children:r?"Sauvegardée":"Temporaire"})]})]})})},ys=he.memo(vs),Ne=8,js=120,ne=40,rt=6,De=({value:t,options:s,onChange:r,placeholder:a="Sélectionner...",className:i="","aria-label":n,buttonClassName:l=""})=>{const[c,u]=f.useState(!1),[m,p]=f.useState(!1),[d,b]=f.useState({top:0,left:0,width:0,maxHeight:240}),v=f.useRef(null),I=f.useRef(null),w=f.useRef(null),D=f.useMemo(()=>Math.max(0,s.findIndex(S=>S.value===t)),[s,t]),N=()=>{const S=I.current;if(!S)return;const _=S.getBoundingClientRect(),O=window.innerWidth,$=window.innerHeight,z=_.width,Q=Math.min(Math.max(_.left,Ne),Math.max(Ne,O-z-Ne)),Z=$-_.bottom-Ne,X=_.top-Ne,re=Z<160&&X>Z;p(re);const q=Math.max(js,Math.floor(re?X:Z)),we=re?_.top-q:_.bottom;b({top:we,left:Q,width:z,maxHeight:q})},B=()=>u(S=>!S);f.useEffect(()=>{const S=_=>{const O=_.target;!v.current?.contains(O)&&!w.current?.contains(O)&&u(!1)};return document.addEventListener("mousedown",S),()=>document.removeEventListener("mousedown",S)},[]),f.useLayoutEffect(()=>{if(!c)return;N();const S=()=>N(),_=()=>N(),O=new ResizeObserver(()=>N());return I.current&&O.observe(I.current),window.addEventListener("scroll",S,!0),window.addEventListener("resize",_),requestAnimationFrame(()=>{if(!w.current)return;const $=d.maxHeight,z=Math.max(0,D*ne-Math.max(0,$/2-ne/2));w.current.scrollTop=z}),()=>{O.disconnect(),window.removeEventListener("scroll",S,!0),window.removeEventListener("resize",_)}},[c]);const[E,g]=f.useState(0);f.useEffect(()=>{if(!c)return;const S=w.current;if(!S)return;const _=()=>g(S.scrollTop);return S.addEventListener("scroll",_,{passive:!0}),()=>S.removeEventListener("scroll",_)},[c]);const j=s.length*ne,A=Math.ceil(d.maxHeight/ne)+rt*2,k=Math.max(0,Math.floor(E/ne)-rt),L=Math.min(s.length,k+A),V=k*ne,H=s.slice(k,L);f.useEffect(()=>{if(!c)return;let S=Math.max(0,D);const _=$=>{const z=w.current;if(!z)return;const Q=$*ne,Z=Q+ne;Q<z.scrollTop?z.scrollTop=Q:Z>z.scrollTop+z.clientHeight&&(z.scrollTop=Z-z.clientHeight)},O=$=>{if(c){if($.key==="Escape")$.preventDefault(),u(!1),I.current?.focus();else if($.key==="ArrowDown")$.preventDefault(),S=Math.min(s.length-1,S+1),_(S),w.current?.querySelector(`[data-index='${S}']`)?.focus();else if($.key==="ArrowUp")$.preventDefault(),S=Math.max(0,S-1),_(S),w.current?.querySelector(`[data-index='${S}']`)?.focus();else if($.key==="Enter"){const z=document.activeElement;z?.dataset?.value&&(r(z.dataset.value),u(!1))}}};return document.addEventListener("keydown",O),()=>document.removeEventListener("keydown",O)},[c,r,s.length,D]);const J=S=>{r(S),u(!1),I.current?.focus()},T=s.find(S=>S.value===t),pe=e.jsx(le,{children:c&&e.jsx(h.div,{initial:{opacity:0,y:m?6:-6,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:m?6:-6,scale:.98},transition:{duration:.14,ease:"easeOut"},style:{position:"fixed",top:d.top,left:d.left,width:d.width,zIndex:1e5},children:e.jsx(C,{className:"py-1 px-1 overflow-y-auto rounded-2xl",style:{maxHeight:d.maxHeight,background:"linear-gradient(135deg, rgba(255,255,255,0.22) 0%, rgba(255,255,255,0.12) 60%, rgba(255,255,255,0.08) 100%)",backdropFilter:"blur(16px) saturate(160%)",border:CSS.supports("color","color-mix(in srgb, white 28%, transparent)")?"1px solid color-mix(in srgb, white 28%, transparent)":"1px solid rgba(255,255,255,0.28)",boxShadow:"0 12px 32px rgba(0,0,0,0.45), 0 2px 8px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.2)"},ref:w,role:"listbox","aria-label":n,"aria-activedescendant":t||void 0,children:e.jsx("div",{style:{height:j,position:"relative"},children:e.jsx("div",{style:{position:"absolute",insetInlineStart:0,top:V,right:0,left:0},children:e.jsx("div",{className:"space-y-1",children:H.map((S,_)=>{const O=k+_,$=t===S.value;return e.jsx("button",{id:S.value,"data-index":O,"data-value":S.value,type:"button",role:"option","aria-selected":$,onClick:()=>J(S.value),className:`w-full h-10 px-3 text-left text-sm transition-colors outline-none rounded-xl
                                    focus:ring-2 focus:ring-white/30
                                    ${$?"bg-cyan-400/20 text-cyan-300":"text-white/85 hover:bg-white/10"}`,style:{lineHeight:`${ne}px`},children:S.label},S.value)})})})})})})});return e.jsxs("div",{ref:v,className:`relative ${i}`,children:[e.jsxs("button",{ref:I,type:"button",onClick:B,className:`btn-glass w-full justify-between text-left ${l}`,"aria-expanded":c,"aria-haspopup":"listbox","aria-label":n,children:[e.jsx("span",{className:"truncate",children:T?T.label:a}),e.jsx(x,{Icon:o.ChevronDown,size:16,className:`transition-transform duration-200 ${c?"rotate-180":""}`})]}),ut.createPortal(pe,document.body)]})},ws=({availableInventories:t,selectedInventoryId:s,onSelectInventory:r,onGenerateRecipes:a,isGenerating:i})=>{const{click:n}=K(),l=t.find(d=>d.id===s),c=l&&l.inventory_final.length>0,u=t.map(d=>({value:d.id,label:`Inventaire du ${new Date(d.created_at).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"})} (${d.inventory_final.length} ingrédients)`,subtitle:new Date(d.created_at).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"})})),m=()=>{n(),a()},p=d=>{n(),r(d)};return e.jsxs(h.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs(C,{className:"p-5",style:{background:"linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(5, 150, 105, 0.05) 100%)",borderColor:"rgba(16, 185, 129, 0.2)",boxShadow:"0 8px 32px rgba(16, 185, 129, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.1)"},children:[e.jsx("div",{className:"flex items-center gap-4 mb-5",children:e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center breathing-icon flex-shrink-0",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #10B981 35%, transparent), color-mix(in srgb, #10B981 25%, transparent))
                `,border:"2px solid color-mix(in srgb, #10B981 50%, transparent)",boxShadow:"0 0 30px color-mix(in srgb, #10B981 40%, transparent)"},children:e.jsx(x,{Icon:o.ChefHat,size:40,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:"Générateur de Recettes"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Créez des recettes personnalisées à partir de votre inventaire"})]})]})}),e.jsx("div",{className:"w-full mt-5",children:e.jsx(De,{options:u,value:s||"",onChange:p,placeholder:"Sélectionner un inventaire",className:"w-full",disabled:i})}),t.length===0&&e.jsx(h.div,{initial:{opacity:0},animate:{opacity:1},className:"pt-4 border-t border-white/10 mt-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-amber-400",children:[e.jsx(x,{Icon:o.AlertTriangle,size:16}),e.jsx("span",{children:"Aucun inventaire disponible. Scannez votre frigo pour commencer !"})]})})]}),e.jsx(h.div,{className:"w-full mt-4",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1},children:e.jsx("button",{onClick:m,disabled:!c||i,className:`btn-glass btn-glass--primary w-full px-8 py-4 text-lg font-bold transition-all duration-200 flex items-center justify-center gap-2 ${!c||i?"opacity-50 cursor-not-allowed":""}`,style:c&&!i?{background:`
              linear-gradient(135deg,
                color-mix(in srgb, #10B981 80%, transparent),
                color-mix(in srgb, #22C55E 70%, transparent)
              )
            `,border:"2px solid color-mix(in srgb, #10B981 60%, transparent)",boxShadow:`
              0 8px 32px color-mix(in srgb, #10B981 40%, transparent),
              0 0 40px color-mix(in srgb, #10B981 30%, transparent),
              inset 0 2px 0 rgba(255, 255, 255, 0.4),
              inset 0 -2px 0 rgba(0, 0, 0, 0.2)
            `,backdropFilter:"blur(20px) saturate(160%)",WebkitBackdropFilter:"blur(20px) saturate(160%)",color:"white"}:void 0,children:i?e.jsxs(e.Fragment,{children:[e.jsx(x,{Icon:o.Loader2,size:16,className:"animate-spin",style:{color:"white"}}),"Génération..."]}):e.jsxs(e.Fragment,{children:[e.jsx(x,{Icon:o.Sparkles,size:16,style:{color:"white"}}),"Générer les Recettes"]})})})]})},Ns=({searchFilter:t,setSearchFilter:s,selectedFilters:r,setSelectedFilters:a,recipesCount:i,totalRecipesCount:n,isGenerating:l,maxPrepTime:c,setMaxPrepTime:u,maxCookTime:m,setMaxCookTime:p,minServings:d,setMinServings:b})=>{const[v,I]=f.useState(!1),w=["végétarien","vegan","sans gluten","rapide","économique","protéiné","léger","réconfortant"],D=g=>{r.includes(g)?a(r.filter(j=>j!==g)):a([...r,g])},N=()=>{s(""),a([]),u?.(void 0),p?.(void 0),b?.(void 0)},B=t.length>0||r.length>0||c!==void 0||m!==void 0||d!==void 0,E=()=>{I(!v)};return e.jsxs(C,{className:"p-4 space-y-6",style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #10B981 12%, transparent) 0%, transparent 60%),
          radial-gradient(circle at 70% 80%, color-mix(in srgb, #34D399 8%, transparent) 0%, transparent 50%),
          rgba(255, 255, 255, 0.05)
        `,borderColor:"color-mix(in srgb, #10B981 25%, transparent)",boxShadow:`
          0 12px 40px rgba(0, 0, 0, 0.25),
          0 0 30px color-mix(in srgb, #10B981 15%, transparent),
          0 0 60px color-mix(in srgb, #34D399 10%, transparent),
          inset 0 2px 0 rgba(255, 255, 255, 0.15)
        `},children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center breathing-icon",style:{background:`
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                linear-gradient(135deg, color-mix(in srgb, #10B981 35%, transparent), color-mix(in srgb, #10B981 25%, transparent))
              `,border:"2px solid color-mix(in srgb, #10B981 50%, transparent)",boxShadow:"0 0 30px color-mix(in srgb, #10B981 40%, transparent)"},children:e.jsx(x,{Icon:o.Filter,size:20,style:{color:"#10B981"}})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Filtrer les Recettes"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Affiner votre recherche"})]})]}),e.jsxs("button",{onClick:E,disabled:l,className:"flex items-center gap-2 px-4 py-2 rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",style:{background:"color-mix(in srgb, #10B981 15%, transparent)",border:"1px solid color-mix(in srgb, #10B981 30%, transparent)",color:"color-mix(in srgb, #10B981 80%, white)"},children:[e.jsx(x,{Icon:o.Settings,size:16}),e.jsx("span",{className:"text-sm font-medium",children:"Filtres avancés"}),e.jsx(x,{Icon:v?o.ChevronUp:o.ChevronDown,size:16})]})]}),e.jsx(le,{children:v&&e.jsxs(h.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"space-y-4 overflow-hidden",children:[e.jsxs("div",{className:"relative",children:[e.jsx("label",{htmlFor:"search-filter",className:"block text-sm font-medium text-white/80 mb-2",children:"Recherche rapide"}),e.jsx("input",{id:"search-filter",type:"text",placeholder:"Rechercher une recette...",value:t,onChange:g=>s(g.target.value),className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-transparent",disabled:l})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-white/80",children:"Temps de préparation max (min)"}),e.jsx("input",{type:"number",placeholder:"Ex: 30",value:c||"",onChange:g=>u?.(g.target.value?parseInt(g.target.value):void 0),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-transparent",disabled:l,min:"1",max:"180"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-white/80",children:"Temps de cuisson max (min)"}),e.jsx("input",{type:"number",placeholder:"Ex: 45",value:m||"",onChange:g=>p?.(g.target.value?parseInt(g.target.value):void 0),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-transparent",disabled:l,min:"1",max:"300"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-white/80",children:"Portions minimum"}),e.jsx("input",{type:"number",placeholder:"Ex: 2",value:d||"",onChange:g=>b?.(g.target.value?parseInt(g.target.value):void 0),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-transparent",disabled:l,min:"1",max:"12"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-white/80",children:"Tags diététiques"}),B&&e.jsx("button",{onClick:N,className:"text-xs text-green-400 hover:text-green-300 transition-colors",disabled:l,children:"Effacer tout"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:w.map(g=>{const j=r.includes(g);return e.jsx(h.button,{onClick:()=>D(g),disabled:l,className:`px-3 py-1.5 rounded-full text-xs font-medium transition-all ${j?"bg-green-500 text-white shadow-lg":"bg-white/10 text-white/70 hover:bg-white/20"} disabled:opacity-50 disabled:cursor-not-allowed`,whileHover:l?{}:{scale:1.05},whileTap:l?{}:{scale:.95},children:g},g)})})]})]})}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-white/60 mt-6 pt-2 border-t border-white/10",children:[e.jsx("span",{children:l?"Génération en cours...":`${i} recette${i>1?"s":""} ${i!==n?`sur ${n}`:""}`}),B&&!l&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{Icon:o.Filter,size:14,className:"text-green-400"}),e.jsx("span",{className:"text-green-400",children:"Filtres actifs"})]})]})]})},ks=()=>e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.5},className:"mb-6",children:e.jsx(C,{className:"p-8 text-center",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #EC4899 12%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, #F472B6 8%, transparent) 0%, transparent 50%),
            rgba(255, 255, 255, 0.05)
          `,borderColor:"color-mix(in srgb, #EC4899 25%, transparent)",boxShadow:`
            0 12px 40px rgba(0, 0, 0, 0.25),
            0 0 30px color-mix(in srgb, #EC4899 15%, transparent),
            0 0 60px color-mix(in srgb, #F472B6 10%, transparent),
            inset 0 2px 0 rgba(255, 255, 255, 0.15)
          `},children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-20 h-20 rounded-full flex items-center justify-center",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #EC4899 35%, transparent), color-mix(in srgb, #EC4899 25%, transparent))
                `,border:"2px solid color-mix(in srgb, #EC4899 50%, transparent)",boxShadow:"0 0 30px color-mix(in srgb, #EC4899 40%, transparent)"},children:e.jsx(x,{Icon:o.Sparkles,size:40,className:"text-white",motionAnimate:{rotate:360},motionTransition:{repeat:1/0,duration:2,ease:"linear"}})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-2xl font-bold text-white",style:{textShadow:"0 0 20px rgba(236, 72, 153, 0.5), 0 0 40px rgba(236, 72, 153, 0.3)"},children:"Création de recettes en cours..."}),e.jsx("p",{className:"text-white/80 text-lg",style:{textShadow:"0 0 10px rgba(244, 114, 182, 0.3)"},children:"La Forge Spatiale travaille..."})]}),e.jsx("div",{className:"flex justify-center gap-2",children:[0,1,2].map(t=>e.jsx(h.div,{className:"w-3 h-3 bg-white/80 rounded-full",animate:{scale:[1,1.2,1],opacity:[.5,1,.5]},transition:{duration:1.5,repeat:1/0,delay:t*.2,ease:"easeInOut"}},t))}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-white/70",children:[e.jsx(x,{Icon:o.Clock,size:16,className:"text-pink-400"}),e.jsx("span",{children:"Analyse des ingrédients et création des recettes..."})]}),e.jsx("div",{className:"w-full max-w-xs mx-auto h-2 bg-white/10 rounded-full overflow-hidden",children:e.jsx(h.div,{className:"h-full bg-gradient-to-r from-pink-500 to-rose-500 rounded-full",animate:{x:["-100%","100%"]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},style:{width:"50%"}})})]})]})})}),Ss=({selectedInventoryId:t,availableInventories:s,hasSelectedInventory:r,onGenerateRecipes:a})=>{const i=oe(),{startScan:n}=ye(),l=()=>{n(),i("/fridge/scan")},c=r?"Générer vos premières recettes":"Votre bibliothèque de recettes est vide",u=r?"Vous avez un inventaire sélectionné. Générez des recettes personnalisées basées sur vos ingrédients disponibles.":"Commencez par scanner votre frigo pour générer des recettes personnalisées",m=r?"Générer mes recettes":"Scanner mon frigo pour générer des recettes",p=r?a:l;return e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-12 py-1",children:e.jsx(C,{className:"p-8",style:{background:`radial-gradient(ellipse at center, 
            rgba(236, 72, 153, 0.15) 0%, 
            rgba(244, 114, 182, 0.08) 50%, 
            rgba(0, 0, 0, 0.4) 100%)`,borderColor:"rgba(236, 72, 153, 0.3)",boxShadow:`
            0 0 30px rgba(236, 72, 153, 0.2),
            0 8px 32px rgba(0, 0, 0, 0.3),
            inset 0 1px 0 rgba(255, 255, 255, 0.1)
          `,backdropFilter:"blur(20px) saturate(1.2)"},children:e.jsxs("div",{className:"space-y-6 flex flex-col items-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto rounded-2xl flex items-center justify-center",style:{background:`radial-gradient(circle, 
                rgba(236, 72, 153, 0.3) 0%, 
                rgba(244, 114, 182, 0.15) 70%, 
                transparent 100%)`,border:"1px solid rgba(236, 72, 153, 0.4)",boxShadow:`
                0 0 25px rgba(236, 72, 153, 0.3),
                0 4px 20px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.2)
              `},children:e.jsx(x,{Icon:r?o.Sparkles:o.ChefHat,size:48,className:"text-pink-400",style:{filter:`drop-shadow(0 0 12px rgba(236, 72, 153, 0.8)) 
                         drop-shadow(0 2px 8px rgba(0, 0, 0, 0.3))`}})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-3",children:c}),e.jsx("p",{className:"text-white/70 text-lg",children:u})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 my-8",children:[e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-xl flex items-center justify-center",style:{background:`radial-gradient(circle, 
                    rgba(236, 72, 153, 0.3) 0%, 
                    rgba(244, 114, 182, 0.1) 70%, 
                    transparent 100%)`,border:"1px solid rgba(236, 72, 153, 0.4)",boxShadow:`
                    0 0 20px rgba(236, 72, 153, 0.3),
                    0 4px 15px rgba(0, 0, 0, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2)
                  `},children:e.jsx(x,{Icon:r?o.Sparkles:o.Camera,size:24,className:"text-pink-400",style:{filter:`drop-shadow(0 0 8px rgba(236, 72, 153, 0.6)) 
                             drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3))`}})}),e.jsx("h3",{className:"font-semibold text-white",children:r?"Génération par la Forge":"Scanner intelligent"}),e.jsx("p",{className:"text-white/60 text-sm",children:r?"Recettes créées par la Forge basées sur vos ingrédients":"Analysez automatiquement vos ingrédients disponibles"})]}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-xl flex items-center justify-center",style:{background:`radial-gradient(circle, 
                    rgba(236, 72, 153, 0.3) 0%, 
                    rgba(244, 114, 182, 0.1) 70%, 
                    transparent 100%)`,border:"1px solid rgba(236, 72, 153, 0.4)",boxShadow:`
                    0 0 20px rgba(236, 72, 153, 0.3),
                    0 4px 15px rgba(0, 0, 0, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2)
                  `},children:e.jsx(x,{Icon:o.Sparkles,size:24,className:"text-pink-400",style:{filter:`drop-shadow(0 0 8px rgba(236, 72, 153, 0.6)) 
                             drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3))`}})}),e.jsx("h3",{className:"font-semibold text-white",children:"Forge personnalisée"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Recettes adaptées à vos goûts et contraintes alimentaires"})]}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-xl flex items-center justify-center",style:{background:`radial-gradient(circle, 
                    rgba(236, 72, 153, 0.3) 0%, 
                    rgba(244, 114, 182, 0.1) 70%, 
                    transparent 100%)`,border:"1px solid rgba(236, 72, 153, 0.4)",boxShadow:`
                    0 0 20px rgba(236, 72, 153, 0.3),
                    0 4px 15px rgba(0, 0, 0, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2)
                  `},children:e.jsx(x,{Icon:o.Clock,size:24,className:"text-pink-400",style:{filter:`drop-shadow(0 0 8px rgba(236, 72, 153, 0.6)) 
                             drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3))`}})}),e.jsx("h3",{className:"font-semibold text-white",children:"Zéro gaspillage"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Utilisez tous vos ingrédients avant qu'ils ne périment"})]})]}),e.jsx("div",{className:"pt-4",children:e.jsxs("button",{onClick:p,className:"group relative px-8 py-4 text-white font-semibold rounded-2xl transform hover:scale-105 transition-all duration-300",style:{background:`linear-gradient(135deg, 
                  rgba(236, 72, 153, 0.8) 0%, 
                  rgba(244, 114, 182, 0.9) 100%)`,border:"2px solid rgba(236, 72, 153, 0.6)",boxShadow:`
                  0 0 30px rgba(236, 72, 153, 0.4),
                  0 8px 25px rgba(0, 0, 0, 0.3),
                  inset 0 1px 0 rgba(255, 255, 255, 0.2),
                  inset 0 -1px 0 rgba(0, 0, 0, 0.2)
                `,backdropFilter:"blur(10px) saturate(1.2)"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(x,{Icon:r?o.Sparkles:o.Camera,size:24,className:"group-hover:rotate-12 transition-transform duration-300",style:{color:"white",filter:`drop-shadow(0 0 10px rgba(236, 72, 153, 0.8)) 
                             drop-shadow(0 2px 6px rgba(0, 0, 0, 0.3))`}}),e.jsx("span",{className:"text-lg",children:m})]}),e.jsx("div",{className:"absolute inset-0 rounded-2xl blur-xl opacity-50 group-hover:opacity-75 transition-opacity duration-300 -z-10",style:{background:`linear-gradient(135deg, 
                    rgba(236, 72, 153, 0.6) 0%, 
                    rgba(244, 114, 182, 0.6) 100%)`}})]})}),e.jsx("div",{className:"text-white/50 text-sm p-3 rounded-xl",style:{background:`radial-gradient(ellipse at center, 
                rgba(236, 72, 153, 0.1) 0%, 
                transparent 70%)`,border:"1px solid rgba(236, 72, 153, 0.2)",boxShadow:"0 0 15px rgba(236, 72, 153, 0.1)"},children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(x,{Icon:o.Lightbulb,size:16,className:"text-pink-400",style:{filter:"drop-shadow(0 0 6px rgba(236, 72, 153, 0.6))"}}),e.jsx("span",{children:r?"Astuce : Vos recettes seront sauvegardées dans votre bibliothèque personnelle !":"Astuce : Plus votre frigo est rempli, plus vous aurez de recettes créatives !"})]})})]})})})},Cs=({newlyGeneratedRecipes:t,onSaveAllNewRecipes:s,onDiscardNewRecipes:r,isGenerating:a})=>{const[i,n]=f.useState(!1),{click:l}=K(),c=f.useMemo(()=>{if(t.length===0)return 0;const p=t.reduce((d,b)=>{const v=b.prepTimeMin||0,I=b.cookTimeMin||0;return d+v+I},0);return Math.round(p/t.length)},[t]),u=async()=>{n(!0),l();try{await s()}finally{n(!1)}},m=()=>{l(),r()};return a?e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-6",children:e.jsx(C,{className:"p-6 border-2 border-pink-400/30",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-lg animate-pulse"}),e.jsx("div",{className:"h-6 w-48 bg-white/20 rounded animate-pulse"})]}),e.jsx("div",{className:"w-16 h-6 bg-white/20 rounded animate-pulse"})]}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:[1,2,3].map(p=>e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("div",{className:"h-8 w-12 bg-white/20 rounded mx-auto animate-pulse"}),e.jsx("div",{className:"h-4 w-16 bg-white/20 rounded mx-auto animate-pulse"})]},p))}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx("div",{className:"flex-1 h-12 bg-white/20 rounded-xl animate-pulse"}),e.jsx("div",{className:"w-full sm:w-auto h-12 bg-white/20 rounded-xl animate-pulse"})]}),e.jsxs("div",{className:"bg-pink-500/10 rounded-lg p-4 space-y-2",children:[e.jsx("div",{className:"h-4 w-3/4 bg-white/20 rounded animate-pulse"}),e.jsx("div",{className:"h-4 w-1/2 bg-white/20 rounded animate-pulse"})]})]})})}):t.length===0?null:e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-6",children:e.jsx(C,{className:"p-6 border-2 border-pink-400/30",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(x,{Icon:o.ChefHat,size:32,className:"text-pink-400"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold text-white",children:[t.length," Nouvelles Recettes Générées !"]}),e.jsx("p",{className:"text-sm text-white/70",children:"Vos recettes personnalisées sont prêtes"})]})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"text-sm text-pink-400 font-medium",children:"Prêt !"})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:t.length}),e.jsx("div",{className:"text-sm text-white/70",children:"Recettes"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:c}),e.jsx("div",{className:"text-sm text-white/70",children:"Min moy."})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:Math.round(t.reduce((p,d)=>p+(d.servings||1),0)/t.length)}),e.jsx("div",{className:"text-sm text-white/70",children:"Portions"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx("button",{onClick:u,disabled:i,className:"flex-1 bg-gradient-to-r from-green-500/20 to-green-600/20 hover:from-green-500/30 hover:to-green-600/30 border-2 border-green-400/30 rounded-xl px-6 py-3 text-white font-semibold transition-all duration-200 flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("span",{children:"Sauvegarde..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(x,{Icon:o.Save,size:20}),e.jsx("span",{children:"Sauvegarder Toutes"})]})}),e.jsxs("button",{onClick:m,disabled:i,className:"bg-red-500/20 hover:bg-red-500/30 border border-red-400/30 rounded-xl px-4 py-3 text-white font-medium transition-all duration-200 flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(x,{Icon:o.Trash2,size:16}),e.jsx("span",{className:"hidden sm:inline",children:"Supprimer"})]})]}),e.jsx("div",{className:"bg-pink-500/10 rounded-lg p-4",children:e.jsxs("div",{className:"text-sm text-white/80",children:[e.jsx("p",{className:"font-medium mb-1",children:"💡 Conseil :"}),e.jsx("p",{children:"Sauvegardez vos recettes préférées pour les retrouver facilement et créer vos listes de courses personnalisées."})]})})]})})})},Is=({onExportAllRecipes:t,onDeleteAllRecipes:s,recipesCount:r})=>{const{click:a}=K();return r===0?null:e.jsxs(h.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},className:"flex items-center justify-end gap-3 mb-6",children:[e.jsxs(h.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{a(),t()},className:"flex items-center gap-2 px-4 py-2.5 rounded-xl font-medium transition-all duration-200",style:{background:"linear-gradient(135deg, color-mix(in srgb, #10B981 20%, transparent), color-mix(in srgb, #10B981 10%, transparent))",border:"1px solid color-mix(in srgb, #10B981 30%, transparent)",boxShadow:`
            0 4px 16px color-mix(in srgb, #10B981 15%, transparent),
            inset 0 1px 0 rgba(255, 255, 255, 0.15)
          `,backdropFilter:"blur(20px) saturate(180%)",color:"#10B981"},title:"Exporter toutes les recettes",children:[e.jsx(x,{Icon:o.Download,size:18,className:"text-green-400"}),e.jsx("span",{className:"text-sm",children:"Exporter"}),e.jsxs("span",{className:"text-xs opacity-70",children:["(",r,")"]})]}),e.jsxs(h.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{a(),s()},className:"flex items-center gap-2 px-4 py-2.5 rounded-xl font-medium transition-all duration-200",style:{background:"linear-gradient(135deg, color-mix(in srgb, #EF4444 20%, transparent), color-mix(in srgb, #EF4444 10%, transparent))",border:"1px solid color-mix(in srgb, #EF4444 30%, transparent)",boxShadow:`
            0 4px 16px color-mix(in srgb, #EF4444 15%, transparent),
            inset 0 1px 0 rgba(255, 255, 255, 0.15)
          `,backdropFilter:"blur(20px) saturate(180%)",color:"#EF4444"},title:"Supprimer toutes les recettes",children:[e.jsx(x,{Icon:o.Trash2,size:18,className:"text-red-400"}),e.jsx("span",{className:"text-sm",children:"Supprimer"}),e.jsxs("span",{className:"text-xs opacity-70",children:["(",r,")"]})]})]})},Es=({userId:t,profile:s,userEditedInventory:r,recipeCandidates:a,clearRecipeCandidates:i,showToast:n,click:l,success:c})=>{const[u,m]=f.useState([]),[p,d]=f.useState(!0),b=f.useMemo(()=>a.filter(g=>!u.some(j=>j.id===g.id)),[a,u]),v=f.useMemo(()=>{const g=new Set(u.map(A=>A.id));return[...a.filter(A=>!g.has(A.id)),...u]},[u,a]),I=async()=>{if(t)try{d(!0),y.info("GENERATED_RECIPES_TAB","Fetching persisted recipes from database",{userId:t,timestamp:new Date().toISOString()});const{data:g,error:j}=await U.from("recipes").select(`
          id,
          session_id,
          title,
          description,
          ingredients,
          instructions,
          prep_time_min,
          cook_time_min,
          servings,
          dietary_tags,
          nutritional_info,
          image_url,
          image_signature,
          reasons,
          created_at,
          updated_at,
          recipe_sessions!inner(user_id)
        `).eq("recipe_sessions.user_id",t).order("created_at",{ascending:!1});if(j)throw new Error(`Failed to fetch recipes: ${j.message}`);const A=(g||[]).map(k=>({id:k.id,sessionId:k.session_id,title:k.title,description:k.description,ingredients:k.ingredients||[],instructions:k.instructions||[],prepTimeMin:k.prep_time_min||0,cookTimeMin:k.cook_time_min||0,servings:k.servings||2,dietaryTags:k.dietary_tags||[],nutritionalInfo:k.nutritional_info||{},imageUrl:k.image_url,imageSignature:k.image_signature,reasons:k.reasons||[],createdAt:k.created_at,updatedAt:k.updated_at,status:"ready"}));m(A),y.info("GENERATED_RECIPES_TAB","Successfully fetched persisted recipes",{userId:t,recipesCount:A.length,timestamp:new Date().toISOString()})}catch(g){y.error("GENERATED_RECIPES_TAB","Failed to fetch persisted recipes",{userId:t,error:g instanceof Error?g.message:"Unknown error",timestamp:new Date().toISOString()}),n({type:"error",title:"Erreur de chargement",message:"Impossible de charger vos recettes sauvegardées.",duration:4e3})}finally{d(!1)}},w=async g=>{if(!t){n({type:"error",title:"Erreur d'authentification",message:"Vous devez être connecté pour sauvegarder des recettes.",duration:4e3});return}try{y.info("GENERATED_RECIPES_TAB","Saving recipe to database",{userId:t,recipeId:g.id,recipeTitle:g.title,timestamp:new Date().toISOString()});let j=g.sessionId;j||(j=crypto.randomUUID());const A={nutrition:s?.nutrition||{},householdDetails:s?.householdDetails||{},mealPrepPreferences:s?.mealPrepPreferences||{},kitchenEquipment:s?.kitchenEquipment||{},foodPreferences:s?.foodPreferences||{},sensoryPreferences:s?.sensoryPreferences||{},macroTargets:s?.macroTargets||{},shoppingPreferences:s?.shoppingPreferences||{}},{error:k}=await U.from("recipe_sessions").upsert({id:j,user_id:t,inventory_final:r||[],selected_recipe_ids:[g.id],preferences_snapshot:A,filters_snapshot:{},status:"completed",created_at:new Date().toISOString(),updated_at:new Date().toISOString()});if(k)throw new Error(`Failed to create session: ${k.message}`);const{error:L}=await U.from("recipes").upsert({id:g.id,session_id:j,title:g.title,description:g.description,ingredients:g.ingredients,instructions:g.instructions,prep_time_min:g.prepTimeMin,cook_time_min:g.cookTimeMin,servings:g.servings,dietary_tags:g.dietaryTags,nutritional_info:g.nutritionalInfo,...g.imageUrl&&{image_url:g.imageUrl},image_signature:g.imageSignature,reasons:g.reasons,created_at:g.createdAt||new Date().toISOString(),updated_at:new Date().toISOString()});if(L)throw new Error(`Failed to save recipe: ${L.message}`);const V={...g,sessionId:j};m(H=>H.find(T=>T.id===g.id)?H.map(T=>T.id===g.id?V:T):[V,...H]),n({type:"success",title:"Recette sauvegardée",message:`"${g.title}" a été ajoutée à votre bibliothèque.`,duration:3e3}),y.info("GENERATED_RECIPES_TAB","Recipe saved successfully",{userId:t,recipeId:g.id,sessionId:j,timestamp:new Date().toISOString()})}catch(j){y.error("GENERATED_RECIPES_TAB","Failed to save recipe",{userId:t,recipeId:g.id,error:j instanceof Error?j.message:"Unknown error",timestamp:new Date().toISOString()}),n({type:"error",title:"Erreur de sauvegarde",message:"Impossible de sauvegarder la recette. Veuillez réessayer.",duration:4e3})}},D=async g=>{if(t)try{y.info("GENERATED_RECIPES_TAB","Deleting recipe from database",{userId:t,recipeId:g,timestamp:new Date().toISOString()});const{error:j}=await U.from("recipes").delete().eq("id",g);if(j)throw new Error(`Failed to delete recipe: ${j.message}`);m(k=>k.filter(L=>L.id!==g));const A=u.find(k=>k.id===g);n({type:"success",title:"Recette supprimée",message:`"${A?.title||"La recette"}" a été supprimée de votre bibliothèque.`,duration:3e3}),y.info("GENERATED_RECIPES_TAB","Recipe deleted successfully",{userId:t,recipeId:g,timestamp:new Date().toISOString()})}catch(j){y.error("GENERATED_RECIPES_TAB","Failed to delete recipe",{userId:t,recipeId:g,error:j instanceof Error?j.message:"Unknown error",timestamp:new Date().toISOString()}),n({type:"error",title:"Erreur de suppression",message:"Impossible de supprimer la recette. Veuillez réessayer.",duration:4e3})}},N=async g=>{l(),u.some(A=>A.id===g.id)?(await D(g.id),y.debug("GENERATED_RECIPES_TAB","Recipe removed from library",{recipeId:g.id,recipeTitle:g.title,timestamp:new Date().toISOString()})):(await w(g),y.debug("GENERATED_RECIPES_TAB","Recipe added to library",{recipeId:g.id,recipeTitle:g.title,timestamp:new Date().toISOString()}))},B=async()=>{try{for(const g of b)await w(g);c(),n({type:"success",title:"Recettes sauvegardées !",message:`${b.length} recettes ont été ajoutées à votre collection`,duration:4e3})}catch{n({type:"error",title:"Erreur de sauvegarde",message:"Impossible de sauvegarder toutes les recettes",duration:4e3})}},E=()=>{i(),n({type:"info",title:"Recettes supprimées",message:`${b.length} nouvelles recettes ont été supprimées`,duration:3e3})};return f.useEffect(()=>{t&&I()},[t]),{persistedRecipes:u,loadingPersistedRecipes:p,newlyGeneratedRecipes:b,allRecipes:v,fetchPersistedRecipes:I,saveRecipeToDb:w,deleteRecipeFromDb:D,handleToggleSaveStatus:N,handleSaveAllNewRecipes:B,handleDiscardNewRecipes:E}},Fs=({allRecipes:t})=>{const[s,r]=f.useState(""),[a,i]=f.useState([]),[n,l]=f.useState(void 0),[c,u]=f.useState(void 0),[m,p]=f.useState(void 0),[d,b]=f.useState(8),[v,I]=f.useState(8);f.useEffect(()=>{const g=()=>{const A=window.innerWidth<=768?8:9;I(A),b(A)};return g(),window.addEventListener("resize",g),()=>window.removeEventListener("resize",g)},[]);const w=f.useMemo(()=>t.filter(g=>{const j=g.title.toLowerCase().includes(s.toLowerCase())||g.description?.toLowerCase().includes(s.toLowerCase()),A=a.length===0||a.some(H=>g.dietaryTags?.includes(H)||g.reasons?.includes(H)),k=n===void 0||g.prepTimeMin&&g.prepTimeMin<=n,L=c===void 0||g.cookTimeMin&&g.cookTimeMin<=c,V=m===void 0||g.servings&&g.servings>=m;return j&&A&&k&&L&&V}),[t,s,a,n,c,m]),D=f.useMemo(()=>w.slice(0,d),[w,d]),N=w.length>d;return{searchFilter:s,setSearchFilter:r,selectedFilters:a,setSelectedFilters:i,maxPrepTime:n,setMaxPrepTime:l,maxCookTime:c,setMaxCookTime:u,minServings:m,setMinServings:p,itemsPerPage:d,initialItemsPerPage:v,filteredRecipes:w,displayedRecipes:D,hasMoreRecipes:N,handleLoadMore:()=>{b(g=>g+v)},clearAllFilters:()=>{r(""),i([]),l(void 0),u(void 0),p(void 0),b(v)}}},Ds=({allRecipes:t,userId:s,showToast:r,click:a})=>{const i=l=>{let c=`# ${l.title}

`;return l.description&&(c+=`${l.description}

`),c+=`**Temps de préparation:** ${l.prepTimeMin||0} min
`,c+=`**Temps de cuisson:** ${l.cookTimeMin||0} min
`,c+=`**Portions:** ${l.servings||2}

`,l.ingredients&&l.ingredients.length>0&&(c+=`## Ingrédients
`,l.ingredients.forEach(u=>{c+=`- ${u}
`}),c+=`
`),l.instructions&&l.instructions.length>0&&(c+=`## Instructions
`,l.instructions.forEach((u,m)=>{c+=`${m+1}. ${u}
`}),c+=`
`),l.dietaryTags&&l.dietaryTags.length>0&&(c+=`**Tags:** ${l.dietaryTags.join(", ")}

`),c+=`---

`,c};return{handleExportAllRecipes:async()=>{try{if(a(),t.length===0){r({type:"warning",title:"Aucune recette à exporter",message:"Générez d'abord des recettes pour pouvoir les exporter.",duration:3e3});return}y.info("GENERATED_RECIPES_TAB","Exporting all recipes",{userId:s,recipesCount:t.length,timestamp:new Date().toISOString()});let l=`# Mes Recettes Générées

`;l+=`Exporté le ${new Date().toLocaleDateString("fr-FR")} à ${new Date().toLocaleTimeString("fr-FR")}

`,l+=`Total: ${t.length} recette${t.length>1?"s":""}

`,l+="=".repeat(50)+`

`,t.forEach((c,u)=>{l+=i(c)}),await navigator.clipboard.writeText(l),r({type:"success",title:"Recettes exportées !",message:`${t.length} recette${t.length>1?"s ont été copiées":" a été copiée"} dans le presse-papiers.`,duration:4e3}),y.info("GENERATED_RECIPES_TAB","Recipes exported successfully",{userId:s,recipesCount:t.length,timestamp:new Date().toISOString()})}catch(l){y.error("GENERATED_RECIPES_TAB","Failed to export recipes",{userId:s,error:l instanceof Error?l.message:"Unknown error",timestamp:new Date().toISOString()}),r({type:"error",title:"Erreur d'exportation",message:"Impossible d'exporter les recettes. Veuillez réessayer.",duration:4e3})}},formatRecipeForExport:i}},As=({allRecipes:t,persistedRecipes:s,newlyGeneratedRecipes:r,userId:a,showToast:i,click:n,clearRecipeCandidates:l,deleteRecipeFromDb:c})=>({handleDeleteAllRecipes:async()=>{try{if(n(),t.length===0){i({type:"warning",title:"Aucune recette à supprimer",message:"Il n'y a aucune recette à supprimer.",duration:3e3});return}y.info("GENERATED_RECIPES_TAB","Deleting all recipes",{userId:a,totalRecipes:t.length,persistedRecipes:s.length,newRecipes:r.length,timestamp:new Date().toISOString()}),l();const m=s.map(p=>c(p.id));await Promise.all(m),i({type:"success",title:"Recettes supprimées !",message:`${t.length} recette${t.length>1?"s ont été supprimées":" a été supprimée"} de votre collection.`,duration:4e3}),y.info("GENERATED_RECIPES_TAB","All recipes deleted successfully",{userId:a,deletedCount:t.length,timestamp:new Date().toISOString()})}catch(m){y.error("GENERATED_RECIPES_TAB","Failed to delete all recipes",{userId:a,error:m instanceof Error?m.message:"Unknown error",timestamp:new Date().toISOString()}),i({type:"error",title:"Erreur de suppression",message:"Impossible de supprimer toutes les recettes. Veuillez réessayer.",duration:4e3})}}}),yr=()=>{oe();const[t,s]=f.useState(!1),[r,a]=f.useState(null),{click:i,success:n}=K(),{showToast:l}=Ae(),{recipeCandidates:c,loadingState:u,userEditedInventory:m,generateRecipes:p,clearRecipeCandidates:d,startScan:b}=ye(),{session:v,profile:I}=Be(),w=v?.user?.id,{availableInventories:D,selectedInventoryId:N,selectInventory:B,loadAvailableInventories:E}=ke(),{persistedRecipes:g,loadingPersistedRecipes:j,newlyGeneratedRecipes:A,allRecipes:k,handleToggleSaveStatus:L,handleSaveAllNewRecipes:V,handleDiscardNewRecipes:H,deleteRecipeFromDb:J}=Es({userId:w,profile:I,userEditedInventory:m,recipeCandidates:c,clearRecipeCandidates:d,showToast:l,click:i,success:n}),{searchFilter:T,setSearchFilter:pe,selectedFilters:S,setSelectedFilters:_,maxPrepTime:O,setMaxPrepTime:$,maxCookTime:z,setMaxCookTime:Q,minServings:Z,setMinServings:X,filteredRecipes:re,displayedRecipes:q,hasMoreRecipes:we,handleLoadMore:Ge}=Fs({allRecipes:k}),{handleExportAllRecipes:Oe}=Ds({allRecipes:k,userId:w,showToast:l,click:i}),{handleDeleteAllRecipes:Ue}=As({allRecipes:k,persistedRecipes:g,newlyGeneratedRecipes:A,userId:w,showToast:l,click:i,clearRecipeCandidates:d,deleteRecipeFromDb:J});he.useEffect(()=>{w&&E()},[w,E]);const Ve=he.useMemo(()=>{if(!N)return!1;const P=D.find(G=>G.id===N);return P&&P.inventory_final&&P.inventory_final.length>0},[N,D]),He=P=>{a(P),s(!0)},We=()=>{s(!1),a(null)},R=u==="generating"||u==="streaming",ae=k.length>0,W=j||R;return e.jsxs("div",{className:"space-y-6",children:[ae&&!W&&e.jsx(ws,{availableInventories:D,selectedInventoryId:N,onSelectInventory:B,onGenerateRecipes:()=>{const P=D.find(G=>G.id===N);P&&P.inventory_final.length>0?p():l({type:"warning",title:"Aucun inventaire sélectionné",message:"Veuillez sélectionner un inventaire avec des ingrédients pour générer des recettes.",duration:3e3})},isGenerating:R}),R&&!j&&e.jsx(ks,{}),A.length>0&&e.jsx(Cs,{newlyGeneratedRecipes:A,onSaveAllNewRecipes:V,onDiscardNewRecipes:H,isGenerating:R}),!R&&ae&&!W&&e.jsxs(e.Fragment,{children:[e.jsx(Ns,{searchFilter:T,setSearchFilter:pe,selectedFilters:S,setSelectedFilters:_,recipesCount:re.length,totalRecipesCount:k.length,isGenerating:R,maxPrepTime:O,setMaxPrepTime:$,maxCookTime:z,setMaxCookTime:Q,minServings:Z,setMinServings:X}),e.jsx(Is,{onExportAllRecipes:Oe,onDeleteAllRecipes:Ue,recipesCount:k.length})]}),!ae&&!W?e.jsx(Ss,{selectedInventoryId:N,availableInventories:D,hasSelectedInventory:Ve,onGenerateRecipes:()=>{const P=D.find(G=>G.id===N);P&&P.inventory_final.length>0?p():l({type:"warning",title:"Aucun inventaire sélectionné",message:"Veuillez sélectionner un inventaire avec des ingrédients pour générer des recettes.",duration:3e3})}}):e.jsxs("div",{className:"space-y-4",children:[j&&e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-8",children:e.jsx(C,{className:"p-8",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"w-16 h-16 mx-auto",children:e.jsx(x,{Icon:o.Loader2,size:64,className:"animate-spin text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Chargement de votre bibliothèque..."}),e.jsx("p",{className:"text-white/70",children:"Récupération de vos recettes sauvegardées"})]})]})})}),!j&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsx(le,{children:q.map((P,G)=>{const Ye=g.some(Me=>Me.id===P.id),mt=c.some(Me=>Me.id===P.id)&&!Ye;return e.jsx(ys,{recipe:P,index:G,isSaved:Ye,isNewlyGenerated:mt,isLoading:P.status==="loading"||P.isGeneratingImage,onToggleSaveStatus:()=>L(P),onView:He},P.id)})})}),we&&e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex justify-center",children:e.jsxs("button",{onClick:Ge,className:"px-6 py-3 bg-white/10 hover:bg-white/20 border border-white/20 rounded-xl text-white font-medium transition-all duration-200 hover:scale-105",children:["Charger plus de recettes (",re.length-q.length," restantes)"]})})]}),ae&&re.length===0&&!W&&e.jsx(h.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-8",children:e.jsx(C,{className:"p-8",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(x,{Icon:o.Search,size:48,className:"mx-auto text-white/50"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Aucune recette trouvée"}),e.jsx("p",{className:"text-white/70",children:"Essayez de modifier vos filtres ou votre recherche"})]})]})})})]}),r&&e.jsx(pt,{isOpen:t,onClose:We,recipe:r})]})},Ie=(t,s)=>{if(!t)return null;const r=t.mealName||t.title||"Recette non trouvée";let a=`  ${s}: ${r}`;if(t.detailedRecipe){if(t.detailedRecipe.ingredients&&t.detailedRecipe.ingredients.length>0&&(a+=`
    Ingrédients:`,t.detailedRecipe.ingredients.forEach(i=>{const n=typeof i=="string"?i:`${i.quantity||""} ${i.unit||""} ${i.name||i.ingredient||""}`.trim();a+=`
      • ${n}`})),t.detailedRecipe.instructions&&t.detailedRecipe.instructions.length>0&&(a+=`
    Instructions:`,t.detailedRecipe.instructions.forEach((i,n)=>{const l=typeof i=="string"?i:i.step||i.instruction||"";a+=`
      ${n+1}. ${l}`})),t.detailedRecipe.nutritional_info){const i=t.detailedRecipe.nutritional_info;a+=`
    Informations nutritionnelles:`,i.calories&&(a+=`
      • Calories: ${i.calories}`),i.protein&&(a+=`
      • Protéines: ${i.protein}g`),i.carbs&&(a+=`
      • Glucides: ${i.carbs}g`),i.fat&&(a+=`
      • Lipides: ${i.fat}g`)}}else a+=`
    (Détails de la recette non disponibles - générez d'abord la recette détaillée)`;return a},Bs=()=>{const{session:t,profile:s}=Be(),{currentPlan:r,currentWeek:a,availableInventories:i,selectedInventoryId:n,isGenerating:l,generationProgress:c,loadingMessage:u,currentLoadingTitle:m,currentLoadingSubtitle:p,recipes:d,availableWeeks:b,maxAvailableWeek:v,isWeekAvailable:I,isCurrentWeekActive:w,canGenerateNextWeek:D,getWeekDateRange:N,loadAvailableInventories:B,selectInventory:E,generateMealPlan:g,regenerateWeek:j,generateNextWeek:A,generateSpecificWeek:k,clearPlan:L,setCurrentWeek:V}=ke(),{click:H,success:J}=K(),{showToast:T}=Ae(),pe=ze(s),S=xt(s,"planning"),[_,O]=f.useState(!1),[$,z]=f.useState(!1),[Q,Z]=f.useState(null),X=t?.user?.id,re=n&&i.length>0,q=i.find(R=>R.id===n),we=f.useMemo(()=>{const R=N(a);return{formatted:R.formatted,startDate:R.startDate,endDate:R.endDate}},[a,N]);return f.useEffect(()=>{X&&B()},[X,B]),{currentPlan:r,currentWeek:a,availableInventories:i,selectedInventoryId:n,isGenerating:l,generationProgress:c,loadingMessage:u,currentLoadingTitle:m,currentLoadingSubtitle:p,recipes:d,availableWeeks:b,maxAvailableWeek:v,canGenerateNextWeek:D,profileCompletion:pe,featureGuidance:S,nudgeDismissed:_,showRecipeDetailModal:$,selectedRecipeForDetail:Q,userId:X,hasInventory:re,selectedInventory:q,weekDateRange:we,getWeekDateRange:N,loadAvailableInventories:B,selectInventory:E,generateMealPlan:g,regenerateWeek:j,generateNextWeek:A,generateSpecificWeek:k,clearPlan:L,setCurrentWeek:V,setNudgeDismissed:O,setShowRecipeDetailModal:z,setSelectedRecipeForDetail:Z,isWeekAvailable:R=>b.includes(R),handleGenerateMealPlan:async()=>{if(!n||!q){T({type:"warning",title:"Inventaire requis",message:"Sélectionnez un inventaire pour générer un plan de repas",duration:3e3});return}if(!s){T({type:"warning",title:"Profil incomplet",message:"Complétez votre profil nutritionnel pour un plan optimal",duration:3e3});return}try{y.info("PLAN_TAB","Starting meal plan generation",{userId:X,selectedInventoryId:n,inventoryItemsCount:q.inventory_final?.length||0,currentWeek:a,timestamp:new Date().toISOString()}),await g(a,q.inventory_final),J(),T({type:"success",title:"Plan généré !",message:`Plan de repas créé pour la semaine ${a}`,duration:4e3})}catch(R){y.error("PLAN_TAB","Meal plan generation failed",{error:R instanceof Error?R.message:"Unknown error",userId:X,selectedInventoryId:n,currentWeek:a,timestamp:new Date().toISOString()}),T({type:"error",title:"Erreur de génération",message:"Impossible de générer le plan de repas",duration:4e3})}},handleRegenerateWeek:async()=>{if(console.log("handleRegenerateWeek called",{selectedInventoryId:n,selectedInventory:!!q,currentWeek:a,isGenerating:l,userId:X}),!(!n||!q)){if(l){console.warn("Cannot regenerate: generation already in progress"),T({type:"warning",title:"Génération en cours",message:"Attendez la fin de la génération actuelle",duration:3e3});return}if(!q.inventory_final||q.inventory_final.length===0){console.warn("Cannot regenerate: no inventory items",{inventoryFinal:q.inventory_final}),T({type:"warning",title:"Inventaire vide",message:"L'inventaire sélectionné ne contient aucun ingrédient",duration:3e3});return}try{console.log("Starting week regeneration",{currentWeek:a,inventoryItemsCount:q.inventory_final.length}),await j(q.inventory_final,a),console.log("Week regeneration successful"),J(),T({type:"success",title:"Semaine régénérée !",message:`Nouveau plan créé pour la semaine ${a}`,duration:3e3})}catch(R){console.error("Week regeneration failed",{error:R instanceof Error?R.message:"Unknown error",currentWeek:a,selectedInventoryId:n}),T({type:"error",title:"Erreur de régénération",message:"Impossible de régénérer la semaine",duration:4e3})}}},handleGenerateNextWeek:async()=>{if(!(!n||!q))try{await A(q.inventory_final),J(),T({type:"success",title:"Semaine suivante générée !",message:`Plan créé pour la semaine ${a+1}`,duration:3e3})}catch{T({type:"error",title:"Erreur de génération",message:"Impossible de générer la semaine suivante",duration:4e3})}},handleExportPlan:async()=>{if(r)try{H();const R=r.days.map(W=>{const P=[];if(W.meals.breakfast){const G=Ie(W.meals.breakfast,"Petit-déjeuner");G&&P.push(G)}if(W.meals.lunch){const G=Ie(W.meals.lunch,"Déjeuner");G&&P.push(G)}if(W.meals.dinner){const G=Ie(W.meals.dinner,"Dîner");G&&P.push(G)}if(W.meals.snack){const G=Ie(W.meals.snack,"Collation");G&&P.push(G)}return`${W.dayName}
${P.join(`
`)}`}).join(`

`),ae=`Plan de Repas TwinForge - Semaine ${a}

${R}`;await navigator.clipboard.writeText(ae),J(),T({type:"success",title:"Plan exporté !",message:"Le plan de repas a été copié dans le presse-papiers",duration:3e3})}catch{T({type:"error",title:"Erreur d'export",message:"Impossible de copier le plan dans le presse-papiers",duration:3e3})}},handleViewRecipe:R=>{R&&(Z(R),z(!0))},handleGenerateAllRecipes:async()=>{if(r)try{for(let R=0;R<r.days.length;R++){const ae=r.days[R];ae&&ae.date&&await Qe(R)}J(),T({type:"success",title:"Toutes les recettes générées !",message:"Les recettes détaillées sont maintenant disponibles",duration:4e3})}catch{T({type:"error",title:"Erreur de génération",message:"Impossible de générer toutes les recettes",duration:4e3})}},generateDetailedRecipeForMeal:ft,generateAllDetailedRecipesForDay:Qe}},Rs=({nutritionalSummary:t,estimatedWeeklyCost:s})=>t?e.jsxs(C,{className:"p-6",style:{background:`
        radial-gradient(circle at 30% 20%, color-mix(in srgb, #10B981 8%, transparent) 0%, transparent 60%),
        var(--glass-opacity)
      `,borderColor:"color-mix(in srgb, #10B981 20%, transparent)"},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:"color-mix(in srgb, #10B981 15%, transparent)",border:"2px solid color-mix(in srgb, #10B981 25%, transparent)"},children:e.jsx(x,{Icon:o.BarChart3,size:16,style:{color:"#10B981"}})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-green-300 font-semibold text-lg",children:"Résumé Nutritionnel"}),e.jsx("p",{className:"text-green-200 text-sm",children:"Moyennes quotidiennes calculées"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 rounded-xl bg-orange-500/10 border border-orange-400/20",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-400 mb-1",children:t.avgCaloriesPerDay}),e.jsx("div",{className:"text-orange-300 text-sm font-medium",children:"kcal/jour"})]}),e.jsxs("div",{className:"text-center p-4 rounded-xl bg-red-500/10 border border-red-400/20",children:[e.jsxs("div",{className:"text-2xl font-bold text-red-400 mb-1",children:[t.avgProteinPerDay,"g"]}),e.jsx("div",{className:"text-red-300 text-sm font-medium",children:"Protéines"})]}),e.jsxs("div",{className:"text-center p-4 rounded-xl bg-blue-500/10 border border-blue-400/20",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-400 mb-1",children:[t.avgCarbsPerDay,"g"]}),e.jsx("div",{className:"text-blue-300 text-sm font-medium",children:"Glucides"})]}),e.jsxs("div",{className:"text-center p-4 rounded-xl bg-purple-500/10 border border-purple-400/20",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-400 mb-1",children:[t.avgFatPerDay,"g"]}),e.jsx("div",{className:"text-purple-300 text-sm font-medium",children:"Lipides"})]})]}),s&&e.jsxs("div",{className:"mt-4 p-4 rounded-xl bg-green-500/10 border border-green-400/20 text-center",children:[e.jsxs("div",{className:"text-xl font-bold text-green-400 mb-1",children:[s.toFixed(2),"€"]}),e.jsx("div",{className:"text-green-300 text-sm",children:"Coût estimé par semaine"})]})]}):null,Ts=({currentPlan:t,selectedInventoryId:s,availableInventories:r,selectInventory:a,isGenerating:i,currentWeek:n,availableWeeks:l,maxAvailableWeek:c,canGenerateNextWeek:u,setCurrentWeek:m,getWeekDateRange:p,handleGenerateMealPlan:d,isWeekAvailable:b,weekDateRange:v})=>{const{click:I}=K(),w=n>1,D=n<c||u,N=l.map(E=>({value:E.toString(),label:`Semaine ${E} - ${p(E).formatted}`})),B=t&&t.weekNumber===n;return e.jsxs(e.Fragment,{children:[t?.nutritionalSummary&&e.jsx(Rs,{nutritionalSummary:t.nutritionalSummary,estimatedWeeklyCost:t.estimatedWeeklyCost}),e.jsxs(C,{className:"p-6",style:{position:"relative",background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #8B5CF6 12%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, #A855F7 8%, transparent) 0%, transparent 50%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, #8B5CF6 25%, transparent)",boxShadow:`
            0 12px 40px rgba(0, 0, 0, 0.25),
            0 0 30px color-mix(in srgb, #8B5CF6 15%, transparent),
            inset 0 2px 0 rgba(255, 255, 255, 0.15)
          `},children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4",children:e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center breathing-icon",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #8B5CF6 35%, transparent), color-mix(in srgb, #8B5CF6 25%, transparent))
                `,border:"2px solid color-mix(in srgb, #8B5CF6 50%, transparent)",boxShadow:"0 0 30px color-mix(in srgb, #8B5CF6 40%, transparent)"},children:e.jsx(x,{Icon:o.Calendar,size:32,style:{color:"#8B5CF6"}})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl sm:text-2xl font-bold text-white",children:"Générateur de Plan Repas"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Organisez vos repas de la semaine avec votre inventaire"})]})]})}),e.jsx(De,{value:s||"",options:r.map(E=>({value:E.id,label:`Inventaire du ${new Date(E.created_at).toLocaleDateString("fr-FR")} (${E.inventory_final?.length||0} ingrédients)`})),onChange:a,placeholder:"Sélectionner un inventaire...",className:"w-full","aria-label":"Sélectionner l'inventaire pour le plan de repas",disabled:i}),N.length>0&&e.jsx("div",{className:"space-y-4 mt-4 pt-4 border-t border-white/10",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>{I(),m(n-1)},disabled:!w||i,className:"btn-glass w-8 h-8 rounded-full flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed flex-shrink-0",title:w?"Semaine précédente":"Aucune semaine précédente disponible",style:{background:"color-mix(in srgb, #8B5CF6 15%, transparent)",border:"1px solid color-mix(in srgb, #8B5CF6 25%, transparent)"},children:e.jsx(x,{Icon:o.ChevronLeft,size:14,className:"text-cyan-300"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx(De,{options:N,value:n.toString(),onChange:E=>{I(),m(parseInt(E))},placeholder:"Sélectionner une semaine",disabled:i,className:"w-full"})}),e.jsx("button",{onClick:()=>{I(),m(n+1)},disabled:!D||i,className:"btn-glass w-8 h-8 rounded-full flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed flex-shrink-0",title:D?"Semaine suivante":"Semaine suivante non disponible",style:{background:"color-mix(in srgb, #8B5CF6 15%, transparent)",border:"1px solid color-mix(in srgb, #8B5CF6 25%, transparent)"},children:e.jsx(x,{Icon:o.ChevronRight,size:14,className:"text-cyan-300"})})]})}),t?.nutritionalSummary&&e.jsxs("div",{className:"flex items-center gap-4 mt-4 pt-4 border-t border-white/10 text-sm",children:[e.jsxs("span",{className:"text-purple-300 font-medium",children:["~",Math.round(t.nutritionalSummary.avgCaloriesPerDay)," kcal/jour"]}),e.jsxs("span",{className:"text-cyan-300 font-medium",children:[Math.round(t.nutritionalSummary.avgProteinPerDay),"g protéines/jour"]})]})]}),t&&e.jsx("div",{className:"mt-4",children:!B&&s&&b(n)&&e.jsx(le,{children:e.jsx(h.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},children:e.jsx("button",{onClick:()=>{I(),d()},disabled:i,className:"btn-glass btn-glass--primary w-full px-6 py-3 font-medium transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",style:i?void 0:{background:`
                      linear-gradient(135deg, 
                        color-mix(in srgb, #8B5CF6 80%, transparent),
                        color-mix(in srgb, #A855F7 70%, transparent)
                      )
                    `,border:"2px solid color-mix(in srgb, #8B5CF6 60%, transparent)",boxShadow:`
                      0 8px 32px color-mix(in srgb, #8B5CF6 40%, transparent),
                      0 0 40px color-mix(in srgb, #8B5CF6 30%, transparent),
                      inset 0 2px 0 rgba(255, 255, 255, 0.4),
                      inset 0 -2px 0 rgba(0, 0, 0, 0.2)
                    `,backdropFilter:"blur(20px) saturate(160%)",WebkitBackdropFilter:"blur(20px) saturate(160%)",color:"white"},children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[i?e.jsx(x,{Icon:o.Loader2,size:20,className:"animate-spin",style:{color:"white"}}):e.jsx(x,{Icon:o.Calendar,size:20,style:{color:"white"}}),e.jsx("span",{children:i?"Génération...":`Générer Semaine ${n}`})]})})})})})]})},_s=({progress:t,loadingMessage:s,currentLoadingTitle:r,currentLoadingSubtitle:a})=>e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:e.jsx(C,{className:"p-8 text-center",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #8B5CF6 15%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, #A855F7 12%, transparent) 0%, transparent 50%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, #8B5CF6 30%, transparent)",boxShadow:`
            0 12px 40px rgba(0, 0, 0, 0.25),
            0 0 30px color-mix(in srgb, #8B5CF6 20%, transparent),
            inset 0 2px 0 rgba(255, 255, 255, 0.15)
          `},children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(h.div,{className:"w-20 h-20 mx-auto rounded-full flex items-center justify-center",style:{background:`
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                linear-gradient(135deg, color-mix(in srgb, #8B5CF6 35%, transparent), color-mix(in srgb, #8B5CF6 25%, transparent))
              `,border:"2px solid color-mix(in srgb, #8B5CF6 50%, transparent)",boxShadow:"0 0 30px color-mix(in srgb, #8B5CF6 40%, transparent)"},animate:{scale:[1,1.05,1],opacity:[.8,1,.8]},transition:{duration:2,repeat:1/0},children:e.jsx(x,{Icon:o.Calendar,size:40,style:{color:"#8B5CF6"}})}),e.jsxs("div",{children:[e.jsx(h.h3,{className:"text-3xl font-bold text-white mb-3",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.4},style:{textShadow:"0 0 20px color-mix(in srgb, #8B5CF6 60%, transparent)"},children:r||"Génération du Plan Nutritionnel"},r),e.jsx(h.p,{className:"text-white/90 text-xl mb-2",initial:{opacity:0,y:5},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1},children:a||"Préparation de votre plan personnalisé"},a),s&&e.jsx(h.p,{className:"text-white/70 text-sm",initial:{opacity:0},animate:{opacity:1},transition:{duration:.2},children:s},s)]}),e.jsxs("div",{className:"max-w-md mx-auto space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm text-white/70",children:[e.jsx("span",{children:"Progression"}),e.jsxs("span",{children:[Math.round(t),"%"]})]}),e.jsx("div",{className:"w-full bg-white/10 rounded-full h-3 overflow-hidden",children:e.jsx(h.div,{className:"h-3 rounded-full relative overflow-hidden",style:{background:`linear-gradient(90deg, 
                    #8B5CF6, 
                    #A855F7, 
                    #C084FC
                  )`,boxShadow:`
                    0 0 16px color-mix(in srgb, #8B5CF6 70%, transparent),
                    inset 0 1px 0 rgba(255,255,255,0.4)
                  `,width:`${t}%`},initial:{width:0},animate:{width:`${t}%`},transition:{duration:.3,ease:"easeOut"},children:e.jsx("div",{className:"absolute inset-0 rounded-full",style:{background:`linear-gradient(90deg, 
                      transparent 0%, 
                      rgba(255,255,255,0.6) 50%, 
                      transparent 100%
                    )`,animation:"progressShimmer 2s ease-in-out infinite"}})})})]}),e.jsx("div",{className:"text-sm text-white/60",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(x,{Icon:o.Zap,size:14,style:{color:"#8B5CF6"}}),e.jsx("span",{children:"Analyse de la Forge • Optimisation nutritionnelle • Planification de la Forge"})]})})]})})}),Ps=({currentPlan:t,onGenerateAllRecipes:s,onRegenerateWeek:r,onExportPlan:a,clearPlan:i,isGenerating:n})=>{const[l,c]=f.useState(!1),[u,m]=f.useState(!1),{click:p}=K(),d=f.useMemo(()=>{if(!t?.days)return{totalMeals:0,generatedRecipes:0,totalUniqueIngredients:0,totalUniqueRecipes:0};let D=0,N=0;const B=new Set,E=new Set;return t.days.forEach(g=>{g.meals&&Object.values(g.meals).forEach(j=>{j&&typeof j=="object"&&(D++,j.detailedRecipe?.id?(E.add(j.detailedRecipe.id),N++):j.recipeId&&E.add(j.recipeId),j.detailedRecipe?.ingredients?j.detailedRecipe.ingredients.forEach(A=>{A.name&&B.add(A.name.toLowerCase())}):j.mainIngredients&&j.mainIngredients.forEach(A=>{B.add(A.toLowerCase())}))})}),{totalMeals:D,generatedRecipes:N,totalUniqueIngredients:B.size,totalUniqueRecipes:E.size}},[t]),b=async()=>{c(!0),p();try{await s()}finally{c(!1)}},v=async()=>{m(!0),p();try{await r()}finally{m(!1)}},I=()=>{p(),a()},w=()=>{p(),i()};return n?null:e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-6",children:e.jsx(C,{className:"p-6 border-2 border-purple-400/30",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-purple-400 to-purple-600 rounded-lg flex items-center justify-center",children:e.jsx(x,{Icon:o.CheckCircle,size:20,className:"text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-white",children:"Plan de repas généré avec succès !"})]}),e.jsxs("div",{className:"text-sm text-purple-300 font-medium",children:["Semaine ",t?.weekNumber||1]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-white/70",children:"Progression des recettes"}),e.jsxs("span",{className:"text-white font-medium",children:[d.generatedRecipes,"/",d.totalMeals]})]}),e.jsx("div",{className:"w-full bg-white/10 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-purple-400 to-purple-600 h-2 rounded-full transition-all duration-300",style:{width:d.totalMeals>0?`${d.generatedRecipes/d.totalMeals*100}%`:"0%"}})})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:t?.days?.length||0}),e.jsx("div",{className:"text-sm text-white/70",children:"Jours"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:d.totalUniqueRecipes}),e.jsx("div",{className:"text-sm text-white/70",children:"Recettes uniques"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:d.totalUniqueIngredients}),e.jsx("div",{className:"text-sm text-white/70",children:"Ingrédients uniques"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:t?.batchCookingDays?.length>0?t.batchCookingDays.length:d.totalMeals}),e.jsx("div",{className:"text-sm text-white/70",children:t?.batchCookingDays?.length>0?"Jours de batch cooking":"Repas planifiés"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"w-full",children:e.jsx("button",{onClick:b,disabled:l,className:"w-full text-white font-semibold py-3 px-6 rounded-xl transition-all duration-200 flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",style:l?void 0:{background:"linear-gradient(135deg, rgba(168, 85, 247, 0.9) 0%, rgba(147, 51, 234, 0.85) 100%)",backdropFilter:"blur(20px) saturate(160%)",border:"2px solid color-mix(in srgb, #A855F7 60%, transparent)",boxShadow:`
                    0 12px 40px color-mix(in srgb, #A855F7 40%, transparent),
                    0 0 60px color-mix(in srgb, #A855F7 30%, transparent),
                    inset 0 3px 0 rgba(255, 255, 255, 0.4),
                    inset 0 -3px 0 rgba(0, 0, 0, 0.2),
                    inset 2px 0 0 rgba(255, 255, 255, 0.1),
                    inset -2px 0 0 rgba(0, 0, 0, 0.1)
                  `,transform:"translateZ(0)",WebkitBackdropFilter:"blur(20px) saturate(160%)"},children:l?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("span",{children:"Génération en cours..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(x,{Icon:o.Zap,size:20}),e.jsx("span",{children:"Valider & Générer toutes les recettes"})]})})}),e.jsxs("div",{className:"w-full flex flex-col sm:flex-row gap-3",children:[e.jsx("button",{onClick:I,disabled:l||n,className:"sm:w-auto sm:flex-1 h-10 px-4 flex items-center justify-center bg-white/10 hover:bg-white/20 text-white font-medium rounded-xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Exporter le plan",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{Icon:o.Download,size:16}),e.jsx("span",{children:"Exporter"})]})}),e.jsx("button",{onClick:w,disabled:l||n,className:"sm:w-auto sm:flex-1 h-10 px-4 flex items-center justify-center bg-white/10 hover:bg-white/20 text-white font-medium rounded-xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Supprimer le plan",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{Icon:o.Trash2,size:16}),e.jsx("span",{children:"Supprimer"})]})}),e.jsx("button",{onClick:v,disabled:u||n,className:"sm:w-auto sm:flex-1 h-10 px-4 flex items-center justify-center bg-white/10 hover:bg-white/20 text-white font-medium rounded-xl transition-all duration-200",title:"Régénérer la semaine",children:u?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("span",{children:"Régénérer"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{Icon:o.RotateCcw,size:16}),e.jsx("span",{children:"Régénérer"})]})})]})]}),e.jsx("div",{className:"bg-purple-500/10 rounded-lg p-4",children:e.jsxs("div",{className:"text-sm text-white/80",children:[e.jsx("p",{className:"font-medium mb-1",children:"💡 Conseil :"}),e.jsx("p",{children:"Générez toutes les recettes pour obtenir des instructions détaillées et une liste de courses complète."})]})})]})})})},zs=({dayName:t,date:s,index:r})=>e.jsx(h.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.4,delay:r*.05},children:e.jsxs(C,{className:"p-5",style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #6B7280 8%, transparent) 0%, transparent 60%),
          var(--glass-opacity)
        `,borderColor:"color-mix(in srgb, #6B7280 20%, transparent)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:"color-mix(in srgb, #6B7280 15%, transparent)",border:"2px solid color-mix(in srgb, #6B7280 25%, transparent)"},children:e.jsx(x,{Icon:o.CalendarDays,size:16,style:{color:"#6B7280"}})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-bold text-lg",children:t}),e.jsx("div",{className:"text-white/60 text-xs",children:new Date(s).toLocaleDateString("fr-FR",{day:"numeric",month:"short"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{Icon:o.Loader2,size:16,className:"animate-spin text-gray-400"}),e.jsx("span",{className:"text-gray-400 text-xs",children:"Génération..."})]})]}),e.jsx("div",{className:"space-y-3",children:["Petit-déjeuner","Déjeuner","Dîner"].map((a,i)=>e.jsxs("div",{className:"p-4 rounded-xl bg-white/5 border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-4 h-4 bg-white/20 rounded animate-pulse"}),e.jsx("div",{className:"h-4 bg-white/20 rounded w-24 animate-pulse"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-white/15 rounded w-full animate-pulse"}),e.jsx("div",{className:"h-3 bg-white/15 rounded w-2/3 animate-pulse"})]})]},i))})]})}),Ms=()=>e.jsxs("div",{className:"animate-pulse space-y-3",children:[e.jsx("div",{className:"h-4 bg-white/10 rounded w-3/4"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-white/5 rounded w-full"}),e.jsx("div",{className:"h-3 bg-white/5 rounded w-5/6"}),e.jsx("div",{className:"h-3 bg-white/5 rounded w-4/5"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"h-3 bg-white/5 rounded w-16"}),e.jsx("div",{className:"h-3 bg-white/5 rounded w-12"})]})]}),Ee=({mealType:t,meal:s,onViewRecipe:r,dayIndex:a,onGenerateDetailedRecipe:i})=>{const n=p=>p==="snack"?"snacks":p,l=p=>({breakfast:"#F59E0B",lunch:"#10B981",dinner:"#8B5CF6",snacks:"#EC4899"})[n(p)]||"#6B7280",c=p=>({breakfast:"Coffee",lunch:"Utensils",dinner:"Utensils",snacks:"Coffee"})[n(p)]||"Utensils",u=p=>({breakfast:"Petit-déjeuner",lunch:"Déjeuner",dinner:"Dîner",snacks:"Collations"})[n(p)]||p,m=l(t);return s?.status==="loading"?e.jsx(Ms,{}):e.jsxs("div",{className:"p-4 rounded-xl border transition-all duration-200",style:{background:s?`color-mix(in srgb, ${m} 8%, transparent)`:"rgba(255, 255, 255, 0.05)",borderColor:s?`color-mix(in srgb, ${m} 25%, transparent)`:"rgba(255, 255, 255, 0.15)"},children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{Icon:o[c(t)],size:16,style:{color:m}}),e.jsx("span",{className:"text-white/80 text-sm font-medium",children:u(t)})]})}),s?e.jsxs("div",{className:"space-y-3",children:[s.imageUrl?e.jsxs("div",{className:"mb-3 relative h-32 overflow-hidden rounded-lg",children:[e.jsx("img",{src:s.imageUrl,alt:s.mealName||s.title,className:"w-full h-full object-cover",onError:p=>{p.currentTarget.style.display="none"}}),e.jsx("div",{className:"absolute top-2 right-2 z-10",children:s.status==="loading"?e.jsxs("button",{disabled:!0,className:"btn-glass px-2 py-1 text-xs rounded-full flex items-center gap-1 cursor-not-allowed",style:{background:"color-mix(in srgb, #6B7280 15%, transparent)",border:"1px solid color-mix(in srgb, #6B7280 25%, transparent)",color:"#9CA3AF"},children:[e.jsx(x,{Icon:o.Loader2,size:12,className:"animate-spin"}),"Génération..."]}):s.isDetailedRecipeGenerated?e.jsxs("button",{onClick:()=>r&&r(s),className:`btn-glass px-2 py-1 text-xs rounded-full flex items-center gap-1 
                             hover:scale-105 transition-all duration-200`,style:{background:`color-mix(in srgb, ${m} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${m} 30%, transparent)`,color:m},children:[e.jsx(x,{Icon:o.Eye,size:12}),"Voir"]}):e.jsxs("button",{onClick:()=>{console.log("🍽️ INDIVIDUAL MEAL BUTTON CLICKED: Générer la recette",{dayIndex:a,mealType:t,mealTitle:s.mealName||s.title,hasFunction:!!i}),i(a,t)},className:`btn-glass px-2 py-1 text-xs rounded-full flex items-center gap-1 
                             hover:scale-105 transition-all duration-200`,style:{background:`color-mix(in srgb, ${m} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${m} 30%, transparent)`,color:m},children:[e.jsx(x,{Icon:o.Sparkles,size:12}),"Générer"]})})]}):s.isDetailedRecipeGenerated&&!s.imageGenerationError?e.jsxs("div",{className:"mb-3 relative h-32 bg-gradient-to-br from-blue-900/20 to-purple-900/20 rounded-lg flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-blue-400/30 border-t-blue-400 rounded-full"}),e.jsx("div",{className:"absolute top-2 right-2 z-10",children:e.jsxs("button",{onClick:()=>r&&r(s),className:`btn-glass px-2 py-1 text-xs rounded-full flex items-center gap-1 
                           hover:scale-105 transition-all duration-200`,style:{background:`color-mix(in srgb, ${m} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${m} 30%, transparent)`,color:m},children:[e.jsx(x,{Icon:o.Eye,size:12}),"Voir"]})})]}):null,s.imageGenerationError&&e.jsxs("div",{className:"mb-3 relative h-32 bg-gradient-to-br from-gray-800 to-gray-900 rounded-lg flex items-center justify-center",children:[e.jsx(x,{Icon:o.AlertTriangle,size:24,className:"text-orange-400"}),e.jsx("div",{className:"absolute top-2 right-2 z-10",children:s.isDetailedRecipeGenerated?e.jsxs("button",{onClick:()=>r&&r(s),className:`btn-glass px-2 py-1 text-xs rounded-full flex items-center gap-1 
                             hover:scale-105 transition-all duration-200`,style:{background:`color-mix(in srgb, ${m} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${m} 30%, transparent)`,color:m},children:[e.jsx(x,{Icon:o.Eye,size:12}),"Voir"]}):e.jsxs("button",{onClick:()=>{console.log("🍽️ INDIVIDUAL MEAL BUTTON CLICKED: Générer la recette",{dayIndex:a,mealType:t,mealTitle:s.mealName||s.title,hasFunction:!!i}),i(a,t)},className:`btn-glass px-2 py-1 text-xs rounded-full flex items-center gap-1 
                             hover:scale-105 transition-all duration-200`,style:{background:`color-mix(in srgb, ${m} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${m} 30%, transparent)`,color:m},children:[e.jsx(x,{Icon:o.Sparkles,size:12}),"Générer"]})})]}),e.jsx("h5",{className:"text-white font-semibold text-sm mb-2 leading-tight",children:s.mealName||s.title}),(s.descriptionSummary||s.description)&&e.jsx("p",{className:"text-white/60 text-xs mb-2 line-clamp-2",children:s.descriptionSummary||s.description}),e.jsxs("div",{className:"flex items-center gap-3 mb-2 text-xs text-white/70",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"⏱️"}),e.jsxs("span",{children:[s.estimatedPrepTime||s.prep_time_min||0,"min (prép)"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"/"}),e.jsxs("span",{children:[s.estimatedCookTime||s.cook_time_min||0,"min (cuis)"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"🔥"}),e.jsxs("span",{children:[s.estimatedCalories||s.calories_est||0," kcal"]})]})]}),s.mealComponents&&s.mealComponents.length>0&&e.jsx("div",{className:"space-y-1 mb-2",children:s.mealComponents.slice(0,2).map((p,d)=>e.jsxs("div",{className:"text-xs text-white/70 flex items-center gap-1",children:[e.jsx("div",{className:"w-1 h-1 rounded-full bg-white/40"}),e.jsx("span",{children:p})]},d))}),s.dietaryTags&&s.dietaryTags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:s.dietaryTags.slice(0,2).map(p=>e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs",style:{background:`color-mix(in srgb, ${m} 15%, transparent)`,color:m},children:p},p))})]}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx(x,{Icon:o.Plus,size:20,className:"text-white/40 mx-auto mb-2"}),e.jsx("span",{className:"text-white/50 text-sm",children:"Aucun repas planifié"})]})]})},$s=({day:t,index:s,isEditable:r=!1,onViewRecipe:a,onGenerateDetailedRecipe:i,onGenerateAllDetailedRecipesForDay:n})=>{if(t.status==="loading")return e.jsx(zs,{dayName:t.dayName,date:t.date,index:s});const l=t.date===new Date().toISOString().split("T")[0],c=t.isBatchCookingDay,u=()=>{console.log("🔥 BUTTON CLICKED: Générer les Recettes du Jour",{dayIndex:s,dayName:t.dayName,date:t.date,hasFunction:!!n}),n?(console.log("🚀 CALLING onGenerateAllDetailedRecipesForDay with dayIndex:",s),n(s)):console.error("❌ onGenerateAllDetailedRecipesForDay function is not available")};return e.jsx(h.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.4,delay:s*.05},className:"relative group",children:e.jsxs(C,{className:"p-5",style:{background:l?`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #22C55E 12%, transparent) 0%, transparent 60%),
              radial-gradient(circle at 70% 80%, color-mix(in srgb, #10B981 8%, transparent) 0%, transparent 50%),
              var(--glass-opacity)
            `:c?`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #8B5CF6 8%, transparent) 0%, transparent 60%),
              var(--glass-opacity)
            `:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #06B6D4 8%, transparent) 0%, transparent 60%),
              var(--glass-opacity)
            `,borderColor:l?"color-mix(in srgb, #22C55E 30%, transparent)":c?"color-mix(in srgb, #8B5CF6 25%, transparent)":"color-mix(in srgb, #06B6D4 20%, transparent)",boxShadow:l?`
              0 12px 40px rgba(0, 0, 0, 0.25),
              0 0 30px color-mix(in srgb, #22C55E 20%, transparent),
              inset 0 2px 0 rgba(255, 255, 255, 0.15)
            `:`
              0 8px 32px rgba(0, 0, 0, 0.2),
              0 0 20px color-mix(in srgb, #06B6D4 12%, transparent),
              inset 0 1px 0 rgba(255, 255, 255, 0.12)
            `},children:[e.jsxs("div",{className:"absolute top-4 right-4 flex flex-col gap-2 z-10",children:[l&&e.jsx("div",{className:`px-2 py-1 bg-gradient-to-r from-orange-500/80 to-red-500/80 
                          border border-orange-400/60 rounded-lg text-white text-xs font-medium
                          shadow-lg backdrop-blur-sm`,children:"Aujourd'hui"}),c&&e.jsx("div",{className:`px-2 py-1 bg-gradient-to-r from-green-500/80 to-emerald-500/80 
                          border border-green-400/60 rounded-lg text-white text-xs font-medium
                          shadow-lg backdrop-blur-sm`,children:"Planifié"})]}),e.jsx("div",{className:"relative flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:l?"color-mix(in srgb, #22C55E 20%, transparent)":c?"color-mix(in srgb, #8B5CF6 15%, transparent)":"color-mix(in srgb, #06B6D4 15%, transparent)",border:l?"2px solid color-mix(in srgb, #22C55E 40%, transparent)":c?"2px solid color-mix(in srgb, #8B5CF6 30%, transparent)":"2px solid color-mix(in srgb, #06B6D4 25%, transparent)"},children:e.jsx(x,{Icon:l?o.Calendar:c?o.Clock:o.CalendarDays,size:16,style:{color:l?"#22C55E":c?"#8B5CF6":"#06B6D4"}})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-bold text-lg",children:t.dayName}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-white/60",children:[e.jsx("span",{children:new Date(t.date).toLocaleDateString("fr-FR",{day:"numeric",month:"short"})}),c&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx("span",{className:"text-purple-300 font-medium",children:"Batch Cooking"})]})]})]})]})}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"p-4 rounded-xl border",style:{background:`
                radial-gradient(circle at 30% 20%, color-mix(in srgb, ${l?"#22C55E":c?"#8B5CF6":"#06B6D4"} 12%, transparent) 0%, transparent 60%),
                rgba(255, 255, 255, 0.08)
              `,borderColor:`color-mix(in srgb, ${l?"#22C55E":c?"#8B5CF6":"#06B6D4"} 30%, transparent)`,backdropFilter:"blur(12px) saturate(140%)"},children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(x,{Icon:o.Clock,size:18,style:{color:l?"#22C55E":c?"#8B5CF6":"#06B6D4"}}),e.jsx("span",{className:"text-white font-bold text-xl",children:t.prepTime+t.cookTime}),e.jsx("span",{className:"text-white/70 text-sm font-medium",children:"min"})]}),e.jsx("div",{className:"text-white/60 text-xs",children:"Temps total"})]}),e.jsx("div",{className:"w-px h-8 bg-white/20"}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(x,{Icon:o.Flame,size:18,style:{color:"#F59E0B"}}),e.jsx("span",{className:"text-white font-bold text-xl",children:t.totalCalories}),e.jsx("span",{className:"text-white/70 text-sm font-medium",children:"kcal"})]}),e.jsx("div",{className:"text-white/60 text-xs",children:"Calories totales"})]})]})})})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(Ee,{mealType:"breakfast",meal:t.meals?.breakfast,onViewRecipe:a,dayIndex:s,onGenerateDetailedRecipe:i}),e.jsx(Ee,{mealType:"lunch",meal:t.meals?.lunch,onViewRecipe:a,dayIndex:s,onGenerateDetailedRecipe:i}),e.jsx(Ee,{mealType:"dinner",meal:t.meals?.dinner,onViewRecipe:a,dayIndex:s,onGenerateDetailedRecipe:i}),t.meals?.snack&&e.jsx(Ee,{mealType:"snack",meal:t.meals.snack,onViewRecipe:a,dayIndex:s,onGenerateDetailedRecipe:i})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-white/10",children:e.jsx("button",{onClick:u,className:"w-full btn-glass--primary py-3 px-4 text-sm font-semibold",style:{background:`
                linear-gradient(135deg, 
                  color-mix(in srgb, ${l?"#22C55E":c?"#8B5CF6":"#06B6D4"} 80%, transparent), 
                  color-mix(in srgb, ${l?"#10B981":c?"#A855F7":"#0891B2"} 60%, transparent)
                )
              `,border:`2px solid color-mix(in srgb, ${l?"#22C55E":c?"#8B5CF6":"#06B6D4"} 60%, transparent)`,boxShadow:`
                0 8px 32px color-mix(in srgb, ${l?"#22C55E":c?"#8B5CF6":"#06B6D4"} 40%, transparent),
                0 0 40px color-mix(in srgb, ${l?"#22C55E":c?"#8B5CF6":"#06B6D4"} 30%, transparent),
                inset 0 2px 0 rgba(255,255,255,0.4)
              `,backdropFilter:"blur(16px) saturate(150%)"},children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx(x,{Icon:o.Sparkles,size:18,className:"text-white",variant:"pure"}),e.jsx("span",{className:"text-white",children:"Générer les Recettes du Jour"}),e.jsx(x,{Icon:o.ArrowRight,size:16,className:"text-white/80",variant:"pure"})]})})})]})})},Ls=({weekNumber:t})=>e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},children:e.jsxs(C,{className:"p-6",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #10B981 12%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, #22C55E 8%, transparent) 0%, transparent 50%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, #10B981 30%, transparent)",boxShadow:`
            0 12px 40px rgba(0, 0, 0, 0.25),
            0 0 30px color-mix(in srgb, #10B981 20%, transparent),
            inset 0 2px 0 rgba(255, 255, 255, 0.15)
          `},children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center breathing-icon animate-pulse",style:{background:`
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.25) 0%, transparent 60%),
                linear-gradient(135deg, color-mix(in srgb, #10B981 40%, transparent), color-mix(in srgb, #22C55E 30%, transparent))
              `,border:"3px solid color-mix(in srgb, #10B981 60%, transparent)",boxShadow:`
                0 0 40px color-mix(in srgb, #10B981 50%, transparent),
                0 0 80px color-mix(in srgb, #22C55E 30%, transparent),
                inset 0 3px 0 rgba(255,255,255,0.4)
              `},children:e.jsx(x,{Icon:o.Lightbulb,size:32,style:{color:"#10B981",filter:`
                  drop-shadow(0 0 16px color-mix(in srgb, #10B981 90%, transparent))
                  drop-shadow(0 0 32px color-mix(in srgb, #10B981 70%, transparent))
                `},variant:"pure"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"Votre Assistant Nutritionnel de la Forge"}),e.jsxs("p",{className:"text-green-200 text-lg",children:["Analyse personnalisée de votre plan - Semaine ",t]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-4 bg-green-300/20 rounded-xl w-3/4"}),e.jsx("div",{className:"h-16 bg-white/5 rounded-xl border border-green-400/20 p-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-green-200/30 rounded w-full"}),e.jsx("div",{className:"h-3 bg-green-200/30 rounded w-5/6"}),e.jsx("div",{className:"h-3 bg-green-200/30 rounded w-4/5"})]})})]}),e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-4 bg-green-300/20 rounded-xl w-2/3"}),e.jsx("div",{className:"h-16 bg-white/5 rounded-xl border border-green-400/20 p-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-green-200/30 rounded w-full"}),e.jsx("div",{className:"h-3 bg-green-200/30 rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-green-200/30 rounded w-5/6"})]})})]}),e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-4 bg-green-300/20 rounded-xl w-1/2"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx("div",{className:"h-12 bg-white/5 rounded-xl border border-green-400/20"}),e.jsx("div",{className:"h-12 bg-white/5 rounded-xl border border-green-400/20"})]})]})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-green-400/20",children:e.jsxs("div",{className:"flex items-center justify-between text-xs text-green-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{Icon:o.Sparkles,size:12}),e.jsx("span",{children:"Génération en cours..."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{Icon:o.Clock,size:12}),e.jsx("span",{className:"animate-pulse",children:"Analyse en temps réel"})]})]})})]})}),qs=({aiExplanation:t,weekNumber:s,isLoading:r=!1})=>r||!t?e.jsx(Ls,{weekNumber:s}):e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},children:e.jsxs(C,{className:"p-6",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #10B981 12%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, #22C55E 8%, transparent) 0%, transparent 50%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, #10B981 30%, transparent)",boxShadow:`
            0 12px 40px rgba(0, 0, 0, 0.25),
            0 0 30px color-mix(in srgb, #10B981 20%, transparent),
            inset 0 2px 0 rgba(255, 255, 255, 0.15)
          `},children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center breathing-icon",style:{background:`
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.25) 0%, transparent 60%),
                linear-gradient(135deg, color-mix(in srgb, #10B981 40%, transparent), color-mix(in srgb, #22C55E 30%, transparent))
              `,border:"3px solid color-mix(in srgb, #10B981 60%, transparent)",boxShadow:`
                0 0 40px color-mix(in srgb, #10B981 50%, transparent),
                0 0 80px color-mix(in srgb, #22C55E 30%, transparent),
                inset 0 3px 0 rgba(255,255,255,0.4)
              `},children:e.jsx(x,{Icon:o.Lightbulb,size:32,style:{color:"#10B981",filter:`
                  drop-shadow(0 0 16px color-mix(in srgb, #10B981 90%, transparent))
                  drop-shadow(0 0 32px color-mix(in srgb, #10B981 70%, transparent))
                `},variant:"pure"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"Votre Assistant Nutritionnel de la Forge"}),e.jsxs("p",{className:"text-green-200 text-lg",children:["Analyse personnalisée de votre plan - Semaine ",s]})]})]}),e.jsxs("div",{className:"space-y-6",children:[t.personalizedReasoning&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-green-300 font-semibold text-lg mb-3 flex items-center gap-2",children:[e.jsx(x,{Icon:o.User,size:18}),"Pourquoi ce plan vous convient"]}),e.jsx("p",{className:"text-green-100 text-sm leading-relaxed bg-white/5 p-4 rounded-xl border border-green-400/20",children:t.personalizedReasoning})]}),t.nutritionalStrategy&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-green-300 font-semibold text-lg mb-3 flex items-center gap-2",children:[e.jsx(x,{Icon:o.Target,size:18}),"Stratégie nutritionnelle"]}),e.jsx("p",{className:"text-green-100 text-sm leading-relaxed bg-white/5 p-4 rounded-xl border border-green-400/20",children:t.nutritionalStrategy})]}),t.adaptationHighlights&&t.adaptationHighlights.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-green-300 font-semibold text-lg mb-3 flex items-center gap-2",children:[e.jsx(x,{Icon:o.Check,size:18}),"Adaptations spécifiques"]}),e.jsx("div",{className:"space-y-2",children:t.adaptationHighlights.map((a,i)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-xl bg-white/5 border border-green-400/20",children:[e.jsx(x,{Icon:o.ArrowRight,size:14,className:"text-green-400 mt-0.5"}),e.jsx("span",{className:"text-green-100 text-sm leading-relaxed",children:a})]},i))})]}),t.weeklyGoals&&t.weeklyGoals.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-green-300 font-semibold text-lg mb-3 flex items-center gap-2",children:[e.jsx(x,{Icon:o.Flag,size:18}),"Objectifs de la semaine"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:t.weeklyGoals.map((a,i)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-xl bg-white/5 border border-green-400/20",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-400"}),e.jsx("span",{className:"text-green-100 text-sm",children:a})]},i))})]}),t.complianceNotes&&t.complianceNotes.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-green-300 font-semibold text-lg mb-3 flex items-center gap-2",children:[e.jsx(x,{Icon:o.Shield,size:18}),"Respect de vos contraintes"]}),e.jsx("div",{className:"space-y-2",children:t.complianceNotes.map((a,i)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-xl bg-white/5 border border-green-400/20",children:[e.jsx(x,{Icon:o.CheckCircle,size:14,className:"text-green-400 mt-0.5"}),e.jsx("span",{className:"text-green-100 text-sm leading-relaxed",children:a})]},i))})]})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-green-400/20",children:e.jsxs("div",{className:"flex items-center justify-between text-xs text-green-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{Icon:o.Sparkles,size:12}),e.jsx("span",{children:"Généré par votre Assistant Nutritionnel de la Forge"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{Icon:o.Clock,size:12}),e.jsx("span",{children:"Mis à jour en temps réel"})]})]})})]})}),Gs=({hasContext:t,onGenerate:s,isGenerating:r,profileCompletion:a,featureGuidance:i,onDismissNudge:n,nudgeDismissed:l,currentWeek:c,isWeekAvailable:u,weekDateRange:m,setCurrentWeek:p})=>{const d=()=>u?t?`Générer Semaine ${c}`:"Scannez votre frigo pour commencer":`Semaine ${c} Non Disponible`,b=()=>u?t?"Votre plan de repas sera généré automatiquement en organisant vos recettes sur 7 jours avec optimisation nutritionnelle.":"Commencez par scanner votre frigo ou sélectionner un inventaire existant pour générer votre plan de repas personnalisé.":"Cette semaine ne peut pas encore être générée. Attendez que la semaine précédente soit terminée pour débloquer la planification.";return e.jsxs("div",{className:"space-y-6",children:[e.jsx(C,{className:"p-8 text-center",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #8B5CF6 8%, transparent) 0%, transparent 60%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, #8B5CF6 20%, transparent)"},children:e.jsxs("div",{className:"space-y-6 w-full text-center",children:[e.jsx("div",{className:"flex justify-center items-center w-full",children:e.jsx("div",{className:"w-20 h-20 rounded-full flex items-center justify-center breathing-icon",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #8B5CF6 35%, transparent), color-mix(in srgb, #A855F7 25%, transparent))
                `,border:"2px solid color-mix(in srgb, #8B5CF6 50%, transparent)",boxShadow:`
                  0 0 30px color-mix(in srgb, #8B5CF6 40%, transparent),
                  0 0 60px color-mix(in srgb, #8B5CF6 30%, transparent),
                  inset 0 2px 0 rgba(255, 255, 255, 0.2)
                `,backdropFilter:"blur(16px) saturate(150%)"},children:e.jsx(x,{Icon:t?o.Calendar:o.Scan,size:40,style:{color:"#8B5CF6",filter:`
                    drop-shadow(0 0 12px color-mix(in srgb, #8B5CF6 80%, transparent))
                    drop-shadow(0 0 24px color-mix(in srgb, #8B5CF6 60%, transparent))
                  `},variant:"pure"})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:d()}),e.jsx("div",{className:"text-purple-300 text-sm font-medium mb-3",children:m.formatted}),e.jsx("p",{className:"text-white/70 text-lg leading-relaxed",children:b()})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 my-8",children:[e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center mx-auto",style:{background:`
                    radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                    linear-gradient(135deg, color-mix(in srgb, #8B5CF6 25%, transparent), color-mix(in srgb, #A855F7 15%, transparent))
                  `,border:"1px solid color-mix(in srgb, #8B5CF6 40%, transparent)",boxShadow:`
                    0 0 20px color-mix(in srgb, #8B5CF6 30%, transparent),
                    inset 0 1px 0 rgba(255, 255, 255, 0.15)
                  `,backdropFilter:"blur(12px) saturate(140%)"},children:e.jsx(x,{Icon:o.Sparkles,size:24,style:{color:"#8B5CF6",filter:"drop-shadow(0 0 8px #8B5CF6)"}})}),e.jsx("h4",{className:"text-white font-semibold",children:"Génération par la Forge"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Créez des plans uniques basés sur votre inventaire"})]}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center mx-auto",style:{background:`
                    radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                    linear-gradient(135deg, color-mix(in srgb, #8B5CF6 25%, transparent), color-mix(in srgb, #A855F7 15%, transparent))
                  `,border:"1px solid color-mix(in srgb, #8B5CF6 40%, transparent)",boxShadow:`
                    0 0 20px color-mix(in srgb, #8B5CF6 30%, transparent),
                    inset 0 1px 0 rgba(255, 255, 255, 0.15)
                  `,backdropFilter:"blur(12px) saturate(140%)"},children:e.jsx(x,{Icon:o.Save,size:24,style:{color:"#8B5CF6",filter:"drop-shadow(0 0 8px #8B5CF6)"}})}),e.jsx("h4",{className:"text-white font-semibold",children:"Sauvegarde"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Gardez vos plans favoris dans votre bibliothèque"})]}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center mx-auto",style:{background:`
                    radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                    linear-gradient(135deg, color-mix(in srgb, #8B5CF6 25%, transparent), color-mix(in srgb, #A855F7 15%, transparent))
                  `,border:"1px solid color-mix(in srgb, #8B5CF6 40%, transparent)",boxShadow:`
                    0 0 20px color-mix(in srgb, #8B5CF6 30%, transparent),
                    inset 0 1px 0 rgba(255, 255, 255, 0.15)
                  `,backdropFilter:"blur(12px) saturate(140%)"},children:e.jsx(x,{Icon:o.Search,size:24,style:{color:"#8B5CF6",filter:"drop-shadow(0 0 8px #8B5CF6)"}})}),e.jsx("h4",{className:"text-white font-semibold",children:"Organisation"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Filtrez et recherchez facilement dans vos plans"})]})]}),e.jsx("div",{className:"flex justify-center mt-8",children:e.jsxs("button",{onClick:s,disabled:r||!t||!u,className:"group relative overflow-hidden px-8 py-4 text-lg font-bold transition-all duration-300 hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",style:{background:`
                  linear-gradient(135deg, 
                    color-mix(in srgb, #8B5CF6 90%, transparent) 0%,
                    color-mix(in srgb, #A855F7 80%, transparent) 50%,
                    color-mix(in srgb, #7C3AED 85%, transparent) 100%
                  )
                `,border:"2px solid color-mix(in srgb, #8B5CF6 70%, transparent)",borderRadius:"16px",boxShadow:`
                  0 8px 32px color-mix(in srgb, #8B5CF6 50%, transparent),
                  0 0 40px color-mix(in srgb, #8B5CF6 40%, transparent),
                  inset 0 2px 0 rgba(255, 255, 255, 0.4),
                  inset 0 -2px 0 rgba(0, 0, 0, 0.3),
                  inset 2px 0 0 rgba(255, 255, 255, 0.2),
                  inset -2px 0 0 rgba(0, 0, 0, 0.2)
                `,backdropFilter:"blur(20px) saturate(160%)",WebkitBackdropFilter:"blur(20px) saturate(160%)",color:"white",textShadow:"0 2px 4px rgba(0, 0, 0, 0.3)",transform:"translateZ(0)",willChange:"transform, box-shadow"},children:[e.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-300",style:{background:`
                    linear-gradient(135deg, 
                      color-mix(in srgb, #8B5CF6 95%, transparent) 0%,
                      color-mix(in srgb, #A855F7 90%, transparent) 50%,
                      color-mix(in srgb, #7C3AED 95%, transparent) 100%
                    )
                  `,borderRadius:"14px"}}),e.jsxs("div",{className:"relative flex items-center gap-3 z-10",children:[r?e.jsx(x,{Icon:o.Loader2,size:24,className:"animate-spin",style:{color:"white",filter:"drop-shadow(0 0 8px rgba(255, 255, 255, 0.5))"}}):e.jsx(x,{Icon:t?o.Calendar:o.Scan,size:24,style:{color:"white",filter:"drop-shadow(0 0 8px rgba(255, 255, 255, 0.5))"}}),e.jsx("span",{className:"relative",children:r?"Génération en cours...":t?"Générer mon plan de repas":"Scanner mon frigo"})]}),e.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-500",style:{background:"linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.2) 50%, transparent 70%)",transform:"translateX(-100%)",animation:"shine 2s infinite",borderRadius:"14px"}})]})}),c>1&&e.jsx("div",{className:"flex justify-center mt-4",children:e.jsxs("button",{onClick:()=>p(c-1),className:"group relative overflow-hidden px-6 py-3 text-base font-semibold transition-all duration-300 hover:scale-105",style:{background:`
                    linear-gradient(135deg, 
                      color-mix(in srgb, #6B7280 60%, transparent) 0%,
                      color-mix(in srgb, #9CA3AF 50%, transparent) 50%,
                      color-mix(in srgb, #6B7280 55%, transparent) 100%
                    )
                  `,border:"2px solid color-mix(in srgb, #6B7280 50%, transparent)",borderRadius:"12px",boxShadow:`
                    0 4px 16px color-mix(in srgb, #6B7280 30%, transparent),
                    0 0 20px color-mix(in srgb, #6B7280 20%, transparent),
                    inset 0 1px 0 rgba(255, 255, 255, 0.3),
                    inset 0 -1px 0 rgba(0, 0, 0, 0.2)
                  `,backdropFilter:"blur(16px) saturate(140%)",WebkitBackdropFilter:"blur(16px) saturate(140%)",color:"white",textShadow:"0 1px 2px rgba(0, 0, 0, 0.3)"},children:[e.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-300",style:{background:`
                      linear-gradient(135deg, 
                        color-mix(in srgb, #6B7280 70%, transparent) 0%,
                        color-mix(in srgb, #9CA3AF 60%, transparent) 50%,
                        color-mix(in srgb, #6B7280 65%, transparent) 100%
                      )
                    `,borderRadius:"10px"}}),e.jsxs("div",{className:"relative flex items-center gap-2 z-10",children:[e.jsx(x,{Icon:o.ArrowLeft,size:20,style:{color:"white",filter:"drop-shadow(0 0 6px rgba(255, 255, 255, 0.3))"}}),e.jsx("span",{className:"relative",children:"Retour à la semaine précédente"})]})]})}),e.jsx("div",{className:"mt-8 p-4 rounded-lg",style:{background:"color-mix(in srgb, #8B5CF6 8%, transparent)",border:"1px solid color-mix(in srgb, #8B5CF6 20%, transparent)"},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(x,{Icon:o.Lightbulb,size:20,className:"text-purple-400 mt-0.5",style:{filter:"drop-shadow(0 0 6px #8B5CF6)"}}),e.jsxs("div",{className:"text-left",children:[e.jsx("h5",{className:"text-purple-300 font-semibold text-sm mb-1",children:"Astuce"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Les plans générés sont dynamiques. Vous pouvez les modifier et les sauvegarder pour les retrouver plus tard."})]})]})})]})}),e.jsx("style",{jsx:!0,children:`
        @keyframes shine {
          0% { transform: translateX(-100%); }
          100% { transform: translateX(100%); }
        }
        
        .breathing-icon {
          animation: breathe 3s ease-in-out infinite;
        }
        
        @keyframes breathe {
          0%, 100% { transform: scale(1); }
          50% { transform: scale(1.05); }
        }
      `})]})},Os=({hasInventory:t,isGenerating:s,generationProgress:r,loadingMessage:a,currentLoadingTitle:i,currentLoadingSubtitle:n,currentPlan:l,selectedInventory:c,handleGenerateAllRecipes:u,handleRegenerateWeek:m,handleExportPlan:p,clearPlan:d,handleViewRecipe:b,generateDetailedRecipeForMeal:v,generateAllDetailedRecipesForDay:I,profileCompletion:w,featureGuidance:D,nudgeDismissed:N,setNudgeDismissed:B,currentWeek:E,weekDateRange:g,handleGenerateMealPlan:j,isWeekAvailable:A,setCurrentWeek:k})=>(console.log("PlanContentSection render conditions:",{hasInventory:t,isGenerating:s,currentPlan:!!l,currentPlanWeek:l?.weekNumber,currentWeek:E,selectedInventory:!!c}),e.jsxs(e.Fragment,{children:[s&&e.jsx(_s,{progress:r,loadingMessage:a,currentLoadingTitle:i,currentLoadingSubtitle:n}),l&&e.jsxs(e.Fragment,{children:[console.log("Rendering MealPlanReviewAndGenerateCTA with currentPlan:",l.weekNumber),e.jsx(Ps,{currentPlan:l,onRegenerateWeek:m,onGenerateAllRecipes:u,onExportPlan:p,clearPlan:d,isGenerating:s}),e.jsx(h.div,{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:l.days.filter(L=>L&&L.date).map((L,V)=>e.jsx($s,{day:L,index:V,isEditable:!1,onViewRecipe:b,onGenerateDetailedRecipe:v,onGenerateAllDetailedRecipesForDay:I},L.date))})]}),(s||l?.aiExplanation)&&e.jsx(qs,{aiExplanation:l?.aiExplanation,weekNumber:E,isLoading:s}),!s&&!l&&e.jsxs(e.Fragment,{children:[console.log("Rendering EmptyPlanState - no current plan"),e.jsx(Gs,{hasContext:t,onGenerate:j,isGenerating:s,profileCompletion:w,featureGuidance:D,onDismissNudge:()=>B(!0),nudgeDismissed:N,currentWeek:E,isWeekAvailable:A(E),weekDateRange:g,setCurrentWeek:k})]})]})),Us=({isGenerating:t,currentPlan:s,selectedInventory:r,currentWeek:a})=>e.jsxs(e.Fragment,{children:[!t&&s&&r&&e.jsx(C,{className:"p-4",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #06B6D4 8%, transparent) 0%, transparent 60%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, #06B6D4 20%, transparent)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(x,{Icon:o.Info,size:16,className:"text-cyan-400"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-cyan-300 font-medium",children:"Plan basé sur : "}),e.jsxs("span",{className:"text-white/80",children:["Inventaire du ",new Date(r.created_at).toLocaleDateString(),"(",r.inventory_final?.length||0," ingrédients) + Profil nutritionnel"]}),e.jsxs("span",{className:"text-white/60 ml-2",children:["• Semaine ",a]})]})]})}),!t&&s&&e.jsxs(C,{className:"p-6",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #10B981 8%, transparent) 0%, transparent 60%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, #10B981 20%, transparent)"},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"color-mix(in srgb, #10B981 15%, transparent)",border:"2px solid color-mix(in srgb, #10B981 25%, transparent)"},children:e.jsx(x,{Icon:o.Lightbulb,size:14,style:{color:"#10B981"}})}),e.jsx("h4",{className:"text-green-300 font-semibold",children:"Conseils de votre Nutritionniste IA"})]}),e.jsxs("div",{className:"space-y-2 text-sm text-green-200",children:[e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Personnalisation :"})," Ce plan est adapté à vos objectifs fitness et préférences alimentaires"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Optimisation :"})," Utilise au maximum les ingrédients de votre inventaire sélectionné"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Évolution :"})," Générez une nouvelle semaine pour une progression continue"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Flexibilité :"})," Cliquez sur une recette pour voir les détails complets et instructions"]})]})]})]}),jr=()=>{const{currentPlan:t,currentWeek:s,availableInventories:r,selectedInventoryId:a,isGenerating:i,generationProgress:n,loadingMessage:l,currentLoadingTitle:c,currentLoadingSubtitle:u,availableWeeks:m,maxAvailableWeek:p,isWeekAvailable:d,profileCompletion:b,featureGuidance:v,nudgeDismissed:I,showRecipeDetailModal:w,selectedRecipeForDetail:D,hasInventory:N,selectedInventory:B,weekDateRange:E,canGenerateNextWeek:g,getWeekDateRange:j,selectInventory:A,clearPlan:k,setCurrentWeek:L,setNudgeDismissed:V,setShowRecipeDetailModal:H,setSelectedRecipeForDetail:J,handleGenerateMealPlan:T,handleRegenerateWeek:pe,handleExportPlan:S,handleViewRecipe:_,handleGenerateAllRecipes:O,handleSavePlanAsIs:$,generateDetailedRecipeForMeal:z,generateAllDetailedRecipesForDay:Q}=Bs();return e.jsxs("div",{className:"space-y-6",children:[(t||i)&&e.jsx(Ts,{currentPlan:t,handleExportPlan:S,clearPlan:k,selectedInventoryId:a,availableInventories:r,selectInventory:A,isGenerating:i,currentWeek:s,availableWeeks:m,maxAvailableWeek:p,canGenerateNextWeek:g,setCurrentWeek:L,getWeekDateRange:j,handleGenerateMealPlan:T,isWeekAvailable:d,weekDateRange:E}),e.jsx(Os,{hasInventory:N,isGenerating:i,generationProgress:n,loadingMessage:l,currentLoadingTitle:c,currentLoadingSubtitle:u,currentPlan:t,selectedInventory:B,handleGenerateAllRecipes:O,handleRegenerateWeek:pe,handleViewRecipe:_,generateDetailedRecipeForMeal:z,setCurrentWeek:L,generateAllDetailedRecipesForDay:Q,profileCompletion:b,featureGuidance:v,nudgeDismissed:I,setNudgeDismissed:V,currentWeek:s,weekDateRange:E,handleGenerateMealPlan:T,isWeekAvailable:d,handleSavePlanAsIs:$}),e.jsx(Us,{isGenerating:i,currentPlan:t,selectedInventory:B,currentWeek:s}),e.jsx(pt,{isOpen:w,onClose:()=>{H(!1),J(null)},recipe:D})]})},Vs=({onGenerate:t,hasAvailableMealPlans:s,onGenerateFromPlan:r,onScanFridge:a})=>{oe();const[i,n]=f.useState(!1),{profile:l}=Be(),c=ze(l),u=s?{text:"Générer une liste depuis un plan de repas",icon:o.ShoppingCart,action:r?()=>{y.info("User initiated shopping list generation from meal plan"),r()}:()=>{}}:{text:"Scanner mon frigo pour générer une liste",icon:o.Scan,action:a?()=>{y.info("User initiated fridge scan for shopping list"),a()}:()=>{}},m=s?{title:"Générez votre Liste de Courses",description:"Créez une liste de courses optimisée à partir de vos plans de repas existants ou scannez votre frigo pour une approche personnalisée."}:{title:"Votre Atelier de Courses",description:"Commencez par scanner votre frigo pour générer des listes de courses intelligentes basées sur vos ingrédients actuels."};return e.jsx(C,{className:"w-full",style:{background:"radial-gradient(circle at 20% 50%, rgba(251, 146, 60, 0.15) 0%, rgba(249, 115, 22, 0.1) 50%, rgba(234, 88, 12, 0.05) 100%)",borderColor:"rgba(251, 146, 60, 0.2)",boxShadow:"0 8px 32px rgba(251, 146, 60, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.1)"},children:e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"w-20 h-20 rounded-full flex items-center justify-center",style:{background:"radial-gradient(circle, rgba(251, 146, 60, 0.2) 0%, rgba(249, 115, 22, 0.15) 100%)",border:"2px solid rgba(251, 146, 60, 0.3)",boxShadow:"0 8px 24px rgba(251, 146, 60, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.1)"},children:e.jsx(x,{Icon:o.ShoppingCart,size:32,style:{color:"var(--color-plasma-orange)",filter:"drop-shadow(0 2px 4px rgba(251, 146, 60, 0.3))"}})})}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-3",children:m.title}),e.jsx("p",{className:"text-white/80 text-lg mb-8 max-w-2xl mx-auto",children:m.description}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 my-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",style:{background:"radial-gradient(circle, rgba(251, 146, 60, 0.15) 0%, rgba(249, 115, 22, 0.1) 100%)",border:"1px solid rgba(251, 146, 60, 0.2)",boxShadow:"0 4px 16px rgba(251, 146, 60, 0.15)"},children:e.jsx(x,{Icon:o.Zap,size:24,style:{color:"var(--color-plasma-orange)",filter:"drop-shadow(0 2px 4px rgba(251, 146, 60, 0.3))"}})}),e.jsx("h4",{className:"text-white font-semibold mb-2",children:"Génération Intelligente"}),e.jsx("h4",{className:"text-white font-semibold mb-2",children:"Génération par la Forge"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Mécanismes de la Forge pour des listes optimisées selon vos besoins nutritionnels."})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",style:{background:"radial-gradient(circle, rgba(251, 146, 60, 0.15) 0%, rgba(249, 115, 22, 0.1) 100%)",border:"1px solid rgba(251, 146, 60, 0.2)",boxShadow:"0 4px 16px rgba(251, 146, 60, 0.15)"},children:e.jsx(x,{Icon:o.Package,size:24,style:{color:"var(--color-plasma-orange)",filter:"drop-shadow(0 2px 4px rgba(251, 146, 60, 0.3))"}})}),e.jsx("h4",{className:"text-white font-semibold mb-2",children:"Optimisation Budget"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Suggestions d'alternatives économiques sans compromettre la qualité nutritionnelle."})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",style:{background:"radial-gradient(circle, rgba(251, 146, 60, 0.15) 0%, rgba(249, 115, 22, 0.1) 100%)",border:"1px solid rgba(251, 146, 60, 0.2)",boxShadow:"0 4px 16px rgba(251, 146, 60, 0.15)"},children:e.jsx(x,{Icon:o.Lightbulb,size:24,style:{color:"var(--color-plasma-orange)",filter:"drop-shadow(0 2px 4px rgba(251, 146, 60, 0.3))"}})}),e.jsx("h4",{className:"text-white font-semibold mb-2",children:"Conseils Personnalisés"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Recommandations adaptées à vos préférences alimentaires et contraintes."})]})]}),e.jsx("div",{className:"mb-8",children:e.jsxs("button",{onClick:u.action,className:"group relative px-8 py-4 rounded-2xl font-semibold text-lg transition-all duration-300 hover:scale-105",style:{background:"linear-gradient(135deg, rgba(251, 146, 60, 0.4) 0%, rgba(249, 115, 22, 0.35) 50%, rgba(234, 88, 12, 0.3) 100%)",border:"2px solid rgba(251, 146, 60, 0.4)",boxShadow:"0 12px 40px rgba(251, 146, 60, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.15), inset 0 -1px 0 rgba(0, 0, 0, 0.1)",color:"#FFFFFF",textShadow:"0 2px 4px rgba(0, 0, 0, 0.3)",backdropFilter:"blur(12px)",WebkitBackdropFilter:"blur(12px)"},children:[e.jsx("div",{className:"absolute inset-0 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300",style:{background:"linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 50%, transparent 70%)",animation:"shine 2s infinite"}}),e.jsxs("div",{className:"relative flex items-center justify-center gap-3",children:[e.jsx(x,{Icon:u.icon,size:24,style:{color:"#FFFFFF",filter:"drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3))"}}),e.jsx("span",{children:u.text})]})]})}),c&&!c.isSufficient&&!i&&e.jsx("div",{className:"mb-8",children:e.jsx(bt,{completion:c,variant:"banner",onDismiss:()=>n(!0),showDismiss:!0})}),e.jsx("div",{className:"mt-8 p-4 rounded-lg",style:{background:"rgba(251, 146, 60, 0.08)",border:"1px solid rgba(251, 146, 60, 0.15)"},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(x,{Icon:o.Lightbulb,size:20,style:{color:"var(--color-plasma-orange)",filter:"drop-shadow(0 2px 4px rgba(251, 146, 60, 0.3))"},className:"flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("h4",{className:"text-white font-medium mb-1",children:"Astuce TwinForge"}),e.jsx("p",{className:"text-white/70 text-sm",children:s?"Utilisez vos plans de repas existants pour générer des listes de courses optimisées, ou scannez votre frigo pour une approche basée sur vos ingrédients actuels.":"Commencez par scanner votre frigo pour identifier vos ingrédients disponibles et générer des listes de courses personnalisées."})]})]})})]})})},Y=(t,s,r)=>CSS.supports(t,s)?s:r,Hs=({currentLoadingTitle:t,currentLoadingSubtitle:s,simulatedProgressPercentage:r})=>e.jsx(C,{className:"border-orange-500/30",style:{background:`
          linear-gradient(135deg, rgba(251, 146, 60, 0.20) 0%, rgba(249, 115, 22, 0.12) 50%, rgba(234, 88, 12, 0.08) 100%)
        `,backdropFilter:"blur(20px) saturate(180%)",border:`1px solid ${Y("color","color-mix(in srgb, #fb923c 40%, transparent)","rgba(251, 146, 60, 0.4)")}`,boxShadow:`
          0 12px 40px rgba(0, 0, 0, 0.5),
          0 6px 20px rgba(251, 146, 60, 0.3),
          0 2px 8px rgba(251, 146, 60, 0.4),
          inset 0 1px 0 rgba(255, 255, 255, 0.1),
          inset 0 -1px 0 rgba(0, 0, 0, 0.3)
        `},children:e.jsxs("div",{className:"p-2 text-center space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 w-24 h-24 mx-auto rounded-full bg-gradient-to-br from-orange-400/50 to-orange-600/30 blur-xl"}),e.jsxs(h.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"relative w-16 h-16 mx-auto rounded-full flex items-center justify-center shadow-2xl",style:{background:`
                radial-gradient(circle at 30% 30%, rgba(251, 146, 60, 0.6) 0%, rgba(249, 115, 22, 0.4) 40%, rgba(234, 88, 12, 0.2) 100%)
              `,border:`1px solid ${Y("color","color-mix(in srgb, #fb923c 60%, transparent)","rgba(251, 146, 60, 0.6)")}`,boxShadow:`
                0 8px 32px rgba(0, 0, 0, 0.4),
                0 4px 16px rgba(251, 146, 60, 0.4),
                0 2px 8px rgba(251, 146, 60, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.2),
                inset 0 -1px 0 rgba(0, 0, 0, 0.2)
              `},children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-orange-300/30 to-transparent blur-sm"}),e.jsx(x,{Icon:o.ShoppingCart,size:32,className:"relative text-orange-100 drop-shadow-2xl"})]}),e.jsx(h.div,{animate:{scale:[1,1.2,1],opacity:[.5,0,.5]},transition:{duration:2,repeat:1/0},className:"absolute inset-0 w-20 h-20 mx-auto rounded-full border-2 border-orange-500/50"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-2xl font-bold bg-gradient-to-r from-orange-200 to-orange-100 bg-clip-text text-transparent drop-shadow-sm",children:t||"TwinForge génère votre liste..."}),e.jsx("p",{className:"text-white/70 text-sm",children:s||"Intelligence artificielle en action pour vos courses parfaites"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"w-full bg-white/10 rounded-full h-2 overflow-hidden",children:e.jsx(h.div,{className:"h-full bg-gradient-to-r from-orange-400 to-orange-500 rounded-full shadow-lg",initial:{width:0},animate:{width:`${r}%`},transition:{duration:.5,ease:"easeOut"}})}),e.jsxs("span",{className:"text-orange-200 text-sm font-semibold",children:[Math.round(r),"%"]})]})]})}),$e=[{step:1,title:"Analyse nutritionnelle",progress:15,icon:"User"},{step:2,title:"Vérification inventaire",progress:30,icon:"Package"},{step:3,title:"Extraction des recettes",progress:45,icon:"Utensils"},{step:4,title:"Génération intelligente",progress:70,icon:"ShoppingCart"},{step:5,title:"Optimisation IA",progress:85,icon:"Zap"},{step:6,title:"Finalisation",progress:100,icon:"Check"}],Ws=({simulatedProgressPercentage:t})=>e.jsx(C,{className:"border-white/20",style:{background:`
          linear-gradient(135deg, rgba(255, 255, 255, 0.12) 0%, rgba(255, 255, 255, 0.06) 50%, rgba(255, 255, 255, 0.03) 100%)
        `,backdropFilter:"blur(20px) saturate(180%)",border:`1px solid ${Y("color","color-mix(in srgb, white 25%, transparent)","rgba(255, 255, 255, 0.25)")}`,boxShadow:`
          0 12px 40px rgba(0, 0, 0, 0.5),
          0 6px 20px rgba(255, 255, 255, 0.15),
          0 2px 8px rgba(255, 255, 255, 0.2),
          inset 0 1px 0 rgba(255, 255, 255, 0.1),
          inset 0 -1px 0 rgba(0, 0, 0, 0.3)
        `},children:e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-white/20 to-white/10 blur-sm"}),e.jsxs("div",{className:"relative p-2 rounded-full",style:{background:"rgba(255, 255, 255, 0.15)",border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:`
                  0 2px 8px rgba(0, 0, 0, 0.2),
                  inset 0 1px 0 rgba(255, 255, 255, 0.2)
                `},children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-white/20 to-transparent blur-sm"}),e.jsx(x,{Icon:o.Clock,className:"relative w-5 h-5 text-white/70 drop-shadow-lg"})]})]}),e.jsx("span",{className:"text-white/80 text-sm font-medium",children:"Étapes de génération TwinForge"})]}),e.jsx("div",{className:"space-y-3",children:$e.map((s,r)=>{s.step/$e.length*100;const a=Math.floor(t/100*$e.length),i=r===a,n=r<a;return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[i&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-orange-400/40 to-orange-600/20 blur-md"}),e.jsxs("div",{className:"relative w-10 h-10 rounded-full flex items-center justify-center text-xs font-medium transition-all duration-500",style:n?{background:`
                              radial-gradient(circle at 30% 30%, rgba(251, 146, 60, 0.5) 0%, rgba(249, 115, 22, 0.3) 40%, rgba(234, 88, 12, 0.15) 100%)
                            `,border:`1px solid ${Y("color","color-mix(in srgb, #fb923c 60%, transparent)","rgba(251, 146, 60, 0.6)")}`,color:"rgba(251, 146, 60, 0.9)",boxShadow:`
                              0 2px 8px rgba(0, 0, 0, 0.3),
                              0 1px 4px rgba(251, 146, 60, 0.4),
                              inset 0 1px 0 rgba(255, 255, 255, 0.15)
                            `}:i?{background:`
                              radial-gradient(circle at 30% 30%, rgba(251, 146, 60, 0.3) 0%, rgba(249, 115, 22, 0.2) 40%, rgba(234, 88, 12, 0.1) 100%)
                            `,border:`1px solid ${Y("color","color-mix(in srgb, #fb923c 40%, transparent)","rgba(251, 146, 60, 0.4)")}`,color:"rgba(251, 146, 60, 0.8)",boxShadow:`
                              0 2px 8px rgba(0, 0, 0, 0.2),
                              inset 0 1px 0 rgba(255, 255, 255, 0.1)
                            `}:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",color:"rgba(255, 255, 255, 0.5)"},children:[i&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-orange-300/20 to-transparent blur-sm"}),n?e.jsx(x,{Icon:o.Check,size:20,className:"relative drop-shadow-lg"}):e.jsx(x,{Icon:o[s.icon],size:20,className:"relative drop-shadow-lg"})]})]}),e.jsx("span",{className:`text-base ${i?"text-white font-medium":"text-white/50"}`,children:s.title})]},s.step)})})]})}),Ys=()=>{const{isGenerating:t,simulatedProgressPercentage:s,currentLoadingTitle:r,currentLoadingSubtitle:a,startSimulatedProgress:i,stopSimulatedProgress:n}=Re();return he.useEffect(()=>(t&&i(),()=>{t||n()}),[t,i,n]),f.useEffect(()=>(i(),()=>{n()}),[i,n]),e.jsxs("div",{className:"space-y-6",children:[e.jsx(Hs,{currentLoadingTitle:r,currentLoadingSubtitle:a,simulatedProgressPercentage:s}),e.jsx(Ws,{simulatedProgressPercentage:s})]})},Js=({shoppingList:t,completedCount:s,totalCount:r,progressPercentage:a,onReset:i})=>e.jsx(C,{className:"border-cyan-500/30 p-1",style:{background:`
          radial-gradient(circle at 30% 20%, rgba(6, 182, 212, 0.15) 0%, transparent 60%),
          radial-gradient(circle at 70% 80%, rgba(8, 145, 178, 0.10) 0%, transparent 50%),
          linear-gradient(135deg, rgba(6, 182, 212, 0.12) 0%, rgba(8, 145, 178, 0.08) 50%, rgba(14, 116, 144, 0.06) 100%)
        `,backdropFilter:"blur(24px) saturate(180%)",border:`1px solid ${Y("color","color-mix(in srgb, #06b6d4 35%, transparent)","rgba(6, 182, 212, 0.35)")}`,boxShadow:`
          0 12px 40px rgba(0, 0, 0, 0.4),
          0 6px 20px rgba(6, 182, 212, 0.20),
          0 2px 8px rgba(6, 182, 212, 0.25),
          inset 0 2px 0 rgba(255, 255, 255, 0.15),
          inset 0 -1px 0 rgba(0, 0, 0, 0.2)
        `},children:e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-cyan-400/40 to-cyan-600/25 blur-2xl"}),e.jsxs("div",{className:"relative w-16 h-16 rounded-full flex items-center justify-center shadow-2xl breathing-icon",style:{background:`
                    radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                    radial-gradient(circle at 70% 70%, rgba(6, 182, 212, 0.4) 0%, rgba(8, 145, 178, 0.3) 50%, rgba(14, 116, 144, 0.2) 100%)
                  `,border:`2px solid ${Y("color","color-mix(in srgb, #06b6d4 50%, transparent)","rgba(6, 182, 212, 0.5)")}`,boxShadow:`
                    0 8px 32px rgba(0, 0, 0, 0.3),
                    0 4px 16px rgba(6, 182, 212, 0.3),
                    0 2px 8px rgba(6, 182, 212, 0.4),
                    0 0 40px rgba(6, 182, 212, 0.25),
                    inset 0 2px 0 rgba(255, 255, 255, 0.25),
                    inset 0 -1px 0 rgba(0, 0, 0, 0.15)
                  `},children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-cyan-300/20 to-transparent blur-sm"}),e.jsx(x,{Icon:o.ShoppingCart,size:32,className:"relative text-cyan-100 drop-shadow-2xl"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold bg-gradient-to-r from-cyan-200 to-cyan-100 bg-clip-text text-transparent drop-shadow-sm",children:t.name}),e.jsx("p",{className:"text-white/70 text-sm",children:t.generationMode==="user_and_family"?"Liste familiale":"Liste personnelle"})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-cyan-200/70 font-medium",children:"Progression des courses"}),e.jsxs("span",{className:"text-cyan-200 font-semibold",children:[s,"/",r," articles"]})]}),e.jsx("div",{className:"w-full bg-white/10 rounded-full h-2 overflow-hidden",children:e.jsx(h.div,{className:"h-full rounded-full shadow-lg",style:{background:"linear-gradient(90deg, rgba(16, 185, 129, 0.9) 0%, rgba(5, 150, 105, 0.95) 100%)"},initial:{width:0},animate:{width:`${a}%`},transition:{duration:.5}})})]}),e.jsx("button",{onClick:i,className:"w-full mt-4 px-4 py-2 rounded-lg text-sm font-medium transition-all duration-300 btn-glass",style:{background:`
              linear-gradient(135deg,
                color-mix(in srgb, #06b6d4 80%, transparent),
                color-mix(in srgb, #0891b2 75%, transparent)
              )
            `,border:`2px solid ${Y("color","color-mix(in srgb, #06b6d4 60%, transparent)","rgba(6, 182, 212, 0.6)")}`,boxShadow:`
              0 8px 32px color-mix(in srgb, #06b6d4 35%, transparent),
              0 0 40px color-mix(in srgb, #06b6d4 25%, transparent),
              inset 0 2px 0 rgba(255, 255, 255, 0.3),
              inset 0 -2px 0 rgba(0, 0, 0, 0.2)
            `,backdropFilter:"blur(20px) saturate(160%)",color:"white"},children:"Nouvelle liste"})]})}),Ks=({budgetEstimation:t})=>!t||!t.estimated_cost||t.estimated_cost==="Non estimé"?null:e.jsx(C,{className:"border-slate-400/30 p-1 mb-4",style:{background:`
          linear-gradient(135deg, 
            rgba(148, 163, 184, 0.15) 0%, 
            rgba(100, 116, 139, 0.12) 25%,
            rgba(71, 85, 105, 0.08) 50%,
            rgba(51, 65, 85, 0.06) 75%,
            rgba(30, 41, 59, 0.04) 100%
          )
        `,backdropFilter:"blur(24px) saturate(200%)",border:`1px solid ${Y("color","color-mix(in srgb, #94a3b8 30%, transparent)","rgba(148, 163, 184, 0.3)")}`,boxShadow:`
          0 16px 48px rgba(0, 0, 0, 0.4),
          0 8px 24px rgba(148, 163, 184, 0.15),
          0 4px 12px rgba(148, 163, 184, 0.2),
          0 2px 6px rgba(148, 163, 184, 0.25),
          inset 0 1px 0 rgba(255, 255, 255, 0.15),
          inset 0 -1px 0 rgba(0, 0, 0, 0.2),
          inset 1px 0 0 rgba(255, 255, 255, 0.08),
          inset -1px 0 0 rgba(0, 0, 0, 0.08)
        `},children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-slate-300/40 to-slate-500/20 blur-xl"}),e.jsxs("div",{className:"relative w-12 h-12 rounded-full flex items-center justify-center shadow-2xl",style:{background:`
                  radial-gradient(circle at 30% 30%, 
                    rgba(148, 163, 184, 0.4) 0%, 
                    rgba(100, 116, 139, 0.3) 40%, 
                    rgba(71, 85, 105, 0.2) 70%,
                    rgba(51, 65, 85, 0.1) 100%
                  )
                `,border:`1px solid ${Y("color","color-mix(in srgb, #94a3b8 50%, transparent)","rgba(148, 163, 184, 0.5)")}`,boxShadow:`
                  0 8px 32px rgba(0, 0, 0, 0.3),
                  0 4px 16px rgba(148, 163, 184, 0.2),
                  0 2px 8px rgba(148, 163, 184, 0.3),
                  inset 0 1px 0 rgba(255, 255, 255, 0.25),
                  inset 0 -1px 0 rgba(0, 0, 0, 0.15)
                `},children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-slate-200/20 to-transparent blur-sm"}),e.jsx(x,{Icon:o.DollarSign,size:24,className:"relative text-slate-200 drop-shadow-lg"})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-lg font-semibold bg-gradient-to-r from-slate-200 to-slate-300 bg-clip-text text-transparent drop-shadow-sm",children:"Budget estimé"}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-2xl font-bold text-slate-100 drop-shadow-lg",children:t.estimated_cost}),t.confidence_level&&e.jsx("span",{className:"text-xs text-slate-300/80 font-medium",children:t.confidence_level})]})]})]}),t.notes&&t.notes.length>0&&e.jsx("div",{className:"mt-3 p-3 rounded-lg",style:{background:`
                linear-gradient(135deg, 
                  rgba(148, 163, 184, 0.08) 0%, 
                  rgba(100, 116, 139, 0.06) 50%,
                  rgba(71, 85, 105, 0.04) 100%
                )
              `,border:`1px solid ${Y("color","color-mix(in srgb, #94a3b8 20%, transparent)","rgba(148, 163, 184, 0.2)")}`,boxShadow:`
                inset 0 1px 0 rgba(255, 255, 255, 0.1),
                inset 0 -1px 0 rgba(0, 0, 0, 0.1)
              `},children:e.jsx("div",{className:"space-y-1",children:t.notes.map((s,r)=>e.jsxs("div",{className:"flex items-start gap-2 text-xs text-slate-300/90",children:[e.jsx("div",{className:"w-1 h-1 rounded-full mt-1.5 flex-shrink-0",style:{background:"linear-gradient(45deg, rgba(148, 163, 184, 0.6), rgba(100, 116, 139, 0.4))",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.2)"}}),e.jsx("span",{children:s})]},r))})})]})}),Qs=({suggestions:t})=>!t||t.length===0?null:e.jsxs(C,{className:"border-blue-500/30 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-500/20 flex items-center justify-center",children:e.jsx(x,{Icon:o.Lightbulb,size:20,className:"text-blue-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Suggestions Complémentaires"})]}),e.jsx("div",{className:"space-y-2",children:t.map((s,r)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-white/5",children:[e.jsx(x,{Icon:o.Plus,size:16,className:"text-blue-400 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-white font-medium",children:s.name}),s.reason&&e.jsx("p",{className:"text-white/70 text-sm",children:s.reason})]}),s.estimatedPrice&&e.jsxs("span",{className:"text-blue-400 font-medium",children:[s.estimatedPrice,"€"]})]},r))})]}),Zs=({advice:t})=>!t||t.length===0?null:e.jsxs(C,{className:"border-green-500/30 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500/20 flex items-center justify-center",children:e.jsx(x,{Icon:o.CheckCircle,size:20,className:"text-green-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Conseils Personnalisés"})]}),e.jsx("div",{className:"space-y-3",children:t.map((s,r)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-white/5",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-400 flex-shrink-0 mt-2"}),e.jsx("p",{className:"text-white/90 text-sm leading-relaxed",children:s})]},r))})]}),Xs=({item:t,itemKey:s,isChecked:r,onToggle:a,index:i})=>(y.debug("ShoppingListItem rendering",{itemName:t.name,itemKey:s,isChecked:r,quantity:t.quantity}),e.jsxs(h.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:i*.05},whileHover:{scale:1.01},whileTap:{scale:.99},className:`flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-all duration-300 ${r?"bg-green-500/20 border border-green-500/40 shadow-lg":"bg-white/5 hover:bg-white/10 border border-white/10 hover:border-white/20"}`,onClick:()=>a(s),children:[e.jsxs("div",{className:"relative",children:[r&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-green-400/40 to-green-600/20 blur-md"}),e.jsx("div",{className:"relative w-6 h-6 rounded border-2 flex items-center justify-center transition-all duration-300",style:r?{background:`
              linear-gradient(135deg, rgba(34, 197, 94, 0.8) 0%, rgba(22, 163, 74, 0.6) 50%, rgba(21, 128, 61, 0.4) 100%)
            `,border:`2px solid ${Y("color","color-mix(in srgb, #22c55e 80%, transparent)","rgba(34, 197, 94, 0.8)")}`,boxShadow:`
              0 4px 12px rgba(0, 0, 0, 0.3),
              0 2px 6px rgba(34, 197, 94, 0.5),
              inset 0 1px 0 rgba(255, 255, 255, 0.2),
              inset 0 -1px 0 rgba(0, 0, 0, 0.1)
            `}:{border:"2px solid rgba(255, 255, 255, 0.4)",background:"rgba(255, 255, 255, 0.08)",boxShadow:`
              0 2px 4px rgba(0, 0, 0, 0.2),
              inset 0 1px 0 rgba(255, 255, 255, 0.1)
            `},children:e.jsx(le,{children:r&&e.jsxs(h.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},transition:{duration:.2},children:[e.jsx("div",{className:"absolute inset-0 rounded bg-gradient-to-br from-green-300/20 to-transparent blur-sm"}),e.jsx(x,{Icon:o.Check,className:"relative w-4 h-4 text-white drop-shadow-lg"})]})})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("span",{className:`font-medium text-base transition-all duration-300 ${r?"text-white/60 line-through":"text-white"}`,children:t.name})}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-white/70 text-sm font-medium",children:t.quantity}),t.notes&&e.jsxs("span",{className:"text-white/50 text-xs",children:["• ",t.notes]})]})]})]})),er=({category:t,checkedItems:s,onToggleItem:r,index:a})=>(y.debug("ShoppingListCategory rendering",{categoryName:t.category,itemsCount:t.items?.length||0,checkedItemsCount:s.size}),!t.items||t.items.length===0?(y.warn("ShoppingListCategory received empty items array",{category:t.category}),null):e.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:a*.1},className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-xl font-bold text-white flex items-center drop-shadow-lg mb-3",children:[e.jsx("span",{className:"w-2 h-2 bg-orange-400 rounded-full mr-3"}),t.category]}),e.jsxs("span",{className:"text-sm text-white/70 font-medium",children:[t.items.length," article",t.items.length>1?"s":""]})]}),e.jsx("div",{className:"space-y-2",children:t.items.map((i,n)=>{const l=`${t.category}-${i.name}`;return e.jsx(Xs,{item:i,itemKey:l,isChecked:s.has(l),onToggle:r,index:n},l)})})]})),tr=({shoppingList:t})=>{const s=()=>{y.info("PDF export requested",{shoppingListId:t.id});const a={name:t.name,totalItems:t.totalItems,categories:t.categories?.map(i=>({name:i.name,items:i.items.map(n=>`${n.name} - ${n.quantity}`)}))};y.debug("Formatted shopping list for PDF export",a),typeof window<"u"&&window.alert&&window.alert("Génération PDF en cours de développement. Cette fonctionnalité sera bientôt disponible !")},r=async()=>{y.info("Text export requested",{shoppingListId:t.id});let a=`${t.name}
`;a+=`${"=".repeat(t.name.length)}

`,t.categories?.forEach(i=>{a+=`${i.name}:
`,i.items.forEach(n=>{a+=`  • ${n.name} - ${n.quantity}`,n.notes&&(a+=` (${n.notes})`),a+=`
`}),a+=`
`}),a+=`Total: ${t.totalItems} articles
`;try{typeof navigator<"u"&&navigator.clipboard?(await navigator.clipboard.writeText(a),y.info("Shopping list copied to clipboard successfully"),typeof window<"u"&&window.alert&&window.alert("Liste de courses copiée dans le presse-papiers !")):(y.warn("Clipboard API not available, using fallback"),typeof window<"u"&&window.alert&&window.alert(`Votre navigateur ne supporte pas la copie automatique. Voici votre liste:

`+a))}catch(i){y.error("Failed to copy to clipboard",i),typeof window<"u"&&window.alert&&window.alert(`Erreur lors de la copie. Voici votre liste:

`+a)}};return e.jsx(C,{className:"border-white/20 p-1",style:{background:`
          linear-gradient(135deg, rgba(255, 255, 255, 0.12) 0%, rgba(255, 255, 255, 0.06) 50%, rgba(255, 255, 255, 0.03) 100%)
        `,backdropFilter:"blur(20px) saturate(180%)",border:`1px solid ${Y("color","color-mix(in srgb, white 25%, transparent)","rgba(255, 255, 255, 0.25)")}`,boxShadow:`
          0 12px 40px rgba(0, 0, 0, 0.5),
          0 6px 20px rgba(255, 255, 255, 0.15),
          0 2px 8px rgba(255, 255, 255, 0.2),
          inset 0 1px 0 rgba(255, 255, 255, 0.1),
          inset 0 -1px 0 rgba(0, 0, 0, 0.3)
        `},children:e.jsx("div",{className:"p-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-white/20 to-white/10 blur-sm"}),e.jsx("div",{className:"relative w-10 h-10 rounded-full flex items-center justify-center",style:{background:"rgba(255, 255, 255, 0.15)",border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:`
                    0 2px 8px rgba(0, 0, 0, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2)
                  `},children:e.jsx(x,{Icon:o.Download,size:20,className:"relative text-white/70 drop-shadow-lg"})})]}),e.jsx("span",{className:"text-white/80 text-base font-medium",children:"Exporter votre liste"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:s,className:"px-2 py-1 bg-white/10 hover:bg-orange-500/20 rounded-lg text-white/70 hover:text-orange-200 transition-all duration-300 text-xs border border-white/20 hover:border-orange-400/30",children:"PDF"}),e.jsx(h.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:r,className:"px-2 py-1 bg-white/10 hover:bg-orange-500/20 rounded-lg text-white/70 hover:text-orange-200 transition-all duration-300 text-xs border border-white/20 hover:border-orange-400/30",children:"Texte"})]})]})})})},sr=()=>{const{shoppingList:t,suggestions:s,advice:r,budgetEstimation:a,reset:i}=Re(),[n,l]=f.useState(new Set);if(he.useEffect(()=>{y.debug("SHOPPING_LIST_DISPLAY","Current state",{shoppingListCount:t?.categories?.length||0,suggestionsCount:s.length,adviceCount:r.length,hasBudget:!!a}),t&&(y.debug("SHOPPING_LIST_DISPLAY","Shopping list details",{id:t.id,name:t.name,totalItems:t.totalItems,categoriesCount:t.categories?.length||0,categories:t.categories?.map(d=>({id:d.id,name:d.name,itemsCount:d.items?.length||0,items:d.items?.map(b=>({id:b.id,name:b.name,quantity:b.quantity}))||[]}))||[]}),t.categories?.forEach((d,b)=>{y.debug("SHOPPING_LIST_DISPLAY",`Category ${b+1}: ${d.name}`,{categoryId:d.id,itemsCount:d.items?.length||0,items:d.items?.map(v=>`${v.name} (${v.quantity})`)||[]})}))},[t,s,r,a]),!t)return y.debug("SHOPPING_LIST_DISPLAY","No shopping list available"),null;const c=d=>{const b=new Set(n);b.has(d)?b.delete(d):b.add(d),l(b),new Set(n).size,y.debug("SHOPPING_LIST_DISPLAY","Item toggled",{itemId:d,isChecked:b.has(d),totalChecked:b.size})},u=t.totalItems||0,m=n.size,p=u>0?m/u*100:0;return y.debug("SHOPPING_LIST_DISPLAY","Rendering shopping list",{totalCount:u,completedCount:m,progressPercentage:p,categoriesCount:t.categories?.length||0}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(Js,{shoppingList:t,totalCount:u,completedCount:m,progressPercentage:p,onReset:i}),e.jsx(Ks,{budgetEstimation:a}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.categories?.map((d,b)=>(y.debug("SHOPPING_LIST_DISPLAY",`Rendering category ${b+1}`,{categoryId:d.id,categoryName:d.name,itemsCount:d.items?.length||0}),e.jsx(er,{category:d,checkedItems:n,onToggleItem:c,index:b},d.id)))}),e.jsx(Qs,{suggestions:s}),e.jsx(Zs,{advice:r}),e.jsx(tr,{shoppingList:t})]})},at=()=>{const{generationMode:t,selectedMealPlanId:s,setGenerationMode:r,setSelectedMealPlanId:a,generateShoppingList:i}=Re(),{allMealPlans:n,loadAllMealPlans:l}=ke(),[c,u]=f.useState(!1);f.useEffect(()=>{l()},[l]);const m=(n||[]).map(d=>({value:d.id,label:`Plan du ${new Date(d.createdAt).toLocaleDateString()}`})),p=async()=>{if(!c){y.debug("SHOPPING_LIST_GENERATOR","Starting generation",{generationMode:t,selectedMealPlanId:s}),u(!0);try{await i({generationMode:t,selectedMealPlanId:s})}catch(d){y.error("SHOPPING_LIST_GENERATOR","Generation failed",{error:d})}finally{u(!1)}y.info("User initiated shopping list generation",{selectedMealPlanId:s,generationMode:t})}};return e.jsx(C,{className:"p-6",style:{background:`
          radial-gradient(circle at 30% 20%, rgba(251, 146, 60, 0.25) 0%, transparent 50%),
          linear-gradient(135deg, rgba(251, 146, 60, 0.20) 0%, rgba(249, 115, 22, 0.12) 50%, rgba(234, 88, 12, 0.08) 100%)
        `,backdropFilter:"blur(20px) saturate(180%)",border:`1px solid ${CSS.supports("color","color-mix(in srgb, #fb923c 40%, transparent)")?"color-mix(in srgb, #fb923c 40%, transparent)":"rgba(251, 146, 60, 0.4)"}`,boxShadow:`
          0 12px 40px rgba(0, 0, 0, 0.5),
          0 6px 20px rgba(251, 146, 60, 0.3),
          0 2px 8px rgba(251, 146, 60, 0.4),
          inset 0 1px 0 rgba(255, 255, 255, 0.1),
          inset 0 -1px 0 rgba(0, 0, 0, 0.3)
        `},children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-orange-400/50 to-orange-600/30 blur-xl"}),e.jsxs("div",{className:"relative w-16 h-16 rounded-full flex items-center justify-center shadow-2xl",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(251, 146, 60, 0.6) 0%, rgba(249, 115, 22, 0.4) 40%, rgba(234, 88, 12, 0.2) 100%)
                `,border:`1px solid ${CSS.supports("color","color-mix(in srgb, #fb923c 60%, transparent)")?"color-mix(in srgb, #fb923c 60%, transparent)":"rgba(251, 146, 60, 0.6)"}`,boxShadow:`
                  0 8px 32px rgba(0, 0, 0, 0.4),
                  0 4px 16px rgba(251, 146, 60, 0.4),
                  0 2px 8px rgba(251, 146, 60, 0.6),
                  inset 0 1px 0 rgba(255, 255, 255, 0.2),
                  inset 0 -1px 0 rgba(0, 0, 0, 0.2)
                `},children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-orange-300/30 to-transparent blur-sm"}),e.jsx(o.ShoppingCart,{size:32,className:"relative text-orange-100 drop-shadow-lg"})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Générateur de Liste de Courses"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Créez des listes de courses optimisées pour vos repas"})]})]}),e.jsx("div",{className:"space-y-3",children:e.jsx(De,{options:m,value:s||"",onChange:d=>a(d),placeholder:"Choisir un plan de repas",className:"w-full",disabled:c})}),e.jsx("div",{className:"border-t border-white/10 mt-4 pt-4"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:()=>r("user_only"),className:`flex-1 p-4 rounded-xl border transition-all duration-500 ${t==="user_only"?"border-orange-400/50 bg-gradient-to-br from-orange-500/25 to-orange-600/15 text-orange-300 shadow-2xl":"border-white/20 bg-white/5 text-white/60 hover:border-orange-400/30 hover:bg-orange-500/10"}`,children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[t==="user_only"&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-orange-400/40 to-orange-600/20 blur-md"}),e.jsxs("div",{className:"relative w-10 h-10 rounded-full flex items-center justify-center",style:t==="user_only"?{background:`
                      radial-gradient(circle at 30% 30%, rgba(251, 146, 60, 0.5) 0%, rgba(249, 115, 22, 0.3) 40%, rgba(234, 88, 12, 0.15) 100%)
                    `,border:`1px solid ${CSS.supports("color","color-mix(in srgb, #fb923c 50%, transparent)")?"color-mix(in srgb, #fb923c 50%, transparent)":"rgba(251, 146, 60, 0.5)"}`,boxShadow:`
                      0 4px 16px rgba(0, 0, 0, 0.3),
                      0 2px 8px rgba(251, 146, 60, 0.3),
                      inset 0 1px 0 rgba(255, 255, 255, 0.15),
                      inset 0 -1px 0 rgba(0, 0, 0, 0.15)
                    `}:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)"},children:[t==="user_only"&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-orange-300/20 to-transparent blur-sm"}),e.jsx(o.User,{size:20,className:"relative drop-shadow-lg"})]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-base",children:"Courses Personnelles"}),e.jsx("div",{className:"text-sm opacity-75",children:"Liste personnelle"})]})]})}),e.jsx("button",{onClick:()=>r("user_and_family"),className:`flex-1 p-4 rounded-xl border transition-all duration-500 ${t==="user_and_family"?"border-orange-400/50 bg-gradient-to-br from-orange-500/25 to-orange-600/15 text-orange-300 shadow-2xl":"border-white/20 bg-white/5 text-white/60 hover:border-orange-400/30 hover:bg-orange-500/10"}`,children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[t==="user_and_family"&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-orange-400/40 to-orange-600/20 blur-md"}),e.jsxs("div",{className:"relative w-10 h-10 rounded-full flex items-center justify-center",style:t==="user_and_family"?{background:`
                      radial-gradient(circle at 30% 30%, rgba(251, 146, 60, 0.5) 0%, rgba(249, 115, 22, 0.3) 40%, rgba(234, 88, 12, 0.15) 100%)
                    `,border:`1px solid ${CSS.supports("color","color-mix(in srgb, #fb923c 50%, transparent)")?"color-mix(in srgb, #fb923c 50%, transparent)":"rgba(251, 146, 60, 0.5)"}`,boxShadow:`
                      0 4px 16px rgba(0, 0, 0, 0.3),
                      0 2px 8px rgba(251, 146, 60, 0.3),
                      inset 0 1px 0 rgba(255, 255, 255, 0.15),
                      inset 0 -1px 0 rgba(0, 0, 0, 0.15)
                    `}:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)"},children:[t==="user_and_family"&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-orange-300/20 to-transparent blur-sm"}),e.jsx(o.Users,{size:20,className:"relative drop-shadow-lg"})]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-base",children:"Courses Familiales"}),e.jsx("div",{className:"text-sm opacity-75",children:"Liste pour tous"})]})]})})]}),e.jsxs("button",{onClick:p,disabled:!s||c,className:"w-full px-8 py-4 text-lg font-bold text-white rounded-xl disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-500 flex items-center justify-center gap-3 transform hover:scale-[1.02] active:scale-[0.98]",style:{background:`
              linear-gradient(135deg, rgba(251, 146, 60, 0.9) 0%, rgba(249, 115, 22, 0.95) 50%, rgba(234, 88, 12, 1) 100%)
            `,border:`1px solid ${CSS.supports("color","color-mix(in srgb, #fb923c 70%, transparent)")?"color-mix(in srgb, #fb923c 70%, transparent)":"rgba(251, 146, 60, 0.7)"}`,boxShadow:`
              0 12px 40px rgba(0, 0, 0, 0.4),
              0 6px 20px rgba(251, 146, 60, 0.4),
              0 3px 10px rgba(251, 146, 60, 0.6),
              inset 0 1px 0 rgba(255, 255, 255, 0.2),
              inset 0 -2px 0 rgba(0, 0, 0, 0.2)
            `},children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-white/40 to-white/20 blur-sm"}),e.jsxs("div",{className:"relative p-1 rounded-full",style:{background:"rgba(255, 255, 255, 0.25)",border:"1px solid rgba(255, 255, 255, 0.4)",boxShadow:`
                  0 2px 8px rgba(0, 0, 0, 0.2),
                  inset 0 1px 0 rgba(255, 255, 255, 0.3)
                `},children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-white/20 to-transparent blur-sm"}),e.jsx(o.Sparkles,{className:"relative w-4 h-4 text-white drop-shadow-lg"})]})]}),e.jsx("span",{className:"drop-shadow-sm",children:"Générer ma liste de courses"})]})]})})},wr=()=>{oe();const{isGenerating:t,shoppingList:s,error:r,reset:a,generateShoppingList:i}=Re(),{allMealPlans:n,loadAllMealPlans:l}=ke(),{startScan:c}=ye();he.useEffect(()=>{l()},[l]),he.useEffect(()=>(y.debug("SHOPPING_LIST_TAB","Component mounted",{isGenerating:t,hasShoppingList:!!s,hasError:!!r,allMealPlansCount:n.length}),()=>{y.debug("SHOPPING_LIST_TAB","Component unmounting")}),[t,s,r,n.length]);const u=n.length>0,m=s&&s.totalItems>0,p=()=>{y.info("SHOPPING_LIST_TAB","User initiated generation from meal plan")},d=()=>t?e.jsx(Ys,{}):m?e.jsxs("div",{className:"space-y-6",children:[e.jsx(sr,{}),e.jsx(at,{})]}):u?e.jsx(at,{}):e.jsx(Vs,{hasAvailableMealPlans:u,onGenerateFromPlan:p});return e.jsxs("div",{className:"space-y-6 w-full",children:[e.jsx(le,{children:r&&e.jsx(h.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"w-full",children:e.jsx(C,{className:"border-red-500/20 bg-red-500/5",children:e.jsxs("div",{className:"flex items-center gap-3 p-4",children:[e.jsx(x,{name:"AlertTriangle",size:20,className:"text-red-400 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-red-400 font-medium",children:"Erreur de génération"}),e.jsx("p",{className:"text-red-300/80 text-sm mt-1",children:r})]}),e.jsx("button",{onClick:a,className:"text-red-400 hover:text-red-300 transition-colors",children:e.jsx(x,{name:"X",size:16})})]})})})}),e.jsx(le,{mode:"wait",children:e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"w-full",children:d()},t?"generating":s?"display":"generator")})]})};export{vr as F,se as H,jr as P,yr as R,fr as S,gr as a,mr as b,ze as c,br as d,wr as e,xr as f,ee as g,ur as h,hr as i,cr as j,y as l,dr as p,U as s,pr as t,K as u};
