var _e=Object.defineProperty;var He=(a,t,r)=>t in a?_e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r;var U=(a,t,r)=>He(a,typeof t!="symbol"?t+"":t,r);import{R as T,r as N,j as e,h as We,B as qe,A as Ue,D as Ve,i as Ge,S as Je,W as Ke,F as Xe,k as ge,l as Ze,H as Ye,T as Qe,m as et,L as tt,G as at,n as be,o as rt,Z as fe,p as st,q as it,t as nt,v as ot,w as lt,x as ct,C as dt,N as pt,M as xt,y as ut,z as mt,E as ht,I as gt,J as bt,K as ft,O as yt,P as vt,Q as wt,U as jt,V as Nt,Y as Ct,_ as St,$ as kt,a0 as It,a1 as Tt,a2 as Et,a3 as At,a4 as Ft,a5 as $t,a6 as Mt,a7 as Rt,a8 as Bt,a9 as Ot,aa as Pt,ab as Dt,ac as Lt,ad as zt,ae as ye,af as _t,ag as Ht,ah as Wt,ai as qt,aj as Ut,ak as Vt,al as Gt,am as Jt,an as Kt,ao as Xt,ap as Zt,aq as Yt,ar as Qt,as as ea,at as ta,au as aa,av as ra,aw as sa,ax as ia,ay as na,az as oa,aA as la,aB as ca,aC as da,aD as pa,aE as xa,aF as ua,aG as ma,aH as ha,aI as ga,aJ as ba,aK as fa,aL as ya,aM as va,aN as wa,aO as ja,aP as Na,aQ as Ca,aR as Sa,aS as ka,aT as Ia,aU as ve,aV as Ta,aW as Ea,aX as Aa,aY as Fa,aZ as $a,a_ as Ma,a$ as Ra,b0 as Ba,b1 as Oa,b2 as Pa,b3 as Da,b4 as La,b5 as za,b6 as _a,b7 as Ha,b8 as Wa,b9 as qa,ba as Ua,bb as Va,bc as Ga,bd as Ja,be as Ka,bf as Xa,bg as Za,bh as Ya,bi as Qa,bj as er,bk as tr,bl as ar,bm as rr,bn as sr,bo as ir,bp as nr,bq as or,br as lr,bs as cr,bt as dr,bu as pr,bv as xr,bw as ur,bx as mr,by as hr,bz as gr,bA as br,bB as fr,bC as yr,bD as vr,bE as wr,bF as jr,bG as Nr,bH as Cr,bI as Sr,bJ as kr,bK as Ir,bL as Tr,bM as Er,bN as Ar,bO as Fr,bP as $r,bQ as Mr,bR as Rr,bS as Br,bT as Or,bU as we,bV as Pr,bW as je,bX as Dr,bY as Lr,bZ as zr,b_ as _r,b$ as Hr,c0 as Wr,c1 as qr,c2 as Ur,c3 as Vr,c4 as Gr,c5 as Jr,c6 as Kr,c7 as Xr,c8 as Zr,c9 as Yr,ca as Qr,cb as es,cc as ts,cd as as,ce as Ne,cf as rs,cg as ss,ch as is,ci as ns,cj as Ce,ck as os,cl as ls,cm as cs,cn as ds,co as ps,cp as xs,cq as us,cr as ms,X as hs,cs as gs,ct as bs,cu as fs,cv as ys,cw as vs,cx as ws,cy as js,cz as Ns,cA as Cs,cB as Ss,cC as ks,cD as Is,cE as Ts,cF as Es,cG as As,cH as Fs,cI as $s,d as Ms,e as Rs,u as Y,cJ as Bs,cK as se,b as le}from"./vendor-DX97-qL9.js";import{l as w,u as _,s as W,H as Z}from"./page-fridge-BvAjnJpI.js";import{m as h,u as Os,A as z}from"./motion-DLE-fuXv.js";import{a as Ps,n as Ds}from"./utils-CUtLAp28.js";import{b as $e,a as Ls,h as V,Z as Me,i as zs}from"./stores-DcNfcD_j.js";import"./page-fridge-scan-ZLPWYd6x.js";function _s(){const a=navigator.userAgent.toLowerCase();return/android/.test(a)?"android":/iphone|ipad|ipod/.test(a)?"ios":window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0?"desktop":"unknown"}function Se(){return!!(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0||window.matchMedia("(display-mode: minimal-ui)").matches)}function Hs(){const[a,t]=T.useState(null),[r,s]=T.useState(!1),[i,n]=T.useState(!1),[c,l]=T.useState("unknown");N.useEffect(()=>{const u=_s(),o=Se();l(u),n(o),w.info("PWA_INSTALL","PWA state initialized",{platform:u,isInstalled:o,userAgent:navigator.userAgent.substring(0,100),displayMode:window.matchMedia("(display-mode: standalone)").matches?"standalone":"browser",timestamp:new Date().toISOString()})},[]),N.useEffect(()=>{const u=b=>{const d=b;b.preventDefault(),t(d),s(!0),w.info("PWA_INSTALL","beforeinstallprompt event captured",{platforms:d.platforms,canPrompt:!0,timestamp:new Date().toISOString()})},o=()=>{n(!0),s(!1),t(null),w.info("PWA_INSTALL","PWA installed successfully",{platform:c,timestamp:new Date().toISOString()})};return window.addEventListener("beforeinstallprompt",u),window.addEventListener("appinstalled",o),()=>{window.removeEventListener("beforeinstallprompt",u),window.removeEventListener("appinstalled",o)}},[c]),N.useEffect(()=>{const u=window.matchMedia("(display-mode: standalone)"),o=b=>{const d=b.matches||window.navigator.standalone===!0;n(d),w.info("PWA_INSTALL","Display mode changed",{isStandalone:b.matches,isInstalled:d,timestamp:new Date().toISOString()})};return u.addEventListener("change",o),()=>{u.removeEventListener("change",o)}},[]);const p=async()=>{if(!a)return w.warn("PWA_INSTALL","No install prompt event available",{platform:c,isInstallable:r,timestamp:new Date().toISOString()}),!1;try{w.info("PWA_INSTALL","Showing install prompt",{platform:c,timestamp:new Date().toISOString()}),await a.prompt();const u=await a.userChoice;return w.info("PWA_INSTALL","User install choice",{outcome:u.outcome,platform:u.platform,timestamp:new Date().toISOString()}),u.outcome==="accepted"?(s(!1),t(null),!0):!1}catch(u){return w.error("PWA_INSTALL","Install prompt failed",{error:u instanceof Error?u.message:"Unknown error",platform:c,timestamp:new Date().toISOString()}),!1}},m=()=>{s(!1),t(null),w.info("PWA_INSTALL","Install prompt dismissed by user",{platform:c,timestamp:new Date().toISOString()})},x=()=>{const u=Se();n(u),w.debug("PWA_INSTALL","Install status checked",{isInstalled:u,platform:c,timestamp:new Date().toISOString()})};return{isInstallable:r,isInstalled:i,isStandalone:window.matchMedia("(display-mode: standalone)").matches,platform:c,canShowPrompt:!!a,installPromptEvent:a,showInstallPrompt:p,dismissInstallPrompt:m,checkInstallStatus:x}}function Ws(a,t,r=250){N.useEffect(()=>{const s=a.current;if(!s||t.length===0)return;s.style.willChange=t.join(", ");const i=setTimeout(()=>{s&&(s.style.willChange="auto")},r);return()=>{clearTimeout(i),s&&(s.style.willChange="auto")}},[a,t,r])}const ue=N.createContext({preferredMotion:"full",hasTouch:!1,isMobile:!1}),qs=()=>N.useContext(ue).preferredMotion,Us=()=>N.useContext(ue).hasTouch,Li=({children:a})=>{const t=window.matchMedia("(prefers-reduced-motion: reduce)").matches?"reduced":"full",r="ontouchstart"in window||navigator.maxTouchPoints>0,s=window.innerWidth<768||r,i={preferredMotion:t,hasTouch:r,isMobile:s};return e.jsx(ue.Provider,{value:i,children:a})},ke={gentle:[.25,.1,.25,1],smooth:[.16,1,.3,1]};function Vs(a){return a<=24?2:a>=24?2.5:2}function Gs(a){return a<=20?8:a<=32?10:a<=48?12:14}const j=({Icon:a,size:t=24,className:r="",animate:s=!0,color:i,glowColor:n,variant:c="default",shape:l="round",style:p,animate:m,transition:x,"aria-label":u,"aria-hidden":o,"aria-describedby":b,role:d,tabIndex:g,onClick:C,onKeyDown:v})=>{const y=qs(),k=Us(),I=N.useRef(null),E=!y&&s&&window.innerWidth>768,F=i??"var(--text-icon-idle)",O="var(--text-icon-active)",M=Vs(t),D=Gs(t);Ws(I,E&&s?["transform"]:[],100);const A={initial:{scale:1,transition:{duration:0}},hover:E&&!k?{scale:1.03,transition:{duration:.1,ease:ke.gentle}}:{},tap:E?{scale:.98,transition:{duration:.08,ease:ke.smooth}}:{}},R=()=>{if(!(!E||k||c==="pure")&&I.current){const H=getComputedStyle(document.documentElement).getPropertyValue("--color-plasma-cyan").trim()||"#18E3FF";I.current.style.filter=`drop-shadow(0 0 ${D}px ${H}15)`,I.current.style.color=O}},$=()=>{!E||k||c==="pure"||I.current&&(I.current.style.filter="",I.current.style.color=F)},q=H=>{v?.(H),C&&(H.key==="Enter"||H.key===" ")&&(H.preventDefault(),C())},L=!!C,Q=L?g!==void 0?g:0:void 0,ee=o!==void 0?o:!L&&!u&&!d,J=c==="pure"?`inline-flex items-center justify-center spatial-icon icon-container ${L?"cursor-pointer focus-ring":""} ${window.innerWidth<=768?"mobile-static-icon":""} ${E?"will-change-transform-important":"will-change-auto-important"} ${r}`:`inline-flex items-center justify-center spatial-icon icon-container gpu-only-transform ${L?"cursor-pointer focus-ring":""} ${window.innerWidth<=768?"mobile-static-icon":""} ${E?"will-change-transform-important":"will-change-auto-important"} ${r}`,ie=()=>l==="square"?`${Math.max(4,t*.15)}px`:"50%",ce=c==="pure"?{transform:"translateZ(0)",alignItems:"center",justifyContent:"center",position:"relative"}:{transform:"translateZ(0)",alignItems:"center",justifyContent:"center",position:"relative",background:L?"color-mix(in srgb, var(--brand-primary) 8%, transparent)":"transparent",borderRadius:ie(),padding:`${Math.max(4,t*.15)}px`,border:L?"1px solid color-mix(in srgb, var(--color-plasma-cyan) 10%, transparent)":"none"};return e.jsxs(h.div,{ref:I,className:J,style:ce,variants:A,initial:"initial",whileHover:"hover",whileTap:L?E?{scale:.98,transition:{duration:.08,ease:[.16,1,.3,1]}}:{}:{},animate:m,transition:x,onMouseEnter:R,onMouseLeave:$,onClick:H=>{C?.()},onKeyDown:L?q:void 0,role:d||(L?"button":void 0),tabIndex:Q,"aria-label":u,"aria-hidden":ee,"aria-describedby":b,children:[(c==="default"||c==="pure"&&n)&&e.jsx("div",{className:"absolute inset-0 pointer-events-none transition-opacity duration-200",style:{background:`radial-gradient(circle, color-mix(in srgb, ${n||"var(--color-plasma-cyan)"} 6%, transparent) 0%, transparent 70%)`,opacity:n?1:0,transform:`scale(${1+D/t})`,filter:`blur(${Math.max(2,D/4)}px)`,borderRadius:ie(),zIndex:-1},ref:H=>{H&&I.current&&(I.current._haloNode=H)}}),a?e.jsx(a,{size:t,color:F,strokeWidth:M,style:{filter:n?`drop-shadow(0 0 12px ${n}80) drop-shadow(0 0 24px ${n}60) drop-shadow(0 0 36px color-mix(in srgb, ${n} 40%, transparent))`:c==="pure"?`drop-shadow(0 0 6px ${F}40)`:"drop-shadow(0 1px 2px rgba(0,0,0,0.2))",transition:"color 200ms ease, filter 200ms ease",transform:"translateZ(0)",strokeLinecap:"round",strokeLinejoin:"round",...p}}):e.jsx("span",{style:{fontSize:t,color:F,transform:"none"},children:"⚠️"})]})},f={Home:$s,Target:Fs,Timer:As,Utensils:Es,Activity:be,Smile:Ts,Scan:Is,ScanLine:ks,ScanFace:Ss,ScanBarcode:Cs,Barcode:Ns,Refrigerator:js,Users:ws,ChefHat:vs,Archive:ys,LayoutDashboard:fs,Phone:bs,Menu:gs,X:hs,Plus:ms,PlusCircle:us,Minus:xs,MinusCircle:ps,Edit:ds,Triangle:cs,Minimize2:ls,Circle:os,BarChart3:Ce,BarChart:Ce,List:ns,ListChecks:is,GitCompare:ss,LineChart:rs,History:Ne,Timeline:Ne,Trash2:as,Save:ts,Settings:es,Sliders:Qr,Palette:Yr,RotateCcw:Zr,Dumbbell:Xr,Mic:Kr,MicOff:Jr,Square:Gr,Wrench:Vr,User:Ur,LogIn:qr,LogOut:Wr,UserPlus:Hr,Check:_r,CheckCircle:zr,AlertCircle:Lr,AlertTriangle:je,AlertOctagon:Dr,TriangleAlert:je,Info:Pr,Loader:we,Loader2:we,ChevronLeft:Or,ChevronRight:Br,ChevronDown:Rr,ChevronUp:Mr,ArrowLeft:$r,ArrowRight:Fr,ArrowDown:Ar,ArrowUp:Er,Heart:Tr,HeartPulse:Ir,Moon:kr,Zap:fe,TrendingUp:Sr,Calendar:Cr,CalendarDays:Nr,CalendarRange:jr,Clock:wr,Bookmark:vr,MessageCircle:yr,MessageSquare:fr,Bell:br,Mail:gr,Volume2:hr,Send:mr,Camera:ur,Image:xr,ShoppingCart:pr,Flag:dr,FileText:cr,Download:lr,Upload:or,PlayCircle:nr,Clapperboard:ir,PlaySquare:sr,Coffee:rr,Droplet:ar,CookingPot:tr,Wifi:er,WifiOff:Qa,Smartphone:Ya,Monitor:Za,HelpCircle:Xa,Shield:Ka,Lock:Ja,Globe:Ga,Eye:Va,EyeOff:Ua,Lightbulb:qa,Construction:Wa,Search:Ha,Star:_a,Copy:za,RefreshCw:La,Package:Da,Tag:Pa,Sparkles:Oa,Filter:Ba,Database:Ra,Server:Ma,Ruler:$a,Scale:Fa,Maximize2:Aa,Calculator:Ea,Hammer:Ta,Fire:ve,Flame:ve,Wind:Ia,Cloud:ka,Sun:Sa,TreePine:Ca,Ban:Na,Droplets:ja,Waves:wa,Apple:va,Milk:ya,Grid3X3:fa,DollarSign:ba,Syringe:ga,Bug:ha,Stethoscope:ma,Microscope:ua,Biohazard:xa,Cigarette:pa,Wine:da,Pill:ca,Baby:la,TestTube:oa,TestTubes:na,Play:ia,MapPin:sa,Map:ra,MapPinOff:aa,Building:ta,Box:ea,GripHorizontal:Qt,TrendingDown:Yt,Watch:Zt,Bike:Xt,Link:Kt,Link2:Jt,Unlink:Gt,CloudOff:Vt,Bluetooth:Ut,RectangleHorizontal:qt,Cylinder:Wt,Cable:Ht,Mountain:_t,TreePalm:ye,Palmtree:ye,TreeDeciduous:zt,Footprints:Lt,LayoutGrid:Dt,CircleDot:Pt,Weight:Ot,Flower2:Bt,BoxSelect:Rt,Skull:Mt,Shuffle:$t,CheckCircle2:Ft,Armchair:At,Sprout:Et,Trophy:Tt,Medal:It,Crown:kt,Award:St,ThumbsUp:Ct,ThumbsDown:Nt,Pause:jt,StopCircle:wt,SkipForward:vt,Repeat:yt,Hash:ft,Sunrise:bt,Sunset:gt,Brain:ht,Route:mt,Gauge:ut,Move:xt,Navigation:pt,Compass:dt,Radar:ct,Radio:lt,Webhook:ot,FastForward:nt,Rewind:it,Rocket:st,Zap2:fe,BarChart2:rt,Activity2:be,GitBranch:at,Layers:tt,Disc:et,Type:Qe,Hourglass:Ye,BadgeCheck:Ze,Beef:ge,Drumstick:ge,Fish:Xe,Wheat:Ke,Salad:Je,BatteryCharging:Ge,Dna:Ve,Atom:Ue,Bolt:qe,XCircle:We};function Js(){const a=navigator.deviceMemory||4,t=navigator.hardwareConcurrency||4,r=window.innerWidth<768||"ontouchstart"in window,s=window.matchMedia("(hover: hover)").matches;let i="medium";return a>=8&&t>=8?i="ultra":a>=6&&t>=6?i="high":a>=4&&t>=4?i="medium":i="low",{performanceLevel:i,supportsHover:s,isMobile:r,memoryGB:a,cores:t}}function Ks(a){const t=a.getBoundingClientRect(),r=Math.max(t.width,t.height);return r<200?"small":r<400?"medium":"large"}function Xs(){switch(Js().performanceLevel){case"low":return"low";case"high":case"ultra":return"high";default:return"medium"}}function Re(){const a=window.matchMedia("(hover: hover)").matches,t=window.matchMedia("(pointer: fine)").matches;return a&&t}const K=class K{constructor(){U(this,"performanceLevel");U(this,"supportsHover");U(this,"isMobile");this.performanceLevel=Xs(),this.supportsHover=Re(),this.isMobile=window.innerWidth<768||"ontouchstart"in window}static getInstance(){return K.instance||(K.instance=new K),K.instance}getEffectClass(t){if(!this.supportsHover||this.isMobile)return null;const r=Ks(t);return`${this.performanceLevel}-${r}`}shouldEnableEffect(){return this.supportsHover&&!this.isMobile}getPerformanceLevel(){return this.performanceLevel}};U(K,"instance");let pe=K;const de=()=>typeof window<"u"&&window.matchMedia("(hover: hover) and (pointer: fine)").matches,B=N.forwardRef(({className:a,as:t="div",interactive:r=!0,elevation:s="md",children:i,disabled:n=!1,size:c="base",spotlight:l=!1,sheen:p=!0,onPointerDown:m,style:x,...u},o)=>{const b=h[t]??h.div,d=Os(),{glassClick:g}=_(),[C,v]=N.useState(null);N.useEffect(()=>{if(o&&"current"in o&&o.current&&Re()){const P=pe.getInstance().getEffectClass(o.current);v(P)}},[o]);const y=P=>{!n&&r&&g(),m?.(P)},k=typeof window<"u"&&window.innerWidth<=768,I=!d&&!k,E=N.useCallback(P=>{if(!r||!de()||n||!p||k)return;const A=P.currentTarget,R=A.getBoundingClientRect(),$=(P.clientX-R.left)/R.width,q=(P.clientY-R.top)/R.height;A.style.setProperty("--mx",String($)),A.style.setProperty("--my",String(q)),A.style.setProperty("--sheen-size","var(--glass-sheen-size)")},[r,n,p,k]),F=N.useCallback(P=>{if(!r||!de()||n||!p||k)return;P.currentTarget.style.setProperty("--sheen-visible","1")},[r,n,p,k]),O=N.useCallback(P=>{if(!r||n||!p||k)return;const A=P.currentTarget;A.style.removeProperty("--sheen-visible"),A.style.removeProperty("--mx"),A.style.removeProperty("--my")},[r,n,p,k]);r&&de();const M={sm:"p-3",base:"p-4",lg:"p-6"},D={sm:"glass-elev-sm",md:"glass-elev-md",lg:"glass-elev-lg"};return e.jsxs(b,{ref:o,onMouseMove:E,onMouseEnter:F,onMouseLeave:O,onPointerDown:y,"data-hover-effect":C,whileTap:!n&&!d?{scale:"var(--interaction-scale-active)",opacity:"var(--interaction-opacity-active)",transition:{duration:.15,ease:"easeOut"}}:{},className:Ps("glass-base glass-card relative will-transform group","rounded-3xl",M[c],D[s],r&&"transform-gpu preserve-3d",r&&!n&&"cursor-pointer glass-focus",n&&"opacity-50 cursor-not-allowed","z-0",a),style:{"--spotlight-opacity":l?.6:0,"--glass-sheen-size":window.innerWidth<768?"240px":"420px",position:"relative",isolation:"isolate",...x},...t==="button"?{disabled:n}:{},...u,children:[p&&e.jsx("div",{"aria-hidden":!0,className:"glass-sheen pointer-events-none absolute rounded-[inherit] overflow-hidden",style:{inset:"-1px"}}),e.jsx("div",{className:"relative z-10 pointer-events-auto",children:i})]})});B.displayName="GlassCard";const Zs=({toast:a,onDismiss:t})=>{const{id:r,type:s,title:i,message:n,duration:c=4e3}=a;T.useEffect(()=>{if(c<=0)return;const m=setTimeout(()=>{t(r)},c);return()=>clearTimeout(m)},[r,c,t]);const l=()=>{switch(s){case"success":return f.Check;case"error":return f.AlertCircle;case"warning":return f.AlertCircle;default:return f.Info}},p=()=>{switch(s){case"success":return"text-green-400 border-green-500/20 bg-green-500/10";case"error":return"text-red-400 border-red-500/20 bg-red-500/10";case"warning":return"text-yellow-400 border-yellow-500/20 bg-yellow-500/10";default:return"text-blue-400 border-blue-500/20 bg-blue-500/10"}};return e.jsx(h.div,{initial:{opacity:0,y:50,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.95},transition:{type:"spring",stiffness:300,damping:30},className:"pointer-events-auto",children:e.jsx(B,{className:`p-4 ${p()} border`,children:e.jsxs("div",{className:"flex items-start gap-3 visionos-grid-sm",children:[e.jsx(j,{Icon:l(),size:20,className:"mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-white text-visionos-body",children:i}),n&&e.jsx("p",{className:"text-white/70 text-sm mt-1 text-visionos-body",children:n})]}),e.jsx("button",{onClick:()=>t(r),className:"p-1 rounded-glass hover:bg-white/10 transition-colors","aria-label":"Fermer la notification",children:e.jsx(j,{Icon:f.X,size:14,className:"text-white/60"})})]})})})},Be=N.createContext(void 0),Ys=()=>{const a=N.useContext(Be);if(!a)throw new Error("useToast must be used within ToastProvider");return a},zi=({children:a})=>{const[t,r]=N.useState([]),{success:s,error:i,notif:n}=_(),c=N.useCallback(x=>{try{const u=Ds(),o={...x,id:u,duration:x.duration??4e3};try{x.type==="success"?s():x.type==="error"?i():n()}catch(b){w.error("TOAST_FEEDBACK_ERROR","Toast feedback audio failed",{toastType:x.type,error:b instanceof Error?b.message:"Unknown error",timestamp:new Date().toISOString()})}r(b=>{try{return[...b.slice(-3),o]}catch(d){return w.error("TOAST_STATE_ERROR","Failed to update toast state",{error:d instanceof Error?d.message:"Unknown error",toastId:u,timestamp:new Date().toISOString()}),b}})}catch(u){w.error("TOAST_PROVIDER_ERROR","Complete toast creation failed",{toastType:x.type,toastTitle:x.title,error:u instanceof Error?u.message:"Unknown error",timestamp:new Date().toISOString()})}},[s,i,n]),l=N.useCallback(x=>{r(u=>u.filter(o=>o.id!==x))},[]),p=N.useCallback(()=>{r([])},[]),m={showToast:c,dismissToast:l,clearAll:p};return e.jsxs(Be.Provider,{value:m,children:[a,e.jsx("div",{className:"fixed top-4 right-4 space-y-2",style:{zIndex:9999},children:e.jsx(z,{children:t.map(x=>e.jsx(Zs,{toast:x,onDismiss:l},x.id))})})]})};function Qs(a){switch(a){case"ios":return{title:"Installer TwinForge sur iOS",instructions:["Appuyez sur l'icône Partager en bas de l'écran",`Faites défiler et sélectionnez "Sur l'écran d'accueil"`,'Appuyez sur "Ajouter" pour confirmer'],icon:"Smartphone"};case"android":return{title:"Installer TwinForge sur Android",instructions:['Appuyez sur "Installer" dans la bannière',`Ou utilisez le menu ⋮ > "Installer l'application"`,"Confirmez l'installation"],icon:"Smartphone"};case"desktop":return{title:"Installer TwinForge sur Desktop",instructions:["Cliquez sur l'icône d'installation dans la barre d'adresse",'Ou utilisez le menu ⋮ > "Installer TwinForge"',"Confirmez l'installation"],icon:"Monitor"};default:return{title:"Installer TwinForge",instructions:[`Recherchez l'option "Installer" dans votre navigateur`,"Suivez les instructions de votre appareil","Profitez de l'expérience native"],icon:"Download"}}}const _i=({className:a="",variant:t="card",autoShow:r=!0,onInstallSuccess:s,onDismiss:i})=>{const{isInstallable:n,isInstalled:c,platform:l,canShowPrompt:p,showInstallPrompt:m,dismissInstallPrompt:x}=Hs(),{success:u,click:o}=_(),{showToast:b}=Ys(),[d,g]=N.useState(!1),[C,v]=N.useState(!1),[y,k]=N.useState(!1);if(c||!n||y&&!r)return null;const I=Qs(l),E=async()=>{if(!p){v(!0);return}g(!0);try{w.info("PWA_INSTALL_PROMPT","User initiated installation",{platform:l,variant:t,timestamp:new Date().toISOString()}),await m()?(u(),b({type:"success",title:"Installation réussie !",message:"TwinForge a été ajouté à votre écran d'accueil",duration:4e3}),s?.(),w.info("PWA_INSTALL_PROMPT","Installation completed successfully",{platform:l,timestamp:new Date().toISOString()})):b({type:"info",title:"Installation annulée",message:"Vous pouvez installer TwinForge plus tard depuis le menu du navigateur",duration:3e3})}catch(M){w.error("PWA_INSTALL_PROMPT","Installation failed",{error:M instanceof Error?M.message:"Unknown error",platform:l,timestamp:new Date().toISOString()}),b({type:"error",title:"Erreur d'installation",message:"Impossible d'installer l'application. Réessayez plus tard.",duration:4e3})}finally{g(!1)}},F=()=>{o(),k(!0),x(),i?.(),w.info("PWA_INSTALL_PROMPT","Install prompt dismissed",{platform:l,variant:t,timestamp:new Date().toISOString()})},O=()=>{v(!1)};return t==="banner"?e.jsx(h.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},exit:{opacity:0,y:-50},className:`fixed top-20 left-4 right-4 z-50 ${a}`,children:e.jsx(B,{className:"p-4",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--brand-primary) 12%, transparent) 0%, transparent 60%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, var(--brand-primary) 25%, transparent)",backdropFilter:"blur(16px) saturate(150%)"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:"color-mix(in srgb, var(--brand-primary) 20%, transparent)",border:"1px solid color-mix(in srgb, var(--brand-primary) 30%, transparent)"},children:e.jsx(j,{Icon:f.Download,size:18,style:{color:"var(--brand-primary)"}})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-semibold text-sm",children:"Installer TwinForge"}),e.jsx("p",{className:"text-white/70 text-xs",children:"Accès rapide depuis votre écran d'accueil"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:E,disabled:d,className:"btn-glass--primary px-4 py-2 text-sm",children:d?"Installation...":"Installer"}),e.jsx("button",{onClick:F,className:"p-2 rounded-full hover:bg-white/10 transition-colors",children:e.jsx(j,{Icon:f.X,size:14,className:"text-white/60"})})]})]})})}):t==="floating"?e.jsx(h.div,{initial:{opacity:0,scale:.8,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.8,y:20},className:`fixed bottom-24 right-4 z-40 ${a}`,children:e.jsx("button",{onClick:E,disabled:d,className:"w-14 h-14 rounded-full flex items-center justify-center",style:{background:`
              radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
              linear-gradient(135deg, color-mix(in srgb, var(--brand-primary) 80%, transparent), color-mix(in srgb, var(--brand-accent) 60%, transparent))
            `,border:"2px solid color-mix(in srgb, var(--brand-primary) 60%, transparent)",backdropFilter:"blur(16px) saturate(150%)",boxShadow:`
              0 8px 32px rgba(0, 0, 0, 0.25),
              0 0 20px color-mix(in srgb, var(--brand-primary) 20%, transparent)
            `},title:"Installer TwinForge",children:e.jsx(j,{Icon:d?f.Loader2:f.Download,size:20,className:`text-white ${d?"animate-spin":""}`})})}):e.jsxs(e.Fragment,{children:[e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:a,children:e.jsx(B,{className:"p-6",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--brand-primary) 12%, transparent) 0%, transparent 60%),
              radial-gradient(circle at 70% 80%, color-mix(in srgb, var(--brand-accent) 8%, transparent) 0%, transparent 50%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, var(--brand-primary) 25%, transparent)",boxShadow:`
              0 12px 40px rgba(0, 0, 0, 0.25),
              0 0 30px color-mix(in srgb, var(--brand-primary) 15%, transparent),
              inset 0 2px 0 rgba(255, 255, 255, 0.15)
            `},children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, var(--brand-primary) 30%, transparent), color-mix(in srgb, var(--brand-accent) 25%, transparent))
                `,border:"2px solid color-mix(in srgb, var(--brand-primary) 40%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, var(--brand-primary) 30%, transparent)"},children:e.jsx(j,{Icon:f[I.icon],size:20,style:{color:"var(--brand-primary)"}})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-white font-bold text-lg mb-2",children:"Installer TwinForge"}),e.jsx("p",{className:"text-white/70 text-sm mb-4 leading-relaxed",children:"Installez TwinForge sur votre appareil pour un accès rapide et une expérience optimisée."}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx("button",{onClick:E,disabled:d,className:"btn-glass--primary px-4 py-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[d?e.jsx(j,{Icon:f.Loader2,size:16,className:"animate-spin"}):e.jsx(j,{Icon:f.Download,size:16}),e.jsx("span",{children:d?"Installation...":"Installer"})]})}),e.jsx("button",{onClick:()=>v(!0),className:"btn-glass--secondary-nav px-4 py-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{Icon:f.Info,size:16}),e.jsx("span",{children:"Instructions"})]})}),e.jsx("button",{onClick:F,className:"btn-glass--secondary-nav px-3 py-2",title:"Fermer",children:e.jsx(j,{Icon:f.X,size:16})})]})]})]})})}),e.jsx(z,{children:C&&e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",style:{background:"rgba(0, 0, 0, 0.8)",backdropFilter:"blur(16px)",WebkitBackdropFilter:"blur(16px)"},onClick:M=>{M.target===M.currentTarget&&O()},children:e.jsx(h.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{type:"spring",stiffness:300,damping:30},className:"w-full max-w-md",onClick:M=>M.stopPropagation(),children:e.jsxs(B,{className:"p-6",style:{background:`
                    radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--brand-accent) 12%, transparent) 0%, transparent 60%),
                    var(--glass-opacity)
                  `,borderColor:"color-mix(in srgb, var(--brand-accent) 30%, transparent)",backdropFilter:"blur(24px) saturate(160%)"},children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:`
                        radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                        linear-gradient(135deg, color-mix(in srgb, var(--brand-accent) 35%, transparent), color-mix(in srgb, var(--brand-accent) 25%, transparent))
                      `,border:"2px solid color-mix(in srgb, var(--brand-accent) 50%, transparent)",boxShadow:"0 0 30px color-mix(in srgb, var(--brand-accent) 40%, transparent)"},children:e.jsx(j,{Icon:f[I.icon],size:28,style:{color:"var(--brand-accent)"}})}),e.jsx("h3",{className:"text-2xl font-bold text-white mb-3",children:I.title}),e.jsxs("p",{className:"text-white/70 text-sm",children:["Suivez ces étapes pour installer TwinForge sur votre ",l==="ios"?"iPhone/iPad":l==="android"?"appareil Android":"ordinateur"]})]}),e.jsx("div",{className:"space-y-4 mb-6",children:I.instructions.map((M,D)=>e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",style:{background:"color-mix(in srgb, var(--brand-accent) 20%, transparent)",border:"1px solid color-mix(in srgb, var(--brand-accent) 30%, transparent)",color:"var(--brand-accent)",fontSize:"12px",fontWeight:"bold"},children:D+1}),e.jsx("p",{className:"text-white/80 text-sm leading-relaxed",children:M})]},D))}),e.jsxs("div",{className:"flex gap-3",children:[p&&e.jsx("button",{onClick:E,disabled:d,className:"flex-1 btn-glass--primary py-3",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[d?e.jsx(j,{Icon:f.Loader2,size:16,className:"animate-spin"}):e.jsx(j,{Icon:f.Download,size:16}),e.jsx("span",{children:d?"Installation...":"Installer Maintenant"})]})}),e.jsx("button",{onClick:O,className:"btn-glass--secondary-nav px-4 py-3",children:e.jsx("span",{children:"Fermer"})})]})]})})})})]})},Hi=({isVisible:a,onUpdate:t,onDismiss:r,updateInfo:s})=>{const{success:i,click:n}=_(),[c,l]=N.useState(!1),p=async()=>{l(!0);try{w.info("PWA_UPDATE","User initiated app update",{version:s?.version,isRequired:s?.isRequired,timestamp:new Date().toISOString()}),i(),await t(),w.info("PWA_UPDATE","App update completed",{timestamp:new Date().toISOString()})}catch(x){w.error("PWA_UPDATE","App update failed",{error:x instanceof Error?x.message:"Unknown error",timestamp:new Date().toISOString()})}finally{l(!1)}},m=()=>{n(),r(),w.info("PWA_UPDATE","Update notification dismissed",{version:s?.version,timestamp:new Date().toISOString()})};return e.jsx(z,{children:a&&e.jsx(h.div,{initial:{opacity:0,y:50,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:50,scale:.95},className:"fixed bottom-4 left-4 right-4 z-50 max-w-md mx-auto",children:e.jsx(B,{className:"p-5",style:{background:`
                radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--brand-accent) 15%, transparent) 0%, transparent 60%),
                radial-gradient(circle at 70% 80%, color-mix(in srgb, var(--brand-primary) 10%, transparent) 0%, transparent 50%),
                var(--glass-opacity)
              `,borderColor:"color-mix(in srgb, var(--brand-accent) 35%, transparent)",boxShadow:`
                0 16px 48px rgba(0, 0, 0, 0.3),
                0 0 40px color-mix(in srgb, var(--brand-accent) 25%, transparent),
                inset 0 2px 0 rgba(255, 255, 255, 0.2)
              `,backdropFilter:"blur(24px) saturate(170%)"},children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`
                    radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                    linear-gradient(135deg, color-mix(in srgb, var(--brand-accent) 40%, transparent), color-mix(in srgb, var(--brand-accent) 30%, transparent))
                  `,border:"2px solid color-mix(in srgb, var(--brand-accent) 50%, transparent)",boxShadow:"0 0 25px color-mix(in srgb, var(--brand-accent) 40%, transparent)"},children:e.jsx(h.div,{animate:{scale:[1,1.1,1],rotate:[0,5,-5,0]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:e.jsx(j,{Icon:f.Download,size:20,style:{color:"var(--brand-accent)"}})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-white font-bold text-lg mb-2",children:"Nouvelle Version Disponible"}),e.jsx("p",{className:"text-white/80 text-sm mb-3 leading-relaxed",children:"Une mise à jour de TwinForge est disponible avec de nouvelles fonctionnalités et améliorations."}),s?.features&&s.features.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-white/60 text-xs mb-2",children:"Nouveautés :"}),e.jsx("div",{className:"space-y-1",children:s.features.slice(0,3).map((x,u)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-1 rounded-full bg-cyan-400"}),e.jsx("span",{className:"text-white/70 text-xs",children:x})]},u))})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:p,disabled:c,className:"btn-glass--primary px-4 py-2 text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[c?e.jsx(j,{Icon:f.Loader2,size:14,className:"animate-spin"}):e.jsx(j,{Icon:f.Download,size:14}),e.jsx("span",{children:c?"Mise à jour...":"Mettre à jour"})]})}),!s?.isRequired&&e.jsx("button",{onClick:m,className:"btn-glass--secondary-nav px-3 py-2 text-sm",children:"Plus tard"})]})]})]})})})})},ei={inventory:{colors:{primary:"#06B6D4",secondary:"#0891B2",glow:"rgba(6, 182, 212, 0.4)"},icon:"Package",defaultTitle:"Analyse de votre inventaire",defaultSubtitle:"Traitement des données en cours..."},recipes:{colors:{primary:"#EC4899",secondary:"#F472B6",glow:"rgba(236, 72, 153, 0.4)"},icon:"ChefHat",defaultTitle:"Création de recettes",defaultSubtitle:"La Forge Spatiale travaille..."},plan:{colors:{primary:"#8B5CF6",secondary:"#A78BFA",glow:"rgba(139, 92, 246, 0.4)"},icon:"Calendar",defaultTitle:"Génération du plan hebdomadaire",defaultSubtitle:"Optimisation nutritionnelle en cours..."},shopping:{colors:{primary:"#10B981",secondary:"#34D399",glow:"rgba(16, 185, 129, 0.4)"},icon:"ShoppingCart",defaultTitle:"Génération de la liste de courses",defaultSubtitle:"Organisation des achats..."},training:{colors:{primary:"#10B981",secondary:"#34D399",glow:"rgba(16, 185, 129, 0.4)"},icon:"Activity",defaultTitle:"Ton Coach IA Prépare Ton Plan...",defaultSubtitle:"Analyse de tes capacités et génération d'un programme personnalisé"},default:{colors:{primary:"#60A5FA",secondary:"#93C5FD",glow:"rgba(96, 165, 250, 0.4)"},icon:"Sparkles",defaultTitle:"Chargement",defaultSubtitle:"Traitement en cours..."}},Wi=({variant:a="default",title:t,subtitle:r,progress:s,showProgressBar:i=!0,showSteps:n=!1,onCancel:c,showCancelButton:l=!1,elapsedTime:p=0,customColor:m})=>{const x=ei[a],u=f[x.icon],o=m||x.colors.primary,b=m?`color-mix(in srgb, ${m} 80%, white)`:x.colors.secondary,d=m?`color-mix(in srgb, ${m} 40%, transparent)`:x.colors.glow,g=v=>{const y=Math.floor(v/60),k=v%60;return y>0?`${y}m ${k}s`:`${k}s`},C=(()=>{if(s==null)return 0;const v=Number(s);return isNaN(v)?0:Math.max(0,Math.min(100,v))})();return e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.5},className:"loader-optimized",children:e.jsxs(B,{className:"p-8 text-center relative loader-isolate",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, ${o} 15%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, ${b} 10%, transparent) 0%, transparent 60%),
            rgba(255, 255, 255, 0.06)
          `,borderColor:`color-mix(in srgb, ${o} 30%, transparent)`,backdropFilter:"blur(24px) saturate(180%)",boxShadow:`
            0 12px 48px rgba(0, 0, 0, 0.3),
            0 0 40px color-mix(in srgb, ${o} 20%, transparent),
            0 0 80px color-mix(in srgb, ${o} 10%, transparent),
            inset 0 2px 0 rgba(255, 255, 255, 0.2),
            inset 0 -2px 0 rgba(0, 0, 0, 0.1)
          `,borderRadius:"1.5rem",overflow:"hidden"},children:[[...Array(12)].map((v,y)=>e.jsx("div",{className:"loader-particle",style:{color:y%3===0?b:o,top:`${15+Math.random()*70}%`,left:`${5+y*8}%`,"--tx":`${(Math.random()-.5)*120}px`,"--ty":`${-60-Math.random()*120}px`,"--duration":`${3.5+Math.random()*2.5}s`,"--delay":`${y*.25}s`,width:y%4===0?"6px":"4px",height:y%4===0?"6px":"4px"}},y)),e.jsxs("div",{className:"space-y-6 relative z-10",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx(h.div,{className:"w-32 h-32 rounded-full flex items-center justify-center loader-breathing-border",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.3) 0%, transparent 60%),
                  radial-gradient(circle at 70% 70%, color-mix(in srgb, ${b} 15%, transparent) 0%, transparent 70%),
                  linear-gradient(135deg, color-mix(in srgb, ${o} 45%, transparent), color-mix(in srgb, ${o} 30%, transparent))
                `,border:`3px solid color-mix(in srgb, ${o} 70%, transparent)`,color:o,boxShadow:`
                  0 0 50px ${d},
                  0 0 25px ${d},
                  0 0 80px color-mix(in srgb, ${o} 20%, transparent),
                  inset 0 0 25px color-mix(in srgb, ${o} 18%, transparent),
                  inset 0 2px 0 rgba(255, 255, 255, 0.3)
                `},animate:{scale:[1,1.08,1],rotate:[0,180,360],boxShadow:[`0 0 50px ${d}, 0 0 25px ${d}, 0 0 80px color-mix(in srgb, ${o} 20%, transparent), inset 0 0 25px color-mix(in srgb, ${o} 18%, transparent), inset 0 2px 0 rgba(255, 255, 255, 0.3)`,`0 0 70px ${d}, 0 0 35px ${d}, 0 0 100px color-mix(in srgb, ${o} 30%, transparent), inset 0 0 35px color-mix(in srgb, ${o} 28%, transparent), inset 0 2px 0 rgba(255, 255, 255, 0.4)`,`0 0 50px ${d}, 0 0 25px ${d}, 0 0 80px color-mix(in srgb, ${o} 20%, transparent), inset 0 0 25px color-mix(in srgb, ${o} 18%, transparent), inset 0 2px 0 rgba(255, 255, 255, 0.3)`]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},children:e.jsx(j,{Icon:u,size:64,className:"text-white loader-icon-pulse",motionAnimate:{scale:[1,1.1,1]},motionTransition:{repeat:1/0,duration:2,ease:"easeInOut"},style:{filter:`drop-shadow(0 0 16px ${d}) drop-shadow(0 0 8px white)`}})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h.h3,{className:"text-2xl font-bold text-white",style:{textShadow:`0 0 24px ${d}, 0 0 48px color-mix(in srgb, ${o} 35%, transparent), 0 2px 4px rgba(0, 0, 0, 0.3)`},animate:{opacity:[.95,1,.95]},transition:{duration:2.5,repeat:1/0,ease:"easeInOut"},children:t||x.defaultTitle}),e.jsx(h.p,{className:"text-white/85 text-lg",style:{textShadow:`0 0 12px color-mix(in srgb, ${b} 35%, transparent), 0 1px 2px rgba(0, 0, 0, 0.2)`},animate:{opacity:[.9,1,.9]},transition:{duration:2,repeat:1/0,ease:"easeInOut",delay:.3},children:r||x.defaultSubtitle})]}),e.jsx("div",{className:"flex justify-center gap-2",children:[0,1,2].map(v=>e.jsx("div",{className:"w-3 h-3 bg-white/80 rounded-full loader-dot",style:{"--delay":`${v*.2}s`}},v))}),i&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-center",children:e.jsxs("span",{className:"text-4xl font-bold text-white",style:{textShadow:`0 0 20px ${d}`},children:[Math.round(C),"%"]})}),e.jsx("div",{className:"w-full max-w-xs mx-auto h-2 bg-white/10 rounded-full overflow-hidden relative",children:e.jsx(h.div,{className:"h-full rounded-full relative",style:{background:`linear-gradient(90deg, ${o}, ${b})`,width:`${C}%`,boxShadow:`0 0 12px ${d}`},initial:{width:0},animate:{width:`${C}%`},transition:{duration:.4,ease:"easeOut"},children:C<95&&e.jsx("div",{className:"loader-progress-shimmer"})})})]}),p>0&&e.jsxs(h.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"text-white/60 text-sm",children:["Temps écoulé: ",g(p)]}),l&&c&&e.jsx(h.button,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},onClick:c,className:"mt-4 px-6 py-2.5 rounded-xl text-white/80 text-sm font-medium transition-all",style:{background:"rgba(255, 255, 255, 0.08)",border:"2px solid rgba(255, 255, 255, 0.15)",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.2)"},whileHover:{background:"rgba(255, 255, 255, 0.12)",scale:1.02,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.25)"},whileTap:{scale:.98},children:e.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[e.jsx(j,{Icon:f.X,size:16}),e.jsx("span",{children:"Annuler"})]})})]})]})})},ti=Ms((a,t)=>({drawerOpen:!1,setDrawer:r=>a({drawerOpen:r})})),ne=({to:a,children:t,prefetch:r=!0,className:s="",onMouseEnter:i,onPointerDown:n,...c})=>{T.useEffect(()=>{w.trace("LINK","Component rendered for route",{to:a,prefetch:r})},[a,r]),Rs();const{session:l}=$e(),{click:p}=_();Y();const m=async o=>{i?.(o)},x=o=>{if(w.trace("LINK","PointerDown captured for route",{to:a,eventType:o.type}),w.trace("LINK","PointerDown event triggered",{to:a,isSidebarLink:!!o.currentTarget.closest(".sidebar-item")}),o.currentTarget.closest(".sidebar.item")){const{sidebarClick:d}=_();w.trace("LINK","Triggering sidebar click sound"),d()}else w.trace("LINK","Triggering regular click sound"),p();n?.(o)},u=o=>{if(w.trace("LINK","Click captured",{to:a,eventType:o.type}),w.trace("LINK","Click event triggered",{to:a,currentPath:window.location.pathname,defaultPrevented:o.defaultPrevented}),o.defaultPrevented){w.debug("🔍 [Link] Navigation blocked by router guard, respecting block");return}w.trace("LINK","Proceeding with navigation to",{to:a})};return T.useEffect(()=>(w.trace("LINK","Component mounted for route",{to:a}),()=>{w.trace("LINK","Component unmounted for route",{to:a})}),[a]),e.jsx(Bs,{to:a,className:`${s} inline-flex items-center`,onMouseEnter:m,onPointerDown:x,onClick:u,onMouseDown:o=>{w.trace("LINK","MouseDown captured",{to:a,button:o.button})},onTouchStart:o=>{w.trace("LINK","TouchStart captured",{to:a,touches:o.touches.length})},...c,children:t})},G={home:"var(--color-plasma-cyan)",track:"var(--color-plasma-cyan)",fasting:"var(--circuit-fasting)",activity:"var(--circuit-activity)",training:"var(--circuit-training)",emotions:"var(--circuit-emotions)",videos:"var(--circuit-videos)",health:"var(--circuit-health)",preferences:"var(--circuit-fridge)","coach-videos":"var(--circuit-videos)","coach-clients":"var(--brand-accent)","coach-branding":"var(--brand-accent)"};function ai(a){return a.replace(/^\//,"").replace(/\/.*$/,"")}function te(a){if(a==="/")return G.home;if(a.startsWith("/coach/")){const r=a.replace("/coach/","");return G[`coach-${r}`]||G["coach-clients"]}const t=ai(a);return a.includes("coach-")?G[t]||G["coach-clients"]:G[t]||G.home}function ri(){return[{title:"",type:"primary",items:[{to:"/",icon:"Home",label:"Coeur de la Forge",subtitle:"Tableau de Bord",isPrimary:!0,circuitColor:"#F7931E",actionLabel:void 0}]},{title:"",type:"twin",items:[{to:"/avatar",icon:"User",label:"Mon Twin",subtitle:"Avatar 3D",isTwin:!0,circuitColor:"#8B5CF6",tabs:["Scanner","Avatar","Projection","Insights","Historique"]}]},{title:"Alimentation",type:"forge-category",items:[{to:"/meals",icon:"Utensils",label:"Forge Nutritionnelle",subtitle:"Scanner de Repas",isForge:!0,circuitColor:"#10B981",tabs:["Scanner","Insights","Progression","Historique"],subItems:[{to:"/meals#daily",icon:"ScanLine",label:"Scanner de Repas & Code",isPrimarySubMenu:!0},{to:"/meals#insights",icon:"TrendingUp",label:"Insights"},{to:"/meals#progression",icon:"BarChart3",label:"Progression"},{to:"/meals#history",icon:"History",label:"Historique"}]},{to:"/fridge",icon:"ChefHat",label:"Forge Culinaire",subtitle:"Scanner de Frigo",isForge:!0,circuitColor:"#EC4899",tabs:["Scanner","Inventaire","Recettes","Plan","Courses"],subItems:[{to:"/fridge#scanner",icon:"ScanLine",label:"Scanner de Frigo",isPrimarySubMenu:!0},{to:"/fridge#inventaire",icon:"Refrigerator",label:"Inventaire"},{to:"/fridge#recipes",icon:"ChefHat",label:"Recettes"},{to:"/fridge#plan",icon:"Calendar",label:"Plan"},{to:"/fridge#courses",icon:"ShoppingCart",label:"Courses"}]}]},{title:"Activité",type:"forge-category",items:[{to:"/activity",icon:"Activity",label:"Forge Énergétique",subtitle:"Tracker d'Activités",isForge:!0,circuitColor:"#3B82F6",tabs:["Tracker","Insights","Progression","Historique"],subItems:[{to:"/activity#daily",icon:"Activity",label:"Tracker d'Activités",isPrimarySubMenu:!0},{to:"/activity#insights",icon:"BarChart3",label:"Insights",color:"#10B981"},{to:"/activity#progression",icon:"TrendingUp",label:"Progression",color:"#10B981"},{to:"/activity#history",icon:"History",label:"Historique"}]},{to:"/training",icon:"Dumbbell",label:"Forge Corporelle",subtitle:"Coaching live",isForge:!0,circuitColor:"#18E3FF",tabs:["Coaching","Conseils","Progression","Records","Historique"],subItems:[{to:"/training#aujourd hui",icon:"Home",label:"Coaching Live",isPrimarySubMenu:!0},{to:"/training#conseils",icon:"Lightbulb",label:"Conseils"},{to:"/training#progression",icon:"TrendingUp",label:"Progression"},{to:"/training#records",icon:"Trophy",label:"Records"},{to:"/training#historique",icon:"History",label:"Historique"}]}]},{title:"Santé",type:"forge-category",items:[{to:"/fasting",icon:"Timer",label:"Forge du Temps",subtitle:"Jeûne Intermittent",isForge:!0,circuitColor:"#F59E0B",tabs:["Tracker","Insights","Progression","Historique"],subItems:[{to:"/fasting#daily",icon:"Timer",label:"Tracker de Jeûne",isPrimarySubMenu:!0},{to:"/fasting#insights",icon:"TrendingUp",label:"Insights",color:"#10B981"},{to:"/fasting#progression",icon:"BarChart3",label:"Progression"},{to:"/fasting#history",icon:"History",label:"Historique"}]},{to:"/vital",icon:"HeartPulse",label:"Forge Vitale",subtitle:"Médecine Préventive",isForge:!0,circuitColor:"#EF4444",tabs:["Dossier","Analyses","Suivi","Prévention"],subItems:[{to:"/vital#dossier",icon:"FileText",label:"Dossier",isPrimarySubMenu:!0},{to:"/vital#analyses",icon:"Activity",label:"Analyses"},{to:"/vital#suivi",icon:"TrendingUp",label:"Suivi"},{to:"/vital#prevention",icon:"Shield",label:"Prévention"}]}]}]}const Oe=T.memo(({title:a,children:t,type:r})=>{const s=r==="forge-category",i=a==="Alimentation"||a==="Activité"||a==="Santé";return e.jsxs("div",{className:s?"mt-4":"",children:[a&&e.jsxs(e.Fragment,{children:[i&&e.jsx("div",{className:"sidebar-category-separator"}),e.jsx("h3",{className:"sidebar-section-title text-white/50 text-xs uppercase tracking-wider font-semibold mb-1 px-1",children:a})]}),e.jsx("div",{className:"space-y-0.5",children:t})]})});Oe.displayName="Section";const si=T.memo(()=>{const{drawerOpen:a,setDrawer:t}=ti(),r=se(),s=Y(),i=T.useRef(null),{profile:n}=$e(),[c,l]=T.useState({}),p=N.useCallback(o=>r.pathname===o,[r.pathname]);N.useEffect(()=>{if(a){const o=document.body.style.overflow,b=document.body.style.position;return document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%",document.body.style.height="100%",()=>{document.body.style.overflow=o,document.body.style.position=b,document.body.style.width="",document.body.style.height=""}}},[a]);const m=N.useMemo(()=>ri(),[]);T.useEffect(()=>{const o=r.pathname,b={};m.forEach(d=>{d.items.forEach(g=>{g.subItems&&g.subItems.length>0&&(g.subItems.some(v=>{const y=v.to.split("#")[0];return o===y})?b[g.to]=!0:b[g.to]=!1)})}),l(b)},[r.pathname,m]);const x=N.useCallback(o=>{l(b=>{if(b[o])return{...b,[o]:!1};const g={};return Object.keys(b).forEach(C=>{g[C]=!1}),g[o]=!0,g})},[]),u=N.useCallback(async()=>{try{await W.auth.signOut(),t(!1),s("/")}catch(o){console.error("Logout error:",o)}},[s,t]);return e.jsx(z,{children:a&&e.jsxs(e.Fragment,{children:[e.jsx(h.div,{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9998]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},onClick:()=>t(!1)}),e.jsx(h.nav,{ref:i,className:"mobile-drawer fixed top-0 left-0 h-full w-[85vw] max-w-[340px] z-[9999] overflow-y-auto",initial:{x:"-100%"},animate:{x:0},exit:{x:"-100%"},transition:{type:"spring",stiffness:300,damping:30},role:"navigation","aria-label":"Navigation mobile",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:e.jsxs("div",{className:"py-3 pl-3 pr-2.5 space-y-2",children:[m.map((o,b)=>e.jsxs(T.Fragment,{children:[e.jsx(Oe,{title:o.title,type:o.type,children:o.items.map(d=>{const g=d.subItems&&d.subItems.length>0,C=g&&d.subItems.some(y=>{const k=y.to.split("#")[0],I=y.to.split("#")[1],E=r.pathname,F=r.hash.replace("#","")||"daily";return E===k&&(!I||F===I)}),v=y=>{g?(y.preventDefault(),x(d.to)):t(!1)};return e.jsxs("div",{className:"relative sidebar-nav-item-container",children:[e.jsxs(ne,{to:d.to,className:`
                            sidebar-item
                            ${d.isPrimary?"sidebar-item--primary":""}
                            ${d.isTwin?"sidebar-item--twin":""}
                            ${d.isForge?"sidebar-item--forge":""}
                            ${g?"sidebar-item--with-submenu":""}
                            group focus-ring
                            ${p(d.to)||C?"text-white shadow-sm":"text-white/70 hover:text-white"}
                          `,onClick:v,style:{"--item-circuit-color":d.circuitColor||te(d.to)},children:[e.jsx("div",{className:`sidebar-item-icon-container ${p(d.to)||C?"sidebar-item-icon-container--active":""}`,children:e.jsx(j,{Icon:f[d.icon],size:16,className:`sidebar-item-icon ${p(d.to)||C?"":"opacity-80 group-hover:opacity-100"}`,color:p(d.to)||C?te(d.to):void 0,style:p(d.to)||C?{color:te(d.to),filter:`drop-shadow(0 0 8px ${te(d.to)}60)`}:void 0})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:`sidebar-item-label font-medium text-xs truncate ${p(d.to)||C?"text-white":"text-white/82"}`,children:d.label}),e.jsx("div",{className:`sidebar-item-subtitle text-xxs truncate mt-0 ${p(d.to)||C?"text-white/70":"text-white/50"}`,children:d.subtitle})]})]}),g&&e.jsx("div",{className:`sidebar-submenu ${c[d.to]?"sidebar-submenu--expanded":""}`,role:"group","aria-label":`Sous-menu ${d.label}`,children:e.jsx("div",{className:"sidebar-submenu-inner",children:d.subItems.map(y=>{const k=f[y.icon],I=y.to.split("#")[0],E=y.to.split("#")[1],F=r.pathname,O=r.hash.replace("#","")||"daily",M=F===I&&(!E||O===E),D=y.isPrimarySubMenu&&F===I;return e.jsxs(ne,{to:y.to,className:`
                                      sidebar-submenu-item
                                      ${y.isPrimarySubMenu?"sidebar-submenu-item--primary":"sidebar-submenu-item--secondary"}
                                      ${M||D?"sidebar-submenu-item--active":""}
                                      focus-ring
                                    `,onClick:()=>t(!1),"aria-current":M?"page":void 0,style:{"--item-circuit-color":y.color||d.circuitColor||te(d.to)},children:[e.jsx("div",{className:`sidebar-submenu-item-icon-container ${M||D?"sidebar-submenu-item-icon-container--active":""}`,children:e.jsx(j,{Icon:k,size:y.isPrimarySubMenu?16:14,className:"sidebar-submenu-item-icon"})}),e.jsx("span",{className:"sidebar-submenu-item-label",children:y.label})]},y.to)})})})]},d.to)})}),o.type==="primary"&&e.jsx("div",{className:"sidebar-primary-separator","aria-hidden":"true"})]},b)),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"sidebar-category-separator mb-3"}),e.jsx("div",{className:"px-1.5 mb-1.5",children:e.jsx("h3",{className:"text-white/50 text-xs uppercase tracking-wider font-semibold",children:"Compte"})}),e.jsxs("div",{className:"space-y-0.5",children:[e.jsxs(ne,{to:"/profile",className:`
                      sidebar-item group focus-ring
                      ${p("/profile")?"text-white shadow-sm":"text-white/70 hover:text-white"}
                    `,onClick:()=>t(!1),style:{"--item-circuit-color":"#18E3FF"},children:[e.jsx("div",{className:`sidebar-item-icon-container ${p("/profile")?"sidebar-item-icon-container--active":""}`,children:e.jsx(j,{Icon:f.User,size:16,className:`sidebar-item-icon ${p("/profile")?"":"opacity-80 group-hover:opacity-100"}`,style:p("/profile")?{color:"#18E3FF",filter:"drop-shadow(0 0 8px rgba(24, 227, 255, 0.6))"}:void 0})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:`sidebar-item-label font-medium text-xs truncate ${p("/profile")?"text-white":"text-white/82"}`,children:"Mon Profil"}),e.jsx("div",{className:`sidebar-item-subtitle text-xxs truncate mt-0 ${p("/profile")?"text-white/70":"text-white/50"}`,children:"Infos personnelles"})]})]}),e.jsxs(ne,{to:"/settings",className:`
                      sidebar-item group focus-ring
                      ${p("/settings")?"text-white shadow-sm":"text-white/70 hover:text-white"}
                    `,onClick:()=>t(!1),style:{"--item-circuit-color":"#7A5AF8"},children:[e.jsx("div",{className:`sidebar-item-icon-container ${p("/settings")?"sidebar-item-icon-container--active":""}`,children:e.jsx(j,{Icon:f.Settings,size:16,className:`sidebar-item-icon ${p("/settings")?"":"opacity-80 group-hover:opacity-100"}`,style:p("/settings")?{color:"#7A5AF8",filter:"drop-shadow(0 0 8px rgba(122, 90, 248, 0.6))"}:void 0})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:`sidebar-item-label font-medium text-xs truncate ${p("/settings")?"text-white":"text-white/82"}`,children:"Paramètres"}),e.jsx("div",{className:`sidebar-item-subtitle text-xxs truncate mt-0 ${p("/settings")?"text-white/70":"text-white/50"}`,children:"Configuration"})]})]})]}),e.jsx("div",{className:"sidebar-category-separator my-2"}),e.jsxs("button",{onClick:u,className:"sidebar-item group focus-ring text-white/70 hover:text-white w-full",style:{"--item-circuit-color":"#EF4444"},children:[e.jsx("div",{className:"sidebar-item-icon-container",children:e.jsx(j,{Icon:f.LogOut,size:16,className:"sidebar-item-icon opacity-80 group-hover:opacity-100",style:{color:"#EF4444"}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"sidebar-item-label font-medium text-xs truncate text-white/82",children:"Déconnexion"}),e.jsx("div",{className:"sidebar-item-subtitle text-xxs truncate mt-0 text-white/50",children:"Se déconnecter"})]})]})]})]})})]})})});si.displayName="MobileDrawer";const ii=({width:a=85,height:t=70,className:r="",isHovered:s=!1})=>{const i=T.useId(),n=`forgeGrad-${i}`,c=`forgeGradHover-${i}`,l=`hammerGlow-${i}`;return e.jsxs("svg",{viewBox:"0 0 85 70",width:a,height:t,className:r,xmlns:"http://www.w3.org/2000/svg",style:{filter:s?"drop-shadow(0 0 12px rgba(253, 200, 48, 0.5))":"drop-shadow(0 0 6px rgba(247, 147, 30, 0.3))"},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:n,x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",style:{stopColor:"#FF6B35",stopOpacity:1}}),e.jsx("stop",{offset:"50%",style:{stopColor:"#F7931E",stopOpacity:1}}),e.jsx("stop",{offset:"100%",style:{stopColor:"#FDC830",stopOpacity:1}})]}),e.jsxs("linearGradient",{id:c,x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",style:{stopColor:"#FF8C00",stopOpacity:1}}),e.jsx("stop",{offset:"50%",style:{stopColor:"#FFA500",stopOpacity:1}}),e.jsx("stop",{offset:"100%",style:{stopColor:"#FFD700",stopOpacity:1}})]}),e.jsxs("filter",{id:l,children:[e.jsx("feGaussianBlur",{stdDeviation:"2.5",result:"coloredBlur"}),e.jsxs("feMerge",{children:[e.jsx("feMergeNode",{in:"coloredBlur"}),e.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),e.jsx("path",{d:"M 20 10 L 85 10 L 85 28 L 65 28 L 65 70 L 40 70 L 40 28 L 20 28 Z",fill:s?`url(#${c})`:`url(#${n})`,filter:`url(#${l})`,stroke:"rgba(15, 23, 42, 0.8)",strokeWidth:"2.5"}),e.jsx("path",{d:"M 23 13 L 82 13 L 82 25 L 65 25 L 65 67 L 40 67 L 40 25 L 23 25 Z",fill:"none",stroke:"rgba(255, 255, 255, 0.3)",strokeWidth:"1.5",opacity:"0.6"}),e.jsxs("circle",{cx:"80",cy:"18",r:"3",fill:"#FDC830",opacity:s?1:.9,children:[e.jsx("animate",{attributeName:"opacity",values:"0.4;1;0.4",dur:"1.5s",repeatCount:"indefinite"}),e.jsx("animate",{attributeName:"r",values:"2.5;3.5;2.5",dur:"1.5s",repeatCount:"indefinite"})]}),e.jsx("circle",{cx:"25",cy:"16",r:"2.5",fill:"#FF6B35",opacity:s?.9:.8,children:e.jsx("animate",{attributeName:"opacity",values:"0.3;0.9;0.3",dur:"2s",repeatCount:"indefinite"})}),e.jsx("circle",{cx:"75",cy:"24",r:"2",fill:"#FDC830",opacity:s?.8:.7,children:e.jsx("animate",{attributeName:"opacity",values:"0.3;0.8;0.3",dur:"1.8s",repeatCount:"indefinite"})}),e.jsx("circle",{cx:"52",cy:"12",r:"2.5",fill:"#F7931E",opacity:s?.9:.75,children:e.jsx("animate",{attributeName:"opacity",values:"0.4;0.9;0.4",dur:"2.2s",repeatCount:"indefinite"})})]})},qi=({variant:a="desktop",isHovered:t=!1,className:r=""})=>a==="desktop"?e.jsx("div",{className:`flex items-center ${r}`,style:{transition:"all 300ms ease-out",height:"100%"},children:e.jsxs("div",{style:{display:"inline-flex",alignItems:"baseline",gap:"0"},children:[e.jsx("span",{style:{fontFamily:"'Montserrat', sans-serif",fontSize:"25px",fontWeight:800,letterSpacing:"1.2px",color:"#E5E7EB",lineHeight:1,textTransform:"uppercase",filter:t?"drop-shadow(0 0 8px rgba(255, 255, 255, 0.3))":"drop-shadow(0 0 4px rgba(255, 255, 255, 0.15))",transition:"filter 300ms ease"},children:"TWIN"}),e.jsx("span",{style:{fontFamily:"'Montserrat', sans-serif",fontSize:"25px",fontWeight:800,letterSpacing:"1.2px",background:"linear-gradient(135deg, #FF6B35 0%, #F7931E 50%, #FDC830 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",lineHeight:1,textTransform:"uppercase",filter:t?"drop-shadow(0 0 12px rgba(253, 200, 48, 0.5))":"drop-shadow(0 0 6px rgba(247, 147, 30, 0.3))",transition:"filter 300ms ease"},children:"FØRGE"})]})}):e.jsxs("div",{className:`flex items-center ${r}`,style:{transition:"all 300ms ease-out",gap:"8px",position:"relative"},children:[e.jsx("div",{style:{position:"relative",display:"flex",alignItems:"center"},children:e.jsx(ii,{width:42,height:50,isHovered:t})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px",alignItems:"flex-start",justifyContent:"center",transform:"translateY(2px)"},children:[e.jsx("span",{style:{fontFamily:"'Montserrat', sans-serif",fontSize:"15px",fontWeight:800,letterSpacing:"0.8px",color:"#E5E7EB",lineHeight:1,textTransform:"uppercase",filter:t?"drop-shadow(0 0 6px rgba(255, 255, 255, 0.3))":"drop-shadow(0 0 3px rgba(255, 255, 255, 0.15))",transition:"filter 300ms ease"},children:"TWIN"}),e.jsx("span",{style:{fontFamily:"'Montserrat', sans-serif",fontSize:"15px",fontWeight:800,letterSpacing:"0.8px",background:"linear-gradient(135deg, #FF6B35 0%, #F7931E 50%, #FDC830 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",lineHeight:1,textTransform:"uppercase",filter:t?"drop-shadow(0 0 10px rgba(253, 200, 48, 0.4))":"drop-shadow(0 0 5px rgba(247, 147, 30, 0.25))",transition:"filter 300ms ease"},children:"FØRGE"})]})]}),Ui=({className:a="",showOnHome:t=!1})=>{const r=Y(),s=se(),{click:i}=_(),n=T.useMemo(()=>s.pathname==="/"&&!t?!1:s.pathname!=="/",[s.pathname,t]),c=T.useCallback(()=>{try{i(),w.debug("BACK_BUTTON","Back navigation triggered",{currentPath:s.pathname,timestamp:new Date().toISOString()}),r(-1)}catch(l){w.warn("BACK_BUTTON","Back navigation failed, redirecting to home",{error:l instanceof Error?l.message:"Unknown error",currentPath:s.pathname}),r("/")}},[r,s.pathname,i]);return n?e.jsx(h.button,{onClick:c,className:a,style:{width:"48px",height:"48px",borderRadius:"50%",position:"relative",overflow:"visible",padding:0,display:"flex",alignItems:"center",justifyContent:"center",background:`
          radial-gradient(circle at 30% 30%, rgba(255,255,255,0.18) 0%, transparent 50%),
          rgba(255, 255, 255, 0.10)
        `,border:"1px solid rgba(255,255,255,0.2)",backdropFilter:"blur(16px) saturate(140%)",WebkitBackdropFilter:"blur(16px) saturate(140%)",boxShadow:`
          0 8px 24px rgba(0, 0, 0, 0.25),
          0 2px 12px rgba(0, 0, 0, 0.18),
          inset 0 1px 0 rgba(255, 255, 255, 0.12)
        `,transition:"transform 280ms cubic-bezier(0.25, 0.1, 0.25, 1), background 180ms cubic-bezier(0.16, 1, 0.3, 1), box-shadow 180ms cubic-bezier(0.16, 1, 0.3, 1), border-color 180ms cubic-bezier(0.16, 1, 0.3, 1)",transform:"translateZ(0)",willChange:"transform, filter",cursor:"pointer"},onMouseEnter:l=>{window.matchMedia("(hover: hover)").matches&&(l.currentTarget.style.background=`
            radial-gradient(circle at 30% 30%, rgba(255,255,255,0.25) 0%, transparent 60%),
            rgba(255, 255, 255, 0.10)
          `,l.currentTarget.style.borderColor="rgba(255,255,255,0.3)",l.currentTarget.style.boxShadow=`
            0 8px 24px rgba(0, 0, 0, 0.25),
            0 2px 12px rgba(0, 0, 0, 0.18),
            inset 0 1px 0 rgba(255, 255, 255, 0.12),
            0 0 20px rgba(255,255,255,0.15),
            0 4px 16px rgba(0,0,0,0.2)
          `)},onMouseLeave:l=>{window.matchMedia("(hover: hover)").matches&&(l.currentTarget.style.background=`
            radial-gradient(circle at 30% 30%, rgba(255,255,255,0.18) 0%, transparent 50%),
            rgba(255, 255, 255, 0.10)
          `,l.currentTarget.style.borderColor="rgba(255,255,255,0.2)",l.currentTarget.style.boxShadow=`
            0 8px 24px rgba(0, 0, 0, 0.25),
            0 2px 12px rgba(0, 0, 0, 0.18),
            inset 0 1px 0 rgba(255, 255, 255, 0.12)
          `)},whileHover:{scale:1.08},whileTap:{scale:.95},initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},transition:{duration:.3,ease:[.25,.1,.25,1]},"aria-label":"Retour à la page précédente",title:"Retour",children:e.jsx(j,{Icon:f.ArrowLeft,size:18,style:{color:"rgba(255,255,255,0.9)",filter:"drop-shadow(0 0 8px rgba(24, 227, 255, 0.3))"},"aria-hidden":"true"})}):null},Vi=()=>{const{isOpen:a,title:t,message:r,processName:s,dirtyFields:i,confirmExit:n,cancelExit:c,saveAndExit:l,onSaveAndExit:p}=Ls(),{click:m,error:x,success:u}=_(),[o,b]=T.useState(!1);T.useEffect(()=>{a&&console.log("🚨 GLOBAL_EXIT_MODAL: Rendering modal immediately",{isOpen:a,title:t,processName:s,timestamp:new Date().toISOString(),bodyExists:!!document.body,modalRootExists:!!document.getElementById("modal-root")})},[a,t,s]);const d=()=>{console.log("🚨 GLOBAL_EXIT_MODAL: Confirm clicked",{timestamp:new Date().toISOString()}),x(),n()},g=()=>{console.log("🚨 GLOBAL_EXIT_MODAL: Cancel clicked",{timestamp:new Date().toISOString()}),m(),c()},C=async()=>{console.log("🚨 GLOBAL_EXIT_MODAL: Save and exit clicked",{timestamp:new Date().toISOString()}),b(!0);try{await l(),u()}catch(v){console.error("🚨 GLOBAL_EXIT_MODAL: Save failed",v),x()}finally{b(!1)}};return T.useEffect(()=>{if(!a)return;const v=y=>{y.key==="Escape"&&g()};return document.addEventListener("keydown",v),()=>document.removeEventListener("keydown",v)},[a]),le.createPortal(e.jsx(z,{children:a&&e.jsx("div",{className:"global-exit-modal",style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:999999,background:"rgba(0, 0, 0, 0.9)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem"},onClick:v=>{v.target===v.currentTarget&&g()},role:"dialog","aria-modal":"true","aria-labelledby":"global-exit-modal-title",children:e.jsx(h.div,{initial:{opacity:0,scale:.8,y:50},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.8,y:50},transition:{type:"spring",stiffness:400,damping:25,mass:.8},className:"p-4 md:p-8 text-center",style:{width:"100%",maxWidth:"28rem",position:"relative",zIndex:1e6},onClick:v=>v.stopPropagation(),children:e.jsxs(B,{className:"p-8 text-center",style:{background:`
                  radial-gradient(circle at 30% 20%, color-mix(in srgb, #EF4444 20%, transparent) 0%, transparent 60%),
                  radial-gradient(circle at 70% 80%, color-mix(in srgb, #F59E0B 15%, transparent) 0%, transparent 50%),
                  linear-gradient(145deg, rgba(255,255,255,0.15), rgba(255,255,255,0.10)),
                  rgba(11, 14, 23, 0.95)
                `,borderColor:"color-mix(in srgb, #EF4444 40%, transparent)",boxShadow:`
                  0 25px 80px rgba(0, 0, 0, 0.6),
                  0 0 60px color-mix(in srgb, #EF4444 30%, transparent),
                  0 0 120px color-mix(in srgb, #F59E0B 20%, transparent),
                  inset 0 3px 0 rgba(255, 255, 255, 0.3),
                  inset 0 -3px 0 rgba(0, 0, 0, 0.2)
                `,backdropFilter:"blur(32px) saturate(180%)",WebkitBackdropFilter:"blur(32px) saturate(180%)",position:"relative",zIndex:1000001},children:[e.jsx("div",{className:"mb-4 md:mb-6",children:e.jsx("div",{className:"w-28 h-28 md:w-32 md:h-32 mx-auto rounded-full flex items-center justify-center breathing-icon",style:{background:`
                      radial-gradient(circle at 30% 30%, rgba(255,255,255,0.3) 0%, transparent 60%),
                      radial-gradient(circle at 70% 70%, color-mix(in srgb, #EF4444 25%, transparent) 0%, transparent 50%),
                      linear-gradient(135deg, color-mix(in srgb, #EF4444 50%, transparent), color-mix(in srgb, #F59E0B 40%, transparent))
                    `,border:"4px solid color-mix(in srgb, #EF4444 80%, transparent)",boxShadow:`
                      0 0 50px color-mix(in srgb, #EF4444 80%, transparent),
                      0 0 100px color-mix(in srgb, #EF4444 60%, transparent),
                      0 0 150px color-mix(in srgb, #F59E0B 50%, transparent),
                      inset 0 4px 0 rgba(255,255,255,0.6),
                      inset 0 -3px 0 rgba(0,0,0,0.3)
                    `,backdropFilter:"blur(24px) saturate(180%)",WebkitBackdropFilter:"blur(24px) saturate(180%)"},children:e.jsx(j,{Icon:f.AlertTriangle,size:window.innerWidth<768?64:72,style:{color:"#EF4444",filter:`
                        drop-shadow(0 0 16px color-mix(in srgb, #EF4444 100%, transparent))
                        drop-shadow(0 0 32px color-mix(in srgb, #EF4444 80%, transparent))
                        drop-shadow(0 0 48px color-mix(in srgb, #F59E0B 60%, transparent))
                      `},variant:"pure"})})}),e.jsxs("div",{className:"space-y-3 md:space-y-4 mb-6 md:mb-8",children:[e.jsx("h2",{id:"global-exit-modal-title",className:"text-xl md:text-3xl font-bold text-white leading-tight",children:t}),e.jsx("p",{className:"text-white/90 text-sm md:text-lg leading-relaxed max-w-sm mx-auto px-2",children:r}),e.jsxs("div",{className:"inline-flex items-center gap-2 md:gap-3 px-4 md:px-6 py-2 md:py-3 rounded-full",style:{background:"color-mix(in srgb, #F59E0B 20%, transparent)",border:"2px solid color-mix(in srgb, #F59E0B 40%, transparent)",backdropFilter:"blur(16px) saturate(140%)"},children:[e.jsx("div",{className:"w-2 h-2 md:w-3 md:h-3 rounded-full bg-orange-400 animate-pulse"}),e.jsxs("span",{className:"text-orange-300 text-sm md:text-base font-bold",children:[s," Actif"]})]}),i&&i.length>0&&e.jsxs("div",{className:"mt-4 p-4 rounded-xl",style:{background:"color-mix(in srgb, #3B82F6 15%, transparent)",border:"2px solid color-mix(in srgb, #3B82F6 30%, transparent)",backdropFilter:"blur(16px)"},children:[e.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[e.jsx(j,{Icon:f.AlertCircle,size:16,className:"text-blue-400 mt-0.5"}),e.jsx("h4",{className:"text-blue-300 font-semibold text-sm",children:"Champs non sauvegardés :"})]}),e.jsx("div",{className:"space-y-2 text-left",children:i.map((v,y)=>e.jsxs("div",{className:"text-blue-200 text-sm",children:[e.jsx("span",{className:"font-medium text-blue-300",children:v.section}),v.fields&&v.fields.length>0&&e.jsxs("span",{className:"text-blue-200/80",children:[" : ",v.fields.join(", ")]})]},y))})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-3 md:gap-4 justify-center",children:[p&&e.jsx("button",{onClick:C,disabled:o,className:"w-full md:w-auto px-6 md:px-8 py-3 md:py-4 text-base md:text-xl font-bold rounded-full relative overflow-hidden",style:{background:`linear-gradient(135deg,
                        color-mix(in srgb, #3B82F6 85%, transparent),
                        color-mix(in srgb, #60A5FA 70%, transparent)
                      )`,border:"3px solid color-mix(in srgb, #3B82F6 70%, transparent)",boxShadow:`
                        0 16px 50px color-mix(in srgb, #3B82F6 50%, transparent),
                        0 0 80px color-mix(in srgb, #3B82F6 40%, transparent),
                        inset 0 4px 0 rgba(255,255,255,0.5)
                      `,backdropFilter:"blur(24px) saturate(170%)",color:"#fff",transition:"all 0.2s ease",opacity:o?.6:1,cursor:o?"not-allowed":"pointer"},children:e.jsxs("div",{className:"flex items-center justify-center gap-2 md:gap-3",children:[e.jsx(j,{Icon:o?f.Loader2:f.Save,size:window.innerWidth<768?18:24,className:o?"text-white animate-spin":"text-white"}),e.jsx("span",{children:o?"Sauvegarde...":"Sauvegarder et Quitter"})]})}),e.jsx("button",{onClick:d,disabled:o,className:"w-full md:w-auto px-6 md:px-8 py-3 md:py-4 text-base md:text-xl font-bold rounded-full relative overflow-hidden",style:{background:`linear-gradient(135deg, 
                      color-mix(in srgb, #EF4444 85%, transparent), 
                      color-mix(in srgb, #F59E0B 70%, transparent)
                    )`,border:"3px solid color-mix(in srgb, #EF4444 70%, transparent)",boxShadow:`
                      0 16px 50px color-mix(in srgb, #EF4444 50%, transparent),
                      0 0 80px color-mix(in srgb, #EF4444 40%, transparent),
                      inset 0 4px 0 rgba(255,255,255,0.5)
                    `,backdropFilter:"blur(24px) saturate(170%)",color:"#fff",transition:"all 0.2s ease",opacity:o?.5:1,cursor:o?"not-allowed":"pointer"},children:e.jsxs("div",{className:"flex items-center justify-center gap-2 md:gap-3",children:[e.jsx(j,{Icon:f.LogOut,size:window.innerWidth<768?18:24,className:"text-white"}),e.jsx("span",{children:"Quitter"})]})}),e.jsx("button",{onClick:g,disabled:o,className:"w-full md:w-auto px-6 md:px-8 py-3 md:py-4 text-base md:text-xl font-bold rounded-full",style:{background:`linear-gradient(135deg, 
                      color-mix(in srgb, #22C55E 80%, transparent), 
                      color-mix(in srgb, #10B981 60%, transparent)
                    )`,border:"3px solid color-mix(in srgb, #22C55E 70%, transparent)",boxShadow:`
                      0 16px 50px color-mix(in srgb, #22C55E 50%, transparent),
                      0 0 80px color-mix(in srgb, #22C55E 40%, transparent),
                      inset 0 4px 0 rgba(255,255,255,0.5)
                    `,backdropFilter:"blur(24px) saturate(170%)",color:"#fff",opacity:o?.5:1,cursor:o?"not-allowed":"pointer"},children:e.jsxs("div",{className:"flex items-center justify-center gap-2 md:gap-3",children:[e.jsx(j,{Icon:f.ArrowLeft,size:window.innerWidth<768?18:24,className:"text-white"}),e.jsx("span",{children:"Continuer"})]})})]})]})})})}),document.body)},ni=({content:a,title:t,examples:r=[],learnMoreUrl:s,placement:i="top",children:n,delay:c=300,maxWidth:l=320})=>{const[p,m]=N.useState(!1),[x,u]=N.useState({top:0,left:0}),o=N.useRef(null),b=N.useRef(null),d=N.useRef(),g=()=>{d.current=setTimeout(()=>{m(!0)},c)},C=()=>{d.current&&clearTimeout(d.current),m(!1)};N.useEffect(()=>{if(p&&o.current&&b.current){const y=o.current.getBoundingClientRect(),k=b.current.getBoundingClientRect();let I=0,E=0;switch(i){case"top":I=y.top-k.height-8,E=y.left+(y.width-k.width)/2;break;case"bottom":I=y.bottom+8,E=y.left+(y.width-k.width)/2;break;case"left":I=y.top+(y.height-k.height)/2,E=y.left-k.width-8;break;case"right":I=y.top+(y.height-k.height)/2,E=y.right+8;break}const F=8;I=Math.max(F,Math.min(I,window.innerHeight-k.height-F)),E=Math.max(F,Math.min(E,window.innerWidth-k.width-F)),u({top:I,left:E})}},[p,i]);const v=e.jsx(z,{children:p&&e.jsx(h.div,{ref:b,initial:{opacity:0,scale:.95,y:i==="top"?10:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:i==="top"?10:-10},transition:{duration:.2,ease:"easeOut"},style:{position:"fixed",top:x.top,left:x.left,zIndex:9999,maxWidth:l,pointerEvents:"none"},children:e.jsxs(B,{className:"p-4 shadow-2xl",style:{background:"rgba(20, 20, 30, 0.95)",borderColor:"rgba(255, 255, 255, 0.15)",backdropFilter:"blur(20px) saturate(180%)",boxShadow:`
                0 20px 60px rgba(0, 0, 0, 0.5),
                0 0 30px rgba(255, 255, 255, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.1)
              `},children:[t&&e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(j,{Icon:f.Info,size:16,className:"text-blue-400"}),e.jsx("h4",{className:"text-white font-semibold text-sm",children:t})]}),e.jsx("div",{className:"text-white/80 text-sm leading-relaxed mb-3",children:a}),r.length>0&&e.jsxs("div",{className:"mt-3 p-3 rounded-lg bg-white/5 border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[e.jsx(j,{Icon:f.Lightbulb,size:14,className:"text-yellow-400"}),e.jsx("span",{className:"text-yellow-300 text-xs font-medium",children:"Exemples"})]}),e.jsx("ul",{className:"space-y-1",children:r.map((y,k)=>e.jsxs("li",{className:"text-white/70 text-xs flex items-start gap-2",children:[e.jsx("span",{className:"text-yellow-400 mt-0.5",children:"•"}),e.jsx("span",{children:y})]},k))})]}),s&&e.jsxs("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1.5 mt-3 text-blue-400 hover:text-blue-300 text-xs font-medium transition-colors pointer-events-auto",children:[e.jsx("span",{children:"En savoir plus"}),e.jsx(j,{Icon:f.ExternalLink,size:12})]}),e.jsx("div",{className:"absolute w-3 h-3 bg-inherit border-inherit",style:{[i==="top"?"bottom":i==="bottom"?"top":i==="left"?"right":"left"]:-6,[i==="top"||i==="bottom"?"left":"top"]:"50%",transform:"translate(-50%, 0) rotate(45deg)",borderWidth:i==="top"?"0 1px 1px 0":i==="bottom"?"1px 0 0 1px":i==="left"?"1px 1px 0 0":"0 0 1px 1px"}})]})})});return e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:o,onMouseEnter:g,onMouseLeave:C,onFocus:g,onBlur:C,style:{display:"inline-block"},children:n}),typeof document<"u"&&le.createPortal(v,document.body)]})},Ie=({buttonRef:a})=>{const{currentNotification:t,open:r,hideNotification:s}=V(),{click:i}=_(),n=N.useRef(null),c=()=>{i(),Z.press(),s(),r(t?.mode)};N.useEffect(()=>{if(!t?.isVisible)return;const u=o=>{const b=o.target,d=n.current?.contains(b),g=a.current?.contains(b);!d&&!g&&s()};return document.addEventListener("mousedown",u),document.addEventListener("touchstart",u),()=>{document.removeEventListener("mousedown",u),document.removeEventListener("touchstart",u)}},[t?.isVisible,s]);const[l,p]=N.useState(typeof window<"u"?window.innerWidth>=1025:!1);N.useEffect(()=>{const u=()=>{p(window.innerWidth>=1025)};return window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]);const[m,x]=N.useState({position:"fixed"});return N.useEffect(()=>{if(!l||!t?.isVisible)return;const u=()=>{if(a?.current&&n?.current){const o=a.current.getBoundingClientRect(),b=n.current.getBoundingClientRect(),d=320,g=8;o.width;const C=o.height,v=b.height||56,y=window.innerWidth-o.left+g,I=o.top+C/2-v/2;x({position:"fixed",right:`${y}px`,top:`${I}px`,transform:"none",width:`${d}px`,maxWidth:`${d}px`})}else x({position:"fixed",bottom:"24px",right:"92px",transform:"none",width:"320px",maxWidth:"320px"})};return setTimeout(u,0),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[l,t?.isVisible,a]),N.useEffect(()=>{l||x({position:"fixed"})},[l]),e.jsx(z,{children:t?.isVisible&&e.jsx(h.div,{ref:n,className:`chat-notification-bubble ${l?"chat-notification-bubble--desktop":"chat-notification-bubble--mobile"}`,style:m,initial:l?{x:-40,opacity:0,scale:.85}:{y:40,opacity:0,scale:.95},animate:l?{x:0,opacity:1,scale:1}:{y:0,opacity:1,scale:1},exit:l?{x:-40,opacity:0,scale:.85}:{y:40,opacity:0,scale:.95},transition:{type:"spring",stiffness:320,damping:28,mass:.8},onClick:c,role:"button",tabIndex:0,"aria-label":t.message,onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),c())},children:e.jsxs("div",{className:"chat-notification-bubble__message",children:[e.jsx("div",{className:"chat-notification-bubble__icon",children:e.jsx(j,{Icon:f.MessageSquare,size:l?16:18,style:{color:"#18E3FF",filter:"drop-shadow(0 0 8px rgba(24, 227, 255, 0.4))"}})}),e.jsx("span",{children:t.message})]})})})},Te="twinforge-chat-notifications-seen",Ee=3;class oi{constructor(){U(this,"state");this.state=this.loadState()}loadState(){try{const t=localStorage.getItem(Te);if(t)return JSON.parse(t)}catch(t){console.warn("Failed to load notification state from localStorage:",t)}return{}}saveState(){try{localStorage.setItem(Te,JSON.stringify(this.state))}catch(t){console.warn("Failed to save notification state to localStorage:",t)}}hasSeen(t){const r=this.state[t];return r?r.seen&&r.viewCount>=Ee:!1}markAsSeen(t){const r=new Date().toISOString();this.state[t]?(this.state[t].seen=!0,this.state[t].lastSeenAt=r,this.state[t].viewCount+=1):this.state[t]={seen:!0,firstSeenAt:r,lastSeenAt:r,viewCount:1},this.saveState()}getViewCount(t){return this.state[t]?.viewCount||0}shouldShow(t){return this.getViewCount(t)<Ee}reset(t){t?delete this.state[t]:this.state={},this.saveState()}resetAll(){this.state={},this.saveState()}}const ae=new oi,li={"step1-welcome":"Salut ! Je suis là si tu as besoin 👋","step2-adjust":"Besoin d'ajuster ton programme ? Je suis là !","training-intro":"Prêt pour ta séance ? Clique pour commencer !","nutrition-intro":"Un conseil nutrition ? Je suis disponible !","fasting-intro":"Ton coach jeûne est là pour t'accompagner !"},oe={appearance:2e3,duration:3e3};class ci{constructor(){U(this,"timeoutId",null);U(this,"hasShownNotification",new Set)}getNotificationForMode(t,r){if(r==="step1")return"step1-welcome";if(r==="step2")return"step2-adjust";switch(t){case"training":return"training-intro";case"nutrition":return"nutrition-intro";case"fasting":return"fasting-intro";default:return"step1-welcome"}}shouldShowNotification(t){if(this.hasShownNotification.has(t))return!1;if(!ae.shouldShow(t))return w.debug("CHAT_NOTIFICATION","Notification already seen max times",{notificationId:t,viewCount:ae.getViewCount(t)}),!1;const{isOpen:r}=V.getState();return!r}scheduleNotification(t,r){const s=this.getNotificationForMode(t,r);this.shouldShowNotification(s)&&(this.clearScheduledNotification(),this.timeoutId=setTimeout(()=>{this.showNotification(s,t)},oe.appearance),w.debug("CHAT_NOTIFICATION","Notification scheduled",{notificationId:s,mode:t,stepId:r,delayMs:oe.appearance}))}showNotification(t,r){const{showNotification:s,addMessage:i}=V.getState(),n=li[t],c={id:t,message:n,mode:r,autoHideDelay:oe.duration};s(c),this.hasShownNotification.add(t),ae.markAsSeen(t),i({role:"coach",type:"text",content:n}),w.info("CHAT_NOTIFICATION","Notification shown",{notificationId:t,mode:r,message:n}),this.timeoutId=setTimeout(()=>{this.hideNotification(t)},oe.duration)}hideNotification(t){const{hideNotification:r,currentNotification:s}=V.getState();s&&(t&&s.id!==t||(r(),w.debug("CHAT_NOTIFICATION","Notification hidden",{notificationId:s.id})))}clearScheduledNotification(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}resetNotificationHistory(t){t?(this.hasShownNotification.delete(t),ae.reset(t)):(this.hasShownNotification.clear(),ae.resetAll()),w.info("CHAT_NOTIFICATION","Notification history reset",{notificationId:t||"all"})}cleanup(){this.clearScheduledNotification(),this.hasShownNotification.clear(),w.debug("CHAT_NOTIFICATION","Service cleaned up")}}const X=new ci,di=T.forwardRef(({className:a=""},t)=>{const r=se(),{isOpen:s,toggle:i,currentMode:n,modeConfigs:c,hasUnreadMessages:l,unreadCount:p,isInStep2:m}=V(),{click:x}=_(),[u,o]=N.useState(typeof window<"u"?window.innerWidth>=1025:!1),b=N.useRef(null),d=t||b,g=m||r.pathname.includes("/pipeline/step-2");N.useEffect(()=>{const I=()=>{o(window.innerWidth>=1025)};return window.addEventListener("resize",I),()=>window.removeEventListener("resize",I)},[]),N.useEffect(()=>{if(!s)return r.pathname.includes("/pipeline/step-2")?X.scheduleNotification(n,"step2"):r.pathname.includes("/training")?X.scheduleNotification("training","step1"):r.pathname.includes("/meals")||r.pathname.includes("/fridge")?X.scheduleNotification("nutrition"):r.pathname.includes("/fasting")?X.scheduleNotification("fasting"):X.scheduleNotification("general","step1"),()=>{X.clearScheduledNotification()}},[r.pathname,s,n]);const v=c[n].color,y=()=>{x(),Z.press(),i()},k=e.jsxs(h.button,{ref:I=>{typeof t=="function"?t(I):t&&(t.current=I),b&&(b.current=I)},onClick:y,className:`floating-chat-button ${g?"floating-chat-button--step2":""} ${a}`,style:{position:"fixed",right:s&&!u?"-100px":u?"24px":"8px",bottom:u?"24px":"calc(var(--new-bottom-bar-height) + var(--new-bottom-bar-bottom-offset) + 8px)",zIndex:Me.FLOATING_CHAT_BUTTON,borderRadius:"50%",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center",padding:"0",isolation:"isolate",width:u?"60px":"56px",height:u?"60px":"56px",background:l?`
              radial-gradient(circle at 30% 30%, color-mix(in srgb, ${v} 30%, transparent) 0%, transparent 50%),
              radial-gradient(circle at 70% 70%, rgba(255,255,255,0.25) 0%, transparent 60%),
              var(--liquid-pill-bg)
            `:`
              radial-gradient(circle at 30% 30%, rgba(255,255,255,0.20) 0%, transparent 50%),
              var(--liquid-pill-bg)
            `,border:l?`1.5px solid color-mix(in srgb, ${v} 40%, transparent)`:"1.5px solid rgba(255,255,255,0.22)",backdropFilter:"blur(var(--liquid-pill-blur)) saturate(var(--liquid-pill-saturate))",WebkitBackdropFilter:"blur(var(--liquid-pill-blur)) saturate(var(--liquid-pill-saturate))",boxShadow:l?`
              var(--liquid-pill-shadow),
              0 0 40px color-mix(in srgb, ${v} 30%, transparent),
              0 0 60px color-mix(in srgb, ${v} 15%, transparent)
            `:`
              var(--liquid-pill-shadow),
              0 0 32px color-mix(in srgb, ${v} 15%, transparent)
            `,cursor:"pointer",transition:"right 400ms cubic-bezier(0.25, 0.1, 0.25, 1), transform var(--liquid-transition-medium), background var(--liquid-transition-fast), box-shadow var(--liquid-transition-fast), border-color var(--liquid-transition-fast)",willChange:"right, transform, filter",transform:"translateZ(0)"},initial:!1,whileHover:{scale:1.08,boxShadow:`
          var(--liquid-pill-shadow),
          0 0 48px color-mix(in srgb, ${v} 25%, transparent),
          0 4px 20px rgba(0, 0, 0, 0.3)
        `,transition:{duration:.25,ease:[.16,1,.3,1]}},whileTap:{scale:.92,transition:{duration:.15}},"aria-label":s?"Fermer le chat":"Ouvrir le chat","aria-expanded":s,children:[e.jsx("div",{style:{position:"absolute",top:"2px",left:"2px",right:"50%",bottom:"50%",borderRadius:"inherit",background:"radial-gradient(circle at 20% 20%, rgba(255,255,255,0.4) 0%, transparent 60%)",opacity:.6,pointerEvents:"none"}}),e.jsx(h.div,{animate:{rotate:s?180:0},transition:{duration:.3},className:"button-icon",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(j,{Icon:f.MessageSquare,size:u?28:24,style:{color:v,filter:g?"drop-shadow(0 0 16px rgba(59, 130, 246, 0.8))":`drop-shadow(0 0 14px color-mix(in srgb, ${v} 60%, transparent))`}})}),e.jsx(z,{children:!s&&(l&&p>0||g)&&e.jsx(h.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},className:g&&!l?"floating-chat-button--step2-notification":"floating-chat-badge",title:g&&!l?"Ton coach t'attend pour ajuster ta séance !":void 0,style:g&&!l?{}:{position:"absolute",minWidth:"20px",height:"20px",padding:"0 6px",borderRadius:"10px",background:`
                radial-gradient(circle at 30% 30%, ${v} 0%, color-mix(in srgb, ${v} 80%, #000) 100%)
              `,border:"2px solid rgba(11, 14, 23, 0.9)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"11px",fontWeight:"bold",color:"white",boxShadow:`
                0 0 16px color-mix(in srgb, ${v} 60%, transparent),
                0 2px 8px rgba(0, 0, 0, 0.4)
              `},children:g?"!":p>9?"9+":p})})]});return g&&!s?e.jsxs(e.Fragment,{children:[e.jsx(ni,{content:"Ton coach t'attend pour ajuster ta séance ! Clique pour ouvrir le chat.",title:"Ajuste ton programme",placement:"left",delay:500,maxWidth:280,children:k}),e.jsx(Ie,{buttonRef:d})]}):e.jsxs(e.Fragment,{children:[k,e.jsx(Ie,{buttonRef:d})]})});di.displayName="FloatingChatButton";const xe=({message:a,stepColor:t,showCTA:r=!1,ctaButtons:s=[],onCTAClick:i})=>{const{currentMode:n}=V(),c=n==="training",l=a.role==="coach";return a.role==="system"?e.jsx(h.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"flex justify-center my-4",children:e.jsxs("div",{className:"system-message px-4 py-2 rounded-full bg-white/5 border border-white/10 text-xs text-white/60 flex items-center gap-2",children:[e.jsx(j,{Icon:f.Info,size:12}),a.content]})}):e.jsx(h.div,{initial:{opacity:0,y:10,x:l?-10:10},animate:{opacity:1,y:0,x:0},transition:{duration:.3,ease:"easeOut"},className:`flex ${l?"justify-start":"justify-end"} mb-4`,children:e.jsxs("div",{className:`flex flex-col gap-2 ${l?"items-start":"items-end"} max-w-[85%]`,children:[e.jsxs("div",{className:`flex ${l?"flex-row":"flex-row-reverse"} items-end gap-2`,children:[l&&e.jsx("div",{className:"message-avatar w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`
                  radial-gradient(circle at 30% 30%, color-mix(in srgb, ${t} 40%, transparent) 0%, transparent 70%),
                  rgba(255, 255, 255, 0.1)
                `,border:`1.5px solid color-mix(in srgb, ${t} 50%, transparent)`,boxShadow:`0 0 12px color-mix(in srgb, ${t} 30%, transparent)`},children:e.jsx(j,{Icon:f.Zap,size:16,style:{color:t,filter:`drop-shadow(0 0 8px color-mix(in srgb, ${t} 60%, transparent))`}})}),e.jsxs("div",{className:`coach-message-bubble ${l?"coach-message-bubble--coach":"coach-message-bubble--user"} ${l?"px-4":"px-5"} py-3 rounded-2xl relative`,style:{background:l?`
                    radial-gradient(circle at 30% 30%, color-mix(in srgb, ${t} 15%, transparent) 0%, transparent 70%),
                    rgba(255, 255, 255, 0.08)
                  `:"rgba(255, 255, 255, 0.12)",border:l?`1px solid color-mix(in srgb, ${t} 25%, transparent)`:"1px solid rgba(255, 255, 255, 0.2)",boxShadow:l?`
                    0 2px 8px rgba(0, 0, 0, 0.2),
                    0 0 16px color-mix(in srgb, ${t} 15%, transparent),
                    inset 0 1px 0 rgba(255, 255, 255, 0.1)
                  `:`
                    0 2px 8px rgba(0, 0, 0, 0.2),
                    inset 0 1px 0 rgba(255, 255, 255, 0.15)
                  `,backdropFilter:"blur(12px) saturate(140%)",WebkitBackdropFilter:"blur(12px) saturate(140%)",borderRadius:l?"4px 16px 16px 16px":"16px 4px 16px 16px"},children:[e.jsx("p",{className:"message-content-text text-sm text-white leading-relaxed",style:{wordBreak:"normal",overflowWrap:"break-word",whiteSpace:"pre-wrap",hyphens:"none",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none"},children:a.content}),a.type==="audio"&&e.jsxs("div",{className:"audio-message-indicator flex items-center gap-2 mt-2 pt-2 border-t border-white/10",children:[e.jsx(j,{Icon:f.Volume2,size:12,style:{color:"rgba(255,255,255,0.6)"}}),e.jsx("span",{className:"text-xs text-white/60",children:"Message vocal"})]}),e.jsx("div",{className:`message-timestamp text-[10px] text-white/40 mt-1 ${l?"text-left":"text-right"}`,children:new Date(a.timestamp).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})})]})]}),l&&r&&c&&s.length>0&&e.jsx("div",{className:"flex flex-col gap-2 pl-10 self-stretch",children:s.map((m,x)=>{const u=m.icon?f[m.icon]:null,o=m.variant==="primary";return e.jsxs(h.button,{onClick:()=>i?.(m.id),className:"flex items-center justify-center gap-2 py-2.5 px-4 rounded-xl font-medium text-sm",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:x*.1,type:"spring",stiffness:400,damping:17},whileHover:{scale:1.02,x:2},whileTap:{scale:.98},style:{background:o?`
                          radial-gradient(circle at 30% 30%, color-mix(in srgb, ${t} 25%, transparent) 0%, transparent 70%),
                          color-mix(in srgb, ${t} 18%, rgba(255, 255, 255, 0.08))
                        `:`
                          radial-gradient(circle at 50% 0%, rgba(255, 255, 255, 0.08) 0%, transparent 70%),
                          rgba(255, 255, 255, 0.05)
                        `,border:o?`1.5px solid color-mix(in srgb, ${t} 35%, transparent)`:"1px solid rgba(255, 255, 255, 0.12)",backdropFilter:"blur(10px)",boxShadow:o?`
                          0 2px 12px color-mix(in srgb, ${t} 20%, transparent),
                          inset 0 1px 0 rgba(255, 255, 255, 0.12)
                        `:"inset 0 1px 0 rgba(255, 255, 255, 0.08)",color:o?t:"rgba(255, 255, 255, 0.9)"},children:[u&&e.jsx(j,{Icon:u,size:14,style:{color:o?t:"rgba(255, 255, 255, 0.8)",filter:o?`drop-shadow(0 0 8px color-mix(in srgb, ${t} 50%, transparent))`:"none"}}),e.jsx("span",{children:m.label})]},m.id)})})]})})},pi=({exercises:a,programType:t,introText:r,onExerciseClick:s,stepColor:i})=>e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-white/90 text-[15px] leading-relaxed",children:r||"Parfait ! Voici les exercices de ta séance. Lequel souhaites-tu ajuster ?"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.map((n,c)=>e.jsxs(h.button,{onClick:()=>s(n.id,n.name),className:"exercise-chip",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:c*.05},whileHover:{scale:1.02},whileTap:{scale:.98},style:{padding:"12px 20px",background:"rgba(255, 255, 255, 0.08)",border:"1.5px solid rgba(255, 255, 255, 0.15)",borderRadius:"16px",backdropFilter:"blur(12px)",color:"white",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},children:[n.orderIndex,". ",n.name]},n.id))})]}),xi=[{id:"increase-sets",label:"+1 Série",icon:"Plus",color:"#10B981",category:"volume",action:"increase",description:"Ajouter une série supplémentaire",shortMessage:"J'aimerais ajouter une série supplémentaire"},{id:"decrease-sets",label:"-1 Série",icon:"Minus",color:"#F59E0B",category:"volume",action:"decrease",description:"Retirer une série",shortMessage:"J'aimerais retirer une série"},{id:"increase-reps",label:"+2 Reps",icon:"TrendingUp",color:"#22C55E",category:"volume",action:"increase",description:"Augmenter le nombre de répétitions",shortMessage:"J'aimerais faire plus de répétitions"},{id:"decrease-reps",label:"-2 Reps",icon:"TrendingDown",color:"#EF4444",category:"volume",action:"decrease",description:"Diminuer le nombre de répétitions",shortMessage:"J'aimerais faire moins de répétitions"},{id:"increase-load",label:"Charge +",icon:"ChevronUp",color:"#8B5CF6",category:"intensity",action:"increase",description:"Augmenter la charge",shortMessage:"C'est trop léger, je peux mettre plus lourd"},{id:"decrease-load",label:"Charge -",icon:"ChevronDown",color:"#EC4899",category:"intensity",action:"decrease",description:"Diminuer la charge",shortMessage:"C'est trop lourd, je dois alléger"},{id:"adjust-tempo",label:"Tempo",icon:"Timer",color:"#06B6D4",category:"technique",action:"modify",description:"Modifier le tempo d'exécution",shortMessage:"Je veux ajuster le tempo de cet exercice"},{id:"adjust-rest",label:"Repos",icon:"Clock",color:"#3B82F6",category:"timing",action:"modify",description:"Modifier le temps de repos",shortMessage:"Je voudrais ajuster le temps de repos"},{id:"increase-rest",label:"Repos +30s",icon:"PlusCircle",color:"#14B8A6",category:"timing",action:"increase",description:"Augmenter le temps de repos de 30 secondes",shortMessage:"J'ai besoin de plus de repos entre les séries"},{id:"decrease-rest",label:"Repos -30s",icon:"MinusCircle",color:"#F97316",category:"timing",action:"decrease",description:"Diminuer le temps de repos de 30 secondes",shortMessage:"Je peux réduire le temps de repos"},{id:"easier-variant",label:"Variante Facile",icon:"ArrowDown",color:"#84CC16",category:"substitution",action:"substitute",description:"Proposer une variante plus facile",shortMessage:"Cet exercice est trop difficile, tu as une variante plus facile ?"},{id:"harder-variant",label:"Variante Difficile",icon:"ArrowUp",color:"#DC2626",category:"substitution",action:"substitute",description:"Proposer une variante plus difficile",shortMessage:"Cet exercice est trop facile, tu as une variante plus difficile ?"},{id:"change-equipment",label:"Changer Équipement",icon:"Settings",color:"#6366F1",category:"equipment",action:"substitute",description:"Utiliser un autre équipement",shortMessage:"Je n'ai pas cet équipement, on peut adapter ?"},{id:"bodyweight-variant",label:"Poids Corps",icon:"User",color:"#A855F7",category:"equipment",action:"substitute",description:"Version au poids du corps",shortMessage:"Je préférerais une version au poids du corps"},{id:"technique-help",label:"Aide Technique",icon:"HelpCircle",color:"#0EA5E9",category:"technique",action:"info",description:"Obtenir des conseils techniques",shortMessage:"Je voudrais des conseils sur la technique de cet exercice"},{id:"substitute-exercise",label:"Autre Exercice",icon:"RefreshCw",color:"#F59E0B",category:"substitution",action:"substitute",description:"Remplacer complètement l'exercice",shortMessage:"Je voudrais remplacer cet exercice par un autre"}],ui=[{id:"volume",label:"Volume",icon:"BarChart3",color:"#10B981",description:"Séries et répétitions"},{id:"intensity",label:"Intensité",icon:"Zap",color:"#8B5CF6",description:"Charge et difficulté"},{id:"technique",label:"Technique",icon:"Target",color:"#06B6D4",description:"Exécution et tempo"},{id:"equipment",label:"Équipement",icon:"Wrench",color:"#6366F1",description:"Matériel utilisé"},{id:"substitution",label:"Substitution",icon:"Repeat",color:"#F59E0B",description:"Variantes et alternatives"},{id:"timing",label:"Timing",icon:"Clock",color:"#3B82F6",description:"Temps de repos"}],mi=({exerciseName:a,onCategorySelect:t,stepColor:r})=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-white/90 text-[15px] leading-relaxed",children:["Super ! Qu'est-ce que tu veux ajuster sur ",e.jsx("strong",{className:"text-white font-semibold",children:a})," ?"]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:ui.map((s,i)=>{const n=f[s.icon];return e.jsxs(h.button,{onClick:()=>t(s.id),className:"category-card",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:i*.06},whileHover:{scale:1.02,y:-2},whileTap:{scale:.98},style:{padding:"16px",background:`
                  radial-gradient(circle at 30% 30%, color-mix(in srgb, ${s.color} 12%, transparent) 0%, transparent 70%),
                  rgba(255, 255, 255, 0.06)
                `,border:`1.5px solid color-mix(in srgb, ${s.color} 30%, transparent)`,borderRadius:"16px",backdropFilter:"blur(12px)",boxShadow:`
                  0 2px 8px rgba(0, 0, 0, 0.15),
                  0 0 16px color-mix(in srgb, ${s.color} 10%, transparent)
                `,cursor:"pointer",position:"relative",overflow:"hidden"},children:[e.jsx("div",{className:"absolute inset-0 opacity-0 hover:opacity-100 transition-opacity",style:{background:`radial-gradient(circle at center, color-mix(in srgb, ${s.color} 20%, transparent) 0%, transparent 70%)`}}),e.jsxs("div",{className:"relative flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-xl flex-shrink-0",style:{background:`color-mix(in srgb, ${s.color} 20%, transparent)`,border:`1px solid color-mix(in srgb, ${s.color} 35%, transparent)`,boxShadow:`0 0 12px color-mix(in srgb, ${s.color} 15%, transparent)`},children:n&&e.jsx(j,{Icon:n,size:20,style:{color:s.color,filter:`drop-shadow(0 0 6px color-mix(in srgb, ${s.color} 40%, transparent))`}})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-semibold text-[14px] mb-1",style:{color:s.color,textShadow:`0 0 8px color-mix(in srgb, ${s.color} 25%, transparent)`},children:s.label}),e.jsx("div",{className:"text-white/60 text-[12px] leading-tight",children:s.description})]})]})]},s.id)})})]}),hi=({exerciseName:a,category:t,onOptionSelect:r,onBack:s,stepColor:i})=>{const n=xi.filter(c=>c.category===t);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(h.button,{onClick:s,className:"back-button p-2 rounded-full",whileHover:{scale:1.1},whileTap:{scale:.9},style:{background:"rgba(255, 255, 255, 0.08)",border:"1px solid rgba(255, 255, 255, 0.15)",backdropFilter:"blur(12px)"},children:e.jsx(j,{Icon:f.ArrowLeft,size:16,style:{color:"rgba(255,255,255,0.8)"}})}),e.jsxs("p",{className:"text-white/90 text-[15px] leading-relaxed flex-1",children:["Comment veux-tu ajuster ",e.jsx("strong",{className:"text-white font-semibold",children:a})," ?"]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:n.map((c,l)=>{const p=f[c.icon];return e.jsxs(h.button,{onClick:()=>r(c.id),className:"option-card",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:l*.05},whileHover:{scale:1.02,y:-2},whileTap:{scale:.98},style:{padding:"14px",background:`
                  radial-gradient(circle at 30% 20%, color-mix(in srgb, ${c.color} 10%, transparent) 0%, transparent 70%),
                  rgba(255, 255, 255, 0.06)
                `,border:`1.5px solid color-mix(in srgb, ${c.color} 25%, transparent)`,borderRadius:"14px",backdropFilter:"blur(12px)",boxShadow:`
                  0 2px 8px rgba(0, 0, 0, 0.12),
                  0 0 12px color-mix(in srgb, ${c.color} 8%, transparent)
                `,cursor:"pointer",textAlign:"left"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[p&&e.jsx("div",{className:"icon-container w-7 h-7 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`
                        radial-gradient(circle at 30% 30%, color-mix(in srgb, ${c.color} 25%, transparent) 0%, transparent 70%),
                        color-mix(in srgb, ${c.color} 15%, rgba(255, 255, 255, 0.08))
                      `,border:`1px solid color-mix(in srgb, ${c.color} 35%, transparent)`,boxShadow:`0 0 10px color-mix(in srgb, ${c.color} 20%, transparent)`},children:e.jsx(j,{Icon:p,size:14,style:{color:c.color,filter:`drop-shadow(0 0 6px color-mix(in srgb, ${c.color} 45%, transparent))`}})}),e.jsx("span",{className:"font-bold text-[13px]",style:{color:c.color,textShadow:`0 0 8px color-mix(in srgb, ${c.color} 25%, transparent)`},children:c.label})]}),e.jsx("p",{className:"text-[11px] text-white/70 leading-tight line-clamp-2 ml-9",children:c.description})]},c.id)})}),e.jsx("style",{children:`
        .line-clamp-2 {
          display: -webkit-box;
          -webkit-line-clamp: 2;
          -webkit-box-orient: vertical;
          overflow: hidden;
        }
      `})]})},gi=({exerciseName:a,adjustmentLabel:t,summary:r,onValidate:s,onModify:i,stepColor:n})=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-white/90 text-[15px] leading-relaxed",children:["Voici ce que je vais appliquer à ",e.jsx("strong",{className:"text-white font-semibold",children:a})," :"]}),e.jsxs(h.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"preview-box",style:{padding:"18px",background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, ${n} 12%, transparent) 0%, transparent 70%),
            rgba(255, 255, 255, 0.08)
          `,border:`1.5px solid color-mix(in srgb, ${n} 30%, transparent)`,borderRadius:"16px",backdropFilter:"blur(14px)",boxShadow:`
            0 2px 12px rgba(0, 0, 0, 0.2),
            0 0 20px color-mix(in srgb, ${n} 12%, transparent),
            inset 0 1px 0 rgba(255, 255, 255, 0.12)
          `},children:[e.jsx("div",{className:"text-[13px] mb-2 uppercase tracking-wide font-bold",style:{color:n,textShadow:`0 0 8px color-mix(in srgb, ${n} 30%, transparent)`},children:t}),e.jsx("div",{className:"text-white text-[15px] font-medium leading-relaxed",children:r})]}),e.jsx("p",{className:"text-white/80 text-[14px]",children:"Est-ce que ça te convient ? 💪"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(h.button,{onClick:s,whileHover:{scale:1.02,y:-1},whileTap:{scale:.98},className:"flex-1 flex items-center justify-center gap-2",style:{padding:"14px 24px",background:`
              linear-gradient(135deg, #10B981 0%, #059669 100%)
            `,border:"1.5px solid rgba(255, 255, 255, 0.25)",borderRadius:"14px",color:"white",fontSize:"15px",fontWeight:"700",cursor:"pointer",boxShadow:`
              0 4px 12px rgba(16, 185, 129, 0.25),
              0 0 20px rgba(16, 185, 129, 0.15),
              inset 0 1px 0 rgba(255, 255, 255, 0.2)
            `},children:[e.jsx(j,{Icon:f.Check,size:18,style:{filter:"drop-shadow(0 0 6px rgba(255,255,255,0.4))"}}),"Valider"]}),e.jsxs(h.button,{onClick:i,whileHover:{scale:1.02,y:-1},whileTap:{scale:.98},className:"flex-1 flex items-center justify-center gap-2",style:{padding:"14px 24px",background:`
              radial-gradient(circle at 30% 30%, rgba(251, 146, 60, 0.15) 0%, transparent 70%),
              rgba(255, 255, 255, 0.08)
            `,border:"1.5px solid rgba(251, 146, 60, 0.3)",borderRadius:"14px",color:"#FB923C",fontSize:"15px",fontWeight:"700",cursor:"pointer",boxShadow:`
              0 2px 8px rgba(0, 0, 0, 0.15),
              0 0 16px rgba(251, 146, 60, 0.12)
            `,backdropFilter:"blur(12px)"},children:[e.jsx(j,{Icon:f.RefreshCw,size:18,style:{color:"#FB923C",filter:"drop-shadow(0 0 6px rgba(251, 146, 60, 0.4))"}}),"Modifier"]})]})]}),bi=({exerciseName:a,newParameters:t,onViewExercise:r,onContinue:s,stepColor:i})=>{const n=()=>{const c=[];return t.sets&&c.push(`${t.sets} séries`),t.reps&&c.push(`${t.reps} reps`),t.load&&c.push(t.load),t.rest&&c.push(`${t.rest} repos`),t.tempo&&c.push(`tempo ${t.tempo}`),c.length>0?c.join(" • "):"Paramètres mis à jour"};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(h.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:200,damping:15},className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2.5 rounded-full flex-shrink-0",style:{background:`
              linear-gradient(135deg, #10B981 0%, #059669 100%)
            `,boxShadow:`
              0 4px 12px rgba(16, 185, 129, 0.3),
              0 0 20px rgba(16, 185, 129, 0.2),
              inset 0 1px 0 rgba(255, 255, 255, 0.25)
            `},children:e.jsx(j,{Icon:f.CheckCircle2,size:24,style:{color:"white",filter:"drop-shadow(0 0 8px rgba(255,255,255,0.5))"}})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-white font-bold text-[16px] mb-1",children:"Modification appliquée ! ✓"}),e.jsxs("div",{className:"text-white/70 text-[14px] leading-relaxed",children:[e.jsx("strong",{className:"text-white",children:a})," a été mis à jour"]})]})]}),e.jsxs(h.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"parameters-preview",style:{padding:"14px 16px",background:`
            radial-gradient(circle at 30% 20%, rgba(16, 185, 129, 0.12) 0%, transparent 70%),
            rgba(255, 255, 255, 0.06)
          `,border:"1.5px solid rgba(16, 185, 129, 0.25)",borderRadius:"12px",backdropFilter:"blur(12px)",boxShadow:`
            0 2px 8px rgba(0, 0, 0, 0.15),
            0 0 16px rgba(16, 185, 129, 0.1)
          `},children:[e.jsx("div",{className:"text-[12px] text-emerald-400 font-bold uppercase tracking-wide mb-1",children:"Nouveaux paramètres"}),e.jsx("div",{className:"text-white text-[13px] font-medium",children:n()})]}),e.jsx("p",{className:"text-white/80 text-[14px] leading-relaxed",children:"Regarde la carte mise à jour ou continue tes ajustements ! 💪"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(h.button,{onClick:r,whileHover:{scale:1.02,y:-1},whileTap:{scale:.98},className:"flex-1 flex items-center justify-center gap-2",style:{padding:"14px 20px",background:`
              radial-gradient(circle at 30% 30%, color-mix(in srgb, ${i} 18%, transparent) 0%, transparent 70%),
              rgba(255, 255, 255, 0.1)
            `,border:`1.5px solid color-mix(in srgb, ${i} 35%, transparent)`,borderRadius:"14px",fontSize:"15px",fontWeight:"700",cursor:"pointer",boxShadow:`
              0 2px 10px rgba(0, 0, 0, 0.15),
              0 0 18px color-mix(in srgb, ${i} 15%, transparent)
            `,backdropFilter:"blur(12px)"},children:[e.jsx(j,{Icon:f.Eye,size:18,style:{color:i,filter:`drop-shadow(0 0 6px color-mix(in srgb, ${i} 45%, transparent))`}}),e.jsx("span",{style:{color:i,textShadow:`0 0 8px color-mix(in srgb, ${i} 30%, transparent)`},children:"Voir l'exercice"})]}),e.jsxs(h.button,{onClick:s,whileHover:{scale:1.02,y:-1},whileTap:{scale:.98},className:"flex-1 flex items-center justify-center gap-2",style:{padding:"14px 20px",background:"rgba(255, 255, 255, 0.08)",border:"1.5px solid rgba(255, 255, 255, 0.18)",borderRadius:"14px",color:"white",fontSize:"15px",fontWeight:"700",cursor:"pointer",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.15)",backdropFilter:"blur(12px)"},children:[e.jsx(j,{Icon:f.ArrowRight,size:18,style:{filter:"drop-shadow(0 0 4px rgba(255,255,255,0.3))"}}),"Continuer"]})]})]})},fi=({message:a,stepColor:t,onExerciseClick:r,onCategorySelect:s,onOptionSelect:i,onValidate:n,onModify:c,onViewExercise:l,onContinue:p,onBack:m})=>{switch(a.type){case"exercise-list-intro":if(a.metadata?.exerciseListData&&r){const{exercises:x,programType:u,introText:o}=a.metadata.exerciseListData;return e.jsx(pi,{exercises:x,programType:u,introText:o,onExerciseClick:r,stepColor:t})}break;case"category-selection":if(a.metadata?.exerciseName&&s)return e.jsx(mi,{exerciseName:a.metadata.exerciseName,onCategorySelect:s,stepColor:t});break;case"option-selection":if(a.metadata?.exerciseName&&a.metadata?.category&&i&&m)return e.jsx(hi,{exerciseName:a.metadata.exerciseName,category:a.metadata.category,onOptionSelect:i,onBack:m,stepColor:t});break;case"validation":if(a.metadata?.validationData&&n&&c){const{exerciseName:x,adjustmentLabel:u,summary:o}=a.metadata.validationData;return e.jsx(gi,{exerciseName:x,adjustmentLabel:u,summary:o,onValidate:n,onModify:c,stepColor:t})}break;case"update-complete":if(a.metadata?.updateCompleteData&&l&&p){const{exerciseName:x,newParameters:u}=a.metadata.updateCompleteData;return e.jsx(bi,{exerciseName:x,newParameters:u,onViewExercise:l,onContinue:p,stepColor:t})}break;default:return e.jsx(xe,{message:a,stepColor:t})}return e.jsx(xe,{message:a,stepColor:t})},yi=({stepColor:a})=>e.jsx(h.div,{initial:{opacity:0,y:10,x:-10},animate:{opacity:1,y:0,x:0},exit:{opacity:0,y:-10},className:"flex justify-start mb-4",children:e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx("div",{className:"message-avatar w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`
              radial-gradient(circle at 30% 30%, color-mix(in srgb, ${a} 40%, transparent) 0%, transparent 70%),
              rgba(255, 255, 255, 0.1)
            `,border:`1.5px solid color-mix(in srgb, ${a} 50%, transparent)`,boxShadow:`0 0 12px color-mix(in srgb, ${a} 30%, transparent)`},children:e.jsx(j,{Icon:f.Zap,size:16,style:{color:a,filter:`drop-shadow(0 0 8px color-mix(in srgb, ${a} 60%, transparent))`}})}),e.jsx("div",{className:"typing-indicator px-5 py-3 rounded-2xl",style:{background:`
              radial-gradient(circle at 30% 30%, color-mix(in srgb, ${a} 15%, transparent) 0%, transparent 70%),
              rgba(255, 255, 255, 0.08)
            `,border:`1px solid color-mix(in srgb, ${a} 25%, transparent)`,boxShadow:`
              0 2px 8px rgba(0, 0, 0, 0.2),
              0 0 16px color-mix(in srgb, ${a} 15%, transparent),
              inset 0 1px 0 rgba(255, 255, 255, 0.1)
            `,backdropFilter:"blur(12px) saturate(140%)",WebkitBackdropFilter:"blur(12px) saturate(140%)",borderRadius:"4px 16px 16px 16px"},children:e.jsx("div",{className:"flex items-center gap-1.5",children:[0,1,2].map(t=>e.jsx("div",{className:"typing-dot",style:{background:`color-mix(in srgb, ${a} 60%, white)`}},t))})})]})}),vi=({onSendMessage:a,onStartVoiceRecording:t,onStopVoiceRecording:r,isRecording:s,isProcessing:i,isSpeaking:n,voiceEnabled:c,stepColor:l,placeholder:p="Parle à ton coach...",disabled:m=!1})=>{const[x,u]=N.useState(""),[o,b]=N.useState(!1),d=N.useRef(null),{triggerHaptic:g}=_();N.useEffect(()=>{d.current&&(d.current.style.height="auto",d.current.style.height=`${Math.min(d.current.scrollHeight,120)}px`)},[x]);const C=()=>{x.trim()&&!m&&(a(x.trim()),u(""),g("light"),d.current&&(d.current.style.height="auto"))},v=k=>{k.key==="Enter"&&!k.shiftKey&&(k.preventDefault(),C())},y=()=>{s?r():t(),g("medium")};return e.jsx("div",{className:"chat-input-bar-container",style:{position:"relative",width:"100%",zIndex:1,pointerEvents:m?"none":"auto",opacity:m?.6:1,margin:"0",padding:"0"},children:e.jsxs("div",{className:`chat-input-bar ${o?"chat-input-bar--focused":""}`,style:{background:`
            radial-gradient(ellipse at 50% 100%, color-mix(in srgb, ${l} 12%, transparent) 0%, transparent 60%),
            var(--liquid-reflections-multi),
            var(--liquid-highlight-ambient),
            var(--liquid-glass-bg-base)
          `,backdropFilter:"blur(var(--liquid-bottombar-blur)) saturate(var(--liquid-bottombar-saturate))",WebkitBackdropFilter:"blur(var(--liquid-bottombar-blur)) saturate(var(--liquid-bottombar-saturate))",border:o?`1.5px solid color-mix(in srgb, ${l} 40%, transparent)`:"1.5px solid rgba(255, 255, 255, 0.15)",boxShadow:o?`
                0 4px 24px rgba(0, 0, 0, 0.25),
                0 0 32px color-mix(in srgb, ${l} 20%, transparent),
                inset 0 1px 0 rgba(255, 255, 255, 0.15)
              `:`
                0 4px 20px rgba(0, 0, 0, 0.2),
                0 0 24px rgba(255, 255, 255, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.1)
              `,borderRadius:"18px",padding:"6px 8px",transition:"all 0.3s cubic-bezier(0.25, 0.1, 0.25, 1)"},children:[e.jsxs("div",{className:"flex items-center gap-2",children:[c&&e.jsx(h.button,{onClick:y,className:`chat-input-button flex-shrink-0 w-9 h-9 rounded-full flex items-center justify-center ${s?"chat-input-button--recording":""}`,style:{background:s?`
                      radial-gradient(circle at 30% 30%, rgba(239, 68, 68, 0.3) 0%, transparent 70%),
                      rgba(239, 68, 68, 0.15)
                    `:`
                      radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.18) 0%, transparent 50%),
                      var(--liquid-pill-bg)
                    `,border:s?"1.5px solid rgba(239, 68, 68, 0.5)":"1px solid rgba(255, 255, 255, 0.2)",boxShadow:s?"0 0 20px rgba(239, 68, 68, 0.3), 0 4px 12px rgba(0, 0, 0, 0.2)":"var(--liquid-pill-shadow)"},whileHover:{scale:1.05},whileTap:{scale:.95},disabled:m||i,children:e.jsx(z,{mode:"wait",children:s?e.jsx(h.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},exit:{scale:0,rotate:180},children:e.jsx(j,{Icon:f.MicOff,size:18,style:{color:"#EF4444"}})},"recording"):e.jsx(h.div,{initial:{scale:0,rotate:180},animate:{scale:1,rotate:0},exit:{scale:0,rotate:-180},children:e.jsx(j,{Icon:f.Mic,size:18,style:{color:"rgba(255, 255, 255, 0.7)"}})},"idle")})}),e.jsx("div",{className:"flex-1 relative",children:e.jsx("textarea",{ref:d,value:x,onChange:k=>u(k.target.value),onKeyDown:v,onFocus:()=>b(!0),onBlur:()=>b(!1),placeholder:s?"Enregistrement en cours...":p,disabled:m||s,rows:1,className:"chat-textarea w-full resize-none bg-transparent border-none outline-none text-white placeholder-white/40 text-sm leading-relaxed py-1.5 px-1.5",style:{maxHeight:"90px",minHeight:"32px"}})}),e.jsx(h.button,{onClick:C,disabled:!x.trim()||m||i,className:`chat-input-button flex-shrink-0 w-9 h-9 rounded-full flex items-center justify-center ${x.trim()&&!m?"chat-input-button--send-enabled":""}`,style:{background:x.trim()?`
                    radial-gradient(circle at 30% 30%, color-mix(in srgb, ${l} 35%, transparent) 0%, transparent 70%),
                    linear-gradient(135deg, color-mix(in srgb, ${l} 30%, transparent), color-mix(in srgb, ${l} 18%, transparent))
                  `:"rgba(255, 255, 255, 0.05)",border:x.trim()?`1.5px solid color-mix(in srgb, ${l} 50%, transparent)`:"1px solid rgba(255, 255, 255, 0.1)",boxShadow:x.trim()?`0 0 16px color-mix(in srgb, ${l} 25%, transparent), 0 4px 12px rgba(0, 0, 0, 0.2)`:"none",cursor:x.trim()&&!m?"pointer":"not-allowed",opacity:x.trim()&&!m?1:.5},whileHover:x.trim()&&!m?{scale:1.05}:void 0,whileTap:x.trim()&&!m?{scale:.95}:void 0,children:e.jsx(j,{Icon:f.Send,size:18,style:{color:x.trim()?l:"rgba(255, 255, 255, 0.4)",filter:x.trim()?`drop-shadow(0 0 8px color-mix(in srgb, ${l} 40%, transparent))`:"none"}})})]}),e.jsx(z,{children:s&&e.jsx(h.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"recording-indicator mt-3 pt-3 border-t border-white/10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"recording-dot"}),e.jsx("span",{className:"text-xs text-white/70",children:"Enregistrement en cours..."})]}),e.jsx("span",{className:"text-xs text-white/50",children:"Tap pour arrêter"})]})})}),e.jsx(z,{children:i&&e.jsx(h.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"processing-indicator mt-3 pt-3 border-t border-white/10",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"processing-spinner",children:e.jsx(j,{Icon:f.Loader,size:14,style:{color:l}})}),e.jsx("span",{className:"text-xs text-white/70",children:"Traitement en cours..."})]})})})]})})},wi=a=>{const t=[];return(a.toLowerCase().includes("prêt")||a.toLowerCase().includes("commencer"))&&(t.push({label:"Oui, allons-y !",action:"confirm"}),t.push({label:"Pas encore",action:"wait"})),(a.toLowerCase().includes("ajuster")||a.toLowerCase().includes("modifier"))&&(t.push({label:"Modifier",action:"modify"}),t.push({label:"C'est bon",action:"keep"})),t},ji=({stepColor:a,onSendMessage:t,isTyping:r=!1,className:s="",messagesContainerRef:i,onScrollChange:n,onExerciseClick:c,onCategorySelect:l,onOptionSelect:p,onValidate:m,onModify:x,onViewExercise:u,onContinue:o,onBack:b})=>{const d=N.useRef(null),g=N.useRef(null),C=i||g,{messages:v,isRecording:y,isProcessing:k,isSpeaking:I,voiceSettings:E}=zs(),{messages:F,currentMode:O}=V(),M=O==="training"?F:v,D=($=!0)=>{d.current?.scrollIntoView({behavior:$?"smooth":"auto",block:"end"})};N.useEffect(()=>{D(!0)},[M,r]);const P=()=>{if(!C.current)return;const{scrollTop:$,scrollHeight:q,clientHeight:L}=C.current,ee=!(q-$-L<100);n&&n(ee)},A=()=>{console.log("Start voice recording")},R=()=>{console.log("Stop voice recording")};return e.jsxs("div",{className:`coach-chat-interface flex flex-col ${s}`,style:{height:"100%",position:"relative",minHeight:0},children:[e.jsx("div",{ref:C,onScroll:P,className:"messages-container flex-1 overflow-y-auto px-2.5 pt-1.5 pb-0",style:{overscrollBehavior:"contain",minHeight:0},children:M.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center h-full text-center py-4",children:e.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-md",children:[e.jsx("div",{className:"w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center",style:{background:`
                    radial-gradient(circle at 30% 30%, color-mix(in srgb, ${a} 35%, transparent) 0%, transparent 70%),
                    rgba(255, 255, 255, 0.1)
                  `,border:`2px solid color-mix(in srgb, ${a} 40%, transparent)`,boxShadow:`0 0 24px color-mix(in srgb, ${a} 25%, transparent)`},children:e.jsx(h.div,{animate:{scale:[1,1.1,1],rotate:[0,5,-5,0]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:e.jsx("span",{className:"text-3xl",children:"💪"})})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Ton Coach est Prêt !"}),e.jsx("p",{className:"text-sm text-white/60 leading-relaxed",children:"Utilise le chat ci-dessous pour échanger avec ton coach IA"})]})}):e.jsxs(e.Fragment,{children:[M.map($=>{const q=$;if(["exercise-list-intro","category-selection","option-selection","validation","update-complete"].includes(q.type)&&O==="training")return e.jsx(fi,{message:q,stepColor:a,onExerciseClick:c,onCategorySelect:l,onOptionSelect:p,onValidate:m,onModify:x,onViewExercise:u,onContinue:o,onBack:b},$.id);const J=$.role==="coach"&&O==="training"&&$.type==="text",ie=J?wi($.content):[],ce=H=>{const ze={"reduce-intensity":"Je voudrais réduire la difficulté","increase-intensity":"J'aimerais augmenter l'intensité","adjust-sets":"Je veux ajuster le nombre de séries","adjust-reps":"Je veux modifier les répétitions","show-alternatives":"Montre-moi les alternatives","keep-exercise":"Je garde cet exercice","keep-as-is":"C'est parfait comme ça","yes-perfect":"Oui, c'est parfait !","need-changes":"J'aimerais faire quelques ajustements",understood:"Compris"}[H]||"OK";t(ze)};return e.jsx(xe,{message:$,stepColor:a,showCTA:J,ctaButtons:ie,onCTAClick:ce},$.id)}),r&&e.jsx(yi,{stepColor:a}),e.jsx("div",{ref:d})]})}),e.jsx("div",{className:"chat-input-footer flex-shrink-0",style:{borderTop:"1px solid rgba(255, 255, 255, 0.08)",padding:"8px 8px 0px 8px"},children:e.jsx(vi,{onSendMessage:t,onStartVoiceRecording:A,onStopVoiceRecording:R,isRecording:y,isProcessing:k,isSpeaking:I,voiceEnabled:E.enabled,stepColor:a})}),e.jsx("style",{children:`
        .messages-container {
          scrollbar-width: thin;
          scrollbar-color: rgba(255, 255, 255, 0.2) transparent;
        }

        .messages-container::-webkit-scrollbar {
          width: 6px;
        }

        .messages-container::-webkit-scrollbar-track {
          background: transparent;
        }

        .messages-container::-webkit-scrollbar-thumb {
          background: rgba(255, 255, 255, 0.2);
          border-radius: 3px;
        }

        .messages-container::-webkit-scrollbar-thumb:hover {
          background: rgba(255, 255, 255, 0.3);
        }
      `})]})};class Ni{constructor(){U(this,"baseUrl");const t="https://kwipydbtjagypocpvbwn.supabase.co";this.baseUrl=`${t}/functions/v1`}async sendMessage(t){try{w.debug("CHAT_AI_SERVICE","Sending message to AI",{mode:t.mode,messageCount:t.messages.length,hasContext:!!t.contextData});const{data:{session:r}}=await W.auth.getSession();if(!r)throw new Error("User not authenticated");const s=await fetch(`${this.baseUrl}/chat-ai`,{method:"POST",headers:{Authorization:`Bearer ${r.access_token}`,"Content-Type":"application/json",apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt3aXB5ZGJ0amFneXBvY3B2YnduIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ2ODg0MjIsImV4cCI6MjA3MDI2NDQyMn0.IS5IdKbmnGtgU_AaGYtUgX3ewaNpsiSAui5kbFV31_U"},body:JSON.stringify(t)});if(!s.ok){const n=await s.json().catch(()=>({error:"Unknown error"}));throw new Error(n.error||`API error: ${s.status}`)}const i=await s.json();return w.info("CHAT_AI_SERVICE","Received AI response",{mode:t.mode,tokensUsed:i.usage?.total_tokens}),i}catch(r){throw w.error("CHAT_AI_SERVICE","Error sending message",{error:r}),r}}async sendStreamMessage(t,r){try{const{data:{session:s}}=await W.auth.getSession();if(!s)throw new Error("User not authenticated");const i=await fetch(`${this.baseUrl}/chat-ai`,{method:"POST",headers:{Authorization:`Bearer ${s.access_token}`,"Content-Type":"application/json",apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt3aXB5ZGJ0amFneXBvY3B2YnduIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ2ODg0MjIsImV4cCI6MjA3MDI2NDQyMn0.IS5IdKbmnGtgU_AaGYtUgX3ewaNpsiSAui5kbFV31_U"},body:JSON.stringify({...t,stream:!0})});if(!i.ok)throw new Error(`API error: ${i.status}`);const n=i.body?.getReader(),c=new TextDecoder;if(!n)throw new Error("Response body is not readable");for(;;){const{done:l,value:p}=await n.read();if(l)break;const x=c.decode(p).split(`
`);for(const u of x)if(u.startsWith("data: ")){const o=u.slice(6);if(o==="[DONE]")return;try{const d=JSON.parse(o).choices[0]?.delta?.content;d&&r(d)}catch{}}}}catch(s){throw w.error("CHAT_AI_SERVICE","Error in stream",{error:s}),s}}convertMessagesToAPI(t){return t.map(r=>({role:r.role==="coach"?"assistant":r.role,content:r.content}))}}const Ae=new Ni;class Ci{async getModeId(t){try{const{data:r,error:s}=await W.from("chat_modes").select("id").eq("name",t).maybeSingle();return s?(w.error("CHAT_CONVERSATION_SERVICE","Error getting mode ID",{error:s}),null):r?.id||null}catch(r){return w.error("CHAT_CONVERSATION_SERVICE","Error in getModeId",{error:r}),null}}async getOrCreateConversation(t,r){try{const{data:{user:s}}=await W.auth.getUser();if(!s)throw new Error("User not authenticated");const i=await this.getModeId(t);if(!i)throw new Error(`Mode ${t} not found in database`);const{data:n,error:c}=await W.from("chat_conversations").select("id").eq("user_id",s.id).eq("mode_id",i).eq("is_active",!0).maybeSingle();if(c)throw w.error("CHAT_CONVERSATION_SERVICE","Error fetching conversation",{fetchError:c}),c;if(n)return w.debug("CHAT_CONVERSATION_SERVICE","Using existing conversation",{conversationId:n.id,mode:t}),n.id;const{data:l,error:p}=await W.from("chat_conversations").insert({user_id:s.id,mode_id:i,context_data:r||{},is_active:!0}).select("id").single();if(p)throw w.error("CHAT_CONVERSATION_SERVICE","Error creating conversation",{createError:p}),p;return w.info("CHAT_CONVERSATION_SERVICE","Created new conversation",{conversationId:l.id,mode:t}),l.id}catch(s){return w.error("CHAT_CONVERSATION_SERVICE","Error in getOrCreateConversation",{error:s}),null}}async saveMessage(t,r){try{const{data:s,error:i}=await W.from("chat_messages").insert({conversation_id:t,role:r.role,type:r.type,content:r.content,metadata:r.metadata||{},audio_url:r.audioUrl||null}).select("id").single();if(i)throw w.error("CHAT_CONVERSATION_SERVICE","Error saving message",{error:i}),i;return w.debug("CHAT_CONVERSATION_SERVICE","Message saved",{messageId:s.id,conversationId:t}),s.id}catch(s){return w.error("CHAT_CONVERSATION_SERVICE","Error in saveMessage",{error:s}),null}}async getConversationMessages(t){try{const{data:r,error:s}=await W.from("chat_messages").select("*").eq("conversation_id",t).order("created_at",{ascending:!0});if(s)throw w.error("CHAT_CONVERSATION_SERVICE","Error fetching messages",{error:s}),s;return(r||[]).map(i=>({id:i.id,role:i.role,type:i.type,content:i.content,timestamp:new Date(i.created_at),...i.metadata&&Object.keys(i.metadata).length>0?{metadata:i.metadata}:{},...i.audio_url?{audioUrl:i.audio_url}:{}}))}catch(r){return w.error("CHAT_CONVERSATION_SERVICE","Error in getConversationMessages",{error:r}),[]}}async endConversation(t){try{const{error:r}=await W.from("chat_conversations").update({is_active:!1,ended_at:new Date().toISOString()}).eq("id",t);return r?(w.error("CHAT_CONVERSATION_SERVICE","Error ending conversation",{error:r}),!1):(w.info("CHAT_CONVERSATION_SERVICE","Conversation ended",{conversationId:t}),!0)}catch(r){return w.error("CHAT_CONVERSATION_SERVICE","Error in endConversation",{error:r}),!1}}async getActiveConversationByMode(t){try{const{data:{user:r}}=await W.auth.getUser();if(!r)return null;const s=await this.getModeId(t);if(!s)return null;const{data:i,error:n}=await W.from("chat_conversations").select("id").eq("user_id",r.id).eq("mode_id",s).eq("is_active",!0).maybeSingle();return n?(w.error("CHAT_CONVERSATION_SERVICE","Error fetching active conversation",{error:n}),null):i?.id||null}catch(r){return w.error("CHAT_CONVERSATION_SERVICE","Error in getActiveConversationByMode",{error:r}),null}}}const re=new Ci,Gi=({chatButtonRef:a})=>{const t=se();Y();const{isOpen:r,close:s,currentMode:i,modeConfigs:n,position:c,setMode:l,closeOnNavigation:p,addMessage:m,messages:x,isTyping:u,setTyping:o,conversationId:b,incrementUnread:d}=V(),g=V.setState,{navClose:C}=_(),v=N.useRef(t.pathname),[y,k]=N.useState(!1),I=N.useRef(null),E=n[i],F=E.color,O=()=>{const A=x[x.length-1],R=A&&A.role==="coach";(u||R)&&(d(),w.debug("GLOBAL_CHAT_DRAWER","Closing chat with unread messages",{mode:i,isTyping:u,hasUnreadCoachMessage:R,timestamp:new Date().toISOString()})),s()};N.useEffect(()=>{v.current!==t.pathname&&(r&&p&&(w.debug("GLOBAL_CHAT_DRAWER","Closing chat on navigation",{from:v.current,to:t.pathname,timestamp:new Date().toISOString()}),C(),Z.tap(),O()),v.current=t.pathname)},[t.pathname,r,p,C]),N.useEffect(()=>{if(!r)return;let A=i;t.pathname.startsWith("/training")||t.pathname.includes("/pipeline")?A="training":t.pathname.startsWith("/meals")||t.pathname.startsWith("/fridge")?A="nutrition":t.pathname.startsWith("/fasting")?A="fasting":t.pathname.startsWith("/body-scan")||t.pathname.startsWith("/avatar")?A="body-scan":A="general",A!==i&&(w.debug("GLOBAL_CHAT_DRAWER","Auto-switching mode based on route",{route:t.pathname,from:i,to:A,timestamp:new Date().toISOString()}),l(A),m({role:"system",type:"system",content:`Passage en mode ${n[A].displayName}`}))},[t.pathname,r]),N.useEffect(()=>{if(!r)return;(async()=>{try{const R=await re.getActiveConversationByMode(i);if(R){const $=await re.getConversationMessages(R);$.length>0&&(g({conversationId:R,messages:$}),w.debug("GLOBAL_CHAT_DRAWER","Loaded conversation history",{conversationId:R,messageCount:$.length,mode:i}))}}catch(R){w.error("GLOBAL_CHAT_DRAWER","Error loading conversation history",{error:R})}})()},[i,r]),N.useEffect(()=>{if(!r)return;const A=R=>{R.key==="Escape"&&(C(),Z.tap(),O())};return document.addEventListener("keydown",A),()=>document.removeEventListener("keydown",A)},[r,C,O]);const M=async A=>{const R={role:"user",type:"text",content:A};m(R),o(!0);try{const $=b||await re.getOrCreateConversation(i);if(!$)throw new Error("Failed to get or create conversation");b||g({conversationId:$}),await re.saveMessage($,R);let q=E.systemPrompt;const L=x.slice(-10),Q=[{role:"system",content:q},...Ae.convertMessagesToAPI(L),{role:"user",content:A}],J={role:"coach",type:"text",content:(await Ae.sendMessage({messages:Q,mode:i})).message.content};m(J),await re.saveMessage($,J)}catch($){w.error("GLOBAL_CHAT_DRAWER","Error sending message",{error:$}),m({role:"system",type:"system",content:"Désolé, une erreur est survenue. Veuillez réessayer."})}finally{o(!1)}},D=c.width,P=(A=!0)=>{I.current&&I.current.scrollTo({top:I.current.scrollHeight,behavior:A?"smooth":"auto"})};return e.jsx(z,{children:r&&e.jsxs(e.Fragment,{children:[e.jsx(h.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},onClick:()=>{C(),Z.tap(),O()},className:"lg:hidden",style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.5)",backdropFilter:"blur(4px)",zIndex:9993}},"chat-overlay"),e.jsxs(h.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",stiffness:300,damping:30,mass:.8},className:"global-chat-drawer",style:{position:"fixed",top:"calc(64px + 12px)",right:"8px",bottom:"calc(var(--new-bottom-bar-height) + var(--new-bottom-bar-bottom-offset) + 12px)",width:`min(${D}px, calc(100vw - 16px))`,zIndex:Me.CHAT_DRAWER,borderRadius:"20px",background:`
                var(--liquid-reflections-multi),
                var(--liquid-highlight-ambient),
                var(--liquid-glass-bg-elevated)
              `,backdropFilter:"blur(var(--liquid-panel-blur)) saturate(var(--liquid-panel-saturate))",WebkitBackdropFilter:"blur(var(--liquid-panel-blur)) saturate(var(--liquid-panel-saturate))",boxShadow:"var(--liquid-panel-shadow)",display:"flex",flexDirection:"column",overflow:"hidden",isolation:"isolate",transform:"translateZ(0)",willChange:"transform, filter"},children:[e.jsx("div",{style:{position:"absolute",inset:"-2px",borderRadius:"inherit",padding:"2px",background:"var(--liquid-border-gradient-tricolor)",WebkitMask:"linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0)",WebkitMaskComposite:"xor",maskComposite:"exclude",pointerEvents:"none",opacity:1,zIndex:1,animation:"borderPulse 4s ease-in-out infinite"}}),e.jsx("div",{style:{position:"absolute",inset:"-8px",borderRadius:"calc(20px + 4px)",background:`radial-gradient(
                  ellipse at 80% 50%,
                  color-mix(in srgb, ${F} 15%, transparent) 0%,
                  rgba(61, 19, 179, 0.1) 40%,
                  transparent 70%
                )`,opacity:.8,zIndex:-1,pointerEvents:"none",animation:"glowPulse 3s ease-in-out infinite alternate"}}),e.jsxs("div",{className:"drawer-header",style:{padding:"16px 20px",borderBottom:`1px solid color-mix(in srgb, ${F} 20%, transparent)`,background:`
                  linear-gradient(180deg,
                    rgba(11, 14, 23, 0.6) 0%,
                    rgba(11, 14, 23, 0.3) 100%
                  )
                `,backdropFilter:"blur(16px)",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"12px",flexShrink:0},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"mode-icon-container",style:{width:"40px",height:"40px",borderRadius:"50%",background:`
                      radial-gradient(circle at 30% 30%, color-mix(in srgb, ${F} 30%, transparent), transparent 70%),
                      rgba(255, 255, 255, 0.1)
                    `,border:`2px solid color-mix(in srgb, ${F} 40%, transparent)`,boxShadow:`0 0 20px color-mix(in srgb, ${F} 25%, transparent)`,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(j,{Icon:f[E.icon]||f.MessageSquare,size:20,style:{color:F}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-bold text-lg",children:E.displayName}),e.jsx("p",{className:"text-white/60 text-xs",children:"En ligne • Prêt à aider"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{children:y&&e.jsx(h.button,{className:"scroll-to-bottom",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},onClick:()=>P(!0),style:{width:"36px",height:"36px",borderRadius:"50%",background:"rgba(255, 255, 255, 0.08)",border:"1px solid rgba(255, 255, 255, 0.15)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},whileHover:{scale:1.05,background:"rgba(255, 255, 255, 0.12)"},whileTap:{scale:.95},children:e.jsx(j,{Icon:f.ArrowDown,size:16,style:{color:F,filter:`drop-shadow(0 0 8px color-mix(in srgb, ${F} 40%, transparent))`}})})}),e.jsx(h.button,{className:"header-button",onClick:()=>{C(),Z.tap(),O()},style:{width:"36px",height:"36px",borderRadius:"50%",background:"rgba(255, 255, 255, 0.08)",border:"1px solid rgba(255, 255, 255, 0.15)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},whileHover:{scale:1.05,background:"rgba(255, 255, 255, 0.12)"},whileTap:{scale:.95},children:e.jsx(j,{Icon:f.X,size:18,className:"text-white/70"})})]})]}),e.jsx("div",{className:"chat-interface-wrapper",style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden",position:"relative",minHeight:0},children:e.jsx(ji,{stepColor:F,onSendMessage:M,isTyping:u,className:"flex-1",messagesContainerRef:I,onScrollChange:k})})]},"chat-drawer")]})})};function Ji({icon:a="Home",title:t,subtitle:r,actions:s,className:i="",circuit:n="home",iconColor:c}){const l=n==="track"?f.Target:f[a],p=c||G[n];return e.jsxs("header",{className:`pt-6 md:pt-8 mb-4 md:mb-6 will-change-transform-important ${i}`,role:"banner","aria-labelledby":"page-title",children:[e.jsxs("div",{className:"flex flex-row items-center gap-6 mb-8",children:[e.jsx("div",{className:"breathing-icon flex-shrink-0",style:{"--animation-duration-slower":"5s"},children:e.jsx("div",{className:"w-20 h-20 md:w-24 md:h-24 rounded-2xl flex items-center justify-center relative overflow-hidden shadow-lg",style:{"--header-icon-radius":"24px",borderRadius:"var(--header-icon-radius)",WebkitMaskImage:"radial-gradient(white, black)",maskImage:"radial-gradient(white, black)",background:`
                radial-gradient(circle at 30% 30%, color-mix(in srgb, ${p} 40%, transparent) 0%, transparent 60%),
                radial-gradient(circle at 70% 70%, color-mix(in srgb, var(--brand-primary) 35%, transparent) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, color-mix(in srgb, ${p} 25%, transparent) 0%, transparent 70%),
                rgba(255, 255, 255, 0.15)
              `,border:`2px solid color-mix(in srgb, ${p} 60%, transparent)`,boxShadow:`
                0 16px 64px color-mix(in srgb, ${p} 45%, transparent),
                0 0 100px color-mix(in srgb, ${p} 35%, transparent),
                0 0 160px color-mix(in srgb, var(--brand-primary) 25%, transparent),
                inset 0 4px 0 rgba(255, 255, 255, 0.3),
                inset 0 -3px 0 rgba(0, 0, 0, 0.15)
              `,backdropFilter:"blur(24px) saturate(200%)",WebkitBackdropFilter:"blur(24px) saturate(200%)",willChange:"transform, box-shadow",transform:"translateZ(0)"},role:"img","aria-label":`Icône de la page ${t}`,children:e.jsx(j,{Icon:l,size:48,variant:"pure",className:"text-white relative z-10",style:{color:p,filter:`drop-shadow(0 0 30px color-mix(in srgb, ${p} 90%, transparent)) drop-shadow(0 0 60px color-mix(in srgb, ${p} 60%, transparent))`,textShadow:`0 0 40px color-mix(in srgb, ${p} 80%, transparent), 0 0 80px color-mix(in srgb, var(--brand-primary) 40%, transparent)`},"aria-hidden":"true"})})}),e.jsxs("div",{className:"space-y-2 text-left flex-1",children:[e.jsx("h1",{id:"page-title",className:"text-2xl md:text-3xl lg:text-4xl font-bold text-white",style:{color:"var(--text-primary)",fontWeight:700,letterSpacing:"-0.01em",textShadow:`0 0 40px color-mix(in srgb, ${p} 50%, transparent)`,lineHeight:"1.2"},children:t}),r&&e.jsx("p",{className:"text-gray-300 text-lg md:text-xl max-w-2xl leading-relaxed",style:{color:`color-mix(in srgb, #E5E7EB 90%, ${p} 10%)`,textShadow:"0 0 20px rgba(0, 0, 0, 0.5)",lineHeight:"1.4"},"aria-describedby":"page-title",children:r})]})]}),s&&e.jsx("div",{className:"mt-3 md:mt-4 flex justify-center",role:"group","aria-label":"Actions de la page",children:s})]})}const Pe=N.createContext(void 0),me=()=>{const a=N.useContext(Pe);if(!a)throw new Error("Tabs components must be used within a Tabs provider");return a},Si={"profile:identity":"#60A5FA","profile:nutrition":"#10B981","profile:health":"#EF4444","profile:fasting":"#F59E0B","profile:preferences":"#18E3FF","profile:geo":"#EC4899","profile:avatar":"#A855F7",scanner:"#EC4899",inventaire:"#06B6D4",recipes:"#10B981",plan:"#8B5CF6",courses:"#F59E0B","meals:daily":"#10B981","meals:insights":"#F59E0B","meals:progression":"#06B6D4","meals:history":"#8B5CF6",journal:"#10B981",statistiques:"#06B6D4","fasting:daily":"#F59E0B","fasting:insights":"#10B981","fasting:progression":"#06B6D4","fasting:history":"#8B5CF6",timer:"#F59E0B",protocoles:"#06B6D4","activity:daily":"#3B82F6","activity:insights":"#F59E0B","activity:progression":"#10B981","activity:history":"#8B5CF6","activity:input":"#3B82F6","avatar:scanCta":"#8B5CF6","avatar:avatar":"#06B6D4","avatar:projection":"#10B981","avatar:insights":"#F59E0B","avatar:history":"#8B5CF6","avatar:face":"#EC4899","avatar:comparaison":"#A855F7","aujourd hui":"#18E3FF",conseils:"#10B981",progressionTraining:"#F59E0B",records:"#EF4444",historiqueTraining:"#8B5CF6",programmes:"#18E3FF",exercices:"#06B6D4",general:"#8B5CF6",notifications:"#EC4899",confidentialite:"#3B82F6",recentes:"#EC4899",parametres:"#8B5CF6","health:overview":"#EF4444","health:basic-info":"#EF4444","health:lifestyle":"#F59E0B","health:intimacy":"#EC4899","health:family-history":"#06B6D4","health:vital-signs":"#8B5CF6","health:geographic":"#3B82F6"},Ki={initial:{opacity:0,y:20,scale:.98},enter:{opacity:1,y:0,scale:1,transition:{type:"spring",stiffness:300,damping:25,mass:.8,duration:.4}},exit:{opacity:0,y:-10,scale:.98,transition:{duration:.2,ease:"easeInOut"}}},Xi={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.08,delayChildren:.05}}},Zi={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{type:"spring",stiffness:300,damping:25}}};function Fe(a){return Si[a]}const he=({defaultValue:a,className:t="",children:r,onValueChange:s,forgeContext:i})=>{const n=se(),c=Y(),l=T.useMemo(()=>{const m=n.hash.replace("#","");return(m?decodeURIComponent(m):"")||a},[n.hash,a]),p=T.useCallback(m=>{c({hash:m}),s?.(m)},[c,s]);return e.jsx(Pe.Provider,{value:{activeTab:l,setActiveTab:p,forgeContext:i},children:e.jsx("div",{className:`tabs w-full ${t}`,children:r})})},ki=({role:a="tablist","aria-label":t,className:r="",children:s})=>{const i=T.useRef(null),n=T.useRef(null),[c,l]=T.useState(!1),[p,m]=T.useState(0),{activeTab:x}=me(),[u,o]=T.useState([]);T.useEffect(()=>{const g=()=>{const v=i.current,y=n.current;if(!v||!y)return;const k=v.scrollWidth>v.clientWidth;l(k),y.classList.toggle("has-overflow",k);const I=Array.from(v.querySelectorAll(".tabs-trigger"));o(I)};g();const C=new ResizeObserver(g);return i.current&&C.observe(i.current),()=>C.disconnect()},[s]),T.useEffect(()=>{const g=u.findIndex(C=>C.getAttribute("aria-selected")==="true"||C.getAttribute("value")===x);g!==-1&&m(g)},[x,u]),T.useEffect(()=>{if(!i.current)return;const g=i.current.querySelector(`button[id="tab-${x}"]`);if(g){const C=i.current,v=g.getBoundingClientRect(),y=C.getBoundingClientRect(),k=v.left<y.left||v.right>y.right;(c||k)&&setTimeout(()=>{g.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},100)}},[x,c]);const b=T.useMemo(()=>!c||u.length===0?[]:u.map((g,C)=>({id:C,active:C===p})),[c,u,p]),d=T.Children.map(s,g=>T.isValidElement(g)&&g.type===De?T.cloneElement(g,{listRef:i,hasOverflow:c,...g.props}):g);return e.jsxs("div",{children:[e.jsx("div",{ref:n,className:`tabs-list-container ${r}`,style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--brand-primary) 8%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, var(--color-plasma-cyan) 6%, transparent) 0%, transparent 50%),
            rgba(255, 255, 255, 0.05)
          `,border:"2px solid color-mix(in srgb, var(--color-plasma-cyan) 15%, transparent)",backdropFilter:"blur(16px) saturate(140%)",boxShadow:`
            0 8px 32px rgba(0, 0, 0, 0.25),
            0 0 20px color-mix(in srgb, var(--brand-primary) 10%, transparent),
            inset 0 1px 0 rgba(255, 255, 255, 0.15)
          `},children:e.jsx("div",{ref:i,role:a,"aria-label":t,className:"tabs-list",children:d})}),c&&b.length>0&&e.jsx("div",{className:"tabs-scroll-indicators",children:b.map(g=>e.jsx("div",{className:`tabs-scroll-dot ${g.active?"tabs-scroll-dot--active":""}`,title:`Onglet ${g.id+1}`},g.id))})]})},De=({value:a,icon:t,children:r,listRef:s,hasOverflow:i})=>{const{activeTab:n,setActiveTab:c,forgeContext:l}=me(),p=n===a,m=t?f[t]:null,x=T.useRef(null),u=(d,g,C)=>{if(g){if(C){const v=`${C}:${d}`,y=Fe(v);if(y)return y}return Fe(d)}},o=()=>{c(a),i&&s?.current&&x.current&&x.current.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},b=u(a,p,l);return e.jsxs("button",{ref:x,role:"tab","aria-selected":p,"aria-controls":`panel-${a}`,id:`tab-${a}`,className:`tabs-trigger ${p?"active":""}`,onClick:o,style:{"--button-color":b||"var(--color-plasma-cyan)"},children:[m&&e.jsx(m,{className:"tab-icon",color:b,style:b?{color:b}:void 0}),r]})},Ii=({value:a,children:t,disableAnimation:r=!1})=>{const{activeTab:s}=me(),i=s===a,[n,c]=T.useState(i);return T.useEffect(()=>{i&&!n&&c(!0)},[i,n]),n?e.jsx("div",{role:"tabpanel",id:`panel-${a}`,"aria-labelledby":`tab-${a}`,className:"tabs-panel pt-6 md:pt-8",style:{display:i?"block":"none"},children:t}):null};he.List=ki;he.Trigger=De;he.Panel=Ii;const Yi=()=>{N.useEffect(()=>{const a=t=>{if(t.target&&t.target.getAttribute("role")==="tab"){const r=t.target.closest('[role="tablist"]');if(!r)return;const s=Array.from(r.querySelectorAll('[role="tab"]')),i=s.indexOf(t.target);let n=i;t.key==="ArrowRight"?n=(i+1)%s.length:t.key==="ArrowLeft"&&(n=(i-1+s.length)%s.length),n!==i&&(t.preventDefault(),s[n]?.click(),s[n]?.focus())}};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[])},Le="twinforge:profile-nudge:dismissed",Ti=24;function Ei(){try{const a=localStorage.getItem(Le);if(!a)return!1;const{timestamp:t}=JSON.parse(a),r=new Date(t);return(new Date().getTime()-r.getTime())/(1e3*60*60)<Ti}catch{return!1}}function Ai(){try{localStorage.setItem(Le,JSON.stringify({timestamp:new Date().toISOString(),completionPercentage:0}))}catch{}}const Qi=({completion:a,variant:t="card",className:r="",onDismiss:s,showDismiss:i=!0})=>{const n=Y(),{click:c,success:l}=_(),[p,m]=T.useState(!1);if(T.useEffect(()=>{m(Ei())},[]),!a||a.isSufficient||p)return null;const x=()=>{c(),a.nextAction&&(n(a.nextAction.route),l())},u=d=>{d?.stopPropagation(),c(),Ai(),m(!0),s?.()},o=a.missingHighPriorityFields.length>0?"#EF4444":"#F59E0B",b=a.missingHighPriorityFields.length>0?"Critique":"Recommandé";return t==="banner"?e.jsx(h.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:`w-full ${r}`,children:e.jsx(B,{className:"p-4",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, ${o} 12%, transparent) 0%, transparent 60%),
              var(--glass-opacity)
            `,borderColor:`color-mix(in srgb, ${o} 25%, transparent)`,boxShadow:`
              0 8px 32px rgba(0, 0, 0, 0.2),
              0 0 20px color-mix(in srgb, ${o} 15%, transparent),
              inset 0 1px 0 rgba(255, 255, 255, 0.15)
            `},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:`color-mix(in srgb, ${o} 20%, transparent)`,border:`2px solid color-mix(in srgb, ${o} 40%, transparent)`},children:e.jsx(j,{Icon:f.User,size:18,style:{color:o}})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-semibold text-sm",children:a.suggestedMessage}),e.jsxs("p",{className:"text-white/70 text-xs",children:[a.completionPercentage,"% complété • ",b]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a.nextAction&&e.jsx("button",{onClick:x,className:"btn-glass--primary px-4 py-2 text-sm",children:a.nextAction.label}),i&&e.jsx("button",{onClick:u,className:"p-2 rounded-full hover:bg-white/10 transition-colors",children:e.jsx(j,{Icon:f.X,size:14,className:"text-white/60"})})]})]})})}):t==="compact"?e.jsx(h.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:`inline-flex ${r}`,children:e.jsxs("button",{onClick:x,className:"flex items-center gap-2 px-3 py-2 rounded-full text-sm transition-all duration-200",style:{background:`color-mix(in srgb, ${o} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${o} 30%, transparent)`,color:o},children:[e.jsx(j,{Icon:f.AlertCircle,size:14}),e.jsxs("span",{className:"font-medium",children:["Profil ",a.completionPercentage,"%"]})]})}):e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:r,children:e.jsx(B,{className:"p-6",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, ${o} 12%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, #06B6D4 8%, transparent) 0%, transparent 50%),
            var(--glass-opacity)
          `,borderColor:`color-mix(in srgb, ${o} 25%, transparent)`,boxShadow:`
            0 12px 40px rgba(0, 0, 0, 0.25),
            0 0 30px color-mix(in srgb, ${o} 15%, transparent),
            inset 0 2px 0 rgba(255, 255, 255, 0.15)
          `},children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                linear-gradient(135deg, color-mix(in srgb, ${o} 35%, transparent), color-mix(in srgb, ${o} 25%, transparent))
              `,border:`2px solid color-mix(in srgb, ${o} 50%, transparent)`,boxShadow:`0 0 20px color-mix(in srgb, ${o} 30%, transparent)`},children:e.jsx(j,{Icon:f.User,size:20,style:{color:o}})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-white font-bold text-lg",children:"Optimisez vos Recettes"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:o}}),e.jsx("span",{className:"text-sm font-medium",style:{color:o},children:b})]})]}),e.jsx("p",{className:"text-white/80 text-sm mb-4 leading-relaxed",children:a.suggestedMessage}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between text-xs text-white/60 mb-2",children:[e.jsx("span",{children:"Profil complété"}),e.jsxs("span",{children:[a.completionPercentage,"%"]})]}),e.jsx("div",{className:"w-full bg-white/10 rounded-full h-2 overflow-hidden",children:e.jsx(h.div,{className:"h-2 rounded-full",style:{background:`linear-gradient(90deg, ${o}, color-mix(in srgb, ${o} 80%, white))`,width:`${a.completionPercentage}%`},initial:{width:0},animate:{width:`${a.completionPercentage}%`},transition:{duration:1,ease:"easeOut"}})})]}),a.missingHighPriorityFields.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{className:"text-white/90 text-sm font-medium mb-2",children:"Champs essentiels manquants :"}),e.jsxs("div",{className:"space-y-1",children:[a.missingHighPriorityFields.slice(0,3).map((d,g)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-1 rounded-full bg-red-400"}),e.jsx("span",{className:"text-red-300 text-xs",children:d.label}),e.jsxs("span",{className:"text-white/50 text-xs",children:["• ",d.description]})]},d.key)),a.missingHighPriorityFields.length>3&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-1 rounded-full bg-red-400"}),e.jsxs("span",{className:"text-red-300 text-xs",children:["+",a.missingHighPriorityFields.length-3," autres champs"]})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[a.nextAction&&e.jsx("button",{onClick:x,className:"btn-glass--primary px-4 py-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{Icon:f.ArrowRight,size:14}),e.jsx("span",{children:a.nextAction.label})]})}),i&&e.jsx("button",{onClick:u,className:"btn-glass--secondary-nav px-3 py-2",title:"Ignorer pour maintenant",children:e.jsx(j,{Icon:f.X,size:14})})]})]})]})})})},en=({isOpen:a,onClose:t,onConfirm:r,title:s,message:i,confirmText:n="Confirmer",cancelText:c="Annuler",variant:l="danger"})=>{const p=()=>{r(),t()},x=(()=>{switch(l){case"danger":return{iconColor:"#EF4444",icon:f.AlertTriangle,borderColor:"rgba(239, 68, 68, 0.3)",bgGradient:"radial-gradient(circle at 30% 20%, rgba(239, 68, 68, 0.1) 0%, transparent 60%)"};case"warning":return{iconColor:"#F59E0B",icon:f.AlertCircle,borderColor:"rgba(245, 158, 11, 0.3)",bgGradient:"radial-gradient(circle at 30% 20%, rgba(245, 158, 11, 0.1) 0%, transparent 60%)"};case"info":return{iconColor:"#3B82F6",icon:f.Info,borderColor:"rgba(59, 130, 246, 0.3)",bgGradient:"radial-gradient(circle at 30% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 60%)"}}})(),u=e.jsx(z,{children:a&&e.jsxs(e.Fragment,{children:[e.jsx(h.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-[200000]",onClick:t,style:{position:"fixed",top:0,left:0,right:0,bottom:0}}),e.jsx(h.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"fixed inset-0 z-[200001] flex items-center justify-center p-4 pointer-events-none",style:{position:"fixed",top:0,left:0,right:0,bottom:0},children:e.jsx(B,{className:"w-full max-w-md pointer-events-auto",style:{background:`${x.bgGradient}, var(--glass-opacity)`,borderColor:x.borderColor},children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-full flex items-center justify-center",style:{background:`radial-gradient(circle at 30% 30%, color-mix(in srgb, ${x.iconColor} 30%, transparent) 0%, transparent 60%), rgba(255, 255, 255, 0.1)`,border:`2px solid color-mix(in srgb, ${x.iconColor} 40%, transparent)`,boxShadow:`0 4px 16px color-mix(in srgb, ${x.iconColor} 20%, transparent)`},children:e.jsx(j,{Icon:x.icon,size:24,style:{color:x.iconColor,filter:`drop-shadow(0 0 8px color-mix(in srgb, ${x.iconColor} 60%, transparent))`}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-white font-semibold text-lg mb-2",children:s}),e.jsx("p",{className:"text-white/70 text-sm leading-relaxed",children:i})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:t,className:"flex-1 py-2.5 px-4 rounded-lg bg-white/10 hover:bg-white/20 text-white text-sm font-medium transition-all",children:c}),e.jsx("button",{onClick:p,className:"flex-1 py-2.5 px-4 rounded-lg text-white text-sm font-medium transition-all shadow-lg",style:{background:l==="danger"?"linear-gradient(135deg, #EF4444 0%, #DC2626 100%)":l==="warning"?"linear-gradient(135deg, #F59E0B 0%, #D97706 100%)":"linear-gradient(135deg, #3B82F6 0%, #2563EB 100%)",boxShadow:`0 4px 12px color-mix(in srgb, ${x.iconColor} 30%, transparent)`},children:n})]})]})})})]})});return typeof document<"u"?le.createPortal(u,document.body):u},tn=({children:a,containerId:t="portal-root"})=>{const r=N.useRef(null);return N.useEffect(()=>{let s=document.getElementById(t);return s||(s=document.createElement("div"),s.id=t,document.body.appendChild(s)),r.current=s,()=>{r.current&&r.current.childNodes.length===0&&r.current.remove()}},[t]),r.current?le.createPortal(a,r.current):null},an=({benefits:a,themeColor:t,title:r="Pourquoi utiliser cette fonctionnalité ?",className:s=""})=>e.jsx(h.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.4},className:s,children:e.jsxs(B,{className:"p-4",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, ${t} 6%, transparent) 0%, transparent 60%),
            var(--glass-opacity-base)
          `,borderColor:`color-mix(in srgb, ${t} 20%, transparent)`,boxShadow:`
            var(--glass-shadow-sm),
            0 0 12px color-mix(in srgb, ${t} 8%, transparent)
          `},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center breathing-icon",style:{background:`
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                linear-gradient(135deg, color-mix(in srgb, ${t} 40%, transparent), color-mix(in srgb, ${t} 30%, transparent))
              `,border:`2px solid color-mix(in srgb, ${t} 60%, transparent)`,boxShadow:`
                0 0 20px color-mix(in srgb, ${t} 50%, transparent),
                inset 0 2px 0 rgba(255,255,255,0.3)
              `},children:e.jsx(j,{Icon:f.Info,size:14,style:{color:t},variant:"pure"})}),e.jsx("h4",{className:"text-white/90 font-medium text-sm",children:r})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:a.map((i,n)=>e.jsxs(h.div,{className:"benefit-card",style:{background:`color-mix(in srgb, ${i.color} 6%, transparent)`,border:`1px solid color-mix(in srgb, ${i.color} 15%, transparent)`,borderRadius:"12px",padding:"12px",backdropFilter:"blur(8px)",transition:"all 0.2s ease"},initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1+n*.1},whileHover:{y:-2,borderColor:`color-mix(in srgb, ${i.color} 30%, transparent)`,background:`color-mix(in srgb, ${i.color} 10%, transparent)`},children:[e.jsx("div",{className:"flex items-center justify-center mb-2",style:{width:"32px",height:"32px",borderRadius:"8px",background:`
                    radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                    linear-gradient(135deg, color-mix(in srgb, ${i.color} 25%, transparent), color-mix(in srgb, ${i.color} 15%, transparent))
                  `,border:`1px solid color-mix(in srgb, ${i.color} 30%, transparent)`,boxShadow:`0 0 12px color-mix(in srgb, ${i.color} 20%, transparent)`},children:e.jsx(j,{Icon:f[i.icon],size:16,style:{color:i.color},variant:"pure"})}),e.jsx("div",{className:"text-white font-semibold text-sm mb-1",children:i.title}),e.jsx("div",{className:"text-white/70 text-xs leading-relaxed",children:i.description})]},i.id))})]})}),S=({width:a="100%",height:t="20px",borderRadius:r="8px",className:s="",style:i={},shimmer:n=!0,pulse:c=!1})=>{const l={width:a,height:t,borderRadius:r,background:"rgba(255, 255, 255, 0.08)",position:"relative",overflow:"hidden",...i},p=n?{animate:{backgroundPosition:["0% 0%","100% 0%","0% 0%"]},transition:{duration:2,repeat:1/0,ease:"linear"},style:{...l,background:"linear-gradient(90deg, rgba(255, 255, 255, 0.06), rgba(255, 255, 255, 0.12), rgba(255, 255, 255, 0.06))",backgroundSize:"200% 100%"}}:{},m=c?{animate:{opacity:[.6,1,.6]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}}:{};return e.jsx(h.div,{className:s,style:n||c?void 0:l,...n?p:{},...c?m:{}})},rn=({className:a=""})=>e.jsxs("div",{className:`space-y-8 w-full ${a}`,children:[e.jsxs(B,{className:"p-6",children:[e.jsx("div",{className:"flex items-center mb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{width:"40px",height:"40px",borderRadius:"50%",shimmer:!0}),e.jsx(S,{width:"150px",height:"24px",shimmer:!0})]})}),e.jsxs("div",{className:"relative h-[400px] sm:h-[500px] lg:h-[600px] rounded-xl overflow-hidden",style:{background:"linear-gradient(135deg, rgba(139, 92, 246, 0.08), rgba(59, 130, 246, 0.04))",border:"1px solid rgba(139, 92, 246, 0.2)"},children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs(h.div,{className:"relative",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.6},children:[e.jsx(h.div,{className:"w-32 h-32 rounded-full border-4",style:{borderColor:"rgba(139, 92, 246, 0.3)"},animate:{scale:[1,1.2,1],opacity:[.3,.6,.3]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}}),e.jsx(h.div,{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(h.div,{className:"w-24 h-24 rounded-full",style:{background:"radial-gradient(circle, rgba(139, 92, 246, 0.4), rgba(139, 92, 246, 0.1))",boxShadow:"0 0 40px rgba(139, 92, 246, 0.3)"},animate:{scale:[1,1.1,1]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"}})}),e.jsx(h.div,{className:"absolute -bottom-12 left-1/2 transform -translate-x-1/2 whitespace-nowrap",animate:{opacity:[.5,1,.5]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:e.jsx("span",{className:"text-white/70 text-sm font-medium",children:"Chargement de votre avatar..."})})]})}),e.jsx(h.div,{className:"absolute top-4 right-4 w-20 h-20 rounded-full",style:{background:"radial-gradient(circle, rgba(139, 92, 246, 0.2), transparent)"},animate:{opacity:[.3,.6,.3],scale:[.8,1,.8]},transition:{duration:3,repeat:1/0,ease:"easeInOut",delay:.5}})]})]}),e.jsxs(B,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{width:"40px",height:"40px",borderRadius:"50%",shimmer:!0}),e.jsx(S,{width:"180px",height:"20px",shimmer:!0})]}),e.jsx(S,{width:"100px",height:"24px",borderRadius:"12px",shimmer:!0})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[...Array(4)].map((t,r)=>e.jsxs(h.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.4,delay:.1+r*.1},className:"p-4 rounded-xl",style:{background:"rgba(255, 255, 255, 0.03)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(S,{width:"32px",height:"32px",borderRadius:"8px",shimmer:!0}),e.jsx(S,{width:"80px",height:"12px",shimmer:!0})]}),e.jsx(S,{width:"60px",height:"24px",shimmer:!0,className:"mb-1"}),e.jsx(S,{width:"50px",height:"14px",shimmer:!0})]},r))})]}),e.jsxs(B,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{width:"40px",height:"40px",borderRadius:"50%",shimmer:!0}),e.jsx(S,{width:"200px",height:"20px",shimmer:!0})]}),e.jsx(S,{width:"120px",height:"24px",borderRadius:"12px",shimmer:!0})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[...Array(4)].map((t,r)=>e.jsxs(h.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1+r*.1},className:"p-4 rounded-xl text-center",style:{background:"rgba(255, 255, 255, 0.03)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx(S,{width:"48px",height:"48px",borderRadius:"50%",shimmer:!0})}),e.jsx(S,{width:"80%",height:"16px",shimmer:!0,className:"mx-auto mb-2"}),e.jsx(S,{width:"60%",height:"14px",shimmer:!0,className:"mx-auto"})]},r))}),e.jsxs(h.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.6},className:"p-4 rounded-xl",style:{background:"rgba(255, 255, 255, 0.03)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx(S,{width:"100%",height:"14px",shimmer:!0,className:"mb-2"}),e.jsx(S,{width:"90%",height:"14px",shimmer:!0,className:"mb-2"}),e.jsx(S,{width:"80%",height:"14px",shimmer:!0})]})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsx(S,{width:"250px",height:"56px",borderRadius:"28px",shimmer:!0,className:"mx-auto"})})]}),sn=({className:a=""})=>e.jsxs("div",{className:`space-y-6 w-full ${a}`,children:[e.jsxs(B,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-6",children:[e.jsx(S,{width:"48px",height:"48px",borderRadius:"50%",shimmer:!0}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(S,{width:"220px",height:"20px",shimmer:!0}),e.jsx(S,{width:"90%",height:"14px",shimmer:!0})]})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx(S,{width:"180px",height:"16px",shimmer:!0}),e.jsx(S,{width:"100px",height:"14px",shimmer:!0})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{width:"40px",height:"40px",borderRadius:"12px",shimmer:!0}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(S,{width:"60px",height:"28px",shimmer:!0,className:"mx-auto"}),e.jsx(S,{width:"100%",height:"6px",borderRadius:"9999px",shimmer:!0})]}),e.jsx(S,{width:"40px",height:"40px",borderRadius:"12px",shimmer:!0})]})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx(S,{width:"160px",height:"16px",shimmer:!0}),e.jsx(S,{width:"80px",height:"14px",shimmer:!0})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{width:"40px",height:"40px",borderRadius:"12px",shimmer:!0}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(S,{width:"60px",height:"28px",shimmer:!0,className:"mx-auto"}),e.jsx(S,{width:"100%",height:"6px",borderRadius:"9999px",shimmer:!0})]}),e.jsx(S,{width:"40px",height:"40px",borderRadius:"12px",shimmer:!0})]})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx(S,{width:"140px",height:"16px",shimmer:!0}),e.jsx(S,{width:"120px",height:"14px",shimmer:!0})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{width:"40px",height:"40px",borderRadius:"12px",shimmer:!0}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(S,{width:"60px",height:"28px",shimmer:!0,className:"mx-auto"}),e.jsx(S,{width:"100%",height:"6px",borderRadius:"9999px",shimmer:!0})]}),e.jsx(S,{width:"40px",height:"40px",borderRadius:"12px",shimmer:!0})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx(S,{width:"140px",height:"16px",shimmer:!0})}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:[...Array(4)].map((t,r)=>e.jsx(S,{width:"100%",height:"36px",borderRadius:"8px",shimmer:!0},r))})]})]}),e.jsxs(B,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(S,{width:"40px",height:"40px",borderRadius:"50%",shimmer:!0}),e.jsx(S,{width:"240px",height:"20px",shimmer:!0})]}),e.jsxs("div",{className:"relative h-[450px] sm:h-[550px] lg:h-[650px] rounded-xl overflow-hidden",style:{background:"linear-gradient(135deg, rgba(16, 185, 129, 0.08), rgba(6, 182, 212, 0.04))",border:"1px solid rgba(16, 185, 129, 0.2)"},children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs(h.div,{className:"relative",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.6},children:[e.jsx(h.div,{className:"w-32 h-32 rounded-full border-4",style:{borderColor:"rgba(16, 185, 129, 0.3)"},animate:{scale:[1,1.2,1],opacity:[.3,.6,.3]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}}),e.jsx(h.div,{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(h.div,{className:"w-24 h-24 rounded-full",style:{background:"radial-gradient(circle, rgba(16, 185, 129, 0.4), rgba(16, 185, 129, 0.1))",boxShadow:"0 0 40px rgba(16, 185, 129, 0.3)"},animate:{scale:[1,1.1,1]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"}})}),e.jsx(h.div,{className:"absolute -bottom-12 left-1/2 transform -translate-x-1/2 whitespace-nowrap",animate:{opacity:[.5,1,.5]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:e.jsx("span",{className:"text-white/70 text-sm font-medium",children:"Calcul de votre projection..."})})]})}),e.jsx(h.div,{className:"absolute top-4 right-4 w-20 h-20 rounded-full",style:{background:"radial-gradient(circle, rgba(16, 185, 129, 0.2), transparent)"},animate:{opacity:[.3,.6,.3],scale:[.8,1,.8]},transition:{duration:3,repeat:1/0,ease:"easeInOut",delay:.5}})]})]}),e.jsx("div",{className:"glass-card p-4 bg-white/5 rounded-xl border border-white/10",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(S,{width:"16px",height:"16px",borderRadius:"50%",shimmer:!0,className:"mt-0.5"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(S,{width:"100%",height:"12px",shimmer:!0}),e.jsx(S,{width:"95%",height:"12px",shimmer:!0}),e.jsx(S,{width:"85%",height:"12px",shimmer:!0})]})]})}),e.jsxs(B,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(S,{width:"40px",height:"40px",borderRadius:"50%",shimmer:!0}),e.jsx(S,{width:"180px",height:"20px",shimmer:!0})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[...Array(2)].map((t,r)=>e.jsxs(h.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.4,delay:.1+r*.1},className:"p-4 rounded-xl",style:{background:"rgba(255, 255, 255, 0.03)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(S,{width:"32px",height:"32px",borderRadius:"8px",shimmer:!0}),e.jsx(S,{width:"80px",height:"16px",shimmer:!0})]}),e.jsxs("div",{className:"flex items-baseline gap-2 mb-2",children:[e.jsx(S,{width:"80px",height:"32px",shimmer:!0}),e.jsx(S,{width:"60px",height:"20px",shimmer:!0})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{width:"16px",height:"16px",borderRadius:"4px",shimmer:!0}),e.jsx(S,{width:"100px",height:"14px",shimmer:!0})]})]},r))})]})]}),nn=({modules:a,progress:t,themeColor:r,reduceMotion:s=!1,className:i=""})=>e.jsx("div",{className:`grid grid-cols-1 md:grid-cols-3 gap-6 ${i}`,children:a.map((n,c)=>{const l=t>=n.activeThreshold;return e.jsxs(h.div,{className:"p-6 rounded-xl relative overflow-hidden",style:{background:`
                radial-gradient(circle at 30% 20%, color-mix(in srgb, ${n.color} ${l?"15":"8"}%, transparent) 0%, transparent 60%),
                rgba(255,255,255,${l?"0.08":"0.04"})
              `,border:`2px solid color-mix(in srgb, ${n.color} ${l?"40":"20"}%, transparent)`,backdropFilter:"blur(12px) saturate(140%)",WebkitBackdropFilter:"blur(12px) saturate(140%)",boxShadow:l?`0 0 20px color-mix(in srgb, ${n.color} 30%, transparent)`:`0 0 8px color-mix(in srgb, ${n.color} 15%, transparent)`,transition:"all 0.6s ease"},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:c*.2},children:[l&&!s&&e.jsx("div",{className:"absolute top-2 right-2 w-3 h-3 rounded-full",style:{background:n.color,boxShadow:`0 0 12px color-mix(in srgb, ${n.color} 80%, transparent)`,animation:"energyPulse 1.5s ease-in-out infinite"}}),e.jsx("div",{className:"flex items-center justify-center gap-3 mb-3",children:e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${l&&!s?"breathing-icon":""}`,style:{background:`
                    radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                    linear-gradient(135deg, color-mix(in srgb, ${n.color} 40%, transparent), color-mix(in srgb, ${n.color} 30%, transparent))
                  `,border:`2px solid color-mix(in srgb, ${n.color} 60%, transparent)`,boxShadow:`
                    0 0 20px color-mix(in srgb, ${n.color} 50%, transparent),
                    inset 0 2px 0 rgba(255,255,255,0.3)
                  `},children:e.jsx(j,{Icon:f[n.icon],size:20,style:{color:n.color},variant:"pure"})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-base font-bold mb-1",style:{color:n.color},children:n.label}),e.jsx("div",{className:"text-xs text-white/60",children:n.sublabel})]}),l&&!s&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 rounded-b-xl overflow-hidden",style:{background:`linear-gradient(90deg,
                    transparent 0%,
                    ${n.color} 50%,
                    transparent 100%
                  )`,animation:"energyFlow 2s ease-in-out infinite"}})]},n.label)})});export{rn as A,Ui as B,en as C,Li as D,di as F,B as G,f as I,Wi as L,si as M,Qi as P,j as S,qi as T,Hi as U,Ki as a,Xi as b,Zi as c,ti as d,ne as e,Hs as f,te as g,_i as h,Vi as i,Gi as j,zi as k,Ji as l,Yi as m,ri as n,he as o,qs as p,tn as q,an as r,sn as s,nn as t,Ys as u};
