import{cK as S,u as $,R as v,j as t}from"./vendor-DX97-qL9.js";import{m as y}from"./stores-DcNfcD_j.js";import{B as j}from"./BodyScanProgressHeader-C9OstcTU.js";import{S as x,I as l}from"./ui-components-DWjWyKd7.js";import{u as N,l as b}from"./page-fridge-BvAjnJpI.js";import{m as s}from"./motion-DLE-fuXv.js";import"./utils-CUtLAp28.js";import"./supabase-C_rF2iqf.js";import"./page-fridge-scan-ZLPWYd6x.js";import"./date-utils-sCOX3Ksr.js";const C=()=>{const r=S(),a=$(),{successMajor:n,success:i}=N(),{completeProgress:d}=y(),f=v.useRef(!1),c=r.state?.scanResults,u=r.state?.isFaceScan||!1;if(v.useEffect(()=>{if(!f.current){if(!c){a(u?"/avatar#avatar":"/body-scan",{replace:!0});return}n(),d(),f.current=!0,b.info("CELEBRATION","Celebration step mounted with scan results",{hasResults:!!c,confidence:g(c),isFaceScan:u})}},[c,a,n,d,u]),!c)return null;const p=g(c),e=p>=.9?{title:"🌟 Scan Absolument Parfait !",subtitle:"Votre morphologie a été capturée avec une précision exceptionnelle",celebrationMessage:"Qualité Légendaire Atteinte",motivationalQuote:"Votre reflet numérique sera d'une fidélité saisissante",color:"#10B981",icon:l.Zap,particleCount:12,celebrationLevel:"legendary"}:p>=.7?{title:"✨ Scan Exceptionnel !",subtitle:"Votre avatar sera d'une qualité remarquable",celebrationMessage:"Excellence Morphologique Détectée",motivationalQuote:"Préparez-vous à découvrir votre double numérique parfait",color:"#22C55E",icon:l.Check,particleCount:10,celebrationLevel:"exceptional"}:p>=.5?{title:"🎯 Scan de Haute Qualité !",subtitle:"Votre morphologie a été analysée avec précision",celebrationMessage:"Analyse Premium Réussie",motivationalQuote:"Votre avatar 3D sera fidèle à votre silhouette unique",color:"#10B981",icon:l.Target,particleCount:8,celebrationLevel:"high"}:p>0?{title:"🚀 Scan Réussi avec Brio !",subtitle:"Votre avatar est prêt avec des optimisations intelligentes",celebrationMessage:"IA d'Optimisation Activée",motivationalQuote:"Notre intelligence artificielle a perfectionné votre scan",color:"#F59E0B",icon:l.Zap,particleCount:6,celebrationLevel:"optimized"}:{title:"🎉 Avatar 3D Créé !",subtitle:"Votre reflet numérique est prêt à être découvert",celebrationMessage:"Scan Terminé avec Succès",motivationalQuote:"Explorez votre avatar 3D personnalisé",color:"#8B5CF6",icon:l.Eye,particleCount:6,celebrationLevel:"complete"},h=()=>{i(),a(u?"/avatar#avatar":"/body-scan/review",{state:{scanResults:c},replace:!1})};return t.jsxs("div",{className:"relative overflow-visible pt-4 pb-6 md:pb-8",children:[t.jsxs("div",{className:"celebration-background-effects absolute inset-0 pointer-events-none overflow-visible",children:[t.jsx("div",{className:"celebration-ambient-glow absolute inset-0 rounded-3xl",style:{background:`radial-gradient(circle at center, ${e.color}15, transparent 70%)`,"--celebration-color":e.color}}),[...Array(e.particleCount)].map((m,o)=>t.jsx("div",{className:`celebration-particle celebration-particle--${o+1} absolute w-3 h-3 rounded-full`,style:{background:`radial-gradient(circle, ${e.color}, ${e.color}80)`,left:`${15+o*8}%`,top:`${20+o%4*15}%`,boxShadow:`0 0 12px ${e.color}80, 0 0 24px ${e.color}40`,"--celebration-color":e.color,"--particle-index":o}},o)),[...Array(6)].map((m,o)=>t.jsx("div",{className:`celebration-ray celebration-ray--${o+1} absolute w-1 h-20 rounded-full`,style:{background:`linear-gradient(180deg, ${e.color}60, transparent)`,left:`${30+o*12}%`,top:"10%",transformOrigin:"bottom center","--celebration-color":e.color}},`ray-${o}`))]}),t.jsxs("div",{className:"celebration-main-content relative text-center py-8 md:py-12 z-10",children:[t.jsxs(s.div,{className:"relative w-32 h-32 mx-auto mb-8",initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",stiffness:200,damping:15,duration:1.2},children:[t.jsx("div",{className:"celebration-icon-outer-glow absolute inset-0 rounded-full",style:{background:`radial-gradient(circle, ${e.color}40, transparent 70%)`,filter:"blur(8px)","--celebration-color":e.color}}),t.jsx("div",{className:"celebration-icon-inner-container absolute inset-8 rounded-full flex items-center justify-center",style:{background:`linear-gradient(135deg, ${e.color}30, ${e.color}60)`,border:`2px solid ${e.color}`,boxShadow:`0 0 60px ${e.color}90, inset 0 4px 0 rgba(255,255,255,0.3)`,"--celebration-color":e.color},children:t.jsx(x,{Icon:e.icon,size:48,color:e.color})}),[...Array(3)].map((m,o)=>t.jsx("div",{className:`celebration-icon-pulse-ring celebration-icon-pulse-ring--${o+1} absolute inset-0 rounded-full border-2`,style:{borderColor:`${e.color}40`,"--celebration-color":e.color}},`pulse-${o}`))]}),t.jsxs(s.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.6,duration:.8},children:[t.jsx(s.h3,{className:"celebration-title-glow text-4xl md:text-5xl font-bold text-white mb-4",style:{color:e.color},children:e.title}),t.jsx(s.p,{className:"text-xl text-white/90 mb-6 leading-relaxed max-w-2xl mx-auto",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.6},children:e.subtitle})]})]}),t.jsx(s.div,{className:"flex justify-center relative z-10 mt-4",initial:{opacity:0,y:40},animate:{opacity:1,y:0},transition:{delay:1,duration:.8},children:t.jsxs(s.button,{onClick:h,className:"btn-glass--primary px-12 py-6 text-xl font-bold relative overflow-hidden",whileHover:{scale:1.03},whileTap:{scale:.97},style:{background:`linear-gradient(135deg, ${e.color}80, ${e.color}60)`,boxShadow:`0 12px 40px ${e.color}40, 0 0 60px ${e.color}30`,border:`2px solid ${e.color}`,color:"#0B0F1A"},children:[t.jsx("div",{className:"celebration-cta-shimmer absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent"}),[...Array(4)].map((m,o)=>t.jsx("div",{className:`celebration-cta-sparkle celebration-cta-sparkle--${o+1} absolute w-2 h-2 rounded-full bg-white`,style:{left:`${20+o*20}%`,top:`${30+o%2*40}%`}},o)),t.jsxs("div",{className:"relative flex items-center justify-center gap-4",children:[t.jsx(x,{Icon:l.Eye,size:28,color:"#0B0F1A"}),t.jsx("span",{children:"Mon Avatar 3D"})]})]})}),t.jsx("div",{className:"absolute inset-0 pointer-events-none overflow-visible",children:[...Array(8)].map((m,o)=>t.jsx("div",{className:`celebration-confetti celebration-confetti--${o+1} absolute w-2 h-6 rounded-full`,style:{background:`linear-gradient(180deg, ${e.color}, ${e.color}60)`,left:`${10+o*10}%`,top:"-10%","--celebration-color":e.color}},`confetti-${o}`))})]})};function g(r){const a=r?.match?.ai_refinement?.ai_confidence;if(typeof a=="number"&&Number.isFinite(a)&&a>0&&a<=1)return b.debug("CELEBRATION","Using AI refinement confidence (highest priority)",{confidence:a,source:"ai_refinement.ai_confidence",clientScanId:r?.clientScanId,serverScanId:r?.serverScanId,philosophy:"ai_refinement_confidence_priority"}),a;const n=[r?.match?.semantic_coherence_score,r?.estimate?.extracted_data?.processing_confidence,r?.insights?.confidence,r?.estimate?.confidence?.vision,r?.semantic?.semantic_confidence,r?.commit?.confidence,r?.blending?.confidence];for(const i of n)if(typeof i=="number"&&Number.isFinite(i)&&i>0&&i<=1)return b.debug("CELEBRATION","Found valid confidence from fallback source",{confidence:i,source:"fallback_hierarchy",clientScanId:r?.clientScanId,serverScanId:r?.serverScanId,philosophy:"fallback_confidence_used"}),i;return b.warn("CELEBRATION","No valid confidence found in scan results (including AI refinement)",{clientScanId:r?.clientScanId,serverScanId:r?.serverScanId,sourcesChecked:[{source:"ai_refinement.ai_confidence",value:a,type:typeof a,isValid:typeof a=="number"&&Number.isFinite(a)&&a>0&&a<=1},...n.map((i,d)=>({index:d,value:i,type:typeof i,isValid:typeof i=="number"&&Number.isFinite(i)&&i>0&&i<=1}))],philosophy:"no_confidence_found_comprehensive_check"}),0}const T=()=>{const{isActive:r,steps:a,currentStep:n,progress:i,message:d,subMessage:f}=y();return t.jsxs("div",{className:"max-w-4xl mx-auto mt-4 space-y-6 pb-4",children:[r&&a.length>0&&t.jsx(j,{steps:a,currentStepId:n,progress:100,message:"Scan Corporel Terminé",subMessage:"Votre avatar 3D est prêt"}),t.jsx(C,{})]})};export{T as default};
