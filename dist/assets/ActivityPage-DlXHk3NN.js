const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/page-fridge-BvAjnJpI.js","assets/vendor-DX97-qL9.js","assets/utils-CUtLAp28.js","assets/supabase-C_rF2iqf.js","assets/page-fridge-scan-ZLPWYd6x.js","assets/stores-DcNfcD_j.js","assets/ui-components-DWjWyKd7.js","assets/motion-DLE-fuXv.js","assets/ui-components-BfdLI5ID.css","assets/page-fridge-scan-DAz6gEg3.css","assets/date-utils-sCOX3Ksr.js"])))=>i.map(i=>d[i]);
import{R as B,e as we,cT as ze,c as K,j as e,u as se,cU as _e,b as $e,r as Me,cK as Oe}from"./vendor-DX97-qL9.js";import{u as ee,G as F,S as g,I as l,e as Pe,p as de,l as qe,o as G}from"./ui-components-DWjWyKd7.js";import{_ as Ve}from"./page-fridge-scan-ZLPWYd6x.js";import{b as L,a as Ce,l as te}from"./stores-DcNfcD_j.js";import{u as Y,l as C,s as V,H as Re}from"./page-fridge-BvAjnJpI.js";import{c as Le,d as He,g as Ge,f as Ye,a as q,b as Ie,e as Fe}from"./ActivityUtils-B02xsDYH.js";import{f as R,d as Ue,a as W,p as Ze,i as We,c as Ke}from"./date-utils-sCOX3Ksr.js";import{m as _,A as ke}from"./motion-DLE-fuXv.js";import"./utils-CUtLAp28.js";import"./supabase-C_rF2iqf.js";function Xe(t=100){const{session:a}=L();return K({queryKey:["activities","history",a?.user?.id,t],queryFn:async()=>{if(!a?.user?.id)throw new Error("User not authenticated");const s=new Date,o=new Date;return o.setDate(o.getDate()-30),Ge(a.user.id,o,s,t)},enabled:!!a?.user?.id,staleTime:5*60*1e3,gcTime:15*60*1e3,refetchOnWindowFocus:!1,retry:2})}function Se(t="last7Days"){const{session:a,profile:s}=L();return K({queryKey:["activities","insights",a?.user?.id,t],queryFn:async()=>{if(C.info("ACTIVITY_INSIGHTS_DIAGNOSTIC","queryFn execution started",{userId:a?.user?.id,period:t,executionTime:new Date().toISOString(),reason:"react_query_triggered_execution",cacheStrategy:"server_side_cache_first",timestamp:new Date().toISOString()}),!a?.user?.id)throw new Error("User not authenticated");const o={weight_kg:s?.weight_kg||70,height_cm:s?.height_cm,sex:s?.sex,birthdate:s?.birthdate,activity_level:s?.activity_level,objective:s?.objective},n="https://kwipydbtjagypocpvbwn.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt3aXB5ZGJ0amFneXBvY3B2YnduIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ2ODg0MjIsImV4cCI6MjA3MDI2NDQyMn0.IS5IdKbmnGtgU_AaGYtUgX3ewaNpsiSAui5kbFV31_U";C.info("ACTIVITY_INSIGHTS_DIAGNOSTIC","MAKING FETCH CALL WITH SERVER-SIDE CACHE",{userId:a.user.id,period:t,endpoint:`${n}/functions/v1/activity-progress-generator`,cacheStrategy:"Server will check cache first, then call OpenAI if needed",timestamp:new Date().toISOString()});const c=await fetch(`${n}/functions/v1/activity-progress-generator`,{method:"POST",headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"},body:JSON.stringify({userId:a.user.id,period:t,userProfile:o,clientTraceId:`activity_insights_${Date.now()}`})});if(!c.ok){const p=await c.json().catch(()=>({}));if(c.status===400&&p.error==="Insufficient data")return C.info("ACTIVITY_INSIGHTS","Insufficient data for insights generation",{userId:a.user.id,period:t,requiredActivities:p.required_activities,currentActivities:p.current_activities,timestamp:new Date().toISOString()}),{insufficient_data:!0,required_activities:p.required_activities,current_activities:p.current_activities,message:p.message};throw new Error(`Erreur de génération d'insights: ${c.statusText}`)}const r=await c.json();return C.info("ACTIVITY_INSIGHTS_DIAGNOSTIC","API CALL COMPLETED",{userId:a.user.id,period:t,insightsCount:r.insights?.length||0,costUsd:r.costUsd,processingTime:r.processingTime,cached:r.cached||!1,cacheAge:r.cache_age_hours,fallback:r.fallback||!1,creditsConsumed:!r.cached&&!r.fallback,timestamp:new Date().toISOString()}),r},enabled:!!a?.user?.id,staleTime:et(t),gcTime:tt(t),refetchOnWindowFocus:!1,retry:(o,n)=>n?.message?.includes("Insufficient data")?!1:o<1})}function Je(){const{session:t}=L(),a=new Date;return K({queryKey:["activities","daily",t?.user?.id,R(a,"yyyy-MM-dd")],queryFn:()=>{if(!t?.user?.id)throw new Error("User not authenticated");return Ye(t.user.id,a)},enabled:!!t?.user?.id,staleTime:5*60*1e3,gcTime:10*60*1e3,refetchOnWindowFocus:!0,retry:2})}function Qe(){const{data:t,isLoading:a,error:s}=Je();return{data:B.useMemo(()=>t?Le(t):null,[t]),isLoading:a,error:s,activities:t||[]}}function Be(){const{session:t}=L(),{showToast:a}=ee(),{success:s,error:o}=Y(),n=we();return ze({mutationFn:async i=>{if(!t?.user?.id)throw new Error("User not authenticated");if(!i||i.trim().length===0)throw new Error("ID d'activité invalide");return await He(i,t.user.id),i},onSuccess:i=>{s(),a({type:"success",title:"Activité supprimée",message:"L'activité a été supprimée avec succès",duration:3e3}),n.invalidateQueries({queryKey:["activities","daily",t?.user?.id]}),n.invalidateQueries({queryKey:["activities","recent",t?.user?.id]}),n.invalidateQueries({queryKey:["activities","stats",t?.user?.id]}),C.info("ACTIVITIES_HOOK","Activity deleted successfully",{activityId:i,userId:t?.user?.id,timestamp:new Date().toISOString()})},onError:i=>{o(),a({type:"error",title:"Erreur de suppression",message:i instanceof Error?i.message:"Impossible de supprimer l'activité",duration:4e3}),C.error("ACTIVITIES_HOOK","Failed to delete activity",{error:i instanceof Error?i.message:"Unknown error",userId:t?.user?.id,timestamp:new Date().toISOString()})}})}function Ee(){const{session:t}=L();return K({queryKey:["activities","has-history",t?.user?.id],queryFn:async()=>{if(!t?.user?.id)return!1;const{data:a,error:s}=await V.from("activities").select("id").eq("user_id",t.user.id).limit(1);return s?(C.error("ACTIVITIES_REPO","Failed to check activity history",{error:s.message,userId:t.user.id,timestamp:new Date().toISOString()}),!1):(a?.length||0)>0},enabled:!!t?.user?.id,staleTime:5*60*1e3,retry:1})}function H(t){switch(t){case"last7Days":return 3;case"last30Days":return 8;case"last3Months":return 20;case"last6Months":return 35;case"last1Year":return 60;default:return 8}}function et(t){switch(t){case"last7Days":return 1e3*60*60*12;case"last30Days":return 1e3*60*60*72;case"last3Months":return 1e3*60*60*168;case"last6Months":return 1e3*60*60*336;case"last1Year":return 1e3*60*60*720;default:return 1e3*60*60*12}}function tt(t){switch(t){case"last7Days":return 7*24*60*60*1e3;case"last30Days":return 14*24*60*60*1e3;case"last3Months":return 30*24*60*60*1e3;case"last6Months":return 60*24*60*60*1e3;case"last1Year":return 90*24*60*60*1e3;default:return 7*24*60*60*1e3}}function st(t){const a=["sex","height_cm","weight_kg"],s=["birthdate","activity_level","objective"],o=a.filter(p=>!t?.[p]),n=s.filter(p=>!t?.[p]),i=a.length+s.length,c=i-o.length-n.length;return{percentage:Math.round(c/i*100),missingCritical:o,missingOptional:n,hasBasicInfo:o.length===0,canUseActivityFeatures:o.length===0}}function rt(t){return t.missingCritical.length>0?{bg:"rgba(239, 68, 68, 0.08)",border:"rgba(239, 68, 68, 0.25)",text:"#EF4444",icon:"AlertCircle"}:t.missingOptional.length>0?{bg:"rgba(245, 158, 11, 0.08)",border:"rgba(245, 158, 11, 0.25)",text:"#F59E0B",icon:"Info"}:{bg:"rgba(34, 197, 94, 0.08)",border:"rgba(34, 197, 94, 0.25)",text:"#22C55E",icon:"Check"}}function at(t){return t.missingCritical.length>0?{title:"Profil incomplet pour le tracking d'activité",actionText:"Compléter"}:t.missingOptional.length>0?{title:"Optimisez votre tracking d'activité",actionText:"Améliorer"}:{title:"Profil optimisé pour le tracking d'activité",actionText:"Voir profil"}}const pe=({profile:t})=>{const a=st(t),s=rt(a),o=at(a);return a.percentage>=100?null:e.jsx(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:e.jsx(F,{className:"p-4 activity-card-base",style:{background:`radial-gradient(circle at 30% 20%, ${s.bg} 0%, transparent 60%), var(--glass-opacity)`,borderColor:s.border},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`${s.text}20`,border:`1px solid ${s.text}40`},children:e.jsx(g,{Icon:l[s.icon],size:12,style:{color:s.text}})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-white font-medium text-sm",children:o.title}),e.jsx("div",{className:"text-white/60 text-xs mt-1",children:a.missingCritical.length>0?`${a.missingCritical.length} champs critiques manquants`:`${a.percentage}% complété`})]})]}),e.jsx(Pe,{to:"/profile#identity",className:"btn-glass--secondary-nav px-3 py-1.5 text-xs",style:{background:"rgba(59, 130, 246, 0.15)",borderColor:"rgba(59, 130, 246, 0.3)",color:"#3B82F6"},children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(g,{Icon:l.User,size:12}),e.jsx("span",{children:o.actionText})]})})]})})})};function it(t){const a=t?.activitiesCount||0,s=t?.totalCalories||0;return a===0?{priority:"high",color:"#3B82F6",icon:"Zap",animation:"pulse"}:a<2||s<200?{priority:"medium",color:"#06B6D4",icon:"Activity",animation:"breathing"}:{priority:"low",color:"#22C55E",icon:"Target",animation:"none"}}function nt(t,a){const s=a?.activitiesCount||0;return t.priority==="high"?{title:"Forgez votre énergie aujourd'hui !",subtitle:"Aucune activité enregistrée aujourd'hui - Commencez dès maintenant",buttonText:"Enregistrer une activité",encouragement:"Chaque mouvement d'aujourd'hui compte pour votre bien-être"}:t.priority==="medium"?{title:"Continuez votre journée active",subtitle:`${s} activité${s>1?"s":""} aujourd'hui - Ajoutez-en une autre !`,buttonText:"Ajouter une activité",encouragement:"Maintenez votre rythme énergétique d'aujourd'hui"}:{title:"Excellente journée active !",subtitle:"Vous avez déjà bien forgé votre énergie aujourd'hui",buttonText:"Ajouter une activité",encouragement:"Continuez à cultiver votre vitalité aujourd'hui"}}function ot(t,a){const s=[];return t?.totalCalories>0&&s.push(`${t.totalCalories} kcal brûlées`),t?.totalDuration>0&&s.push(`${t.totalDuration} min actives`),t?.activitiesCount>0&&s.push(`${t.activitiesCount} activité${t.activitiesCount>1?"s":""}`),s}function lt(t){return t.priority==="high"||t.priority==="medium"}function ge(t){return t.priority==="high"?6:t.priority==="medium"?4:0}const ct=({todayStats:t,profile:a})=>{const s=se(),{click:o}=Y(),n=de()==="reduced",i=it(t),c=nt(i,t),r=ot(t),p=(t?.activitiesCount||0)>0,x=()=>{o(),s("/activity/input")},d=()=>{o(),s("/activity#insights")},h={background:`
      radial-gradient(circle at 30% 20%, color-mix(in srgb, ${i.color} 12%, transparent) 0%, transparent 60%),
      radial-gradient(circle at 70% 80%, color-mix(in srgb, ${i.color} 8%, transparent) 0%, transparent 50%),
      var(--glass-opacity)
    `,borderColor:`color-mix(in srgb, ${i.color} 25%, transparent)`,"--glow-color":`color-mix(in srgb, ${i.color} 30%, transparent)`},m={background:`
      radial-gradient(circle at 30% 30%, rgba(255,255,255,0.25) 0%, transparent 60%),
      linear-gradient(135deg, color-mix(in srgb, ${i.color} 40%, transparent), color-mix(in srgb, ${i.color} 28%, transparent))
    `,border:`2px solid color-mix(in srgb, ${i.color} 55%, transparent)`,boxShadow:`0 0 30px color-mix(in srgb, ${i.color} 40%, transparent)`,"--icon-color":i.color};return e.jsx("div",{className:"dynamic-activity-cta activity-capture-enter",children:e.jsxs(F,{className:"p-6 md:p-8 text-center relative overflow-hidden cursor-pointer activity-card-base",onClick:x,interactive:!0,style:h,children:[e.jsx("div",{className:"training-hero-corners","aria-hidden":"true",children:[0,1,2,3].map(u=>e.jsx(_.div,{className:"corner-particle",style:{position:"absolute",width:"8px",height:"8px",borderRadius:"2px",background:`linear-gradient(135deg, ${i.color}, rgba(255, 255, 255, 0.8))`,boxShadow:`0 0 20px ${i.color}`,top:u<2?"12px":"auto",bottom:u>=2?"12px":"auto",left:u%2===0?"12px":"auto",right:u%2===1?"12px":"auto"},initial:{rotate:u%2===0?45:-45},animate:{scale:[1,1.3,1],opacity:[.6,1,.6],rotate:u%2===0?[45,60,45]:[-45,-60,-45]},transition:{duration:3,repeat:1/0,delay:u*.2,ease:[.4,0,.2,1]}},u))}),i.priority==="high"&&!n&&e.jsx("div",{className:"absolute inset-0 rounded-inherit pointer-events-none urgent-forge-glow-css",style:{background:`radial-gradient(circle at center, color-mix(in srgb, ${i.color} 8%, transparent) 0%, transparent 70%)`,filter:"blur(20px)",transform:"scale(1.2)",zIndex:-1}}),e.jsxs("div",{className:"relative z-10 space-y-4 md:space-y-6",children:[e.jsxs("div",{className:`activity-icon-enhanced mx-auto rounded-full flex items-center justify-center relative ${i.animation==="pulse"&&!n?"icon-pulse-css":i.animation==="breathing"&&!n?"icon-breathing-css":""}`,style:m,children:[e.jsx(g,{Icon:l[i.icon],size:i.priority==="high"?64:56,style:{color:i.color}}),lt(i)&&!n&&[...Array(ge(i))].map((u,b)=>{const f=b*360/ge(i),w=60,I=Math.cos(f*Math.PI/180)*w,y=Math.sin(f*Math.PI/180)*w;return e.jsx("div",{className:`absolute w-2 h-2 rounded-full dynamic-particle-css dynamic-particle-css--${b+1}`,style:{background:i.color,boxShadow:`0 0 12px color-mix(in srgb, ${i.color} 70%, transparent)`,"--particle-x":`${I*.4}px`,"--particle-y":`${y*.4}px`,"--particle-x-end":`${I}px`,"--particle-y-end":`${y}px`}},b)})]}),e.jsxs("div",{className:"space-y-2 md:space-y-3",children:[e.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white",children:c.title}),e.jsx("p",{className:"text-white/80 text-base md:text-lg leading-relaxed max-w-md mx-auto",children:c.subtitle}),c.encouragement&&e.jsx("p",{className:"text-white/60 text-sm italic",children:c.encouragement})]}),r.length>0&&e.jsx("div",{className:"flex flex-wrap items-center justify-center gap-3 text-sm",children:r.map((u,b)=>e.jsx("div",{className:"px-3 py-1.5 rounded-full metric-badge-enter",style:{background:`color-mix(in srgb, ${i.color} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${i.color} 25%, transparent)`,color:i.color,backdropFilter:"blur(8px) saturate(120%)",animationDelay:`${b*.1}s`},children:e.jsx("span",{className:"font-medium",children:u})},b))}),e.jsxs(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.8},className:"flex flex-col gap-4 items-center",children:[e.jsxs(_.button,{onClick:x,className:"px-8 py-4 rounded-full font-bold text-lg text-white relative overflow-hidden min-h-[64px] w-full sm:w-auto",style:{background:`
                  linear-gradient(135deg,
                    color-mix(in srgb, ${i.color} 85%, transparent),
                    color-mix(in srgb, ${i.color} 70%, transparent)
                  )
                `,border:`2px solid ${i.color}`,boxShadow:`
                  0 12px 40px color-mix(in srgb, ${i.color} 40%, transparent),
                  0 0 60px color-mix(in srgb, ${i.color} 30%, transparent),
                  inset 0 3px 0 rgba(255, 255, 255, 0.4)
                `,backdropFilter:"blur(20px) saturate(160%)"},whileHover:{scale:1.02,y:-2,boxShadow:`
                  0 16px 50px color-mix(in srgb, ${i.color} 50%, transparent),
                  0 0 80px color-mix(in srgb, ${i.color} 40%, transparent),
                  inset 0 3px 0 rgba(255, 255, 255, 0.5)
                `},whileTap:{scale:.98},children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{background:"linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent)",animation:"celebration-cta-shimmer-movement 2s ease-in-out infinite",borderRadius:"inherit"}}),e.jsxs("div",{className:"relative z-10 flex items-center justify-center gap-3",children:[e.jsx(g,{Icon:l[i.icon],size:24,style:{color:"white",filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.3))"},variant:"pure"}),e.jsx("span",{style:{textShadow:"0 2px 4px rgba(0,0,0,0.3)"},children:c.buttonText})]})]}),p&&e.jsx(_.button,{onClick:d,className:"px-6 py-4 rounded-full font-medium text-white/90 transition-all duration-200 min-h-[64px]",style:{background:`color-mix(in srgb, ${i.color} 8%, transparent)`,border:`1px solid color-mix(in srgb, ${i.color} 20%, transparent)`,backdropFilter:"blur(12px) saturate(130%)"},onMouseEnter:u=>{u.currentTarget.style.background=`color-mix(in srgb, ${i.color} 12%, transparent)`,u.currentTarget.style.borderColor=`color-mix(in srgb, ${i.color} 30%, transparent)`,u.currentTarget.style.transform="translateY(-1px) scale(1.02)"},onMouseLeave:u=>{u.currentTarget.style.background=`color-mix(in srgb, ${i.color} 8%, transparent)`,u.currentTarget.style.borderColor=`color-mix(in srgb, ${i.color} 20%, transparent)`,u.currentTarget.style.transform="translateY(0) scale(1)"},whileHover:{scale:1.02,y:-1},whileTap:{scale:.98},children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(g,{Icon:l.Zap,size:20,color:"white",variant:"pure"}),e.jsx("span",{children:"Voir mes Insights"})]})})]})]})]})})},O="#18E3FF",dt=()=>{const t=se(),{session:a}=L(),{data:s,isLoading:o}=K({queryKey:["last-training-info",a?.user?.id],queryFn:async()=>{if(!a?.user?.id)return{lastSessionDate:null,daysSinceLastSession:999,hasDraft:!1};const{data:r}=await V.from("training_sessions").select("completed_at").eq("user_id",a.user.id).eq("status","completed").order("completed_at",{ascending:!1}).limit(1).maybeSingle(),{data:p}=await V.from("training_sessions").select("id").eq("user_id",a.user.id).eq("status","draft").limit(1).maybeSingle(),x=r?.completed_at?new Date(r.completed_at):null,d=x?Ue(new Date,x):999;return{lastSessionDate:x,daysSinceLastSession:d,hasDraft:!!p}},enabled:!!a?.user?.id,staleTime:2*60*1e3});if(!o&&s&&s.daysSinceLastSession<3)return null;const n=()=>{Re.press(),t("/training/pipeline")};if(o)return null;const c=s?s.hasDraft?{title:"Reprendre votre draft",subtitle:"Vous avez une session en cours de préparation",buttonText:"Continuer le Training"}:s.daysSinceLastSession>=7?{title:"Prêt à reprendre le training?",subtitle:"Plus de 7 jours sans entraînement structuré",buttonText:"Générer une Séance"}:{title:"Besoin d'un plan structuré?",subtitle:"Générez votre prochaine séance personnalisée",buttonText:"Lancer le Générateur"}:{title:"Commencez votre première session",subtitle:"Générez un programme d'entraînement personnalisé",buttonText:"Créer mon Training"};return e.jsx(_.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.16,1,.3,1]},children:e.jsxs(F,{className:"p-6 relative overflow-hidden cursor-pointer",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, ${O} 12%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, ${O} 8%, transparent) 0%, transparent 50%),
            rgba(255, 255, 255, 0.08)
          `,border:`1px solid color-mix(in srgb, ${O} 25%, transparent)`,boxShadow:`0 4px 16px rgba(0, 0, 0, 0.2), 0 0 24px color-mix(in srgb, ${O} 12%, transparent)`},onClick:n,children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none","aria-hidden":"true",children:[0,1,2,3].map(r=>e.jsx(_.div,{className:"absolute w-2 h-2 rounded-sm",style:{background:`linear-gradient(135deg, ${O}, rgba(255, 255, 255, 0.8))`,boxShadow:`0 0 12px ${O}`,top:r<2?"8px":"auto",bottom:r>=2?"8px":"auto",left:r%2===0?"8px":"auto",right:r%2===1?"8px":"auto"},initial:{rotate:r%2===0?45:-45},animate:{scale:[1,1.2,1],opacity:[.5,1,.5],rotate:r%2===0?[45,55,45]:[-45,-55,-45]},transition:{duration:2.5,repeat:1/0,delay:r*.15,ease:[.4,0,.2,1]}},r))}),e.jsxs("div",{className:"flex items-center justify-between mb-4 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_.div,{className:"w-12 h-12 rounded-xl flex items-center justify-center",style:{background:`
                  radial-gradient(circle at 30% 30%, color-mix(in srgb, ${O} 35%, transparent) 0%, transparent 60%),
                  rgba(255, 255, 255, 0.12)
                `,border:`2px solid color-mix(in srgb, ${O} 50%, transparent)`,boxShadow:`0 4px 16px color-mix(in srgb, ${O} 30%, transparent)`},whileHover:{scale:1.05,rotate:-5},whileTap:{scale:.95},children:e.jsx(_.div,{animate:{rotate:[0,10,-10,0],y:[0,-2,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},children:e.jsx(g,{Icon:l.Dumbbell,size:24,style:{color:O,filter:`drop-shadow(0 0 12px ${O}90)`}})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-bold text-lg",children:"Atelier de Training"}),e.jsx("p",{className:"text-white/50 text-xs",children:"Générateur intelligent de séances"})]})]}),e.jsx(_.div,{whileHover:{x:3},transition:{type:"spring",stiffness:400,damping:25},children:e.jsx(g,{Icon:l.ChevronRight,size:20,style:{color:"rgba(255, 255, 255, 0.4)"}})})]}),e.jsxs("div",{className:"mb-4 relative z-10",children:[e.jsx("h4",{className:"text-white font-semibold text-base mb-1",children:c.title}),e.jsx("p",{className:"text-white/60 text-sm",children:c.subtitle})]}),s&&(s.hasDraft||s.daysSinceLastSession>=7)&&e.jsxs("div",{className:"px-3 py-2 rounded-lg mb-4 flex items-center gap-2 relative z-10",style:{background:s.hasDraft?"rgba(34, 197, 94, 0.1)":"rgba(245, 158, 11, 0.1)",border:s.hasDraft?"1px solid rgba(34, 197, 94, 0.2)":"1px solid rgba(245, 158, 11, 0.2)"},children:[e.jsx(g,{Icon:s.hasDraft?l.FileText:l.Clock,size:14,style:{color:s.hasDraft?"#22C55E":"#F59E0B"}}),e.jsx("span",{className:"text-xs text-white/80",children:s.hasDraft?"Draft sauvegardé prêt à être repris":`${s.daysSinceLastSession} jours sans training structuré`})]}),e.jsxs(_.button,{whileHover:{scale:1.02,y:-2,transition:{type:"spring",stiffness:400,damping:25}},whileTap:{scale:.98,y:0,transition:{type:"spring",stiffness:500,damping:30}},className:"w-full px-4 py-3.5 rounded-xl font-bold text-sm flex items-center justify-center gap-2 relative overflow-hidden group",style:{background:`linear-gradient(180deg, ${O} 0%, color-mix(in srgb, ${O} 85%, #000) 100%)`,border:`2px solid ${O}`,color:"#FFFFFF",textShadow:"0 2px 6px rgba(0, 0, 0, 0.4)",boxShadow:`
              0 1px 0 0 rgba(255, 255, 255, 0.35) inset,
              0 -1px 0 0 rgba(0, 0, 0, 0.2) inset,
              0 10px 30px -5px color-mix(in srgb, ${O} 60%, transparent),
              0 5px 15px -2px rgba(0, 0, 0, 0.5)
            `},children:[e.jsx(_.div,{className:"absolute inset-0 pointer-events-none",style:{background:"linear-gradient(120deg, transparent 0%, transparent 40%, rgba(255, 255, 255, 0.3) 50%, transparent 60%, transparent 100%)"},animate:{x:["-200%","200%"]},transition:{duration:3,repeat:1/0,repeatDelay:2,ease:"easeInOut"}}),e.jsx("div",{className:"absolute top-0 left-8 right-8 h-[2px] rounded-full opacity-60",style:{background:"linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.8), transparent)"}}),e.jsx("span",{className:"relative z-10",children:c.buttonText}),e.jsx(_.div,{className:"relative z-10",animate:{x:[0,4,0]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"},children:e.jsx(g,{Icon:l.Target,size:18,style:{color:"#FFFFFF",filter:"drop-shadow(0 0 10px rgba(255, 255, 255, 0.6))"}})}),e.jsx("div",{className:"absolute -bottom-2 left-8 right-8 h-2 rounded-full blur-md opacity-50 group-hover:opacity-70 transition-opacity",style:{background:`radial-gradient(ellipse, ${O} 0%, transparent 70%)`}})]})]})})},Ae=B.memo(({todayStats:t})=>e.jsxs("div",{className:"daily-stats-grid",children:[e.jsxs(F,{className:"daily-stat-card daily-stat-card-primary",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"daily-stat-icon-container daily-stat-icon-primary",children:e.jsx(g,{Icon:l.Zap,size:28,style:{color:"#3B82F6"}})}),e.jsx("h3",{className:"daily-stat-title",children:"Énergie Brûlée Aujourd'hui"}),e.jsx("p",{className:"daily-stat-subtitle",children:"Calories du jour"})]}),e.jsx("div",{className:"daily-stat-value",children:t?.totalCalories||0}),e.jsx("div",{className:"daily-stat-label",children:"kcal forgées"})]}),e.jsxs(F,{className:"daily-stat-card daily-stat-card-secondary",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"daily-stat-icon-container daily-stat-icon-secondary",children:e.jsx(g,{Icon:l.Activity,size:28,className:"text-cyan-400"})}),e.jsx("h3",{className:"daily-stat-title",children:"Activités d'Aujourd'hui"}),e.jsx("p",{className:"daily-stat-subtitle",children:"Mouvements forgés"})]}),e.jsx("div",{className:"daily-stat-value",children:t?.activitiesCount||0}),e.jsx("div",{className:"daily-stat-label",children:"Sessions du jour"})]}),e.jsxs(F,{className:"daily-stat-card daily-stat-card-accent",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"daily-stat-icon-container daily-stat-icon-accent",children:e.jsx(g,{Icon:l.Clock,size:28,className:"text-purple-400"})}),e.jsx("h3",{className:"daily-stat-title",children:"Dernière Activité"}),e.jsx("p",{className:"daily-stat-subtitle",children:"Heure de la dernière forge"})]}),e.jsx("div",{className:"daily-stat-value",children:t?.lastActivityTime?R(t.lastActivityTime,"HH:mm"):"--:--"}),e.jsx("div",{className:"daily-stat-label",children:t?.lastActivityTime?R(t.lastActivityTime,"dd/MM",{locale:W}):"Aucune aujourd'hui"})]})]}));Ae.displayName="DailyStatsGrid";function le(t){const a=["musculation","crossfit","bodyweight","weight","force","strength"];return t.filter(s=>a.some(o=>s.type.toLowerCase().includes(o))).reduce((s,o)=>s+o.duration_min,0)}function xt(t,a,s=[]){const o=a?.objective,n=a?.activity_level;switch(o){case"muscle_gain":{const i=le(s),c=he(n),r=i/c*100;return r<50?{status:"low",color:"#A855F7",message:"Volume de force insuffisant",recommendation:"Ajoutez des exercices de musculation pour stimuler la croissance",priority:"high",mainMetricLabel:"Volume de Force",subMetricLabel:"Minutes de musculation",currentValue:i,targetValue:c,unit:"min",icon:"Dumbbell",progressPercentage:r}:r>=50&&r<100?{status:"optimal",color:"#A855F7",message:"Bon volume d'entraînement",recommendation:"Continuez pour atteindre votre volume optimal de force",priority:"medium",mainMetricLabel:"Volume de Force",subMetricLabel:"Minutes de musculation",currentValue:i,targetValue:c,unit:"min",icon:"Dumbbell",progressPercentage:r}:{status:"high",color:"#A855F7",message:"Objectif de force atteint !",recommendation:"Excellent volume d'entraînement, maintenez cette intensité",priority:"low",mainMetricLabel:"Volume de Force",subMetricLabel:"Minutes de musculation",currentValue:i,targetValue:c,unit:"min",icon:"Dumbbell",progressPercentage:r}}case"fat_loss":{const i=t?.totalCalories||0,c=re(n,"fat_loss"),r=i/c*100;return r<50?{status:"low",color:"#EF4444",message:"Déficit énergétique insuffisant",recommendation:"Augmentez le cardio et la musculation pour brûler plus de calories",priority:"high",mainMetricLabel:"Énergie Brûlée",subMetricLabel:"Calories de perte",currentValue:i,targetValue:c,unit:"kcal",icon:"Fire",progressPercentage:r}:r>=50&&r<100?{status:"optimal",color:"#EF4444",message:"Bon déficit énergétique",recommendation:"Continuez ce rythme pour optimiser la perte de graisse",priority:"medium",mainMetricLabel:"Énergie Brûlée",subMetricLabel:"Calories de perte",currentValue:i,targetValue:c,unit:"kcal",icon:"Fire",progressPercentage:r}:{status:"high",color:"#EF4444",message:"Objectif de perte atteint !",recommendation:"Excellent déficit énergétique, vous êtes sur la bonne voie",priority:"low",mainMetricLabel:"Énergie Brûlée",subMetricLabel:"Calories de perte",currentValue:i,targetValue:c,unit:"kcal",icon:"Fire",progressPercentage:r}}case"recomp":{const i=t?.totalCalories||0,c=le(s),r=re(n,"recomp"),p=he(n)*.7,x=Math.min(100,i/r*100),d=Math.min(100,c/p*100),h=x*.6+d*.4;return h<50?{status:"low",color:"#F59E0B",message:"Équilibre énergétique insuffisant",recommendation:"Combinez cardio et musculation pour une recomposition optimale",priority:"high",mainMetricLabel:"Équilibre Énergétique",subMetricLabel:"Calories & Force",currentValue:i,targetValue:r,unit:"kcal",icon:"GitCompare",progressPercentage:h}:h>=50&&h<100?{status:"optimal",color:"#F59E0B",message:"Bon équilibre énergétique",recommendation:"Maintenez ce mix cardio-force pour la recomposition",priority:"medium",mainMetricLabel:"Équilibre Énergétique",subMetricLabel:"Calories & Force",currentValue:i,targetValue:r,unit:"kcal",icon:"GitCompare",progressPercentage:h}:{status:"high",color:"#F59E0B",message:"Équilibre optimal atteint !",recommendation:"Parfait équilibre pour la recomposition corporelle",priority:"low",mainMetricLabel:"Équilibre Énergétique",subMetricLabel:"Calories & Force",currentValue:i,targetValue:r,unit:"kcal",icon:"GitCompare",progressPercentage:h}}default:{const i=t?.totalCalories||0,c=re(n,"maintenance"),r=i/c*100;return r<50?{status:"low",color:"#3B82F6",message:"Énergie faiblement forgée",recommendation:"Ajoutez des activités pour atteindre votre objectif",priority:"high",mainMetricLabel:"Énergie Quotidienne",subMetricLabel:"Calories forgées",currentValue:i,targetValue:c,unit:"kcal",icon:"Zap",progressPercentage:r}:r>=50&&r<100?{status:"optimal",color:"#3B82F6",message:"Bonne progression énergétique",recommendation:"Continuez pour atteindre votre objectif quotidien",priority:"medium",mainMetricLabel:"Énergie Quotidienne",subMetricLabel:"Calories forgées",currentValue:i,targetValue:c,unit:"kcal",icon:"Zap",progressPercentage:r}:{status:"high",color:"#3B82F6",message:"Objectif énergétique atteint !",recommendation:"Excellente journée active, maintenez ce rythme",priority:"low",mainMetricLabel:"Énergie Quotidienne",subMetricLabel:"Calories forgées",currentValue:i,targetValue:c,unit:"kcal",icon:"Zap",progressPercentage:r}}}}function re(t,a){let s=300;switch(t){case"athlete":s=500;break;case"active":s=400;break;case"moderate":s=350;break;case"light":s=250;break;case"sedentary":s=200;break}switch(a){case"fat_loss":return s+100;case"recomp":return s+50;case"maintenance":return s;default:return s}}function he(t){switch(t){case"athlete":return 40;case"active":return 30;case"moderate":return 25;case"light":return 20;case"sedentary":return 15;default:return 25}}const mt=({todayStats:t,profile:a,todayActivities:s=[]})=>{const o=xt(t,a,s);return e.jsxs(F,{className:"calorie-progress-card",style:{"--recommendation-color":o.color},children:[e.jsxs("div",{className:"calorie-progress-header",children:[e.jsx("div",{className:"calorie-progress-icon",children:e.jsx(g,{Icon:l[o.icon],size:36,style:{color:o.color}})}),e.jsxs("div",{className:"calorie-progress-info",children:[e.jsxs("h3",{className:"calorie-progress-title",children:[o.mainMetricLabel," Aujourd'hui"]}),e.jsxs("p",{className:"calorie-progress-subtitle",children:["Progression vers votre objectif ",o.subMetricLabel.toLowerCase()," du jour"]})]}),e.jsxs("div",{className:"calorie-progress-percentage",children:[e.jsxs("div",{className:"calorie-progress-percentage-value",children:[Math.round(o.progressPercentage),"%"]}),e.jsx("div",{className:"calorie-progress-percentage-label",children:"Complété"})]})]}),e.jsx("div",{className:"calorie-progress-message",children:e.jsxs("div",{className:"calorie-progress-message-header",children:[e.jsx(g,{Icon:o.priority==="high"?l.AlertCircle:o.priority==="medium"?l.Info:l.Check,size:16,style:{color:o.color},className:"mt-0.5"}),e.jsxs("div",{className:"calorie-progress-message-content",children:[e.jsx("p",{className:"calorie-progress-message-title",style:{color:o.color},children:o.message}),e.jsx("p",{className:"calorie-progress-message-description",children:o.recommendation})]})]})}),e.jsx("div",{className:"calorie-progress-bar-container",children:e.jsx("div",{className:"calorie-progress-bar-fill",style:{width:`${Math.min(100,o.progressPercentage)}%`,background:`linear-gradient(90deg, ${o.color}, color-mix(in srgb, ${o.color} 80%, white))`},children:e.jsx("div",{className:"calorie-progress-bar-shimmer"})})}),e.jsxs("div",{className:"calorie-progress-values",children:[e.jsxs("span",{children:[o.currentValue," ",o.unit]}),e.jsxs("span",{children:[o.targetValue," ",o.unit]})]}),e.jsxs("div",{className:"calorie-progress-objective",children:["Objectif d'aujourd'hui : ",o.subMetricLabel.toLowerCase(),a?.objective&&` • Cible: ${a.objective==="fat_loss"?"Perte de graisse":a.objective==="muscle_gain"?"Prise de muscle":a.objective==="recomp"?"Recomposition":"Maintenance"}`]}),a?.objective==="recomp"&&e.jsxs("div",{className:"calorie-progress-details-grid",children:[e.jsxs("div",{className:"calorie-progress-detail-card",style:{background:"color-mix(in srgb, #EF4444 8%, transparent)",border:"1px solid color-mix(in srgb, #EF4444 15%, transparent)"},children:[e.jsx("div",{className:"calorie-progress-detail-value text-red-400",children:t?.totalCalories||0}),e.jsx("div",{className:"calorie-progress-detail-label text-red-300",children:"Calories"})]}),e.jsxs("div",{className:"calorie-progress-detail-card",style:{background:"color-mix(in srgb, #A855F7 8%, transparent)",border:"1px solid color-mix(in srgb, #A855F7 15%, transparent)"},children:[e.jsx("div",{className:"calorie-progress-detail-value text-purple-400",children:le(s)}),e.jsx("div",{className:"calorie-progress-detail-label text-purple-300",children:"Min Force"})]})]})]})},ut=({todayStats:t,profile:a})=>{const s=[{color:"#3B82F6",name:"Durée Totale",value:`${t?.totalDuration||0} min`,icon:"Clock"},{color:"#06B6D4",name:"Intensité Moy.",value:t?.averageIntensity||"Aucune",icon:"Zap"},{color:"#8B5CF6",name:"Type Principal",value:t?.mostFrequentType||"Aucun",icon:"Target"},{color:"#10B981",name:"Activités",value:`${t?.activitiesCount||0}`,icon:"Activity"}];return e.jsxs(F,{className:"activity-summary-card",children:[e.jsxs("div",{className:"activity-summary-header",children:[e.jsx("div",{className:"activity-summary-icon activity-icon-primary activity-icon-container-md",children:e.jsx(g,{Icon:l.BarChart3,size:20,style:{color:"var(--color-activity-primary)"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"activity-summary-title",children:"Résumé d'Aujourd'hui"}),e.jsx("p",{className:"activity-summary-subtitle",children:"Aperçu de vos activités du jour"})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:s.map((o,n)=>e.jsxs("div",{className:"activity-stat-card text-center rounded-xl activity-metric-enter",style:{background:`color-mix(in srgb, ${o.color} 8%, transparent)`,border:`1px solid color-mix(in srgb, ${o.color} 20%, transparent)`,animationDelay:`${.5+n*.1}s`},children:[e.jsx("div",{className:"flex items-center justify-center gap-1 mb-2",children:e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{background:`color-mix(in srgb, ${o.color} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${o.color} 25%, transparent)`},children:e.jsx(g,{Icon:l[o.icon],size:12,style:{color:o.color}})})}),e.jsx("div",{className:"text-lg font-bold",style:{color:o.color},children:o.value}),e.jsx("div",{className:"text-sm font-medium",style:{color:o.color},children:o.name})]},o.name))}),(t?.activitiesCount||0)>0&&e.jsxs("div",{className:"mt-4 p-4 rounded-xl",style:{background:"color-mix(in srgb, var(--brand-accent) 6%, transparent)",border:"1px solid color-mix(in srgb, var(--brand-accent) 15%, transparent)"},children:[e.jsxs("h4",{className:"text-cyan-300 font-medium text-sm mb-2 flex items-center gap-2",children:[e.jsx(g,{Icon:l.Info,size:12,style:{color:"var(--brand-accent)"}}),"Optimisations Forge"]}),e.jsxs("div",{className:"activity-summary-content space-y-1",children:[e.jsx("p",{children:"• Excellente diversité d'activités aujourd'hui"}),e.jsx("p",{children:"• Maintenez ce rythme pour optimiser votre forme"}),a?.objective==="fat_loss"&&e.jsx("p",{children:"• Activités cardio recommandées pour votre objectif"})]})]})]})};function pt(t){const a=t.toLowerCase();return a.includes("course")||a.includes("running")||a.includes("marche")||a.includes("walk")||a.includes("velo")||a.includes("bike")||a.includes("natation")||a.includes("swim")?"Activity":a.includes("musculation")||a.includes("weight")?"Dumbbell":a.includes("yoga")?"Smile":a.includes("football")||a.includes("sport")?"Target":"Zap"}function Q(t){switch(t){case"low":return"#22C55E";case"medium":return"#F59E0B";case"high":return"#EF4444";case"very_high":return"#DC2626";default:return"#3B82F6"}}const gt=({todayActivities:t=[],todayStats:a,hasAnyActivityHistory:s=!1,onActivityClick:o,deletingActivityId:n,onDeleteActivity:i})=>{const c=r=>{i&&i(r)};return e.jsxs(F,{className:"recent-activities-card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"activity-summary-icon activity-icon-primary activity-icon-container-md",children:e.jsx(g,{Icon:l.History,size:20,style:{color:"var(--color-activity-primary)"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"activity-summary-title",children:"Activités d'Aujourd'hui"}),e.jsx("p",{className:"activity-summary-subtitle",children:"Liste de vos sessions forgées ce jour"})]})]}),t.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-blue-500/20 flex items-center justify-center",children:e.jsx(g,{Icon:l.Activity,size:32,className:"text-blue-400"})}),e.jsx("p",{className:"text-white/70 text-sm mb-2",children:"Aucune activité enregistrée aujourd'hui."}),e.jsx("p",{className:"text-white/50 text-xs",children:"Commencez à forger votre énergie en enregistrant votre première activité !"})]}):e.jsx("div",{className:"recent-activities-list",children:t.map((r,p)=>e.jsx("div",{className:"group relative",children:e.jsx("div",{className:"recent-activity-item activity-item-enter",style:{animationDelay:`${p*.1}s`},onClick:()=>o?.(r),children:e.jsxs("div",{className:"recent-activity-item-header",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:`
                          radial-gradient(circle at 30% 30%, rgba(255,255,255,0.12) 0%, transparent 60%),
                          linear-gradient(135deg, color-mix(in srgb, ${Q(r.intensity)} 25%, transparent), color-mix(in srgb, ${Q(r.intensity)} 15%, transparent))
                        `,border:`1px solid color-mix(in srgb, ${Q(r.intensity)} 30%, transparent)`,boxShadow:`0 0 12px color-mix(in srgb, ${Q(r.intensity)} 20%, transparent)`},children:e.jsx(g,{Icon:l[pt(r.type)],size:16,style:{color:Q(r.intensity)}})}),e.jsxs("div",{children:[e.jsx("div",{className:"recent-activity-item-type",children:r.type}),e.jsxs("div",{className:"recent-activity-item-time",children:[r.duration_min," min • ",R(new Date(r.timestamp),"HH:mm")]})]})]}),e.jsxs("div",{className:"recent-activity-item-stats",children:[e.jsxs("div",{className:"recent-activity-item-stat",children:[e.jsxs("div",{className:"text-white font-bold text-lg",children:[r.calories_est," kcal"]}),e.jsx("div",{className:"text-white/60 text-xs",children:"Brûlées"})]}),i&&e.jsx("button",{onClick:x=>{x.stopPropagation(),c(r.id)},disabled:n===r.id,className:"opacity-0 group-hover:opacity-100 transition-opacity duration-200 p-2 rounded-full",style:{background:"rgba(239, 68, 68, 0.15)",border:"1px solid rgba(239, 68, 68, 0.3)"},title:"Supprimer cette activité",children:n===r.id?e.jsx(g,{Icon:l.Loader2,size:14,className:"text-red-400 animate-spin"}):e.jsx(g,{Icon:l.Trash2,size:14,className:"text-red-400"})})]})]})})},r.id))})]})},ht=[{zone:1,label:"Z1 Récupération",color:"#22C55E",range:"50-60%"},{zone:2,label:"Z2 Endurance",color:"#3B82F6",range:"60-70%"},{zone:3,label:"Z3 Tempo",color:"#F59E0B",range:"70-80%"},{zone:4,label:"Z4 Seuil",color:"#EF4444",range:"80-90%"},{zone:5,label:"Z5 VO2max",color:"#DC2626",range:"90-100%"}];function bt({metrics:t,className:a=""}){const s=!!(t.hr_zone1_minutes||t.hr_zone2_minutes||t.hr_zone3_minutes||t.hr_zone4_minutes||t.hr_zone5_minutes),o=(t.hr_zone1_minutes||0)+(t.hr_zone2_minutes||0)+(t.hr_zone3_minutes||0)+(t.hr_zone4_minutes||0)+(t.hr_zone5_minutes||0),n=i=>!i||o===0?0:i/o*100;return e.jsxs(F,{className:`p-6 ${a}`,style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #EF4444 8%, transparent) 0%, transparent 60%),
          linear-gradient(145deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%),
          var(--glass-opacity)
        `,borderColor:"color-mix(in srgb, #EF4444 20%, transparent)"},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
              radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
              linear-gradient(135deg, color-mix(in srgb, #EF4444 30%, transparent), color-mix(in srgb, #EF4444 20%, transparent))
            `,border:"2px solid color-mix(in srgb, #EF4444 40%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #EF4444 30%, transparent)"},children:e.jsx(g,{Icon:l.Heart,size:20,style:{color:"#EF4444"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Métriques Cardiaques"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Données en temps réel"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[t.hr_avg&&e.jsxs(_.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-red-400",children:t.hr_avg}),e.jsx("div",{className:"text-white/60 text-xs mt-1",children:"FC Moyenne"})]}),t.hr_max&&e.jsxs(_.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-red-500",children:t.hr_max}),e.jsx("div",{className:"text-white/60 text-xs mt-1",children:"FC Max"})]}),t.hr_min&&e.jsxs(_.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-400",children:t.hr_min}),e.jsx("div",{className:"text-white/60 text-xs mt-1",children:"FC Min"})]}),t.hr_recovery_1min&&e.jsxs(_.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-400",children:t.hr_recovery_1min}),e.jsx("div",{className:"text-white/60 text-xs mt-1",children:"Récup. 1min"})]})]}),s&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-white/80 mb-3",children:"Distribution des Zones"}),ht.map(({zone:i,label:c,color:r,range:p})=>{const x=i===1?t.hr_zone1_minutes:i===2?t.hr_zone2_minutes:i===3?t.hr_zone3_minutes:i===4?t.hr_zone4_minutes:t.hr_zone5_minutes;if(!x)return null;const d=n(x);return e.jsxs(_.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*i},className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:r}}),e.jsx("span",{className:"text-white/80",children:c}),e.jsx("span",{className:"text-white/40",children:p})]}),e.jsxs("span",{className:"text-white/60",children:[x," min"]})]}),e.jsx("div",{className:"relative h-2 bg-white/5 rounded-full overflow-hidden",children:e.jsx(_.div,{initial:{width:0},animate:{width:`${d}%`},transition:{duration:.8,delay:.2+.1*i},className:"absolute top-0 left-0 h-full rounded-full",style:{backgroundColor:r,boxShadow:`0 0 12px ${r}40`}})})]},i)})]}),t.hr_avg&&e.jsx(_.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"mt-4 pt-4 border-t border-white/10",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{Icon:l.Check,size:14,style:{color:"#22C55E"}}),e.jsx("span",{className:"text-xs text-white/60",children:"Données enrichies par wearable"})]})})]})}const vt=t=>t?t>=80?"#22C55E":t>=60?"#3B82F6":t>=40?"#F59E0B":"#EF4444":"#6B7280",yt=t=>t?t>=80?"Excellente":t>=60?"Bonne":t>=40?"Modérée":"Faible":"Indisponible",ft=t=>t?t>=80?"Votre corps est prêt pour un entraînement intense":t>=60?"Vous pouvez vous entraîner normalement":t>=40?"Privilégiez un entraînement léger aujourd'hui":"Accordez-vous une journée de repos ou récupération active":"Connectez un objet pour obtenir votre score";function jt({metrics:t,className:a=""}){const s=vt(t.recovery_score),o=yt(t.recovery_score),n=ft(t.recovery_score),i=({value:c,max:r,size:p=120,strokeWidth:x=8})=>{const d=(p-x)/2,h=2*Math.PI*d,m=c/r*h,u=p/2;return e.jsxs("svg",{width:p,height:p,className:"transform -rotate-90",children:[e.jsx("circle",{cx:u,cy:u,r:d,fill:"none",stroke:"rgba(255, 255, 255, 0.1)",strokeWidth:x}),e.jsx(_.circle,{cx:u,cy:u,r:d,fill:"none",stroke:s,strokeWidth:x,strokeLinecap:"round",initial:{strokeDasharray:`0 ${h}`},animate:{strokeDasharray:`${m} ${h}`},transition:{duration:1,ease:"easeOut"},style:{filter:`drop-shadow(0 0 8px ${s}40)`}})]})};return e.jsxs(F,{className:`p-6 ${a}`,style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, ${s} 8%, transparent) 0%, transparent 60%),
          linear-gradient(145deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%),
          var(--glass-opacity)
        `,borderColor:`color-mix(in srgb, ${s} 20%, transparent)`},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
              radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
              linear-gradient(135deg, color-mix(in srgb, ${s} 30%, transparent), color-mix(in srgb, ${s} 20%, transparent))
            `,border:`2px solid color-mix(in srgb, ${s} 40%, transparent)`,boxShadow:`0 0 20px color-mix(in srgb, ${s} 30%, transparent)`},children:e.jsx(g,{Icon:l.Battery,size:20,style:{color:s}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Score de Récupération"}),e.jsx("p",{className:"text-white/60 text-sm",children:"État de préparation"})]})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center mb-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx(i,{value:t.recovery_score||0,max:100}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[e.jsx(_.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.3,type:"spring"},className:"text-4xl font-bold",style:{color:s},children:t.recovery_score||"--"}),e.jsx("div",{className:"text-white/40 text-xs mt-1",children:"sur 100"})]})]}),e.jsxs(_.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},className:"text-center mt-4",children:[e.jsx("div",{className:"text-lg font-semibold mb-1",style:{color:s},children:o}),e.jsx("div",{className:"text-sm text-white/70 max-w-xs",children:n})]})]}),e.jsxs("div",{className:"space-y-3",children:[t.hrv_pre_activity&&e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{Icon:l.Activity,size:14,style:{color:"#3B82F6"}}),e.jsx("span",{className:"text-sm text-white/80",children:"HRV Pré-activité"})]}),e.jsxs("span",{className:"text-sm font-semibold text-white",children:[t.hrv_pre_activity.toFixed(1)," ms"]})]}),t.hrv_avg_overnight&&e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{Icon:l.Moon,size:14,style:{color:"#8B5CF6"}}),e.jsx("span",{className:"text-sm text-white/80",children:"HRV Nuit"})]}),e.jsxs("span",{className:"text-sm font-semibold text-white",children:[t.hrv_avg_overnight.toFixed(1)," ms"]})]}),t.sleep_quality_score&&e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{Icon:l.Moon,size:14,style:{color:"#A855F7"}}),e.jsx("span",{className:"text-sm text-white/80",children:"Qualité Sommeil"})]}),e.jsxs("span",{className:"text-sm font-semibold text-white",children:[t.sleep_quality_score.toFixed(0),"%"]})]}),t.sleep_duration_hours&&e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{Icon:l.Clock,size:14,style:{color:"#06B6D4"}}),e.jsx("span",{className:"text-sm text-white/80",children:"Durée Sommeil"})]}),e.jsxs("span",{className:"text-sm font-semibold text-white",children:[t.sleep_duration_hours.toFixed(1),"h"]})]}),t.stress_level_pre&&e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{Icon:l.AlertCircle,size:14,style:{color:"#F59E0B"}}),e.jsx("span",{className:"text-sm text-white/80",children:"Stress Pré-activité"})]}),e.jsxs("span",{className:"text-sm font-semibold text-white",children:[t.stress_level_pre.toFixed(0),"%"]})]}),t.body_battery_pre&&e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{Icon:l.Zap,size:14,style:{color:"#22C55E"}}),e.jsx("span",{className:"text-sm text-white/80",children:"Body Battery"})]}),e.jsxs("span",{className:"text-sm font-semibold text-white",children:[t.body_battery_pre.toFixed(0),"%"]})]})]}),t.recovery_score&&e.jsx(_.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"mt-4 pt-4 border-t border-white/10",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{Icon:l.Check,size:14,style:{color:"#22C55E"}}),e.jsx("span",{className:"text-xs text-white/60",children:"Données de récupération analysées"})]})})]})}const Nt=t=>t?t>=55?"Excellent":t>=45?"Bon":t>=35?"Moyen":"À améliorer":"",wt=t=>t?t>=55?"#22C55E":t>=45?"#3B82F6":t>=35?"#F59E0B":"#EF4444":"#6B7280";function _t({metrics:t,activityType:a,className:s=""}){const o=wt(t.vo2max_estimated),n=Nt(t.vo2max_estimated),i=r=>r?r>=1e3?`${(r/1e3).toFixed(2)} km`:`${r.toFixed(0)} m`:"--",c=({icon:r,label:p,value:x,unit:d,color:h="#3B82F6",delay:m=0})=>e.jsxs(_.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:m,type:"spring",stiffness:200},className:"flex items-center justify-between p-3 rounded-lg bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{Icon:r,size:14,style:{color:h}}),e.jsx("span",{className:"text-sm text-white/80",children:p})]}),e.jsxs("span",{className:"text-sm font-semibold text-white",children:[x,d&&e.jsx("span",{className:"text-white/60 ml-1",children:d})]})]});return e.jsxs(F,{className:`p-6 ${s}`,style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #3B82F6 8%, transparent) 0%, transparent 60%),
          linear-gradient(145deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%),
          var(--glass-opacity)
        `,borderColor:"color-mix(in srgb, #3B82F6 20%, transparent)"},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
              radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
              linear-gradient(135deg, color-mix(in srgb, #3B82F6 30%, transparent), color-mix(in srgb, #3B82F6 20%, transparent))
            `,border:"2px solid color-mix(in srgb, #3B82F6 40%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #3B82F6 30%, transparent)"},children:e.jsx(g,{Icon:l.TrendingUp,size:20,style:{color:"#3B82F6"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Métriques de Performance"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Données enrichies"})]})]}),t.vo2max_estimated&&e.jsx(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-6 p-4 rounded-xl",style:{background:`linear-gradient(135deg, color-mix(in srgb, ${o} 15%, transparent), color-mix(in srgb, ${o} 5%, transparent))`,border:`1px solid color-mix(in srgb, ${o} 30%, transparent)`},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"VO2max Estimé"}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold",style:{color:o},children:t.vo2max_estimated.toFixed(1)}),e.jsx("span",{className:"text-sm text-white/60",children:"ml/kg/min"})]}),e.jsx("div",{className:"text-xs font-medium mt-1",style:{color:o},children:n})]}),e.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center",style:{background:`radial-gradient(circle, color-mix(in srgb, ${o} 20%, transparent), transparent)`,border:`2px solid color-mix(in srgb, ${o} 40%, transparent)`},children:e.jsx(g,{Icon:l.Zap,size:24,style:{color:o}})})]})}),e.jsxs("div",{className:"space-y-2 mb-4",children:[t.distance_meters&&e.jsx(c,{icon:l.MapPin,label:"Distance",value:i(t.distance_meters),color:"#10B981",delay:.1}),t.avg_pace&&e.jsx(c,{icon:l.Timer,label:"Allure Moyenne",value:t.avg_pace,unit:"/km",color:"#3B82F6",delay:.15}),t.avg_speed_kmh&&e.jsx(c,{icon:l.Gauge,label:"Vitesse Moyenne",value:t.avg_speed_kmh.toFixed(1),unit:"km/h",color:"#06B6D4",delay:.2}),t.elevation_gain_meters&&e.jsx(c,{icon:l.TrendingUp,label:"Dénivelé Positif",value:t.elevation_gain_meters.toFixed(0),unit:"m",color:"#F59E0B",delay:.25})]}),(t.avg_cadence_rpm||t.avg_power_watts)&&e.jsxs("div",{className:"space-y-2 mb-4",children:[t.avg_cadence_rpm&&e.jsx(c,{icon:l.Activity,label:a==="vélo"?"Cadence Moyenne":"Fréquence de Pas",value:t.avg_cadence_rpm.toFixed(0),unit:a==="vélo"?"rpm":"spm",color:"#8B5CF6",delay:.3}),t.avg_power_watts&&e.jsx(c,{icon:l.Zap,label:"Puissance Moyenne",value:t.avg_power_watts.toFixed(0),unit:"W",color:"#EF4444",delay:.35})]}),(t.training_load_score||t.efficiency_score)&&e.jsxs("div",{className:"space-y-2",children:[t.training_load_score&&e.jsx(c,{icon:l.Activity,label:"Charge d'Entraînement",value:t.training_load_score.toFixed(0),unit:"TRIMP",color:"#F59E0B",delay:.4}),t.efficiency_score&&e.jsx(c,{icon:l.Target,label:"Score d'Efficience",value:t.efficiency_score.toFixed(1),unit:"/100",color:"#22C55E",delay:.45})]}),e.jsx(_.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"mt-4 pt-4 border-t border-white/10",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{Icon:l.Check,size:14,style:{color:"#22C55E"}}),e.jsx("span",{className:"text-xs text-white/60",children:"Métriques avancées enrichies par wearable"})]})})]})}function Ct({hasWearableData:t,dataCompletenessScore:a,deviceName:s,className:o=""}){if(!t)return null;const n=a||0,i=n>=80?"#22C55E":n>=50?"#3B82F6":"#F59E0B";return e.jsxs(_.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{type:"spring",stiffness:200},className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium ${o}`,style:{background:`linear-gradient(135deg, color-mix(in srgb, ${i} 20%, transparent), color-mix(in srgb, ${i} 10%, transparent))`,border:`1px solid color-mix(in srgb, ${i} 30%, transparent)`,boxShadow:`0 0 12px color-mix(in srgb, ${i} 20%, transparent)`},children:[e.jsx(g,{Icon:l.Watch,size:12,style:{color:i}}),e.jsx("span",{style:{color:i},children:"Enrichi par wearable"}),s&&e.jsxs("span",{className:"text-white/60",children:["• ",s]}),a&&e.jsxs("span",{className:"text-white/60",children:["• ",Math.round(n),"%"]})]})}function It({activities:t,className:a=""}){const s=B.useMemo(()=>{if(!t||t.length===0)return null;const o=t.filter(d=>d.wearable_device_id);if(o.length===0)return null;const n=o[0],i=o.filter(d=>d.hr_avg).reduce((d,h)=>d+(h.hr_avg||0),0)/o.length||null,c=Math.max(...o.map(d=>d.hr_max||0))||null,r={zone1:o.reduce((d,h)=>d+(h.hr_zone1_minutes||0),0),zone2:o.reduce((d,h)=>d+(h.hr_zone2_minutes||0),0),zone3:o.reduce((d,h)=>d+(h.hr_zone3_minutes||0),0),zone4:o.reduce((d,h)=>d+(h.hr_zone4_minutes||0),0),zone5:o.reduce((d,h)=>d+(h.hr_zone5_minutes||0),0)},p=o.reduce((d,h)=>d+(h.distance_meters||0),0)||null,x=o.reduce((d,h)=>d+(h.training_load_score||0),0)||null;return{heartRate:{hr_avg:i?Math.round(i):null,hr_max:c||null,hr_min:n.hr_min,hr_resting_pre:n.hr_resting_pre,hr_recovery_1min:n.hr_recovery_1min,hr_zone1_minutes:r.zone1||null,hr_zone2_minutes:r.zone2||null,hr_zone3_minutes:r.zone3||null,hr_zone4_minutes:r.zone4||null,hr_zone5_minutes:r.zone5||null},recovery:{recovery_score:n.recovery_score,hrv_pre_activity:n.hrv_pre_activity,hrv_avg_overnight:n.hrv_avg_overnight,sleep_quality_score:n.sleep_quality_score,sleep_duration_hours:n.sleep_duration_hours,stress_level_pre:n.stress_level_pre,body_battery_pre:n.body_battery_pre,fatigue_index:n.fatigue_index},performance:{vo2max_estimated:n.vo2max_estimated,training_load_score:x,efficiency_score:n.efficiency_score,distance_meters:p,avg_pace:n.avg_pace,avg_speed_kmh:n.avg_speed_kmh,elevation_gain_meters:o.reduce((d,h)=>d+(h.elevation_gain_meters||0),0)||null,avg_cadence_rpm:n.avg_cadence_rpm,avg_power_watts:n.avg_power_watts},hasData:!0,activityType:n.type,dataCompletenessScore:n.data_completeness_score}},[t]);return s?e.jsxs(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:`space-y-6 ${a}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Métriques Enrichies"}),e.jsx("p",{className:"text-white/60 text-sm mt-1",children:"Données biométriques provenant de vos objets connectés"})]}),e.jsx(Ct,{hasWearableData:s.hasData,dataCompletenessScore:s.dataCompletenessScore})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(jt,{metrics:s.recovery}),e.jsx(bt,{metrics:s.heartRate})]}),e.jsx(_t,{metrics:s.performance,activityType:s.activityType}),e.jsx(_.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"p-4 rounded-xl",style:{background:"linear-gradient(135deg, color-mix(in srgb, #3B82F6 10%, transparent), color-mix(in srgb, #3B82F6 5%, transparent))",border:"1px solid color-mix(in srgb, #3B82F6 20%, transparent)"},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5",children:e.jsx(g,{Icon:l.Info,size:16,style:{color:"#3B82F6"}})}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-sm text-blue-200",children:"Ces métriques sont automatiquement synchronisées depuis vos objets connectés. Plus vous portez votre montre, plus les données sont précises et les insights personnalisés."})})]})})]}):null}const Ft=()=>{const{profile:t,session:a}=L(),{showToast:s}=ee(),{success:o,error:n}=Y(),{data:i,isLoading:c,error:r,activities:p}=Qe(),x=Be(),{data:d=!1}=K({queryKey:["activities","has-history",a?.user?.id],queryFn:async()=>{if(!a?.user?.id)return!1;const{supabase:u}=await Ve(async()=>{const{supabase:w}=await import("./page-fridge-BvAjnJpI.js").then(I=>I.j);return{supabase:w}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])),{data:b,error:f}=await u.from("activities").select("id").eq("user_id",a.user.id).limit(1);return f?(C.error("ACTIVITY_DAILY_TAB","Failed to check activity history",{error:f.message,userId:a.user.id,timestamp:new Date().toISOString()}),!1):(b?.length||0)>0},enabled:!!a?.user?.id,staleTime:5*60*1e3,retry:1});B.useEffect(()=>{r&&(C.error("ACTIVITY_DAILY_TAB","Failed to load activity stats",{error:r instanceof Error?r.message:"Unknown error",userId:a?.user?.id,timestamp:new Date().toISOString()}),n(),s({type:"error",title:"Erreur de Chargement",message:"Impossible de charger vos activités. Vérifiez votre connexion.",duration:4e3}))},[r,a?.user?.id,n,s]);const h=u=>{C.info("ACTIVITY_DAILY_TAB","Activity clicked for details",{activityId:u.id,activityType:u.type,userId:a?.user?.id,timestamp:new Date().toISOString()}),s({type:"info",title:"Détail d'Activité",message:`${u.type} - ${u.duration_min} min - ${u.calories_est} kcal`,duration:3e3})},m=u=>{C.info("ACTIVITY_DAILY_TAB","Delete activity requested",{activityId:u,userId:a?.user?.id,timestamp:new Date().toISOString()}),x.mutate(u)};return c?e.jsxs("div",{className:"space-y-6",children:[e.jsx(pe,{profile:t}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-32 bg-white/5 rounded-xl animate-pulse"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"h-24 bg-white/5 rounded-xl animate-pulse"}),e.jsx("div",{className:"h-24 bg-white/5 rounded-xl animate-pulse"}),e.jsx("div",{className:"h-24 bg-white/5 rounded-xl animate-pulse"})]}),e.jsx("div",{className:"h-40 bg-white/5 rounded-xl animate-pulse"})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(pe,{profile:t}),e.jsx(ct,{todayStats:i,profile:t}),e.jsx(dt,{}),e.jsx(Ae,{todayStats:i}),e.jsx(mt,{todayStats:i,profile:t,todayActivities:p}),e.jsx(ut,{todayStats:i,profile:t}),e.jsx(gt,{todayActivities:p,todayStats:i,hasAnyActivityHistory:d,deletingActivityId:x.isPending?"deleting":void 0,onActivityClick:h,onDeleteActivity:m}),p&&p.some(u=>u.wearable_device_id)&&e.jsx(It,{activities:p,className:"mt-6"})]})},De=()=>{const t=de()==="reduced";return e.jsxs("div",{className:"space-y-6 analysis-loading-container",children:[e.jsx(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:t?.1:.6},children:e.jsxs(F,{className:"p-8 text-center relative overflow-visible",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-activity-primary) 15%, transparent) 0%, transparent 60%),
              radial-gradient(circle at 70% 80%, color-mix(in srgb, var(--color-activity-secondary) 12%, transparent) 0%, transparent 50%),
              radial-gradient(circle at 50% 50%, color-mix(in srgb, var(--color-activity-accent) 8%, transparent) 0%, transparent 70%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, var(--color-activity-primary) 30%, transparent)",boxShadow:`
              0 16px 48px rgba(0, 0, 0, 0.3),
              0 0 40px color-mix(in srgb, var(--color-activity-primary) 20%, transparent),
              0 0 80px color-mix(in srgb, var(--color-activity-secondary) 15%, transparent),
              inset 0 2px 0 rgba(255, 255, 255, 0.2)
            `,backdropFilter:"blur(24px) saturate(160%)"},children:[e.jsx("div",{className:"absolute inset-0 rounded-inherit pointer-events-none",style:{background:"radial-gradient(circle at center, color-mix(in srgb, var(--color-activity-primary) 8%, transparent) 0%, transparent 70%)",filter:"blur(20px)",transform:"scale(1.2)",zIndex:-1,animation:t?"none":"forge-glow 4s ease-in-out infinite"}}),e.jsxs("div",{className:"relative z-10 space-y-6 flex flex-col items-center",children:[e.jsxs(_.div,{className:"w-24 h-24 rounded-full flex items-center justify-center relative",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.25) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, var(--color-activity-primary) 45%, transparent), color-mix(in srgb, var(--color-activity-secondary) 35%, transparent))
                `,border:"3px solid color-mix(in srgb, var(--color-activity-primary) 70%, transparent)",boxShadow:`
                  0 0 60px color-mix(in srgb, var(--color-activity-primary) 60%, transparent),
                  0 0 120px color-mix(in srgb, var(--color-activity-primary) 40%, transparent),
                  inset 0 3px 0 rgba(255,255,255,0.4)
                `,display:"flex",alignItems:"center",justifyContent:"center"},animate:t?{}:{scale:[1,1.05,1],boxShadow:["0 0 60px color-mix(in srgb, var(--color-activity-primary) 60%, transparent), 0 0 120px color-mix(in srgb, var(--color-activity-primary) 40%, transparent)","0 0 80px color-mix(in srgb, var(--color-activity-primary) 80%, transparent), 0 0 160px color-mix(in srgb, var(--color-activity-primary) 50%, transparent)","0 0 60px color-mix(in srgb, var(--color-activity-primary) 60%, transparent), 0 0 120px color-mix(in srgb, var(--color-activity-primary) 40%, transparent)"]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},children:[e.jsx(_.div,{className:"flex items-center justify-center",animate:t?{}:{rotate:360},transition:{duration:4,repeat:1/0,ease:"linear"},children:e.jsx(g,{Icon:l.Zap,size:36,className:"text-white",style:{filter:"drop-shadow(0 0 12px rgba(255,255,255,0.8))",display:"block"}})}),!t&&[...Array(6)].map((a,s)=>e.jsx("div",{className:"absolute w-3 h-3 rounded-full",style:{background:"var(--color-activity-secondary)",left:`${15+s*15}%`,top:`${15+s%3*25}%`,boxShadow:"0 0 12px color-mix(in srgb, var(--color-activity-secondary) 80%, transparent)",animation:`ai-particle-orbit 6s ease-in-out infinite ${s*.5}s`}},s))]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-white mb-3",children:"Analyse Énergétique Avancée"}),e.jsx("p",{className:"text-white/80 text-lg leading-relaxed max-w-md mx-auto",children:"Analyse de vos patterns d'activité pour générer des insights personnalisés"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[{phase:"Analyse des Patterns",icon:"BarChart3",color:"var(--color-activity-primary)"},{phase:"Génération d'Insights",icon:"TrendingUp",color:"var(--color-activity-secondary)"},{phase:"Recommandations Personnalisées",icon:"Target",color:"var(--color-activity-accent)"}].map((a,s)=>e.jsxs(_.div,{className:"p-4 rounded-xl text-center",style:{background:`color-mix(in srgb, ${a.color} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${a.color} 20%, transparent)`,backdropFilter:"blur(8px) saturate(120%)"},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:t?.1:.5,delay:t?0:.2+s*.1},children:[e.jsx(_.div,{className:"w-12 h-12 mx-auto mb-3 rounded-full flex items-center justify-center",style:{background:`color-mix(in srgb, ${a.color} 20%, transparent)`,border:`1px solid color-mix(in srgb, ${a.color} 30%, transparent)`},animate:t?{}:{scale:[1,1.1,1],boxShadow:[`0 0 16px color-mix(in srgb, ${a.color} 40%, transparent)`,`0 0 24px color-mix(in srgb, ${a.color} 60%, transparent)`,`0 0 16px color-mix(in srgb, ${a.color} 40%, transparent)`]},transition:{duration:2,repeat:1/0,delay:s*.3,ease:"easeInOut"},children:e.jsx(g,{Icon:l[a.icon],size:20,style:{color:a.color}})}),e.jsx("div",{className:"text-white font-medium text-sm",children:a.phase})]},a.phase))}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-white/80 font-medium",children:"Analyse en cours..."}),e.jsx("span",{className:"text-white/60",children:"Forge Énergétique"})]}),e.jsx("div",{className:"w-full bg-white/10 rounded-full h-2 overflow-hidden",children:e.jsx(_.div,{className:"h-full rounded-full relative overflow-hidden",style:{background:`
                      linear-gradient(90deg,
                        var(--color-activity-primary),
                        var(--color-activity-secondary),
                        var(--color-activity-accent)
                      )
                    `,boxShadow:"0 0 16px color-mix(in srgb, var(--color-activity-primary) 60%, transparent)"},initial:{width:0},animate:{width:"100%"},transition:{duration:t?.1:8,repeat:1/0,ease:"easeInOut"},children:!t&&e.jsx("div",{className:"absolute inset-0 rounded-full",style:{background:`linear-gradient(90deg,
                          transparent 0%,
                          rgba(255,255,255,0.6) 50%,
                          transparent 100%
                        )`,animation:"progressShimmer 2s ease-in-out infinite"}})})})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(_.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:t?.1:.6,delay:t?0:.3},children:e.jsxs(F,{className:"p-6 h-80",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"color-mix(in srgb, var(--color-activity-primary) 20%, transparent)"},children:e.jsx(g,{Icon:l.BarChart3,size:16,style:{color:"var(--color-activity-primary)"}})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"h-4 bg-white/10 rounded w-40 skeleton-glass"}),e.jsx("div",{className:"h-3 bg-white/5 rounded w-32"})]})]}),e.jsxs("div",{className:"relative h-48 flex items-center justify-center",children:[e.jsx(_.div,{className:"w-32 h-32 rounded-full border-8 border-transparent relative",style:{background:`conic-gradient(from 0deg,
                    var(--color-activity-primary) 0% 40%,
                    var(--color-activity-secondary) 40% 70%,
                    var(--color-activity-accent) 70% 100%
                  )`,mask:"radial-gradient(circle at center, transparent 40%, black 42%)",WebkitMask:"radial-gradient(circle at center, transparent 40%, black 42%)"},animate:t?{}:{rotate:360},transition:{duration:8,repeat:1/0,ease:"linear"},children:e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-r from-transparent via-white/20 to-transparent opacity-30"})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-white font-bold text-lg",children:"Activités"}),e.jsx("div",{className:"text-white/60 text-sm",children:"Analyse..."})]})})]})]})}),e.jsx(_.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:t?.1:.6,delay:t?0:.4},children:e.jsxs(F,{className:"p-6 h-80",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"color-mix(in srgb, var(--color-activity-secondary) 20%, transparent)"},children:e.jsx(g,{Icon:l.LineChart,size:16,style:{color:"var(--color-activity-secondary)"}})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"h-4 bg-white/10 rounded w-36 skeleton-glass"}),e.jsx("div",{className:"h-3 bg-white/5 rounded w-28"})]})]}),e.jsx("div",{className:"relative h-48 rounded-xl bg-white/5 border border-white/10 overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 flex items-end justify-around p-4",children:Array.from({length:7}).map((a,s)=>e.jsx(_.div,{className:"rounded-t",style:{width:"12px",height:`${30+Math.random()*60}%`,background:"color-mix(in srgb, var(--color-activity-secondary) 30%, transparent)"},initial:{height:0},animate:{height:`${30+Math.random()*60}%`},transition:{duration:t?.1:1.5,delay:t?0:s*.1,repeat:1/0,repeatType:"reverse",ease:"easeInOut"}},s))})})]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Array.from({length:4}).map((a,s)=>e.jsx(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:t?.1:.5,delay:t?0:.5+s*.1},children:e.jsx(F,{className:"p-5",style:{background:`
                  radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-activity-secondary) 6%, transparent) 0%, transparent 60%),
                  var(--glass-opacity)
                `,borderColor:"color-mix(in srgb, var(--color-activity-secondary) 15%, transparent)"},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(_.div,{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{background:"color-mix(in srgb, var(--color-activity-primary) 20%, transparent)"},animate:t?{}:{scale:[1,1.1,1],opacity:[.7,1,.7]},transition:{duration:2,repeat:1/0,delay:s*.2,ease:"easeInOut"},children:e.jsx(g,{Icon:[l.TrendingUp,l.Target,l.BarChart3,l.Zap][s],size:14,style:{color:"var(--color-activity-primary)"}})}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-white/10 rounded skeleton-glass",style:{width:`${60+Math.random()*30}%`}}),e.jsx("div",{className:"h-3 bg-white/5 rounded skeleton-glass",style:{width:`${80+Math.random()*15}%`}}),e.jsx("div",{className:"h-3 bg-white/5 rounded skeleton-glass",style:{width:`${40+Math.random()*40}%`}})]})]})})},s))}),!t&&e.jsx(_.div,{className:"relative h-16 overflow-hidden",initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:.8},children:e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center",children:[Array.from({length:12}).map((a,s)=>e.jsx("div",{className:"absolute w-2 h-2 rounded-full",style:{background:"linear-gradient(135deg, var(--color-activity-primary), var(--color-activity-secondary))",left:`${5+s*8}%`,top:`${40+s%3*20}%`,boxShadow:"0 0 8px color-mix(in srgb, var(--color-activity-primary) 60%, transparent)",display:"block",margin:"0 auto"}},s)),e.jsx("svg",{className:"absolute inset-0 w-full h-full pointer-events-none opacity-30",children:Array.from({length:4}).map((a,s)=>e.jsx(_.path,{d:`M ${10+s*25} 50 Q ${25+s*25} 20 ${40+s*25} 50`,stroke:"var(--color-activity-primary)",strokeWidth:"1",fill:"none",strokeDasharray:"2 2",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:3,repeat:1/0,delay:s*.5,ease:"easeInOut"}},s))})]})}),e.jsx(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:t?.1:.6,delay:t?0:1},children:e.jsx(F,{className:"p-6 text-center",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-activity-secondary) 8%, transparent) 0%, transparent 60%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, var(--color-activity-secondary) 20%, transparent)"},children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx(g,{Icon:l.Info,size:16,style:{color:"var(--color-activity-secondary)"}}),e.jsxs("p",{className:"text-white/70 text-sm",children:["Analyse de vos "," ",e.jsx("span",{className:"font-semibold text-white",children:"patterns énergétiques"})," "," en cours pour générer des recommandations sur mesure..."]})]})})}),e.jsx("style",{children:`
        @keyframes forge-glow {
          0%, 100% {
            opacity: 0.6;
            transform: scale(1.1);
          }
          50% {
            opacity: 0.9;
            transform: scale(1.3);
          }
        }

        @keyframes ai-particle-orbit {
          0%, 100% {
            transform: translateY(0px) translateX(0px) scale(1);
            opacity: 0.6;
          }
          25% {
            transform: translateY(-12px) translateX(8px) scale(1.3);
            opacity: 1;
          }
          50% {
            transform: translateY(-16px) translateX(-4px) scale(1.4);
            opacity: 1;
          }
          75% {
            transform: translateY(-8px) translateX(-8px) scale(1.2);
            opacity: 0.8;
          }
        }

        @keyframes ai-data-flow {
          0%, 100% {
            transform: translateY(0px) translateX(0px) scale(1);
            opacity: 0.6;
          }
          25% {
            transform: translateY(-8px) translateX(4px) scale(1.2);
            opacity: 0.9;
          }
          50% {
            transform: translateY(-12px) translateX(-2px) scale(1.3);
            opacity: 1;
          }
          75% {
            transform: translateY(-8px) translateX(-4px) scale(1.1);
            opacity: 0.8;
          }
        }

        /* Support pour reduced motion */
        @media (prefers-reduced-motion: reduce) {
          .forge-glow,
          .ai-particle-orbit,
          .ai-data-flow {
            animation: none !important;
          }

          .forge-glow {
            opacity: 0.7 !important;
            transform: scale(1.2) !important;
          }

          .ai-particle-orbit {
            opacity: 0.8 !important;
            transform: translateY(-10px) scale(1.2) !important;
          }

          .ai-data-flow {
            opacity: 0.7 !important;
            transform: translateY(-6px) scale(1.1) !important;
          }
        }

        /* Optimisations mobile */
        @media (max-width: 768px) {
          .analysis-loading-container {
            padding: 0.5rem;
          }

          .forge-glow {
            animation-duration: 5s;
          }

          .ai-particle-orbit {
            animation-duration: 8s;
          }

          .ai-data-flow {
            animation-duration: 6s;
          }
        }
      `})]})};function kt(t){switch(t){case"week":return"7 jours";case"month":return"30 jours";case"quarter":return"90 jours";default:return"30 jours"}}function St(t){return{TrendingUp:"TrendingUp",Target:"Target",Zap:"Zap",Activity:"Activity",BarChart3:"BarChart3",Clock:"Clock",Heart:"Heart",Lightbulb:"Lightbulb",Check:"Check",AlertCircle:"AlertCircle",Info:"Info"}[t]||"Info"}const be=({insights:t,summary:a,period:s,apiPeriod:o})=>!t||t.length===0?null:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
              radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
              linear-gradient(135deg, color-mix(in srgb, #F59E0B 30%, transparent), color-mix(in srgb, #F59E0B 20%, transparent))
            `,border:"2px solid color-mix(in srgb, #F59E0B 40%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(g,{Icon:l.Lightbulb,size:20,style:{color:"#F59E0B"}})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-white font-bold text-xl",children:"Insights Énergétiques"}),e.jsxs("p",{className:"text-orange-200 text-sm",children:["Analyses et conseils sur ",kt(s)]})]})]}),e.jsx(F,{className:"p-6",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #10B981 8%, transparent) 0%, transparent 60%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, #10B981 20%, transparent)"},children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400 mb-1",children:a.total_activities}),e.jsx("div",{className:"text-green-300 text-sm font-medium",children:"Activités"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Total"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400 mb-1",children:a.total_calories}),e.jsx("div",{className:"text-blue-300 text-sm font-medium",children:"Calories"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Brûlées"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-cyan-400 mb-1",children:a.total_duration}),e.jsx("div",{className:"text-cyan-300 text-sm font-medium",children:"Minutes"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Actives"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-400 mb-1",children:a.consistency_score}),e.jsx("div",{className:"text-purple-300 text-sm font-medium",children:"Régularité"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Score"})]})]})}),e.jsx("div",{className:"space-y-4",children:t.map((n,i)=>e.jsx(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:i*.1},children:e.jsx(F,{className:"p-5",style:{background:`
                  radial-gradient(circle at 30% 20%, color-mix(in srgb, ${n.color} 8%, transparent) 0%, transparent 60%),
                  var(--glass-opacity)
                `,borderColor:`color-mix(in srgb, ${n.color} 20%, transparent)`,boxShadow:n.priority==="high"?`
                  0 8px 32px rgba(0, 0, 0, 0.2),
                  0 0 20px color-mix(in srgb, ${n.color} 15%, transparent)
                `:void 0},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`color-mix(in srgb, ${n.color} 20%, transparent)`,border:`1px solid color-mix(in srgb, ${n.color} 30%, transparent)`},children:e.jsx(g,{Icon:l[St(n.icon)],size:14,style:{color:n.color}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h4",{className:"text-white font-medium text-sm flex items-center gap-2",children:[n.title,n.priority==="high"&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-400 animate-pulse"})]}),n.confidence&&e.jsxs("span",{className:"text-xs text-white/50",children:[Math.round(n.confidence*100),"% confiance"]})]}),e.jsx("p",{className:"text-white/80 text-sm leading-relaxed mb-3",children:n.content}),n.actionable&&n.action&&e.jsxs("div",{className:"mt-3 p-3 rounded-lg",style:{background:`color-mix(in srgb, ${n.color} 6%, transparent)`,border:`1px solid color-mix(in srgb, ${n.color} 15%, transparent)`},children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{Icon:l.Target,size:12,style:{color:n.color}}),e.jsx("span",{className:"text-sm font-medium",style:{color:n.color},children:"Action suggérée :"})]}),e.jsx("p",{className:"text-xs mt-1 text-white/70",children:n.action})]})]})]})})},i))}),e.jsx(F,{className:"p-6 text-center",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-activity-secondary) 8%, transparent) 0%, transparent 60%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, var(--color-activity-secondary) 20%, transparent)"},children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx(g,{Icon:l.Info,size:16,style:{color:"var(--color-activity-secondary)"}}),e.jsx("p",{className:"text-white/70 text-sm",children:"Continuez à enregistrer vos activités pour des insights encore plus précis et personnalisés"})]})})]});function Bt(t){switch(t){case"week":return"7 jours";case"month":return"30 jours";case"quarter":return"90 jours";default:return"30 jours"}}const ve=({globalStats:t,period:a,apiPeriod:s})=>{if(!t)return e.jsx(F,{className:"p-6",style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #6B7280 8%, transparent) 0%, transparent 60%),
          var(--glass-opacity)
        `,borderColor:"color-mix(in srgb, #6B7280 20%, transparent)"},children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #F59E0B 20%, transparent), color-mix(in srgb, #F59E0B 10%, transparent))",border:"1px solid color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(g,{Icon:l.BarChart3,size:32,style:{color:"#F59E0B"}})}),e.jsx("p",{className:"text-white/70 text-sm",children:"Aucune donnée disponible pour cette période"})]})});const o=Bt(a);return e.jsx(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:e.jsxs(F,{className:"p-6",style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #F59E0B 12%, transparent) 0%, transparent 60%),
          radial-gradient(circle at 70% 80%, color-mix(in srgb, #F59E0B 8%, transparent) 0%, transparent 50%),
          var(--glass-opacity)
        `,borderColor:"color-mix(in srgb, #F59E0B 25%, transparent)",boxShadow:`
          0 12px 40px rgba(0, 0, 0, 0.25),
          0 0 30px color-mix(in srgb, #F59E0B 15%, transparent),
          inset 0 2px 0 rgba(255, 255, 255, 0.15)
        `},children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-white font-semibold flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #F59E0B 35%, transparent), color-mix(in srgb, #F59E0B 25%, transparent))
                `,border:"2px solid color-mix(in srgb, #F59E0B 50%, transparent)",boxShadow:"0 0 30px color-mix(in srgb, #F59E0B 40%, transparent)"},children:e.jsx(g,{Icon:l.BarChart3,size:24,style:{color:"#F59E0B"},variant:"pure"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-xl",children:["Forge Énergétique - ",o]}),e.jsx("div",{className:"text-white/60 text-sm font-normal mt-0.5",children:"Vos métriques de performance"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-400"}),e.jsx("span",{className:"text-orange-300 text-sm font-medium",children:"Période Active"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(_.div,{className:"text-center p-4 rounded-xl",style:{background:"color-mix(in srgb, #3B82F6 10%, transparent)",border:"1px solid color-mix(in srgb, #3B82F6 20%, transparent)"},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.1},children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400 mb-1",children:t.total_activities}),e.jsx("div",{className:"text-blue-300 text-sm font-medium",children:"Activités"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Enregistrées"})]}),e.jsxs(_.div,{className:"text-center p-4 rounded-xl",style:{background:"color-mix(in srgb, #EF4444 10%, transparent)",border:"1px solid color-mix(in srgb, #EF4444 20%, transparent)"},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.2},children:[e.jsx("div",{className:"text-2xl font-bold text-red-400 mb-1",children:t.total_calories}),e.jsx("div",{className:"text-red-300 text-sm font-medium",children:"Calories"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Brûlées"})]}),e.jsxs(_.div,{className:"text-center p-4 rounded-xl",style:{background:"color-mix(in srgb, #10B981 10%, transparent)",border:"1px solid color-mix(in srgb, #10B981 20%, transparent)"},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.3},children:[e.jsx("div",{className:"text-2xl font-bold text-green-400 mb-1",children:t.total_duration}),e.jsx("div",{className:"text-green-300 text-sm font-medium",children:"Minutes"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Actives"})]}),e.jsxs(_.div,{className:"text-center p-4 rounded-xl",style:{background:"color-mix(in srgb, #8B5CF6 10%, transparent)",border:"1px solid color-mix(in srgb, #8B5CF6 20%, transparent)"},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.4},children:[e.jsx("div",{className:"text-2xl font-bold text-purple-400 mb-1",children:t.consistency_score}),e.jsx("div",{className:"text-purple-300 text-sm font-medium",children:"Régularité"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Score"})]})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 rounded-xl bg-white/5 border border-white/10",children:[e.jsx("div",{className:"text-lg font-bold text-white mb-1",children:t.avg_daily_calories}),e.jsx("div",{className:"text-white/70 text-sm",children:"Calories/jour"})]}),e.jsxs("div",{className:"text-center p-4 rounded-xl bg-white/5 border border-white/10",children:[e.jsx("div",{className:"text-lg font-bold text-white mb-1 capitalize",children:t.most_frequent_type||"Aucun"}),e.jsx("div",{className:"text-white/70 text-sm",children:"Type Principal"})]}),e.jsxs("div",{className:"text-center p-4 rounded-xl bg-white/5 border border-white/10",children:[e.jsx("div",{className:"text-lg font-bold text-white mb-1 capitalize",children:t.avg_intensity==="low"?"Faible":t.avg_intensity==="medium"?"Modérée":t.avg_intensity==="high"?"Intense":t.avg_intensity==="very_high"?"Très Intense":"Modérée"}),e.jsx("div",{className:"text-white/70 text-sm",children:"Intensité Moy."})]})]})]})})};function ae(t){switch(t){case"week":return"7 derniers jours";case"month":return"30 derniers jours";case"quarter":return"90 derniers jours";default:return""}}function ie(t){switch(t){case"week":return"Semaine";case"month":return"Mois";case"quarter":return"Trimestre";default:return""}}const Z=({selectedPeriod:t,onPeriodChange:a,currentActivities:s,periodThresholds:o,accentColor:n="#10B981"})=>{const{click:i}=Y();B.useEffect(()=>{C.info("PROGRESSION_PERIOD_SELECTOR_DIAGNOSTIC","Component state debug",{selectedPeriod:t,currentActivities:s,periodThresholds:o,componentRenderTime:new Date().toISOString(),propsReceived:{selectedPeriod:t,currentActivities:s,periodThresholds:o},timestamp:new Date().toISOString()})},[t,s,o]);const c=[{value:"week",label:ie("week"),fullLabel:ae("week"),icon:l.Calendar,threshold:o.week},{value:"month",label:ie("month"),fullLabel:ae("month"),icon:l.CalendarDays,threshold:o.month},{value:"quarter",label:ie("quarter"),fullLabel:ae("quarter"),icon:l.CalendarRange,threshold:o.quarter}],r=p=>{const x=s>=p;return C.debug("PROGRESSION_PERIOD_SELECTOR_DIAGNOSTIC","Period availability check",{currentActivities:s,threshold:p,available:x,calculation:`${s} >= ${p} = ${x}`,timestamp:new Date().toISOString()}),x};return e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"inline-flex gap-2 p-1 rounded-lg",style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",backdropFilter:"blur(10px)"},children:c.map(p=>{const x=r(p.threshold),d=t===p.value;return C.debug("PROGRESSION_PERIOD_SELECTOR_DIAGNOSTIC","Period button render state",{periodValue:p.value,periodLabel:p.label,periodThreshold:p.threshold,currentActivities:s,isAvailable:x,isSelected:d,willShowLock:!x,willBeDisabled:!x,calculation:`${s} >= ${p.threshold} = ${x}`,renderTime:new Date().toISOString(),timestamp:new Date().toISOString()}),C.debug("PROGRESSION_PERIOD_SELECTOR","Period button state",{periodValue:p.value,periodThreshold:p.threshold,isAvailable:x,isSelected:d,currentActivities:s,timestamp:new Date().toISOString()}),e.jsx("button",{onClick:()=>{x?(i(),a(p.value),C.info("PROGRESSION_PERIOD_SELECTOR_DIAGNOSTIC","Period changed",{newPeriod:p.value,wasAvailable:x,currentActivities:s,threshold:p.threshold,timestamp:new Date().toISOString()})):C.warn("PROGRESSION_PERIOD_SELECTOR_DIAGNOSTIC","Attempted to select unavailable period",{period:p.value,currentActivities:s,requiredActivities:p.threshold,missingActivities:p.threshold-s,timestamp:new Date().toISOString()})},disabled:!x,className:"px-6 py-2.5 rounded-lg text-sm font-medium transition-all duration-200",style:{background:d?`${n}33`:"transparent",color:d?n:x?"rgba(255, 255, 255, 0.7)":"rgba(255, 255, 255, 0.4)",border:d?`1px solid ${n}66`:"1px solid transparent",boxShadow:d?`0 0 20px ${n}4D`:"none",opacity:x?1:.5,cursor:x?"pointer":"not-allowed"},children:p.value==="week"?"7 jours":p.value==="month"?"30 jours":"90 jours"},p.value)})})})};class Et{async analyzeHRPerformanceCorrelation(a,s=30){try{const o=new Date;o.setDate(o.getDate()-s);const{data:n,error:i}=await V.from("activities").select("hr_avg, avg_pace, avg_power_watts, avg_cadence_rpm, efficiency_score").eq("user_id",a).gte("timestamp",o.toISOString()).not("hr_avg","is",null).order("timestamp",{ascending:!0});if(i)throw i;if(!n||n.length===0)return null;const c=n.filter(y=>y.hr_avg&&y.efficiency_score);if(c.length<5)return null;const r=c.reduce((y,N)=>y+(N.hr_avg||0),0)/c.length,p=this.calculateAverage(c.map(y=>y.avg_pace)),x=this.calculateAverage(c.map(y=>y.avg_power_watts)),d=this.calculateAverage(c.map(y=>y.avg_cadence_rpm)),h=c.reduce((y,N)=>y+(N.efficiency_score||0),0)/c.length,m=c.slice(-10),u=c.slice(0,10),b=m.reduce((y,N)=>y+(N.efficiency_score||0),0)/m.length,f=u.reduce((y,N)=>y+(N.efficiency_score||0),0)/u.length;let w;const I=b-f;return I>5?w="improving":I<-5?w="declining":w="stable",{avgHeartRate:r,avgPace:p,avgPower:x,avgCadence:d,efficiency:h,trend:w}}catch(o){throw C.error("BIOMETRIC_ANALYSIS","Failed to analyze HR/Performance correlation",{error:o,userId:a}),o}}async detectOvertraining(a){try{const s=new Date;s.setDate(s.getDate()-7);const o=new Date;o.setDate(o.getDate()-30);const{data:n,error:i}=await V.from("activities").select("hrv_pre_activity, recovery_score, hr_resting_pre, sleep_quality_score, stress_level_pre, training_load_score").eq("user_id",a).gte("timestamp",s.toISOString()).not("hrv_pre_activity","is",null),{data:c,error:r}=await V.from("activities").select("hrv_pre_activity, recovery_score, hr_resting_pre").eq("user_id",a).gte("timestamp",o.toISOString()).lt("timestamp",s.toISOString()).not("hrv_pre_activity","is",null);if(i||r)throw i||r;if(!n||n.length===0)return{severity:"none",indicators:["Données insuffisantes pour analyser le surentraînement"],hrvTrend:"stable",recommendations:["Connectez un objet pour suivre votre récupération"],score:0};const p=[];let x=0;const d=n.reduce((j,k)=>j+(k.hrv_pre_activity||0),0)/n.length,h=c&&c.length>0?c.reduce((j,k)=>j+(k.hrv_pre_activity||0),0)/c.length:d,m=(d-h)/h*100;let u;m<-10?(p.push("HRV en baisse significative (-"+Math.abs(m).toFixed(1)+"%)"),x+=30,u="declining"):m>10?u="improving":u="stable";const b=n.reduce((j,k)=>j+(k.recovery_score||0),0)/n.length;b<50&&(p.push("Score de récupération faible ("+b.toFixed(0)+"%)"),x+=25);const f=n.reduce((j,k)=>j+(k.hr_resting_pre||0),0)/n.length,w=c&&c.length>0?c.reduce((j,k)=>j+(k.hr_resting_pre||0),0)/c.length:f;f>w+5&&(p.push("Fréquence cardiaque au repos élevée (+"+(f-w).toFixed(0)+" bpm)"),x+=20);const I=n.reduce((j,k)=>j+(k.sleep_quality_score||0),0)/n.length;I>0&&I<60&&(p.push("Qualité de sommeil dégradée ("+I.toFixed(0)+"%)"),x+=15);const y=n.reduce((j,k)=>j+(k.stress_level_pre||0),0)/n.length;y>70&&(p.push("Niveau de stress élevé ("+y.toFixed(0)+"%)"),x+=10);let N;const v=[];return x>=60?(N="high",v.push("Repos complet recommandé pendant 3-5 jours"),v.push("Consultez un professionnel de santé si les symptômes persistent"),v.push("Évitez tout entraînement intense")):x>=40?(N="moderate",v.push("Réduisez l'intensité d'entraînement de 50%"),v.push("Privilégiez la récupération active (marche, yoga, étirements)"),v.push("Assurez-vous de dormir 8h+ par nuit")):x>=20?(N="low",v.push("Intégrez une journée de repos supplémentaire cette semaine"),v.push("Surveillez votre récupération de près"),v.push("Évitez d'augmenter votre charge d'entraînement")):(N="none",v.push("Votre récupération est bonne, continuez ainsi"),v.push("Maintenez une progression progressive")),p.length===0&&p.push("Aucun signe de surentraînement détecté"),{severity:N,indicators:p,hrvTrend:u,recommendations:v,score:x}}catch(s){throw C.error("BIOMETRIC_ANALYSIS","Failed to detect overtraining",{error:s,userId:a}),s}}async findOptimalTrainingWindows(a,s=60){try{const o=new Date;o.setDate(o.getDate()-s);const{data:n,error:i}=await V.from("activities").select("timestamp, efficiency_score, recovery_score, avg_power_watts, avg_pace").eq("user_id",a).gte("timestamp",o.toISOString()).not("efficiency_score","is",null);if(i)throw i;if(!n||n.length<10)return[];const c={morning:{performances:[],recoveries:[],count:0},afternoon:{performances:[],recoveries:[],count:0},evening:{performances:[],recoveries:[],count:0}};n.forEach(p=>{const x=new Date(p.timestamp).getHours();let d;x>=5&&x<12?d="morning":x>=12&&x<18?d="afternoon":d="evening",c[d].performances.push(p.efficiency_score||0),c[d].recoveries.push(p.recovery_score||0),c[d].count++});const r=[];for(const[p,x]of Object.entries(c)){if(x.count<3)continue;const d=x.performances.reduce((b,f)=>b+f,0)/x.performances.length,h=x.recoveries.reduce((b,f)=>b+f,0)/x.recoveries.length,m=Math.min(x.count/10,1);let u="";d>75&&h>70?u="Fenêtre optimale pour entraînements intensifs":d>60?u="Bon moment pour entraînements modérés":u="Privilégier récupération active ou repos",r.push({timeOfDay:p,avgPerformance:d,avgRecovery:h,recommendation:u,confidence:m})}return r.sort((p,x)=>x.avgPerformance-p.avgPerformance)}catch(o){throw C.error("BIOMETRIC_ANALYSIS","Failed to find optimal training windows",{error:o,userId:a}),o}}calculateAverage(a){const s=a.filter(o=>o!=null);if(s.length!==0)return s.reduce((o,n)=>o+n,0)/s.length}}const ne=new Et,At=({period:t})=>{const{profile:a}=L(),[s,o]=B.useState(null),[n,i]=B.useState(null),[c,r]=B.useState([]),[p,x]=B.useState([]),[d,h]=B.useState(!0),m=t==="week"?7:t==="month"?30:90;if(B.useEffect(()=>{(async()=>{if(a?.id)try{h(!0),C.info("BIOMETRIC_INSIGHTS","Fetching biometric insights",{userId:a.id,period:t});const[N,v,j,k]=await Promise.all([ne.analyzeHRPerformanceCorrelation(a.id,m),ne.detectOvertraining(a.id),ne.findOptimalTrainingWindows(a.id,m*2),Promise.resolve([])]);o(N),i(v),r(j),x(k),C.info("BIOMETRIC_INSIGHTS","Biometric insights fetched successfully",{hasCorrelation:!!N,overtrainingSeverity:v?.severity,windowsCount:j?.length})}catch(N){C.error("BIOMETRIC_INSIGHTS","Failed to fetch biometric insights",{error:N})}finally{h(!1)}})()},[a?.id,m,t]),d)return e.jsx("div",{className:"space-y-4",children:[1,2,3].map(y=>e.jsx("div",{className:"h-48 rounded-2xl animate-pulse",style:{background:"linear-gradient(145deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02))"}},y))});if(!(s||n&&n.severity!=="none"||c.length>0))return e.jsxs(F,{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #F59E0B 20%, transparent), color-mix(in srgb, #F59E0B 10%, transparent))",border:"1px solid color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(g,{Icon:l.Activity,size:32,style:{color:"#F59E0B"}})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Insights Biométriques"}),e.jsx("p",{className:"text-white/70 text-base max-w-md mx-auto leading-relaxed",children:"Connectez un objet et enregistrez des activités avec données biométriques pour débloquer des analyses avancées de corrélation FC/Performance, détection de surentraînement et fenêtres optimales."})]});const b={none:{primary:"#22C55E",secondary:"#10B981"},low:{primary:"#F59E0B",secondary:"#D97706"},moderate:{primary:"#F97316",secondary:"#EA580C"},high:{primary:"#EF4444",secondary:"#DC2626"}},f={improving:{primary:"#22C55E",secondary:"#10B981",icon:l.TrendingUp},stable:{primary:"#3B82F6",secondary:"#2563EB",icon:l.Minus},declining:{primary:"#EF4444",secondary:"#DC2626",icon:l.TrendingDown}},w={morning:"Matin",afternoon:"Après-midi",evening:"Soir"},I={morning:l.Sunrise,afternoon:l.Sun,evening:l.Moon};return e.jsxs("div",{className:"space-y-6",children:[s&&e.jsxs(F,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`linear-gradient(135deg, color-mix(in srgb, ${f[s.trend].primary} 25%, transparent), color-mix(in srgb, ${f[s.trend].secondary} 15%, transparent))`,border:`1px solid color-mix(in srgb, ${f[s.trend].primary} 35%, transparent)`,boxShadow:`0 0 20px color-mix(in srgb, ${f[s.trend].primary} 20%, transparent)`},children:e.jsx(g,{Icon:l.Activity,size:24,style:{color:f[s.trend].primary}})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Corrélation FC / Performance"}),e.jsxs("div",{className:"px-3 py-1 rounded-full text-xs font-semibold flex items-center gap-1.5",style:{background:`color-mix(in srgb, ${f[s.trend].primary} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${f[s.trend].primary} 25%, transparent)`,color:f[s.trend].primary},children:[e.jsx(g,{Icon:f[s.trend].icon,size:12}),s.trend==="improving"&&"En amélioration",s.trend==="stable"&&"Stable",s.trend==="declining"&&"En baisse"]})]}),e.jsxs("p",{className:"text-white/70 text-sm",children:["Analyse de l'efficacité cardiovasculaire sur les ",m," derniers jours"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-xl",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(g,{Icon:l.Heart,size:14,style:{color:"#EF4444"}}),e.jsx("span",{className:"text-white/60 text-xs font-medium",children:"Fréquence Cardiaque Moyenne"})]}),e.jsxs("p",{className:"text-2xl font-bold text-white",children:[s.avgHeartRate.toFixed(0)," bpm"]})]}),e.jsxs("div",{className:"p-4 rounded-xl",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(g,{Icon:l.Target,size:14,style:{color:"#3B82F6"}}),e.jsx("span",{className:"text-white/60 text-xs font-medium",children:"Score d'Efficacité"})]}),e.jsxs("p",{className:"text-2xl font-bold text-white",children:[s.efficiency.toFixed(0),"%"]})]}),s.avgPace&&e.jsxs("div",{className:"p-4 rounded-xl",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(g,{Icon:l.Zap,size:14,style:{color:"#F59E0B"}}),e.jsx("span",{className:"text-white/60 text-xs font-medium",children:"Allure Moyenne"})]}),e.jsxs("p",{className:"text-2xl font-bold text-white",children:[s.avgPace.toFixed(1)," min/km"]})]}),s.avgPower&&e.jsxs("div",{className:"p-4 rounded-xl",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(g,{Icon:l.Zap,size:14,style:{color:"#8B5CF6"}}),e.jsx("span",{className:"text-white/60 text-xs font-medium",children:"Puissance Moyenne"})]}),e.jsxs("p",{className:"text-2xl font-bold text-white",children:[s.avgPower.toFixed(0)," W"]})]})]})]}),n&&n.severity!=="none"&&e.jsxs(F,{className:"p-6",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, ${b[n.severity].primary} 12%, transparent) 0%, transparent 60%),
              var(--glass-opacity)
            `,borderColor:`color-mix(in srgb, ${b[n.severity].primary} 30%, transparent)`,boxShadow:`0 0 24px color-mix(in srgb, ${b[n.severity].primary} 15%, transparent)`},children:[e.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`linear-gradient(135deg, color-mix(in srgb, ${b[n.severity].primary} 25%, transparent), color-mix(in srgb, ${b[n.severity].secondary} 15%, transparent))`,border:`1px solid color-mix(in srgb, ${b[n.severity].primary} 35%, transparent)`,boxShadow:`0 0 20px color-mix(in srgb, ${b[n.severity].primary} 25%, transparent)`},children:e.jsx(g,{Icon:l.AlertTriangle,size:24,style:{color:b[n.severity].primary}})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Détection Surentraînement"}),e.jsxs("div",{className:"px-3 py-1 rounded-full text-xs font-semibold",style:{background:`color-mix(in srgb, ${b[n.severity].primary} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${b[n.severity].primary} 25%, transparent)`,color:b[n.severity].primary},children:[n.severity==="low"&&"Vigilance",n.severity==="moderate"&&"Attention",n.severity==="high"&&"Alerte"]})]}),e.jsxs("p",{className:"text-white/70 text-sm",children:["Score de risque: ",n.score,"/100"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white font-semibold text-sm mb-3 flex items-center gap-2",children:[e.jsx(g,{Icon:l.AlertCircle,size:14}),"Indicateurs détectés"]}),e.jsx("div",{className:"space-y-2",children:n.indicators.map((y,N)=>e.jsxs("div",{className:"flex items-start gap-2 p-3 rounded-lg",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsx("div",{className:"w-1 h-1 rounded-full mt-2",style:{background:b[n.severity].primary}}),e.jsx("span",{className:"text-white/80 text-sm",children:y})]},N))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white font-semibold text-sm mb-3 flex items-center gap-2",children:[e.jsx(g,{Icon:l.Lightbulb,size:14}),"Recommandations"]}),e.jsx("div",{className:"space-y-2",children:n.recommendations.map((y,N)=>e.jsxs("div",{className:"flex items-start gap-2 p-3 rounded-lg",style:{background:`color-mix(in srgb, ${b[n.severity].primary} 8%, transparent)`,border:`1px solid color-mix(in srgb, ${b[n.severity].primary} 15%, transparent)`},children:[e.jsx(g,{Icon:l.Check,size:14,style:{color:b[n.severity].primary,marginTop:2}}),e.jsx("span",{className:"text-white/90 text-sm",children:y})]},N))})]})]})]}),c.length>0&&e.jsxs(F,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:"linear-gradient(135deg, color-mix(in srgb, #8B5CF6 25%, transparent), color-mix(in srgb, #8B5CF6 15%, transparent))",border:"1px solid color-mix(in srgb, #8B5CF6 35%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #8B5CF6 20%, transparent)"},children:e.jsx(g,{Icon:l.Clock,size:24,style:{color:"#8B5CF6"}})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Fenêtres Optimales d'Entraînement"}),e.jsxs("p",{className:"text-white/70 text-sm",children:["Basé sur ",m*2," jours d'analyse de vos performances"]})]})]}),e.jsx("div",{className:"space-y-3",children:c.map((y,N)=>e.jsxs("div",{className:"p-4 rounded-xl",style:{background:N===0?"linear-gradient(135deg, color-mix(in srgb, #8B5CF6 12%, transparent), color-mix(in srgb, #8B5CF6 5%, transparent))":"rgba(255,255,255,0.05)",border:N===0?"1px solid color-mix(in srgb, #8B5CF6 25%, transparent)":"1px solid rgba(255,255,255,0.08)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(g,{Icon:I[y.timeOfDay],size:20,style:{color:"#8B5CF6"}}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-semibold text-base",children:w[y.timeOfDay]}),N===0&&e.jsx("span",{className:"text-purple-300 text-xs font-medium",children:"Meilleur créneau"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-white/50 text-xs",children:"Confiance"}),e.jsxs("p",{className:"text-white font-bold text-sm",children:[(y.confidence*100).toFixed(0),"%"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white/50 text-xs mb-1",children:"Performance"}),e.jsxs("p",{className:"text-white font-semibold",children:[y.avgPerformance.toFixed(0),"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/50 text-xs mb-1",children:"Récupération"}),e.jsxs("p",{className:"text-white font-semibold",children:[y.avgRecovery.toFixed(0),"%"]})]})]}),e.jsx("p",{className:"text-white/80 text-sm",children:y.recommendation})]},N))})]}),p.length>0&&e.jsxs(F,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:"linear-gradient(135deg, color-mix(in srgb, #10B981 25%, transparent), color-mix(in srgb, #10B981 15%, transparent))",border:"1px solid color-mix(in srgb, #10B981 35%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #10B981 20%, transparent)"},children:e.jsx(g,{Icon:l.Target,size:24,style:{color:"#10B981"}})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Recommandations basées sur vos Objectifs"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Insights personnalisés pour atteindre vos objectifs"})]})]}),e.jsx("div",{className:"space-y-4",children:p.map(y=>{const N=y.goal,v=N.deadline?Math.ceil((new Date(N.deadline).getTime()-new Date().getTime())/(1e3*60*60*24)):null,j=v&&v<=14&&y.progress_percentage<70,k=!y.on_track&&y.progress_percentage<100;return!j&&!k?null:e.jsxs("div",{className:"p-4 rounded-xl",style:{background:j?"linear-gradient(135deg, color-mix(in srgb, #F59E0B 12%, transparent), color-mix(in srgb, #F59E0B 5%, transparent))":"linear-gradient(135deg, color-mix(in srgb, #3B82F6 12%, transparent), color-mix(in srgb, #3B82F6 5%, transparent))",border:j?"1px solid color-mix(in srgb, #F59E0B 25%, transparent)":"1px solid color-mix(in srgb, #3B82F6 25%, transparent)"},children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx(g,{Icon:j?l.AlertTriangle:l.Info,size:20,style:{color:j?"#F59E0B":"#3B82F6",marginTop:2}}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-white font-semibold text-base mb-1",children:N.title}),e.jsx("p",{className:"text-white/80 text-sm leading-relaxed",children:j?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Action urgente :"})," Il vous reste ",v," jours pour atteindre cet objectif. Vous êtes à ",y.progress_percentage.toFixed(0),"% de complétion.",N.goal_type==="volume"&&" Augmentez votre fréquence d'entraînement de 20% cette semaine.",N.goal_type==="distance"&&" Privilégiez des séances plus longues pour maximiser la distance parcourue.",N.goal_type==="endurance"&&" Intégrez 2 séances d'interval training haute intensité cette semaine."]}):k?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Ajustez votre stratégie :"})," Vous êtes légèrement en retard sur cet objectif. Basé sur vos performances biométriques, ",s&&s.trend==="improving"?"vous êtes en phase d'amélioration. Maintenez le cap avec une progression constante.":"assurez-vous de bien récupérer entre les séances pour optimiser vos performances."]}):null}),y.estimated_completion_date&&v&&v>0&&e.jsxs("p",{className:"text-white/60 text-xs mt-2",children:["Estimation d'achèvement: ",new Date(y.estimated_completion_date).toLocaleDateString("fr-FR",{day:"numeric",month:"long"})]})]})]}),c.length>0&&j&&e.jsxs("div",{className:"mt-3 p-3 rounded-lg",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsx("p",{className:"text-white/70 text-xs mb-1",children:"💡 Fenêtre optimale recommandée"}),e.jsxs("p",{className:"text-white text-sm font-medium",children:[c[0].timeOfDay==="morning"&&"Matin",c[0].timeOfDay==="afternoon"&&"Après-midi",c[0].timeOfDay==="evening"&&"Soir"," ","pour maximiser vos performances et atteindre votre objectif plus rapidement"]})]})]},N.id)})})]})]})},ye={week:"last7Days",month:"last30Days",quarter:"last3Months"},Dt=()=>{const{profile:t}=L(),{showToast:a}=ee(),{click:s}=Y(),{showModal:o}=Ce(),n=te(y=>y.selectedPeriod),i=te(y=>y.setSelectedPeriod),c=ye[n],[r,p]=B.useState(0),{data:x=!1}=Ee(),{data:d,isLoading:h,error:m}=Se(c),u=_e(({currentLocation:y,nextLocation:N})=>{const v=h&&y.pathname!==N.pathname;return v&&(C.info("ACTIVITY_INSIGHTS_TAB","Navigation blocked during analysis loading",{currentPath:y.pathname,nextPath:N.pathname,isLoading:h,timestamp:new Date().toISOString()}),o({title:"Attention ! Analyse d'insights en cours",message:"Voulez-vous vraiment quitter l'analyse ? Les insights pourraient être perdus et devront être régénérés.",processName:"Analyse d'Insights",onConfirm:()=>{C.info("ACTIVITY_INSIGHTS_TAB","User confirmed exit during analysis",{currentPath:y.pathname,nextPath:N.pathname,timestamp:new Date().toISOString()}),u.proceed?.()},onCancel:()=>{C.info("ACTIVITY_INSIGHTS_TAB","User cancelled exit during analysis",{currentPath:y.pathname,nextPath:N.pathname,timestamp:new Date().toISOString()}),u.reset?.()}})),v});B.useEffect(()=>{d?.current_activities!==void 0&&p(d.current_activities)},[d?.current_activities]),B.useEffect(()=>{m&&(C.error("ACTIVITY_INSIGHTS_TAB","Erreur lors de la génération des insights",{error:m instanceof Error?m.message:"Unknown error",selectedPeriod:n,timestamp:new Date().toISOString()}),a({type:"error",title:"Erreur d'analyse",message:"Impossible de générer les insights. Veuillez réessayer.",duration:4e3}))},[m,n,a]);const b=y=>{s(),i(y),C.info("ACTIVITY_INSIGHTS_TAB","Period changed by user",{newPeriod:y,apiPeriod:ye[y],timestamp:new Date().toISOString()})},f={week:H("last7Days"),month:H("last30Days"),quarter:H("last3Months")},w=d?.fallback,I=d?.cached;return x?d?.insufficient_data?e.jsxs("div",{className:"space-y-6",children:[e.jsx(Z,{selectedPeriod:n,onPeriodChange:b,currentActivities:r,periodThresholds:f,accentColor:"#F59E0B"}),e.jsxs(F,{className:"p-8 text-center",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #F59E0B 15%, transparent) 0%, transparent 60%),
              radial-gradient(circle at 70% 80%, color-mix(in srgb, #EF4444 12%, transparent) 0%, transparent 50%),
              linear-gradient(145deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, #F59E0B 30%, transparent)",boxShadow:`
              0 12px 40px rgba(0, 0, 0, 0.25),
              0 0 30px color-mix(in srgb, #F59E0B 20%, transparent),
              inset 0 2px 0 rgba(255, 255, 255, 0.15)
            `},children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6",children:[e.jsx("div",{className:"w-20 h-20 rounded-full flex items-center justify-center breathing-icon",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #F59E0B 30%, transparent), color-mix(in srgb, #F59E0B 20%, transparent))
                `,border:"2px solid color-mix(in srgb, #F59E0B 40%, transparent)",boxShadow:"0 0 30px color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(g,{Icon:l.AlertCircle,size:40,style:{color:"#F59E0B"}})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-2xl font-bold text-white",children:"Insights en Construction"}),e.jsx("p",{className:"text-white/70 text-base",children:"Plus d'activités nécessaires"})]})]}),e.jsxs("div",{className:"space-y-4 max-w-lg mx-auto",children:[e.jsxs("p",{className:"text-white/80 text-lg leading-relaxed",children:["Vous avez ",e.jsx("strong",{className:"text-orange-300",children:d.current_activities})," activité",d.current_activities>1?"s":""," enregistrée",d.current_activities>1?"s":"","."]}),e.jsxs("p",{className:"text-white/70 text-base leading-relaxed",children:["Il vous faut au moins ",e.jsx("strong",{className:"text-orange-300",children:d.required_activities})," activités pour générer des insights personnalisés sur cette période."]}),e.jsxs("div",{className:"mt-6 p-4 rounded-xl",style:{background:"color-mix(in srgb, #3B82F6 8%, transparent)",border:"1px solid color-mix(in srgb, #3B82F6 20%, transparent)"},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(g,{Icon:l.Zap,size:16,style:{color:"#3B82F6"}}),e.jsx("span",{className:"text-blue-300 font-semibold text-sm",children:"Passez à l'action !"})]}),e.jsxs("p",{className:"text-blue-200 text-sm leading-relaxed",children:["Enregistrez ",d.required_activities-d.current_activities," activité",d.required_activities-d.current_activities>1?"s":""," supplémentaire",d.required_activities-d.current_activities>1?"s":"","pour débloquer vos insights personnalisés et découvrir des recommandations sur mesure."]})]})]})]})]}):w&&d?e.jsxs("div",{className:"space-y-6",children:[e.jsx(Z,{selectedPeriod:n,onPeriodChange:b,currentActivities:r,periodThresholds:f,accentColor:"#F59E0B"}),e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"text-amber-800 text-sm",children:"Analyse détaillée temporairement indisponible. Voici un résumé basique de vos activités."})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(ve,{globalStats:d?.summary,period:n,apiPeriod:c}),e.jsx(be,{insights:d?.insights||[],summary:d?.summary,period:n,apiPeriod:c})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(Z,{selectedPeriod:n,onPeriodChange:b,currentActivities:r,periodThresholds:f,accentColor:"#F59E0B"}),I&&e.jsx(F,{className:"p-4",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #22C55E 8%, transparent) 0%, transparent 60%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, #22C55E 25%, transparent)",boxShadow:"0 0 16px color-mix(in srgb, #22C55E 15%, transparent)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"color-mix(in srgb, #22C55E 15%, transparent)",border:"1px solid color-mix(in srgb, #22C55E 25%, transparent)"},children:e.jsx(g,{Icon:l.Check,size:14,style:{color:"#22C55E"}})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-green-300 font-medium text-sm",children:"Données mises en cache"}),e.jsxs("p",{className:"text-green-200 text-xs mt-0.5",children:["Dernière analyse: ",d.cache_age_hours,"h • Économie de coûts IA"]})]})]})}),h?e.jsx(De,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(ve,{globalStats:d?.summary,period:n,apiPeriod:c}),e.jsx(At,{period:n}),e.jsx(be,{insights:d?.insights||[],summary:d?.summary,period:n,apiPeriod:c}),d&&(!d.insights||d.insights.length===0)&&e.jsxs(F,{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-6 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #F59E0B 20%, transparent), color-mix(in srgb, #F59E0B 10%, transparent))",border:"1px solid color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(g,{Icon:l.Info,size:32,style:{color:"#F59E0B"}})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Aucun Insight Généré"}),e.jsx("p",{className:"text-white/70 text-base mb-6 max-w-md mx-auto leading-relaxed",children:"Aucun insight n'a été généré pour cette période. Continuez à enregistrer vos activités pour enrichir l'analyse et débloquer des insights personnalisés."}),e.jsx("div",{className:"text-orange-300 text-sm",children:"Enregistrez plus d'activités pour des insights détaillés"})]})]})]}):e.jsx("div",{className:"space-y-6",children:e.jsxs(F,{className:"p-8 text-center",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #F59E0B 15%, transparent) 0%, transparent 60%),
              radial-gradient(circle at 70% 80%, color-mix(in srgb, #D97706 12%, transparent) 0%, transparent 50%),
              linear-gradient(145deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, #F59E0B 30%, transparent)",boxShadow:`
              0 12px 40px rgba(0, 0, 0, 0.25),
              0 0 30px color-mix(in srgb, #F59E0B 20%, transparent),
              inset 0 2px 0 rgba(255, 255, 255, 0.15)
            `},children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6",children:[e.jsx("div",{className:"w-20 h-20 rounded-full flex items-center justify-center",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #F59E0B 30%, transparent), color-mix(in srgb, #F59E0B 20%, transparent))
                `,border:"2px solid color-mix(in srgb, #F59E0B 40%, transparent)",boxShadow:"0 0 30px color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(g,{Icon:l.Lightbulb,size:40,style:{color:"#F59E0B"}})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-2xl font-bold text-white",children:"Forge d'Insights Vierge"}),e.jsx("p",{className:"text-white/70 text-base",children:"Vos conseils personnalisés vous attendent"})]})]}),e.jsxs("p",{className:"text-white/70 text-base max-w-lg mx-auto leading-relaxed",children:["Enregistrez au moins ",f.week," activités pour débloquer vos conseils personnalisés et découvrir des insights IA sur votre progression énergétique."]})]})})};function Tt(t){switch(t){case"week":return"7 jours";case"month":return"30 jours";case"quarter":return"90 jours";default:return"30 jours"}}const fe=({data:t,profile:a,period:s,apiPeriod:o})=>{if(de(),!t||!t.activity_types||t.activity_types.length===0)return e.jsx("div",{className:"chart-enter-right",children:e.jsx(F,{className:"p-6",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-activity-primary) 8%, transparent) 0%, transparent 60%),
              radial-gradient(circle at 70% 80%, color-mix(in srgb, var(--color-activity-secondary) 6%, transparent) 0%, transparent 50%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, var(--color-activity-primary) 25%, transparent)",boxShadow:`
              0 8px 32px rgba(0, 0, 0, 0.2),
              0 0 20px color-mix(in srgb, var(--color-activity-primary) 10%, transparent),
              inset 0 1px 0 rgba(255, 255, 255, 0.12)
            `},children:e.jsxs("div",{className:"flex items-center justify-center gap-3 p-8",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #10B981 30%, transparent), color-mix(in srgb, #10B981 20%, transparent))
                `,border:"2px solid color-mix(in srgb, #10B981 40%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #10B981 30%, transparent)"},children:e.jsx(g,{Icon:l.BarChart3,size:20,style:{color:"#10B981"}})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-white font-bold text-xl mb-2",children:"Distribution Énergétique"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Données insuffisantes pour l'analyse"})]})]})})});const i=(()=>{if(!t?.activity_types||t.activity_types.length===0)return 0;const r=Math.min(100,t.activity_types.length/5*100),p=(t.intensity_levels||[]).reduce((x,d)=>{const m=Math.abs(d.percentage-25);return x+(25-Math.min(25,m))},0);return Math.round((r+p)/2)})(),c=i>=80?"#22C55E":i>=60?"#F59E0B":"#EF4444";return e.jsx("div",{className:"chart-enter-right",children:e.jsxs(F,{className:"p-6",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-activity-primary) 8%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, var(--color-activity-secondary) 6%, transparent) 0%, transparent 50%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, var(--color-activity-primary) 25%, transparent)",boxShadow:`
            0 8px 32px rgba(0, 0, 0, 0.2),
            0 0 20px color-mix(in srgb, var(--color-activity-primary) 10%, transparent),
            inset 0 1px 0 rgba(255, 255, 255, 0.12)
          `},children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #10B981 30%, transparent), color-mix(in srgb, #10B981 20%, transparent))
                `,border:"2px solid color-mix(in srgb, #10B981 40%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #10B981 30%, transparent)"},children:e.jsx(g,{Icon:l.BarChart3,size:20,style:{color:"#10B981"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-bold text-xl",children:"Distribution Énergétique"}),e.jsxs("p",{className:"text-white/70 text-sm",children:["Répartition de vos activités sur ",Tt(s)]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:c,boxShadow:`0 0 8px color-mix(in srgb, ${c} 60%, transparent)`}}),e.jsx("span",{className:"text-white font-bold text-lg",children:i})]}),e.jsx("div",{className:"text-white/60 text-xs",children:"Score Équilibre"})]})]}),t.activity_types&&t.activity_types.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h4",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[e.jsx(g,{Icon:l.Target,size:16,style:{color:"#10B981"}}),"Types d'Activités"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:t.activity_types.map((r,p)=>e.jsxs(_.div,{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${r.color} 8%, transparent)`,border:`1px solid color-mix(in srgb, ${r.color} 20%, transparent)`,animationDelay:`${.6+p*.1}s`},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,delay:p*.1},children:[e.jsx("div",{className:"flex items-center justify-center gap-1 mb-2",children:e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{background:`color-mix(in srgb, ${r.color} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${r.color} 25%, transparent)`},children:e.jsx(g,{Icon:l.Activity,size:12,style:{color:r.color}})})}),e.jsxs("div",{className:"text-lg font-bold",style:{color:r.color},children:[r.percentage,"%"]}),e.jsx("div",{className:"text-sm font-medium text-white",children:r.name}),e.jsxs("div",{className:"text-xs text-white/60 mt-1",children:[r.total_minutes," min • ",r.total_calories," kcal"]})]},r.name))})]}),t?.intensity_levels&&t.intensity_levels.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h4",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[e.jsx(g,{Icon:l.Zap,size:16,style:{color:"#10B981"}}),"Niveaux d'Intensité"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:t.intensity_levels.map((r,p)=>e.jsxs(_.div,{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${r.color} 8%, transparent)`,border:`1px solid color-mix(in srgb, ${r.color} 20%, transparent)`},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3+p*.1},children:[e.jsxs("div",{className:"text-xl font-bold",style:{color:r.color},children:[r.percentage,"%"]}),e.jsx("div",{className:"text-sm font-medium text-white",children:r.level}),e.jsxs("div",{className:"text-xs text-white/60 mt-1",children:[r.sessions_count," sessions"]})]},r.level))})]}),t?.time_patterns&&t.time_patterns.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[e.jsx(g,{Icon:l.Clock,size:16,style:{color:"#10B981"}}),"Patterns Temporels"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:t.time_patterns.map((r,p)=>e.jsxs(_.div,{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${r.color} 8%, transparent)`,border:`1px solid color-mix(in srgb, ${r.color} 20%, transparent)`},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.5+p*.1},children:[e.jsx("div",{className:"text-lg font-bold",style:{color:r.color},children:r.activity_count}),e.jsx("div",{className:"text-sm font-medium text-white",children:r.period}),e.jsxs("div",{className:"text-xs text-white/60 mt-1",children:[r.avg_calories," kcal moy."]})]},r.period))})]}),e.jsx("div",{className:"mt-6 p-4 rounded-xl",style:{background:`color-mix(in srgb, ${c} 6%, transparent)`,border:`1px solid color-mix(in srgb, ${c} 18%, transparent)`,backdropFilter:"blur(8px) saturate(120%)"},children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(g,{Icon:i>=80?l.Check:i>=60?l.Info:l.AlertCircle,size:14,style:{color:c},className:"mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",style:{color:c},children:i>=80?"Excellent équilibre énergétique":i>=60?"Bon équilibre, quelques ajustements possibles":"Équilibre à améliorer"}),e.jsx("p",{className:"text-xs mt-1",style:{color:`${c}CC`},children:i>=80?"Continuez cette diversité d'activités":i>=60?"Variez davantage vos types d'activités":"Essayez d'intégrer plus de variété dans vos entraînements"})]})]})})]})})};function zt(t){switch(t){case"week":return"7 jours";case"month":return"30 jours";case"quarter":return"90 jours";default:return"30 jours"}}function $t(t){switch(t){case"week":return 7;case"month":return 30;case"quarter":return 90;default:return 30}}function oe(t,a){const s={excellent:"#22C55E",high:"#3B82F6",medium:"#F59E0B",low:"#EF4444",none:"rgba(255, 255, 255, 0.05)"},o=s[t]||s.none;if(t==="none")return o;const n=Math.max(.3,a);return`${o}${Math.round(n*255).toString(16).padStart(2,"0")}`}const je=({activities:t,period:a,apiPeriod:s})=>{const o=t||[],n=()=>{const r=new Date,p=$t(a),x=new Date(r);x.setDate(r.getDate()-p+1);const d=[];for(let v=0;v<p;v++){const j=new Date(x);j.setDate(x.getDate()+v);const k=j.toISOString().split("T")[0],$=o.filter(A=>A.timestamp.startsWith(k)),D=$.reduce((A,T)=>A+(T.calories_est||0),0),z=$.reduce((A,T)=>A+(T.duration_min||0),0),P=$.length;let E="none",S=0;P>0&&(D>=500||z>=60?(E="excellent",S=1):D>=300||z>=40?(E="high",S=.8):D>=150||z>=20?(E="medium",S=.6):(E="low",S=.4)),d.push({date:k,dayName:R(j,"EEEE",{locale:W}),dayNumber:j.getDate(),monthName:R(j,"MMMM",{locale:W}),status:E,intensity:S,calories:D,activitiesCount:P,duration:z})}const h=[];let m=[];d.forEach((v,j)=>{const k=new Date(v.date).getDay(),$=k===0?6:k-1;(m.length===7||j===0&&$>0)&&m.length>0&&(h.push(m),m=[]),m.push(v),j===d.length-1&&h.push(m)});const u=d.filter(v=>v.status==="excellent").length,b=d.filter(v=>v.activitiesCount>0).length,f=Math.round(b/d.length*100),w=Math.round(u/d.length*100),I=Math.round(d.reduce((v,j)=>v+j.calories,0)/d.length),y=Math.round(d.reduce((v,j)=>v+j.duration,0)/d.length);return{weeks:h,stats:{excellentDays:u,activityRate:f,excellenceRate:w,avgCaloriesPerDay:I,avgDurationPerDay:y}}},{weeks:i,stats:c}=n();return e.jsx("div",{className:"heatmap-enter",children:e.jsxs(F,{className:"p-6",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-activity-secondary) 8%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, var(--color-activity-accent) 6%, transparent) 0%, transparent 50%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, var(--color-activity-secondary) 25%, transparent)",boxShadow:`
            0 8px 32px rgba(0, 0, 0, 0.2),
            0 0 20px color-mix(in srgb, var(--color-activity-secondary) 10%, transparent),
            inset 0 1px 0 rgba(255, 255, 255, 0.12)
          `},children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #10B981 30%, transparent), color-mix(in srgb, #10B981 20%, transparent))
                `,border:"2px solid color-mix(in srgb, #10B981 40%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #10B981 30%, transparent)"},children:e.jsx(g,{Icon:l.Calendar,size:20,style:{color:"#10B981"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-bold text-xl",children:"Activité Énergétique"}),e.jsxs("p",{className:"text-white/70 text-sm",children:["Votre régularité sur ",zt(a)]})]})]}),e.jsxs("div",{className:"text-right space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-400"}),e.jsxs("span",{className:"text-green-300 text-sm font-medium",children:[c.excellentDays," jours excellents"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:"var(--color-activity-secondary)"}}),e.jsxs("span",{className:"text-white/70 text-sm font-medium",children:[c.activityRate,"% d'activité"]})]})]})]}),e.jsxs("div",{className:"space-y-3 heatmap-grid-container overflow-x-auto",children:[e.jsx("div",{className:"grid grid-cols-7 gap-2 mb-2",children:["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"].map(r=>e.jsx("div",{className:"text-center text-white/60 text-xs font-medium py-1",children:r},r))}),e.jsx("div",{className:"space-y-2",children:i.map((r,p)=>e.jsx("div",{className:"grid grid-cols-7 gap-2",children:r.map((x,d)=>e.jsxs(_.div,{className:"aspect-square rounded-lg border cursor-pointer group relative overflow-hidden min-w-0",style:{backgroundColor:oe(x.status,x.intensity),borderColor:x.status!=="none"?`color-mix(in srgb, ${oe(x.status,1)} 40%, transparent)`:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(4px) saturate(120%)"},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.3,delay:(p*7+d)*.02},whileHover:{scale:1.1,zIndex:10,transition:{duration:.2}},title:`${x.dayName} ${x.dayNumber} ${x.monthName} - ${x.calories} kcal (${x.activitiesCount} activités, ${x.duration} min)`,children:[e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center p-0.5",children:[e.jsx("div",{className:"text-white text-xs font-bold leading-none",children:x.dayNumber}),x.activitiesCount>0&&e.jsx("div",{className:"text-white/80 text-xxs leading-none mt-0.5",children:x.activitiesCount})]}),e.jsx("div",{className:"absolute inset-0 rounded-lg opacity-0 group-hover:opacity-30 transition-opacity duration-200",style:{background:"linear-gradient(135deg, rgba(255,255,255,0.3) 0%, transparent 50%, rgba(255,255,255,0.1) 100%)"}})]},x.date))},p))})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-white/10 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 sm:gap-4",children:[e.jsx("span",{className:"text-white/60 text-sm",children:"Moins actif"}),e.jsx("div",{className:"flex items-center gap-1",children:[.2,.4,.6,.8,1].map((r,p)=>e.jsx("div",{className:"w-3 h-3 rounded border border-white/20",style:{backgroundColor:oe("excellent",r)}},p))}),e.jsx("span",{className:"text-white/60 text-sm",children:"Plus actif"})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-3 sm:gap-4 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-400"}),e.jsx("span",{className:"text-green-300",children:"Excellent"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-400"}),e.jsx("span",{className:"text-blue-300",children:"Élevé"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-400"}),e.jsx("span",{className:"text-orange-300",children:"Modéré"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-400"}),e.jsx("span",{className:"text-red-300",children:"Faible"})]})]})]}),e.jsxs("div",{className:"mt-6 p-4 rounded-xl bg-cyan-500/10 border border-cyan-400/20 overflow-hidden",children:[e.jsxs("h4",{className:"text-cyan-300 font-medium text-sm mb-3 flex items-center gap-2",children:[e.jsx(g,{Icon:l.Info,size:12}),"Analyse des Patterns"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm",children:[e.jsx("div",{children:e.jsxs("span",{className:"text-white/80",children:[e.jsxs("strong",{children:[c.excellenceRate,"%"]})," de jours avec activité excellente"]})}),e.jsx("div",{children:e.jsxs("span",{className:"text-white/80",children:[e.jsx("strong",{children:c.avgCaloriesPerDay})," kcal brûlées en moyenne par jour"]})}),e.jsx("div",{children:e.jsxs("span",{className:"text-white/80",children:[e.jsxs("strong",{children:[c.activityRate,"%"]})," de jours avec activité enregistrée"]})}),e.jsx("div",{children:e.jsxs("span",{className:"text-white/80",children:[e.jsx("strong",{children:c.avgDurationPerDay})," min d'activité moyenne par jour"]})})]})]})]})})},Mt=({userId:t,period:a})=>{const[s,o]=B.useState([]),[n,i]=B.useState(!0),c=a==="week"?7:a==="month"?30:90;if(B.useEffect(()=>{(async()=>{try{i(!0);const z=new Date;z.setDate(z.getDate()-c);const{data:P,error:E}=await V.from("activities").select("timestamp, calories_est").eq("user_id",t).gte("timestamp",z.toISOString()).not("calories_est","is",null).order("timestamp",{ascending:!0});if(E)throw E;if(P&&P.length>0){const S=new Map;P.forEach(T=>{const M=new Date(T.timestamp).toISOString().split("T")[0];S.has(M)||S.set(M,{date:M,calories:0,activitiesCount:0});const X=S.get(M);X.calories+=T.calories_est||0,X.activitiesCount+=1});const A=Array.from(S.values()).sort((T,M)=>T.date.localeCompare(M.date));o(A)}C.debug("CALORIE_EVOLUTION_CHART","Data fetched successfully",{count:P?.length})}catch(z){C.error("CALORIE_EVOLUTION_CHART","Failed to fetch calorie data",{error:z})}finally{i(!1)}})()},[t,c]),n)return e.jsx("div",{className:"h-80 rounded-2xl animate-pulse",style:{background:"rgba(255,255,255,0.05)"}});if(s.length===0)return e.jsxs(F,{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #F59E0B 20%, transparent), color-mix(in srgb, #F59E0B 10%, transparent))",border:"1px solid color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(g,{Icon:l.Flame,size:32,style:{color:"#F59E0B"}})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Évolution des Calories"}),e.jsx("p",{className:"text-white/70 text-base max-w-md mx-auto",children:"Aucune donnée de calories disponible pour cette période."})]});const r=s.reduce((D,z)=>D+z.calories,0),p=r/s.length,x=Math.max(...s.map(D=>D.calories)),d=Math.min(...s.map(D=>D.calories)),h=s.slice(0,Math.floor(s.length/2)),m=s.slice(Math.floor(s.length/2)),u=h.reduce((D,z)=>D+z.calories,0)/h.length,b=m.reduce((D,z)=>D+z.calories,0)/m.length,f=b>u?"improving":b<u?"declining":"stable",w=(b-u)/u*100,I=f==="improving"?"#22C55E":f==="declining"?"#EF4444":"#06B6D4",y=f==="improving"?l.TrendingUp:f==="declining"?l.TrendingDown:l.Minus,v=(x-d)*.2,j=Math.max(0,d-v),$=x+v-j;return e.jsx(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:e.jsxs(F,{className:"p-6",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #F59E0B 12%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, #EF4444 8%, transparent) 0%, transparent 50%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, #F59E0B 25%, transparent)",boxShadow:`
            0 12px 40px rgba(0, 0, 0, 0.25),
            0 0 30px color-mix(in srgb, #F59E0B 15%, transparent),
            inset 0 2px 0 rgba(255, 255, 255, 0.15)
          `,backdropFilter:"blur(20px) saturate(160%)"},children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #F59E0B 35%, transparent), color-mix(in srgb, #EF4444 25%, transparent))
                `,border:"2px solid color-mix(in srgb, #F59E0B 50%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(g,{Icon:l.Flame,size:24,style:{color:"#F59E0B"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Évolution des Calories"}),e.jsxs("p",{className:"text-white/80 text-sm",children:[s.length," jours • Tendance ",f==="improving"?"à la hausse":f==="declining"?"à la baisse":"stable"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"px-3 py-1.5 rounded-full mb-2",style:{background:`color-mix(in srgb, ${I} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${I} 25%, transparent)`},children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(g,{Icon:y,size:12,style:{color:I}}),e.jsxs("span",{className:"text-sm font-medium",style:{color:I},children:[f==="improving"?"+":f==="declining"?"":"±",w.toFixed(1),"%"]})]})}),e.jsx("p",{className:"text-2xl font-bold text-white",children:p.toFixed(0)}),e.jsx("p",{className:"text-white/60 text-xs",children:"kcal moy./jour"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"p-3 rounded-xl",style:{background:"color-mix(in srgb, #22C55E 10%, transparent)",border:"1px solid color-mix(in srgb, #22C55E 20%, transparent)"},children:[e.jsx("div",{className:"text-2xl font-bold text-green-400 mb-1",children:x.toFixed(0)}),e.jsx("div",{className:"text-green-300 text-sm font-medium",children:"Maximum"})]}),e.jsxs("div",{className:"p-3 rounded-xl",style:{background:"color-mix(in srgb, #F59E0B 10%, transparent)",border:"1px solid color-mix(in srgb, #F59E0B 20%, transparent)"},children:[e.jsx("div",{className:"text-2xl font-bold text-orange-400 mb-1",children:r.toFixed(0)}),e.jsx("div",{className:"text-orange-300 text-sm font-medium",children:"Total"})]}),e.jsxs("div",{className:"p-3 rounded-xl",style:{background:"color-mix(in srgb, #8B5CF6 10%, transparent)",border:"1px solid color-mix(in srgb, #8B5CF6 20%, transparent)"},children:[e.jsx("div",{className:"text-2xl font-bold text-purple-400 mb-1",children:d.toFixed(0)}),e.jsx("div",{className:"text-purple-300 text-sm font-medium",children:"Minimum"})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white font-semibold mb-3 flex items-center gap-2",children:[e.jsx(g,{Icon:l.BarChart3,size:16,className:"text-orange-400"}),"Calories Brûlées par Jour"]}),e.jsx("div",{className:"relative h-48 bg-white/5 rounded-xl p-4 overflow-hidden",children:e.jsx("div",{className:"relative h-full flex items-end justify-between gap-1",children:s.map((D,z)=>{const P=$>0?(D.calories-j)/$*100:0,E=D.calories===x;return e.jsxs(_.div,{className:"flex-1 group cursor-pointer relative",initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},transition:{duration:.5,delay:z*.02},children:[e.jsx("div",{className:"w-full rounded-t-md transition-all duration-200 group-hover:opacity-100",style:{height:`${Math.max(P,2)}%`,background:E?"linear-gradient(to top, #EF4444, #F59E0B)":"linear-gradient(to top, #F59E0B, #FBBF24)",opacity:E?1:.8,boxShadow:E?"0 0 12px rgba(245, 158, 11, 0.6)":"none"}}),e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-black/90 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-10",children:[e.jsx("div",{className:"font-semibold",children:R(Ze(D.date),"dd MMM",{locale:W})}),e.jsxs("div",{children:[D.calories.toFixed(0)," kcal"]}),e.jsxs("div",{className:"text-white/70",children:[D.activitiesCount," activité",D.activitiesCount>1?"s":""]})]})]},D.date)})})})]}),e.jsx("div",{className:"mt-6 p-4 rounded-xl",style:{background:`color-mix(in srgb, ${I} 6%, transparent)`,border:`1px solid color-mix(in srgb, ${I} 18%, transparent)`,backdropFilter:"blur(8px) saturate(120%)"},children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(g,{Icon:f==="improving"?l.TrendingUp:f==="declining"?l.TrendingDown:l.Info,size:14,style:{color:I},className:"mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",style:{color:I},children:f==="improving"?"Dépense énergétique en hausse":f==="declining"?"Dépense énergétique en baisse":"Dépense énergétique stable"}),e.jsx("p",{className:"text-xs mt-1",style:{color:`${I}CC`},children:f==="improving"?"Excellente progression ! Continuez sur cette lancée.":f==="declining"?"Pensez à intensifier ou augmenter la fréquence de vos entraînements.":"Maintenez votre rythme actuel pour des résultats réguliers."})]})]})})]})})},Ot=({userId:t,period:a})=>{const[s,o]=B.useState([]),[n,i]=B.useState(!0),c=a==="week"?7:a==="month"?30:90,r=[{name:"Lun",number:1,color:"#3B82F6"},{name:"Mar",number:2,color:"#8B5CF6"},{name:"Mer",number:3,color:"#10B981"},{name:"Jeu",number:4,color:"#F59E0B"},{name:"Ven",number:5,color:"#EF4444"},{name:"Sam",number:6,color:"#EC4899"},{name:"Dim",number:0,color:"#06B6D4"}];if(B.useEffect(()=>{(async()=>{try{i(!0);const u=new Date;u.setDate(u.getDate()-c);const{data:b,error:f}=await V.from("activities").select("timestamp, calories_est, duration_min").eq("user_id",t).gte("timestamp",u.toISOString()).order("timestamp",{ascending:!0});if(f)throw f;if(b&&b.length>0){const w=new Map;r.forEach(y=>{w.set(y.number,{day:y.name,dayNumber:y.number,activitiesCount:0,totalCalories:0,totalDuration:0,color:y.color})}),b.forEach(y=>{const N=new Date(y.timestamp).getDay(),v=w.get(N);v.activitiesCount+=1,v.totalCalories+=y.calories_est||0,v.totalDuration+=y.duration_min||0});const I=Array.from(w.values()).sort((y,N)=>y.dayNumber===0?1:N.dayNumber===0?-1:y.dayNumber-N.dayNumber);o(I)}C.debug("WEEKLY_DISTRIBUTION_CHART","Data fetched successfully",{count:b?.length})}catch(u){C.error("WEEKLY_DISTRIBUTION_CHART","Failed to fetch weekly data",{error:u})}finally{i(!1)}})()},[t,c]),n)return e.jsx("div",{className:"h-96 rounded-2xl animate-pulse",style:{background:"rgba(255,255,255,0.05)"}});if(s.length===0)return e.jsxs(F,{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #3B82F6 20%, transparent), color-mix(in srgb, #3B82F6 10%, transparent))",border:"1px solid color-mix(in srgb, #3B82F6 30%, transparent)"},children:e.jsx(g,{Icon:l.Calendar,size:32,style:{color:"#3B82F6"}})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Distribution Hebdomadaire"}),e.jsx("p",{className:"text-white/70 text-base max-w-md mx-auto",children:"Aucune activité disponible pour cette période."})]});const p=Math.max(...s.map(m=>m.activitiesCount)),x=s.reduce((m,u)=>m+u.activitiesCount,0),d=s.reduce((m,u)=>u.activitiesCount>m.activitiesCount?u:m),h=s.reduce((m,u)=>u.activitiesCount>0&&u.activitiesCount<m.activitiesCount?u:m,s[0]);return e.jsx(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:e.jsxs(F,{className:"p-6",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #3B82F6 12%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, #8B5CF6 8%, transparent) 0%, transparent 50%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, #3B82F6 25%, transparent)",boxShadow:`
            0 12px 40px rgba(0, 0, 0, 0.25),
            0 0 30px color-mix(in srgb, #3B82F6 15%, transparent),
            inset 0 2px 0 rgba(255, 255, 255, 0.15)
          `,backdropFilter:"blur(20px) saturate(160%)"},children:[e.jsx("div",{className:"flex items-start justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #3B82F6 35%, transparent), color-mix(in srgb, #8B5CF6 25%, transparent))
                `,border:"2px solid color-mix(in srgb, #3B82F6 50%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #3B82F6 30%, transparent)"},children:e.jsx(g,{Icon:l.Calendar,size:24,style:{color:"#3B82F6"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Distribution Hebdomadaire"}),e.jsxs("p",{className:"text-white/80 text-sm",children:["Répartition de vos ",x," activités par jour de semaine"]})]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[e.jsx(g,{Icon:l.BarChart3,size:16,className:"text-blue-400"}),"Nombre d'Activités par Jour"]}),e.jsx("div",{className:"space-y-3",children:s.map((m,u)=>{const b=p>0?m.activitiesCount/p*100:0,f=m.day===d.day;return e.jsxs(_.div,{className:"relative",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,delay:u*.1},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-16 text-right",children:e.jsx("span",{className:"text-sm font-semibold text-white/80",children:m.day})}),e.jsx("div",{className:"flex-1 relative h-10 rounded-xl overflow-hidden",style:{background:"rgba(255, 255, 255, 0.03)"},children:e.jsx(_.div,{className:"absolute inset-y-0 left-0 rounded-xl flex items-center justify-end pr-3",style:{background:`linear-gradient(to right, ${m.color}40, ${m.color})`,border:`1px solid ${m.color}60`,boxShadow:f?`0 0 16px ${m.color}80`:"none"},initial:{width:0},animate:{width:`${Math.max(b,5)}%`},transition:{duration:.8,delay:.2+u*.1},children:e.jsx("span",{className:"text-white font-bold text-sm",children:m.activitiesCount})})}),e.jsx("div",{className:"w-24 text-left",children:e.jsxs("div",{className:"text-xs text-white/60",children:[m.totalCalories.toFixed(0)," kcal"]})})]}),f&&e.jsx("div",{className:"absolute -right-2 top-1/2 transform -translate-y-1/2",children:e.jsx(_.div,{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{background:`${m.color}40`,border:`2px solid ${m.color}`,boxShadow:`0 0 12px ${m.color}80`},initial:{scale:0},animate:{scale:1},transition:{delay:.8,type:"spring"},children:e.jsx(g,{Icon:l.Zap,size:12,style:{color:m.color}})})})]},m.day)})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 rounded-xl",style:{background:`color-mix(in srgb, ${d.color} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${d.color} 20%, transparent)`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(g,{Icon:l.TrendingUp,size:14,style:{color:d.color}}),e.jsx("span",{className:"text-xs font-medium",style:{color:d.color},children:"Jour le + actif"})]}),e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:d.day}),e.jsxs("div",{className:"text-sm text-white/70",children:[d.activitiesCount," activité",d.activitiesCount>1?"s":""]})]}),e.jsxs("div",{className:"p-4 rounded-xl",style:{background:"color-mix(in srgb, #8B5CF6 10%, transparent)",border:"1px solid color-mix(in srgb, #8B5CF6 20%, transparent)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(g,{Icon:l.BarChart3,size:14,style:{color:"#8B5CF6"}}),e.jsx("span",{className:"text-xs font-medium text-purple-300",children:"Moyenne/jour"})]}),e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:(x/7).toFixed(1)}),e.jsx("div",{className:"text-sm text-white/70",children:"activités"})]})]}),e.jsx("div",{className:"p-4 rounded-xl",style:{background:"color-mix(in srgb, #3B82F6 6%, transparent)",border:"1px solid color-mix(in srgb, #3B82F6 18%, transparent)",backdropFilter:"blur(8px) saturate(120%)"},children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(g,{Icon:l.Info,size:14,style:{color:"#3B82F6"},className:"mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-300",children:"Pattern hebdomadaire identifié"}),e.jsx("p",{className:"text-xs mt-1 text-blue-200",children:d.activitiesCount>x/7*1.5?`Pic d'activité le ${d.day}. Excellente régularité !`:h.activitiesCount===0?`Jour de repos le ${h.day}. Pensez à répartir vos efforts.`:"Distribution équilibrée tout au long de la semaine."})]})]})})]})})},Pt=({userId:t,period:a})=>{const[s,o]=B.useState([]),[n,i]=B.useState(!0),c=a==="week"?7:a==="month"?30:90;if(B.useEffect(()=>{(async()=>{try{i(!0);const A=new Date;A.setDate(A.getDate()-c);const{data:T,error:M}=await V.from("activities").select("timestamp, vo2max_estimated").eq("user_id",t).gte("timestamp",A.toISOString()).not("vo2max_estimated","is",null).order("timestamp",{ascending:!0});if(M)throw M;if(T&&T.length>0){const X=T.map(U=>({date:new Date(U.timestamp).toLocaleDateString("fr-FR",{day:"2-digit",month:"short"}),vo2max:U.vo2max_estimated}));o(X)}C.info("VO2MAX_CHART","Data fetched successfully",{count:T?.length})}catch(A){C.error("VO2MAX_CHART","Failed to fetch VO2max data",{error:A})}finally{i(!1)}})()},[t,c]),n)return e.jsx("div",{className:"h-80 rounded-2xl animate-pulse",style:{background:"rgba(255,255,255,0.05)"}});if(s.length===0)return e.jsxs(F,{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #10B981 20%, transparent), color-mix(in srgb, #10B981 10%, transparent))",border:"1px solid color-mix(in srgb, #10B981 30%, transparent)"},children:e.jsx(g,{Icon:l.TrendingUp,size:32,style:{color:"#10B981"}})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Évolution VO2max"}),e.jsx("p",{className:"text-white/70 text-base max-w-md mx-auto",children:"Aucune donnée VO2max disponible pour cette période. Utilisez un objet connecté pour mesurer votre VO2max."})]});const r=Math.min(...s.map(S=>S.vo2max)),p=Math.max(...s.map(S=>S.vo2max)),x=s.reduce((S,A)=>S+A.vo2max,0)/s.length,d=s[s.length-1].vo2max,h=s[0].vo2max,m=d-h,u=m/h*100,f=(p-r)*.2,w=r-f,y=p+f-w,N=800,v=400,j={top:20,right:20,bottom:40,left:60},k=N-j.left-j.right,$=v-j.top-j.bottom,D=k/(s.length-1||1),z=s.map((S,A)=>{const T=j.left+A*D,M=j.top+$-(S.vo2max-w)/y*$;return`${T},${M}`}).join(" "),P=`M ${z.split(" ").join(" L ")}`,E="vo2max-gradient";return e.jsxs(F,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:"linear-gradient(135deg, color-mix(in srgb, #3B82F6 25%, transparent), color-mix(in srgb, #3B82F6 15%, transparent))",border:"1px solid color-mix(in srgb, #3B82F6 35%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #3B82F6 20%, transparent)"},children:e.jsx(g,{Icon:l.Activity,size:24,style:{color:"#10B981"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Évolution VO2max"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Capacité cardiovasculaire maximale"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-white/50 text-xs mb-1",children:"Actuel"}),e.jsx("p",{className:"text-3xl font-bold text-white",children:d.toFixed(1)}),e.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-semibold mt-1",style:{background:m>=0?"color-mix(in srgb, #22C55E 15%, transparent)":"color-mix(in srgb, #EF4444 15%, transparent)",border:m>=0?"1px solid color-mix(in srgb, #22C55E 25%, transparent)":"1px solid color-mix(in srgb, #EF4444 25%, transparent)",color:m>=0?"#22C55E":"#EF4444"},children:[e.jsx(g,{Icon:m>=0?l.TrendingUp:l.TrendingDown,size:10}),m>=0?"+":"",u.toFixed(1),"%"]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"p-3 rounded-lg",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsx("p",{className:"text-white/50 text-xs mb-1",children:"Minimum"}),e.jsx("p",{className:"text-white font-bold text-lg",children:r.toFixed(1)})]}),e.jsxs("div",{className:"p-3 rounded-lg",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsx("p",{className:"text-white/50 text-xs mb-1",children:"Moyenne"}),e.jsx("p",{className:"text-white font-bold text-lg",children:x.toFixed(1)})]}),e.jsxs("div",{className:"p-3 rounded-lg",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsx("p",{className:"text-white/50 text-xs mb-1",children:"Maximum"}),e.jsx("p",{className:"text-white font-bold text-lg",children:p.toFixed(1)})]})]}),e.jsx("div",{className:"relative",style:{width:"100%",height:"300px"},children:e.jsxs("svg",{viewBox:`0 0 ${N} ${v}`,style:{width:"100%",height:"100%"},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:E,x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",style:{stopColor:"#3B82F6",stopOpacity:.4}}),e.jsx("stop",{offset:"100%",style:{stopColor:"#3B82F6",stopOpacity:.05}})]})}),e.jsx("path",{d:`${P} L ${j.left+k},${j.top+$} L ${j.left},${j.top+$} Z`,fill:`url(#${E})`}),e.jsx("polyline",{points:z,fill:"none",stroke:"#3B82F6",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),s.map((S,A)=>{const T=j.left+A*D,M=j.top+$-(S.vo2max-w)/y*$;return e.jsxs("g",{children:[e.jsx("circle",{cx:T,cy:M,r:"5",fill:"#3B82F6",stroke:"rgba(255,255,255,0.3)",strokeWidth:"2"}),e.jsx("text",{x:T,y:j.top+$+25,textAnchor:"middle",fill:"rgba(255,255,255,0.5)",fontSize:"12",children:S.date})]},A)}),[0,.25,.5,.75,1].map(S=>{const A=j.top+$*(1-S),T=w+y*S;return e.jsxs("g",{children:[e.jsx("line",{x1:j.left,y1:A,x2:j.left+k,y2:A,stroke:"rgba(255,255,255,0.1)",strokeWidth:"1",strokeDasharray:"4,4"}),e.jsx("text",{x:j.left-10,y:A+4,textAnchor:"end",fill:"rgba(255,255,255,0.5)",fontSize:"12",children:T.toFixed(0)})]},S)})]})}),e.jsxs("div",{className:"mt-6 p-4 rounded-xl",style:{background:"rgba(59, 130, 246, 0.08)",border:"1px solid rgba(59, 130, 246, 0.2)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(g,{Icon:l.Info,size:14,style:{color:"#3B82F6"}}),e.jsx("span",{className:"text-blue-300 font-semibold text-sm",children:"Interprétation"})]}),e.jsx("p",{className:"text-blue-200 text-sm leading-relaxed",children:d>=50?"Excellente capacité aérobie ! Maintenez ce niveau avec des entraînements variés.":d>=40?"Bonne capacité cardiovasculaire. Continuez à progresser avec des séances d'endurance.":"Marge de progression importante. Augmentez progressivement votre volume d'entraînement cardio."})]})]})},qt=({userId:t,period:a})=>{const[s,o]=B.useState([]),[n,i]=B.useState(!0),c=a==="week"?7:a==="month"?30:90;if(B.useEffect(()=>{(async()=>{try{i(!0);const m=new Date;m.setDate(m.getDate()-c);const{data:u,error:b}=await V.from("activities").select("timestamp, hr_zone1_minutes, hr_zone2_minutes, hr_zone3_minutes, hr_zone4_minutes, hr_zone5_minutes").eq("user_id",t).gte("timestamp",m.toISOString()).not("hr_zone1_minutes","is",null).order("timestamp",{ascending:!0});if(b)throw b;if(u&&u.length>0){const f=new Map;u.forEach(I=>{const y=new Date(I.timestamp).toLocaleDateString("fr-FR",{day:"2-digit",month:"short"});f.has(y)||f.set(y,{date:y,z1:0,z2:0,z3:0,z4:0,z5:0});const N=f.get(y);N.z1+=I.hr_zone1_minutes||0,N.z2+=I.hr_zone2_minutes||0,N.z3+=I.hr_zone3_minutes||0,N.z4+=I.hr_zone4_minutes||0,N.z5+=I.hr_zone5_minutes||0});const w=Array.from(f.values());o(w)}C.info("HR_ZONES_HEATMAP","Data fetched successfully",{count:u?.length})}catch(m){C.error("HR_ZONES_HEATMAP","Failed to fetch HR zones data",{error:m})}finally{i(!1)}})()},[t,c]),n)return e.jsx("div",{className:"h-96 rounded-2xl animate-pulse",style:{background:"rgba(255,255,255,0.05)"}});if(s.length===0)return e.jsxs(F,{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #10B981 20%, transparent), color-mix(in srgb, #10B981 10%, transparent))",border:"1px solid color-mix(in srgb, #10B981 30%, transparent)"},children:e.jsx(g,{Icon:l.Heart,size:32,style:{color:"#10B981"}})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Heatmap Zones FC"}),e.jsx("p",{className:"text-white/70 text-base max-w-md mx-auto",children:"Aucune donnée de zones de fréquence cardiaque disponible. Utilisez un objet connecté pour suivre vos zones FC."})]});const r=[{key:"z1",label:"Z1 Récupération",color:"#22C55E",lightColor:"#86EFAC"},{key:"z2",label:"Z2 Endurance",color:"#3B82F6",lightColor:"#93C5FD"},{key:"z3",label:"Z3 Tempo",color:"#F59E0B",lightColor:"#FCD34D"},{key:"z4",label:"Z4 Seuil",color:"#F97316",lightColor:"#FDBA74"},{key:"z5",label:"Z5 Max",color:"#EF4444",lightColor:"#FCA5A5"}],p=Math.max(...s.flatMap(h=>[h.z1,h.z2,h.z3,h.z4,h.z5])),x=s.reduce((h,m)=>h+m.z1+m.z2+m.z3+m.z4+m.z5,0),d={z1:s.reduce((h,m)=>h+m.z1,0)/x*100,z2:s.reduce((h,m)=>h+m.z2,0)/x*100,z3:s.reduce((h,m)=>h+m.z3,0)/x*100,z4:s.reduce((h,m)=>h+m.z4,0)/x*100,z5:s.reduce((h,m)=>h+m.z5,0)/x*100};return e.jsxs(F,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:"linear-gradient(135deg, color-mix(in srgb, #EF4444 25%, transparent), color-mix(in srgb, #EF4444 15%, transparent))",border:"1px solid color-mix(in srgb, #EF4444 35%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #EF4444 20%, transparent)"},children:e.jsx(g,{Icon:l.Heart,size:24,style:{color:"#10B981"}})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Heatmap Zones FC"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Distribution du temps par zone de fréquence cardiaque"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-white/70 text-sm font-medium",children:"Distribution globale"}),e.jsxs("span",{className:"text-white/50 text-xs",children:[x.toFixed(0)," min total"]})]}),e.jsx("div",{className:"flex gap-1 h-3 rounded-full overflow-hidden",children:r.map(h=>{const m=d[h.key];return m===0?null:e.jsx("div",{style:{width:`${m}%`,background:h.color},title:`${h.label}: ${m.toFixed(1)}%`},h.key)})})]}),e.jsx("div",{className:"grid grid-cols-5 gap-3 mb-6",children:r.map(h=>{const m=d[h.key];return e.jsxs("div",{className:"p-3 rounded-lg",style:{background:`color-mix(in srgb, ${h.color} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${h.color} 20%, transparent)`},children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:h.color}}),e.jsx("span",{className:"text-xs font-semibold",style:{color:h.lightColor},children:h.label})]}),e.jsxs("p",{className:"text-lg font-bold text-white",children:[m.toFixed(0),"%"]})]},h.key)})}),e.jsx("div",{className:"rounded-xl p-4 overflow-x-auto",style:{background:"rgba(255,255,255,0.03)"},children:e.jsxs("div",{className:"min-w-max",children:[e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("div",{className:"w-20 flex-shrink-0"}),r.map(h=>e.jsx("div",{className:"w-16 text-center",children:e.jsx("span",{className:"text-xs font-semibold",style:{color:h.lightColor},children:h.key.toUpperCase()})},h.key))]}),s.slice(-14).map((h,m)=>e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("div",{className:"w-20 flex-shrink-0 flex items-center",children:e.jsx("span",{className:"text-xs text-white/50",children:h.date})}),r.map(u=>{const b=h[u.key],f=b/p,w=Math.max(.1,f);return e.jsx("div",{className:"w-16 h-10 rounded flex items-center justify-center transition-all duration-200 hover:scale-105",style:{background:`color-mix(in srgb, ${u.color} ${w*100}%, transparent)`,border:b>0?`1px solid color-mix(in srgb, ${u.color} 30%, transparent)`:"1px solid rgba(255,255,255,0.05)"},title:`${h.date} - ${u.label}: ${b}min`,children:b>0&&e.jsx("span",{className:"text-xs font-semibold text-white",children:b.toFixed(0)})},u.key)})]},m))]})}),e.jsxs("div",{className:"mt-6 p-4 rounded-xl",style:{background:"rgba(239, 68, 68, 0.08)",border:"1px solid rgba(239, 68, 68, 0.2)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(g,{Icon:l.Info,size:14,style:{color:"#EF4444"}}),e.jsx("span",{className:"text-red-300 font-semibold text-sm",children:"Analyse"})]}),e.jsx("p",{className:"text-red-200 text-sm leading-relaxed",children:d.z1+d.z2>60?"Excellent équilibre ! Vous passez la majorité du temps en zones d'endurance fondamentale.":d.z4+d.z5>30?"Attention : beaucoup de temps en zones intenses. Assurez-vous de suffisamment récupérer.":"Distribution équilibrée. Variez vos séances pour optimiser les adaptations cardiovasculaires."})]})]})},Vt=({userId:t,period:a})=>{const[s,o]=B.useState([]),[n,i]=B.useState(!0),c=a==="week"?7:a==="month"?30:90;if(B.useEffect(()=>{(async()=>{try{i(!0);const S=new Date;S.setDate(S.getDate()-c);const{data:A,error:T}=await V.from("activities").select("timestamp, training_load_score").eq("user_id",t).gte("timestamp",S.toISOString()).not("training_load_score","is",null).order("timestamp",{ascending:!0});if(T)throw T;if(A&&A.length>0){let U=0,J=0;const xe=[];A.forEach(me=>{const ue=me.training_load_score||0;U=U+(ue-U)/42,J=J+(ue-J)/7;const Te=U-J;xe.push({date:new Date(me.timestamp).toLocaleDateString("fr-FR",{day:"2-digit",month:"short"}),fitness:U,fatigue:J,form:Te})}),o(xe)}C.info("FITNESS_FATIGUE_CHART","Data computed successfully",{count:A?.length})}catch(S){C.error("FITNESS_FATIGUE_CHART","Failed to compute fitness/fatigue",{error:S})}finally{i(!1)}})()},[t,c]),n)return e.jsx("div",{className:"h-96 rounded-2xl animate-pulse",style:{background:"rgba(255,255,255,0.05)"}});if(s.length===0)return e.jsxs(F,{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #10B981 20%, transparent), color-mix(in srgb, #10B981 10%, transparent))",border:"1px solid color-mix(in srgb, #10B981 30%, transparent)"},children:e.jsx(g,{Icon:l.TrendingUp,size:32,style:{color:"#10B981"}})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Fitness / Fatigue"}),e.jsx("p",{className:"text-white/70 text-base max-w-md mx-auto",children:"Aucune donnée de charge d'entraînement disponible. Utilisez un objet connecté pour calculer automatiquement votre TRIMP."})]});const r=s[s.length-1],p=r.form;let x;p>10?x={label:"Forme Optimale",color:"#22C55E",advice:"Condition idéale pour une performance maximale. C'est le moment d'un objectif ambitieux !"}:p>0?x={label:"Forme Fraîche",color:"#3B82F6",advice:"Bonne forme générale. Maintenez l'équilibre entre entraînement et récupération."}:p>-10?x={label:"Forme Neutre",color:"#F59E0B",advice:"Équilibre précaire. Ajustez la charge selon vos sensations."}:p>-20?x={label:"Fatigue Modérée",color:"#F97316",advice:"Phase de fatigue accumulée. Privilégiez la récupération et réduisez l'intensité."}:x={label:"Fatigue Élevée",color:"#EF4444",advice:"Attention au surentraînement ! Repos obligatoire. Consultez un professionnel si persistant."};const d=Math.min(...s.flatMap(E=>[E.fitness,E.fatigue,E.form])),h=Math.max(...s.flatMap(E=>[E.fitness,E.fatigue,E.form])),u=(h-d)*.2,b=d-u,w=h+u-b,I=800,y=400,N={top:20,right:20,bottom:40,left:60},v=I-N.left-N.right,j=y-N.top-N.bottom,k=v/(s.length-1||1),$=E=>E.map((S,A)=>{const T=N.left+A*k,M=N.top+j-(S-b)/w*j;return A===0?`M ${T},${M}`:`L ${T},${M}`}).join(" "),D=$(s.map(E=>E.fitness)),z=$(s.map(E=>E.fatigue)),P=$(s.map(E=>E.form));return e.jsxs(F,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`linear-gradient(135deg, color-mix(in srgb, ${x.color} 25%, transparent), color-mix(in srgb, ${x.color} 15%, transparent))`,border:`1px solid color-mix(in srgb, ${x.color} 35%, transparent)`,boxShadow:`0 0 20px color-mix(in srgb, ${x.color} 20%, transparent)`},children:e.jsx(g,{Icon:l.TrendingUp,size:24,style:{color:x.color}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Courbe Fitness / Fatigue"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Modèle de charge d'entraînement (CTL/ATL/TSB)"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"px-3 py-1 rounded-full text-xs font-semibold mb-2",style:{background:`color-mix(in srgb, ${x.color} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${x.color} 25%, transparent)`,color:x.color},children:x.label}),e.jsx("p",{className:"text-2xl font-bold text-white",children:p.toFixed(1)})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"p-3 rounded-lg",style:{background:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.2)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:"#3B82F6"}}),e.jsx("p",{className:"text-blue-300 text-xs font-medium",children:"Fitness (CTL)"})]}),e.jsx("p",{className:"text-white font-bold text-lg",children:r.fitness.toFixed(1)})]}),e.jsxs("div",{className:"p-3 rounded-lg",style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.2)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:"#EF4444"}}),e.jsx("p",{className:"text-red-300 text-xs font-medium",children:"Fatigue (ATL)"})]}),e.jsx("p",{className:"text-white font-bold text-lg",children:r.fatigue.toFixed(1)})]}),e.jsxs("div",{className:"p-3 rounded-lg",style:{background:`color-mix(in srgb, ${x.color} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${x.color} 20%, transparent)`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:x.color}}),e.jsx("p",{className:"text-xs font-medium",style:{color:x.color},children:"Forme (TSB)"})]}),e.jsx("p",{className:"text-white font-bold text-lg",children:r.form.toFixed(1)})]})]}),e.jsx("div",{className:"relative",style:{width:"100%",height:"300px"},children:e.jsxs("svg",{viewBox:`0 0 ${I} ${y}`,style:{width:"100%",height:"100%"},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"fitness-gradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",style:{stopColor:"#3B82F6",stopOpacity:.2}}),e.jsx("stop",{offset:"100%",style:{stopColor:"#3B82F6",stopOpacity:.02}})]}),e.jsxs("linearGradient",{id:"fatigue-gradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",style:{stopColor:"#EF4444",stopOpacity:.2}}),e.jsx("stop",{offset:"100%",style:{stopColor:"#EF4444",stopOpacity:.02}})]})]}),[0,.25,.5,.75,1].map(E=>{const S=N.top+j*(1-E),A=b+w*E;return e.jsxs("g",{children:[e.jsx("line",{x1:N.left,y1:S,x2:N.left+v,y2:S,stroke:"rgba(255,255,255,0.1)",strokeWidth:"1",strokeDasharray:"4,4"}),e.jsx("text",{x:N.left-10,y:S+4,textAnchor:"end",fill:"rgba(255,255,255,0.5)",fontSize:"12",children:A.toFixed(0)})]},E)}),e.jsx("path",{d:D,fill:"none",stroke:"#3B82F6",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:z,fill:"none",stroke:"#EF4444",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:P,fill:"none",stroke:x.color,strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"6,4"}),s.filter((E,S)=>S%Math.max(1,Math.floor(s.length/8))===0).map((E,S)=>{const A=S*Math.max(1,Math.floor(s.length/8)),T=N.left+A*k;return e.jsx("text",{x:T,y:N.top+j+25,textAnchor:"middle",fill:"rgba(255,255,255,0.5)",fontSize:"12",children:E.date},A)})]})}),e.jsxs("div",{className:"mt-6 p-4 rounded-xl",style:{background:`color-mix(in srgb, ${x.color} 8%, transparent)`,border:`1px solid color-mix(in srgb, ${x.color} 20%, transparent)`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(g,{Icon:l.Lightbulb,size:14,style:{color:x.color}}),e.jsx("span",{className:"font-semibold text-sm",style:{color:x.color},children:"Conseil"})]}),e.jsx("p",{className:"text-sm leading-relaxed",style:{color:x.color},children:x.advice})]})]})},Rt=()=>{const t=se(),{profile:a}=L(),[s,o]=B.useState([]),[n,i]=B.useState(!0),[c,r]=B.useState(!1);B.useEffect(()=>{(async()=>{if(a?.id)try{i(!0);const b=[];o(b),C.info("CONNECTED_GOALS","Goals progress fetched",{count:b.length})}catch(b){C.error("CONNECTED_GOALS","Failed to fetch goals progress",{error:b})}finally{i(!1)}})()},[a?.id]);const p=async()=>{if(a?.id)try{r(!0),o([]),C.info("CONNECTED_GOALS","All goals recalculated successfully")}catch(u){C.error("CONNECTED_GOALS","Failed to recalculate goals",{error:u})}finally{r(!1)}};if(n)return e.jsx("div",{className:"space-y-4",children:[1,2].map(u=>e.jsx("div",{className:"h-32 rounded-2xl animate-pulse",style:{background:"rgba(255,255,255,0.05)"}},u))});if(s.length===0)return e.jsxs(F,{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #10B981 20%, transparent), color-mix(in srgb, #10B981 10%, transparent))",border:"1px solid color-mix(in srgb, #10B981 30%, transparent)"},children:e.jsx(g,{Icon:l.Target,size:32,style:{color:"#10B981"}})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Objectifs Connectés"}),e.jsx("p",{className:"text-white/70 text-base max-w-md mx-auto leading-relaxed mb-6",children:"Créez des objectifs et ils se synchroniseront automatiquement avec vos activités et métriques biométriques pour suivre votre progression en temps réel."}),e.jsx("button",{onClick:()=>{C.info("CONNECTED_GOALS","User clicked Connect Device button",{from:"activity_progression_tab",destination:"/settings?tab=appareils",timestamp:new Date().toISOString()}),t("/settings?tab=appareils")},className:"px-6 py-3 rounded-xl font-semibold text-white transition-all hover:scale-105 active:scale-95",style:{background:"linear-gradient(135deg, #22C55E, #16A34A)",boxShadow:"0 4px 12px rgba(34, 197, 94, 0.3)"},children:"Connecter un Objet"})]});const x=u=>{switch(u){case"volume":return l.Clock;case"distance":return l.MapPin;case"endurance":return l.Activity;case"strength":return l.Zap;case"frequency":return l.Calendar;case"vo2max":return l.Heart;default:return l.Target}},d=(u,b)=>u>=100?{primary:"#22C55E",secondary:"#10B981"}:b?{primary:"#3B82F6",secondary:"#2563EB"}:{primary:"#F59E0B",secondary:"#D97706"},h=(u,b)=>{if(b==="km"||b==="kilometers")return`${u.toFixed(1)} km`;if(b==="minutes"||b==="min"){const f=Math.floor(u/60),w=Math.round(u%60);return f>0?`${f}h ${w}min`:`${w}min`}return b==="sessions"?`${Math.round(u)} séances`:b==="vo2max"?`${u.toFixed(1)} ml/kg/min`:`${u.toFixed(1)} ${b}`},m=u=>{if(!u)return"";const b=new Date(u),f=new Date,w=Math.ceil((b.getTime()-f.getTime())/(1e3*60*60*24));return w<0?"Échéance dépassée":w===0?"Aujourd'hui":w===1?"Demain":w<=7?`${w} jours`:b.toLocaleDateString("fr-FR",{day:"numeric",month:"short"})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #8B5CF6 25%, transparent), color-mix(in srgb, #8B5CF6 15%, transparent))",border:"1px solid color-mix(in srgb, #8B5CF6 35%, transparent)"},children:e.jsx(g,{Icon:l.Target,size:20,style:{color:"#10B981"}})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Objectifs Connectés"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Synchronisés avec vos activités"})]})]}),e.jsxs("button",{onClick:p,disabled:c,className:"px-4 py-2 rounded-lg font-medium text-white/80 hover:text-white transition-all flex items-center gap-2",style:{background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsx(g,{Icon:l.RefreshCw,size:16,className:c?"animate-spin":""}),c?"Synchronisation...":"Recalculer"]})]}),e.jsx("div",{className:"space-y-4",children:s.map(u=>{const b=u.goal,f=d(u.progress_percentage,u.on_track),w=x(b.goal_type);return e.jsxs(F,{className:"p-6",style:{background:u.progress_percentage>=100?"radial-gradient(circle at 30% 20%, color-mix(in srgb, #22C55E 12%, transparent) 0%, transparent 60%), var(--glass-opacity)":void 0},children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`linear-gradient(135deg, color-mix(in srgb, ${f.primary} 25%, transparent), color-mix(in srgb, ${f.secondary} 15%, transparent))`,border:`1px solid color-mix(in srgb, ${f.primary} 35%, transparent)`,boxShadow:`0 0 20px color-mix(in srgb, ${f.primary} 20%, transparent)`},children:e.jsx(g,{Icon:w,size:24,style:{color:f.primary}})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:b.title}),u.progress_percentage>=100&&e.jsx("div",{className:"px-2 py-0.5 rounded-full text-xs font-semibold",style:{background:"color-mix(in srgb, #22C55E 15%, transparent)",border:"1px solid color-mix(in srgb, #22C55E 25%, transparent)",color:"#22C55E"},children:"Complété"}),!u.on_track&&u.progress_percentage<100&&e.jsx("div",{className:"px-2 py-0.5 rounded-full text-xs font-semibold",style:{background:"color-mix(in srgb, #F59E0B 15%, transparent)",border:"1px solid color-mix(in srgb, #F59E0B 25%, transparent)",color:"#F59E0B"},children:"Retard"})]}),b.discipline&&e.jsx("p",{className:"text-white/50 text-sm",children:b.discipline}),b.deadline&&e.jsxs("p",{className:"text-white/50 text-xs mt-1",children:["Échéance: ",m(b.deadline)]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-3xl font-bold text-white",children:[u.progress_percentage.toFixed(0),"%"]}),e.jsx("p",{className:"text-white/50 text-xs",children:"progression"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"relative h-3 rounded-full overflow-hidden",style:{background:"rgba(255,255,255,0.1)"},children:e.jsx("div",{className:"absolute inset-y-0 left-0 rounded-full transition-all duration-500",style:{width:`${Math.min(u.progress_percentage,100)}%`,background:`linear-gradient(90deg, ${f.primary}, ${f.secondary})`,boxShadow:`0 0 12px ${f.primary}`}})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 rounded-lg",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsx("p",{className:"text-white/50 text-xs mb-1",children:"Actuel"}),e.jsx("p",{className:"text-white font-semibold",children:h(b.current_value,b.unit)})]}),e.jsxs("div",{className:"p-3 rounded-lg",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsx("p",{className:"text-white/50 text-xs mb-1",children:"Objectif"}),e.jsx("p",{className:"text-white font-semibold",children:h(b.target_value,b.unit)})]})]}),u.remaining>0&&e.jsxs("div",{className:"p-3 rounded-lg",style:{background:"rgba(255,255,255,0.03)"},children:[e.jsxs("p",{className:"text-white/70 text-sm",children:["Encore ",h(u.remaining,b.unit)," pour atteindre l'objectif"]}),u.estimated_completion_date&&e.jsxs("p",{className:"text-white/50 text-xs mt-1",children:["Estimation: ",new Date(u.estimated_completion_date).toLocaleDateString("fr-FR",{day:"numeric",month:"long"})]})]})]})]},b.id)})})]})},ce={week:"last7Days",month:"last30Days",quarter:"last3Months"};function Ne(t,a){C.debug("ACTIVITY_PROGRESS_TAB_DIAGNOSTIC","Calculating default period",{hasActivityHistory:t,currentActivities:a,weekThreshold:H("last7Days"),monthThreshold:H("last30Days"),quarterThreshold:H("last3Months"),calculationTime:new Date().toISOString(),timestamp:new Date().toISOString()});const s=H("last7Days");C.debug("ACTIVITY_PROGRESS_TAB_DIAGNOSTIC","Threshold checks",{currentActivities:a,weekThreshold:s,weekAvailable:a>=s,timestamp:new Date().toISOString()});let o="week";return!t||a<s?(o="week",C.debug("ACTIVITY_PROGRESS_TAB_DIAGNOSTIC","Default period: week (insufficient data or no history)",{hasActivityHistory:t,currentActivities:a,weekThreshold:s,timestamp:new Date().toISOString()})):(o="week",C.debug("ACTIVITY_PROGRESS_TAB_DIAGNOSTIC","Default period: week (prioritized to avoid auto API calls)",{currentActivities:a,weekThreshold:s,reasoning:"always_prioritize_week_to_avoid_costly_auto_calls",timestamp:new Date().toISOString()})),C.debug("ACTIVITY_PROGRESS_TAB_DIAGNOSTIC","Default period calculated",{defaultPeriod:o,reasoning:"always_week_to_prevent_auto_expensive_calls",finalDecision:o,calculationComplete:!0,costOptimization:"prevents_automatic_30day_90day_api_calls",timestamp:new Date().toISOString()}),o}function Lt(t,a){const s=ce[t],o=H(s);return a>=o}const Ht=()=>{const{profile:t}=L(),{showToast:a}=ee(),{click:s}=Y(),{showModal:o}=Ce(),{data:n=!1}=Ee(),[i,c]=B.useState(0),r=te(v=>v.selectedPeriod),p=te(v=>v.setSelectedPeriod),[x,d]=B.useState(!1),h=ce[r],{data:m,isLoading:u,error:b}=Se(h),f=_e(({currentLocation:v,nextLocation:j})=>{const k=u&&v.pathname!==j.pathname;return k&&(C.debug("ACTIVITY_PROGRESS_TAB","Navigation blocked during analysis loading",{currentPath:v.pathname,nextPath:j.pathname,isLoading:u,timestamp:new Date().toISOString()}),o({title:"Attention ! Analyse de progression en cours",message:"Voulez-vous vraiment quitter l'analyse de progression ? Les données d'analyse pourraient être perdues et devront être régénérées.",processName:"Analyse de Progression",onConfirm:()=>{C.info("ACTIVITY_PROGRESS_TAB","User confirmed exit during analysis",{currentPath:v.pathname,nextPath:j.pathname,timestamp:new Date().toISOString()}),f.proceed?.()},onCancel:()=>{C.info("ACTIVITY_PROGRESS_TAB","User cancelled exit during analysis",{currentPath:v.pathname,nextPath:j.pathname,timestamp:new Date().toISOString()}),f.reset?.()}})),k}),w=m?.fallback,I=m?.cached;B.useEffect(()=>{if(m?.current_activities!==void 0)if(C.debug("ACTIVITY_PROGRESS_TAB","Activities count updated from insights data",{previousCount:i,newCount:m.current_activities,selectedPeriod:r,userHasSelectedPeriod:x,cacheStatus:m.cached?"cached":"fresh",willRespectUserChoice:x,timestamp:new Date().toISOString()}),c(m.current_activities),x){const v=Lt(r,m.current_activities);if(C.debug("ACTIVITY_PROGRESS_TAB","Checking user-selected period validity",{selectedPeriod:r,activitiesCount:m.current_activities,isCurrentPeriodValid:v,userHasSelectedPeriod:x,willRespectUserChoice:!0,timestamp:new Date().toISOString()}),!v){const j=Ne(n,m.current_activities);C.warn("ACTIVITY_PROGRESS_TAB","User-selected period no longer valid, falling back",{invalidPeriod:r,fallbackPeriod:j,activitiesCount:m.current_activities,reason:"user_selected_period_became_invalid",timestamp:new Date().toISOString()}),p(j),d(!1),a({type:"info",title:"Période ajustée",message:`Période changée vers ${j==="week"?"7 jours":j==="month"?"30 jours":"90 jours"} (données insuffisantes pour la période précédente)`,duration:4e3})}}else{const v=Ne(n,m.current_activities);C.debug("ACTIVITY_PROGRESS_TAB","Auto-calculating period (no user selection)",{currentSelectedPeriod:r,newDefaultPeriod:v,activitiesCount:m.current_activities,willAutoSwitch:v!==r&&!x,timestamp:new Date().toISOString()}),v!==r&&!x&&(C.debug("ACTIVITY_PROGRESS_TAB","Auto-switching to calculated period",{from:r,to:v,reason:"automatic_calculation_respecting_no_user_selection",timestamp:new Date().toISOString()}),p(v))}},[m?.current_activities,x,r,n]),B.useEffect(()=>{b&&(C.error("ACTIVITY_PROGRESS_TAB","Erreur lors de la génération des insights",{error:b instanceof Error?b.message:"Unknown error",selectedPeriod:r,timestamp:new Date().toISOString()}),a({type:"error",title:"Erreur d'analyse",message:"Impossible de générer les insights. Veuillez réessayer.",duration:4e3}))},[b,r,a]);const y=v=>{s(),d(!0),p(v),C.debug("ACTIVITY_PROGRESS_TAB_DIAGNOSTIC","Period changed by user",{newPeriod:v,apiPeriod:ce[v],userAction:!0,manualSelection:!0,userHasSelectedPeriod:!0,timestamp:new Date().toISOString()})},N={week:H("last7Days"),month:H("last30Days"),quarter:H("last3Months")};return n?m?.insufficient_data?e.jsxs("div",{className:"space-y-6",children:[e.jsx(Z,{selectedPeriod:r,onPeriodChange:y,currentActivities:i,periodThresholds:N,accentColor:"#10B981"}),e.jsxs(F,{className:"p-8 text-center",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #F59E0B 15%, transparent) 0%, transparent 60%),
              radial-gradient(circle at 70% 80%, color-mix(in srgb, #EF4444 12%, transparent) 0%, transparent 50%),
              linear-gradient(145deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, #F59E0B 30%, transparent)",boxShadow:`
              0 12px 40px rgba(0, 0, 0, 0.25),
              0 0 30px color-mix(in srgb, #F59E0B 20%, transparent),
              inset 0 2px 0 rgba(255, 255, 255, 0.15)
            `},children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6",children:[e.jsx("div",{className:"w-20 h-20 rounded-full flex items-center justify-center breathing-icon",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #F59E0B 30%, transparent), color-mix(in srgb, #F59E0B 20%, transparent))
                `,border:"2px solid color-mix(in srgb, #F59E0B 40%, transparent)",boxShadow:"0 0 30px color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(g,{Icon:l.AlertCircle,size:40,style:{color:"#F59E0B"}})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-2xl font-bold text-white",children:"Forge en Construction"}),e.jsx("p",{className:"text-white/70 text-base",children:"Plus d'activités nécessaires"})]})]}),e.jsxs("div",{className:"space-y-4 max-w-lg mx-auto",children:[e.jsxs("p",{className:"text-white/80 text-lg leading-relaxed",children:["Vous avez ",e.jsx("strong",{className:"text-orange-300",children:m.current_activities})," activité",m.current_activities>1?"s":""," enregistrée",m.current_activities>1?"s":"","."]}),e.jsxs("p",{className:"text-white/70 text-base leading-relaxed",children:["Il vous faut au moins ",e.jsx("strong",{className:"text-orange-300",children:m.required_activities})," activités pour générer des insights personnalisés sur cette période."]}),e.jsxs("div",{className:"mt-6 p-4 rounded-xl",style:{background:"color-mix(in srgb, #3B82F6 8%, transparent)",border:"1px solid color-mix(in srgb, #3B82F6 20%, transparent)"},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(g,{Icon:l.Zap,size:16,style:{color:"#3B82F6"}}),e.jsx("span",{className:"text-blue-300 font-semibold text-sm",children:"Passez à l'action !"})]}),e.jsxs("p",{className:"text-blue-200 text-sm leading-relaxed",children:["Enregistrez ",m.required_activities-m.current_activities," activité",m.required_activities-m.current_activities>1?"s":""," supplémentaire",m.required_activities-m.current_activities>1?"s":"","pour débloquer vos insights personnalisés et découvrir des recommandations sur mesure."]})]})]})]})]}):w&&m?e.jsxs("div",{className:"space-y-6",children:[e.jsx(Z,{selectedPeriod:r,onPeriodChange:y,currentActivities:i,periodThresholds:N,accentColor:"#10B981"}),e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"text-amber-800 text-sm",children:"⚠️ Analyse détaillée temporairement indisponible. Voici les visualisations de base."})}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(fe,{data:m?.distribution,period:r,apiPeriod:h}),e.jsx(je,{activities:m?.activities||[],period:r,apiPeriod:h})]})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(Z,{selectedPeriod:r,onPeriodChange:y,currentActivities:i,periodThresholds:N,accentColor:"#10B981"}),I&&e.jsx(F,{className:"p-4",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #22C55E 8%, transparent) 0%, transparent 60%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, #22C55E 25%, transparent)",boxShadow:"0 0 16px color-mix(in srgb, #22C55E 15%, transparent)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"color-mix(in srgb, #22C55E 15%, transparent)",border:"1px solid color-mix(in srgb, #22C55E 25%, transparent)"},children:e.jsx(g,{Icon:l.Check,size:14,style:{color:"#22C55E"}})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-green-300 font-medium text-sm",children:"Données mises en cache"}),e.jsxs("p",{className:"text-green-200 text-xs mt-0.5",children:["Dernière analyse: ",m.cache_age_hours,"h • Économie de coûts IA"]})]})]})}),u?e.jsx(De,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(F,{className:"p-6",style:{background:`
                radial-gradient(circle at 30% 20%, color-mix(in srgb, #10B981 8%, transparent) 0%, transparent 60%),
                var(--glass-opacity)
              `,borderColor:"color-mix(in srgb, #10B981 20%, transparent)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
                    radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                    linear-gradient(135deg, color-mix(in srgb, #10B981 30%, transparent), color-mix(in srgb, #10B981 20%, transparent))
                  `,border:"2px solid color-mix(in srgb, #10B981 40%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #10B981 30%, transparent)"},children:e.jsx(g,{Icon:l.BarChart3,size:20,style:{color:"#10B981"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Visualisez votre évolution énergétique"}),e.jsx("p",{className:"text-green-200 text-sm",children:"Graphiques et tendances de vos activités sur la période sélectionnée"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(fe,{data:m?.distribution,period:r,apiPeriod:h}),e.jsx(je,{activities:m?.activities||[],period:r,apiPeriod:h})]}),t?.id&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(Mt,{userId:t.id,period:r}),e.jsx(Ot,{userId:t.id,period:r})]}),t?.id&&e.jsx("div",{className:"space-y-6",children:e.jsx(Rt,{})}),t?.id&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(Pt,{userId:t.id,period:r}),e.jsx(qt,{userId:t.id,period:r}),e.jsx(Vt,{userId:t.id,period:r})]}),e.jsx(F,{className:"p-6 text-center",style:{background:`
                radial-gradient(circle at 30% 20%, color-mix(in srgb, #F59E0B 8%, transparent) 0%, transparent 60%),
                var(--glass-opacity)
              `,borderColor:"color-mix(in srgb, #F59E0B 20%, transparent)"},children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx(g,{Icon:l.Lightbulb,size:16,style:{color:"#F59E0B"}}),e.jsxs("p",{className:"text-white/70 text-sm",children:["Consultez l'onglet ",e.jsx("strong",{className:"text-orange-300",children:"Insights"})," pour des conseils personnalisés basés sur ces données"]})]})})]})]}):e.jsx("div",{className:"space-y-6",children:e.jsxs(F,{className:"p-8 text-center",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #10B981 15%, transparent) 0%, transparent 60%),
              radial-gradient(circle at 70% 80%, color-mix(in srgb, #10B981 12%, transparent) 0%, transparent 50%),
              linear-gradient(145deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, #10B981 30%, transparent)",boxShadow:`
              0 12px 40px rgba(0, 0, 0, 0.25),
              0 0 30px color-mix(in srgb, #10B981 20%, transparent),
              inset 0 2px 0 rgba(255, 255, 255, 0.15)
            `},children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6",children:[e.jsx("div",{className:"w-20 h-20 rounded-full flex items-center justify-center",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #10B981 30%, transparent), color-mix(in srgb, #10B981 20%, transparent))
                `,border:"2px solid color-mix(in srgb, #10B981 40%, transparent)",boxShadow:"0 0 30px color-mix(in srgb, #10B981 30%, transparent)"},children:e.jsx(g,{Icon:l.Activity,size:40,style:{color:"#10B981"}})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-2xl font-bold text-white",children:"Progression Vierge"}),e.jsx("p",{className:"text-white/70 text-base",children:"Vos données de progression vous attendent"})]})]}),e.jsxs("p",{className:"text-white/70 text-base max-w-lg mx-auto leading-relaxed",children:["Enregistrez au moins ",N.week," activités pour débloquer vos conseils personnalisés et découvrir des insights sur votre progression énergétique."]})]})})},Gt=({activity:t,onClose:a,onDelete:s})=>{const{click:o}=Y(),n=p=>{p.target===p.currentTarget&&(o(),a())},i=()=>{s&&(s(t.id),a())},c=q(t.intensity),r=Ie(t.type);return $e.createPortal(e.jsx(ke,{children:e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",style:{background:"rgba(0, 0, 0, 0.8)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)"},onClick:n,role:"dialog","aria-modal":"true","aria-labelledby":"activity-detail-title",children:e.jsx(_.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{type:"spring",stiffness:300,damping:30},className:"w-full max-w-lg",onClick:p=>p.stopPropagation(),children:e.jsxs(F,{className:"p-6",style:{background:`
                radial-gradient(circle at 30% 20%, color-mix(in srgb, ${c} 12%, transparent) 0%, transparent 60%),
                radial-gradient(circle at 70% 80%, color-mix(in srgb, ${c} 8%, transparent) 0%, transparent 50%),
                linear-gradient(145deg, rgba(255,255,255,0.15), rgba(255,255,255,0.10)),
                rgba(11, 14, 23, 0.95)
              `,borderColor:`color-mix(in srgb, ${c} 30%, transparent)`,boxShadow:`
                0 25px 80px rgba(0, 0, 0, 0.6),
                0 0 60px color-mix(in srgb, ${c} 30%, transparent),
                inset 0 3px 0 rgba(255, 255, 255, 0.3),
                inset 0 -3px 0 rgba(0, 0, 0, 0.2)
              `,backdropFilter:"blur(32px) saturate(180%)",WebkitBackdropFilter:"blur(32px) saturate(180%)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center",style:{background:`
                      radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                      linear-gradient(135deg, color-mix(in srgb, ${c} 40%, transparent), color-mix(in srgb, ${c} 30%, transparent))
                    `,border:`3px solid color-mix(in srgb, ${c} 60%, transparent)`,boxShadow:`0 0 30px color-mix(in srgb, ${c} 50%, transparent)`},children:e.jsx(g,{Icon:l[r],size:28,style:{color:c},variant:"pure"})}),e.jsxs("div",{children:[e.jsx("h2",{id:"activity-detail-title",className:"text-2xl font-bold text-white mb-1",children:t.type}),e.jsx("p",{className:"text-white/70 text-sm",children:R(new Date(t.timestamp),"EEEE dd MMMM yyyy à HH:mm",{locale:W})})]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-full transition-all duration-200",style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)"},"aria-label":"Fermer le détail",children:e.jsx(g,{Icon:l.X,size:18,className:"text-white/80"})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${c} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${c} 20%, transparent)`},children:[e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:t.duration_min}),e.jsx("div",{className:"text-white/70 text-sm",children:"Minutes"})]}),e.jsxs("div",{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${c} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${c} 20%, transparent)`},children:[e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:t.calories_est}),e.jsx("div",{className:"text-white/70 text-sm",children:"Calories"})]}),e.jsxs("div",{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${c} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${c} 20%, transparent)`},children:[e.jsx("div",{className:"text-lg font-bold text-white mb-1",children:Fe(t.intensity)}),e.jsx("div",{className:"text-white/70 text-sm",children:"Intensité"})]})]}),t.notes&&e.jsxs("div",{className:"mb-6 p-4 rounded-xl",style:{background:`color-mix(in srgb, ${c} 6%, transparent)`,border:`1px solid color-mix(in srgb, ${c} 15%, transparent)`},children:[e.jsxs("h4",{className:"text-white font-medium mb-2 flex items-center gap-2",children:[e.jsx(g,{Icon:l.FileText,size:14,style:{color:c}}),"Notes"]}),e.jsx("p",{className:"text-white/80 text-sm leading-relaxed",children:t.notes})]}),e.jsxs("div",{className:"mb-6 p-4 rounded-xl bg-white/5 border border-white/10",children:[e.jsxs("h4",{className:"text-white font-medium mb-3 flex items-center gap-2",children:[e.jsx(g,{Icon:l.Info,size:14,className:"text-white/70"}),"Informations Techniques"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-white/60",children:"ID :"}),e.jsxs("div",{className:"text-white/80 font-mono text-xs mt-1",children:[t.id.substring(0,8),"..."]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-white/60",children:"Créé le :"}),e.jsx("div",{className:"text-white/80 text-xs mt-1",children:R(new Date(t.created_at),"dd/MM/yyyy HH:mm")})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[s&&e.jsx("button",{onClick:i,className:"flex-1 px-4 py-3 rounded-full font-semibold",style:{background:`linear-gradient(135deg, 
                      color-mix(in srgb, #EF4444 80%, transparent), 
                      color-mix(in srgb, #F59E0B 60%, transparent)
                    )`,border:"2px solid color-mix(in srgb, #EF4444 60%, transparent)",boxShadow:`
                      0 12px 40px color-mix(in srgb, #EF4444 40%, transparent),
                      0 0 60px color-mix(in srgb, #EF4444 30%, transparent),
                      inset 0 3px 0 rgba(255,255,255,0.4)
                    `,backdropFilter:"blur(20px) saturate(160%)",color:"#fff"},children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(g,{Icon:l.Trash2,size:16,className:"text-white"}),e.jsx("span",{children:"Supprimer"})]})}),e.jsx("button",{onClick:a,className:"flex-1 px-4 py-3 rounded-full font-semibold",style:{background:`linear-gradient(135deg, 
                    color-mix(in srgb, #6B7280 80%, transparent), 
                    color-mix(in srgb, #9CA3AF 60%, transparent)
                  )`,border:"2px solid color-mix(in srgb, #6B7280 60%, transparent)",boxShadow:`
                    0 8px 32px color-mix(in srgb, #6B7280 30%, transparent),
                    inset 0 2px 0 rgba(255,255,255,0.3)
                  `,backdropFilter:"blur(16px) saturate(140%)",color:"#fff"},children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(g,{Icon:l.X,size:16,className:"text-white"}),e.jsx("span",{children:"Fermer"})]})})]})]})})})}),document.body)},Yt=()=>{const{profile:t}=L(),{click:a,success:s,error:o}=Y(),{showToast:n}=ee();we();const i=t?.userId,[c,r]=Me.useState(null),{data:p,isLoading:x,error:d}=Xe(100),h=Be();B.useEffect(()=>{d&&(C.error("ACTIVITY_HISTORY_TAB","Failed to load activity history",{error:d instanceof Error?d.message:"Unknown error",userId:i,timestamp:new Date().toISOString()}),o(),n({type:"error",title:"Erreur de Chargement",message:"Impossible de charger votre historique d'activités.",duration:4e3}))},[d,i,o,n]);const m=B.useMemo(()=>p?p.reduce((w,I)=>{const y=R(new Date(I.timestamp),"yyyy-MM-dd");return w[y]||(w[y]=[]),w[y].push(I),w},{}):{},[p]),u=w=>{const I=new Date(w);return We(I)?"Aujourd'hui":Ke(I)?"Hier":R(I,"EEEE dd MMMM",{locale:W})},b=w=>{a(),r(w),C.info("ACTIVITY_HISTORY_TAB","Activity detail opened",{activityId:w.id,activityType:w.type,userId:i,timestamp:new Date().toISOString()})},f=w=>{C.info("ACTIVITY_HISTORY_TAB","Delete activity requested from history",{activityId:w,userId:i,timestamp:new Date().toISOString()}),h.mutate(w)};return x?e.jsx("div",{className:"space-y-6",children:[...Array(5)].map((w,I)=>e.jsx(F,{className:"p-6",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-white/10 rounded-full"}),e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx("div",{className:"h-4 bg-white/10 rounded w-1/3"}),e.jsx("div",{className:"h-3 bg-white/5 rounded w-1/2"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-16 bg-white/5 rounded-xl"}),e.jsx("div",{className:"h-16 bg-white/5 rounded-xl"})]})]})},I))}):!p||p.length===0?e.jsx("div",{className:"space-y-6",children:e.jsxs(F,{className:"p-8 text-center",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #8B5CF6 12%, transparent) 0%, transparent 60%),
              radial-gradient(circle at 70% 80%, color-mix(in srgb, #A855F7 8%, transparent) 0%, transparent 50%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, #8B5CF6 25%, transparent)",boxShadow:`
              0 12px 40px rgba(0, 0, 0, 0.25),
              0 0 30px color-mix(in srgb, #8B5CF6 15%, transparent),
              inset 0 2px 0 rgba(255, 255, 255, 0.15)
            `},children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6",children:[e.jsx("div",{className:"w-20 h-20 rounded-full flex items-center justify-center",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #8B5CF6 30%, transparent), color-mix(in srgb, #8B5CF6 20%, transparent))
                `,border:"2px solid color-mix(in srgb, #8B5CF6 40%, transparent)",boxShadow:"0 0 30px color-mix(in srgb, #8B5CF6 30%, transparent)"},children:e.jsx(g,{Icon:l.History,size:40,style:{color:"#8B5CF6"}})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-2xl font-bold text-white",children:"Forge Énergétique Vierge"}),e.jsx("p",{className:"text-white/70 text-base",children:"Votre historique d'activités vous attend"})]})]}),e.jsx("p",{className:"text-white/70 text-base max-w-lg mx-auto leading-relaxed",children:"Aucune activité enregistrée pour le moment. Commencez à enregistrer vos activités pour construire votre historique énergétique et suivre votre progression."})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-6 w-full",children:Object.entries(m).map(([w,I])=>{const y=I.reduce((v,j)=>v+j.calories_est,0),N=I.reduce((v,j)=>v+j.duration_min,0);return e.jsx("div",{className:"activity-group-enter",children:e.jsxs(F,{className:"p-6",style:{background:`
                    radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-activity-primary) 8%, transparent) 0%, transparent 60%),
                    var(--glass-opacity)
                  `,borderColor:"color-mix(in srgb, var(--color-activity-primary) 20%, transparent)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
                          radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                          linear-gradient(135deg, color-mix(in srgb, #8B5CF6 30%, transparent), color-mix(in srgb, #8B5CF6 20%, transparent))
                        `,border:"2px solid color-mix(in srgb, #8B5CF6 40%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #8B5CF6 30%, transparent)"},children:e.jsx(g,{Icon:l.Calendar,size:18,style:{color:"#8B5CF6"}})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-bold text-xl",children:u(w)}),e.jsx("p",{className:"text-blue-200 text-sm",children:"Forge énergétique de la journée"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-white font-bold text-lg",children:[y," kcal"]}),e.jsxs("div",{className:"text-white/60 text-sm",children:[I.length," activité",I.length>1?"s":""," • ",N," min"]})]})]}),e.jsx("div",{className:"space-y-3",children:I.map((v,j)=>e.jsx("div",{className:"group relative",children:e.jsx("div",{className:"p-5 rounded-xl cursor-pointer transition-all duration-200 hover:scale-[1.02] activity-item-enter",style:{background:`color-mix(in srgb, ${q(v.intensity)} 4%, transparent)`,border:`1px solid color-mix(in srgb, ${q(v.intensity)} 12%, transparent)`,backdropFilter:"blur(8px) saturate(120%)",animationDelay:`${j*.1}s`},onMouseEnter:k=>{k.currentTarget.style.background=`color-mix(in srgb, ${q(v.intensity)} 8%, transparent)`,k.currentTarget.style.borderColor=`color-mix(in srgb, ${q(v.intensity)} 20%, transparent)`,k.currentTarget.style.boxShadow=`0 4px 16px color-mix(in srgb, ${q(v.intensity)} 15%, transparent)`},onMouseLeave:k=>{k.currentTarget.style.background=`color-mix(in srgb, ${q(v.intensity)} 4%, transparent)`,k.currentTarget.style.borderColor=`color-mix(in srgb, ${q(v.intensity)} 12%, transparent)`,k.currentTarget.style.boxShadow="none"},onClick:()=>b(v),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
                                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.12) 0%, transparent 60%),
                                  linear-gradient(135deg, color-mix(in srgb, ${q(v.intensity)} 25%, transparent), color-mix(in srgb, ${q(v.intensity)} 15%, transparent))
                                `,border:`1px solid color-mix(in srgb, ${q(v.intensity)} 30%, transparent)`,boxShadow:`0 0 12px color-mix(in srgb, ${q(v.intensity)} 20%, transparent)`},children:e.jsx(g,{Icon:l[Ie(v.type)],size:18,style:{color:q(v.intensity)}})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-semibold text-lg",children:v.type}),e.jsxs("div",{className:"text-white/70 text-sm",children:[Fe(v.intensity)," • ",R(new Date(v.timestamp),"HH:mm")]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-white font-bold text-lg",children:[v.duration_min," min"]}),e.jsxs("div",{className:"text-white/60 text-sm",children:[v.calories_est," kcal"]})]}),e.jsx("button",{onClick:k=>{k.stopPropagation(),f(v.id)},disabled:h.isPending,className:"opacity-0 group-hover:opacity-100 transition-opacity duration-200 p-2 rounded-full",style:{background:"rgba(239, 68, 68, 0.15)",border:"1px solid rgba(239, 68, 68, 0.3)"},title:"Supprimer cette activité",children:h.isPending?e.jsx(g,{Icon:l.Loader2,size:14,className:"text-red-400 animate-spin"}):e.jsx(g,{Icon:l.Trash2,size:14,className:"text-red-400"})})]})]})})},v.id))})]})},w)})}),e.jsx(ke,{children:c&&e.jsx(Gt,{activity:c,onClose:()=>r(null),onDelete:f})})]})};function Ut(t){switch(t){case"daily":return{icon:"Activity",title:"Forge Énergétique",subtitle:"Votre énergie forgée aujourd'hui et vos séances actives",circuit:"activity",color:"#3B82F6"};case"insights":return{icon:"BarChart3",title:"Insights Énergétiques",subtitle:"Analyses avancées et recommandations personnalisées",circuit:"activity",color:"#F59E0B"};case"progression":return{icon:"TrendingUp",title:"Progression de la Forge",subtitle:"Évolution de vos performances et tendances énergétiques",circuit:"activity",color:"#10B981"};case"history":return{icon:"History",title:"Historique Énergétique",subtitle:"Toutes vos séances et activités forgées",circuit:"activity",color:"#8B5CF6"};default:return{icon:"Activity",title:"Forge Énergétique",subtitle:"Votre centre de suivi d'activité physique",circuit:"activity",color:"#3B82F6"}}}const as=()=>{const t=Oe();se();const{showFeedback:a}=Y(),s=B.useMemo(()=>{const i=t.hash.replace("#","");return(i?decodeURIComponent(i):"")||"daily"},[t.hash]),o=Ut(s),n=i=>{C.info("Activity tab changed",{tab:i})};return e.jsxs(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"space-y-6",children:[e.jsx(qe,{icon:o.icon,title:o.title,subtitle:o.subtitle,circuit:o.circuit,iconColor:o.color}),e.jsxs(G,{defaultValue:"daily",className:"w-full",onValueChange:n,forgeContext:"activity",children:[e.jsxs(G.List,{children:[e.jsx(G.Trigger,{value:"daily",icon:"Activity",children:"Tracker"}),e.jsx(G.Trigger,{value:"insights",icon:"BarChart3",children:"Insights"}),e.jsx(G.Trigger,{value:"progression",icon:"TrendingUp",children:"Progression"}),e.jsx(G.Trigger,{value:"history",icon:"History",children:"Historique"})]}),e.jsx(G.Panel,{value:"daily",className:"mt-6",children:e.jsx(Ft,{})}),e.jsx(G.Panel,{value:"insights",className:"mt-6",children:e.jsx(Dt,{})}),e.jsx(G.Panel,{value:"progression",className:"mt-6",children:e.jsx(Ht,{})}),e.jsx(G.Panel,{value:"history",className:"mt-6",children:e.jsx(Yt,{})})]})]})};export{as as default};
