const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/page-fridge-Cp-W9isk.js","assets/vendor-BefW7Bxj.js","assets/utils-CUtLAp28.js","assets/supabase-pyFrrmXL.js","assets/page-fridge-scan-C62RDC3k.js","assets/stores-Dp3vmZ5-.js","assets/ui-components-lrK_WhZu.js","assets/motion-BQvLDPOm.js","assets/ui-components-DyoLTZgZ.css","assets/page-fridge-scan-DAz6gEg3.css","assets/date-utils-BlBdbPk_.js"])))=>i.map(i=>d[i]);
import{R as T,c as K,e as _e,cW as Oe,u as me,j as e,cX as Ce,b as qe,r as Re,cN as Ve}from"./vendor-BefW7Bxj.js";import{u as se,G as F,S as h,I as c,P as ge,q as Le,m as He,p as U}from"./ui-components-lrK_WhZu.js";import{_ as Ge}from"./page-fridge-scan-C62RDC3k.js";import{a as L,c as Fe,m as ie}from"./stores-Dp3vmZ5-.js";import{u as Z,l as _,s as H}from"./page-fridge-Cp-W9isk.js";import{c as Ye,d as Ue,g as Ze,f as We,a as Je,u as Q,C as $,b as V,e as ke,h as Ie}from"./ActivityUtils-BQw4lb66.js";import{f as M,d as Ke,a as G,c as Xe,p as re,i as Qe,e as et}from"./date-utils-BlBdbPk_.js";import{m as D,A as Be}from"./motion-BQvLDPOm.js";import"./utils-CUtLAp28.js";import"./supabase-pyFrrmXL.js";function tt(t=100){const{session:r}=L();return K({queryKey:["activities","history",r?.user?.id,t],queryFn:async()=>{if(!r?.user?.id)throw new Error("User not authenticated");const s=new Date,i=new Date;return i.setDate(i.getDate()-30),Ze(r.user.id,i,s,t)},enabled:!!r?.user?.id,staleTime:5*60*1e3,gcTime:15*60*1e3,refetchOnWindowFocus:!1,retry:2})}function Ee(t="last7Days"){const{session:r,profile:s}=L();return K({queryKey:["activities","insights",r?.user?.id,t],queryFn:async()=>{if(_.info("ACTIVITY_INSIGHTS_DIAGNOSTIC","queryFn execution started",{userId:r?.user?.id,period:t,executionTime:new Date().toISOString(),reason:"react_query_triggered_execution",cacheStrategy:"server_side_cache_first",timestamp:new Date().toISOString()}),!r?.user?.id)throw new Error("User not authenticated");const i={weight_kg:s?.weight_kg||70,height_cm:s?.height_cm,sex:s?.sex,birthdate:s?.birthdate,activity_level:s?.activity_level,objective:s?.objective},a="https://kwipydbtjagypocpvbwn.supabase.co",p="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt3aXB5ZGJ0amFneXBvY3B2YnduIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ2ODg0MjIsImV4cCI6MjA3MDI2NDQyMn0.IS5IdKbmnGtgU_AaGYtUgX3ewaNpsiSAui5kbFV31_U";_.info("ACTIVITY_INSIGHTS_DIAGNOSTIC","MAKING FETCH CALL WITH SERVER-SIDE CACHE",{userId:r.user.id,period:t,endpoint:`${a}/functions/v1/activity-progress-generator`,cacheStrategy:"Server will check cache first, then call OpenAI if needed",timestamp:new Date().toISOString()});const x=await fetch(`${a}/functions/v1/activity-progress-generator`,{method:"POST",headers:{Authorization:`Bearer ${p}`,"Content-Type":"application/json"},body:JSON.stringify({userId:r.user.id,period:t,userProfile:i,clientTraceId:`activity_insights_${Date.now()}`})});if(!x.ok){const n=await x.json().catch(()=>({}));if(x.status===400&&n.error==="Insufficient data")return _.info("ACTIVITY_INSIGHTS","Insufficient data for insights generation",{userId:r.user.id,period:t,requiredActivities:n.required_activities,currentActivities:n.current_activities,timestamp:new Date().toISOString()}),{insufficient_data:!0,required_activities:n.required_activities,current_activities:n.current_activities,message:n.message};throw new Error(`Erreur de génération d'insights: ${x.statusText}`)}const o=await x.json();return _.info("ACTIVITY_INSIGHTS_DIAGNOSTIC","API CALL COMPLETED",{userId:r.user.id,period:t,insightsCount:o.insights?.length||0,costUsd:o.costUsd,processingTime:o.processingTime,cached:o.cached||!1,cacheAge:o.cache_age_hours,fallback:o.fallback||!1,creditsConsumed:!o.cached&&!o.fallback,timestamp:new Date().toISOString()}),o},enabled:!!r?.user?.id,staleTime:at(t),gcTime:nt(t),refetchOnWindowFocus:!1,retry:(i,a)=>a?.message?.includes("Insufficient data")?!1:i<1})}function st(){const{session:t}=L(),r=new Date;return K({queryKey:["activities","daily",t?.user?.id,M(r,"yyyy-MM-dd")],queryFn:()=>{if(!t?.user?.id)throw new Error("User not authenticated");return We(t.user.id,r)},enabled:!!t?.user?.id,staleTime:5*60*1e3,gcTime:10*60*1e3,refetchOnWindowFocus:!0,retry:2})}function rt(){const{data:t,isLoading:r,error:s}=st();return{data:T.useMemo(()=>t?Ye(t):null,[t]),isLoading:r,error:s,activities:t||[]}}function Se(t=10){const{session:r}=L();return K({queryKey:["activities","recent",r?.user?.id,t],queryFn:()=>{if(!r?.user?.id)throw new Error("User not authenticated");return Je(r.user.id,t)},enabled:!!r?.user?.id,staleTime:2*60*1e3,gcTime:5*60*1e3,retry:2})}function it(){const{session:t}=L();return K({queryKey:["activities","last",t?.user?.id],queryFn:async()=>{if(!t?.user?.id)throw new Error("User not authenticated");const{data:r,error:s}=await H.from("activities").select("*").eq("user_id",t.user.id).order("timestamp",{ascending:!1}).limit(1).single();if(s&&s.code!=="PGRST116")throw _.error("ACTIVITIES_REPO","Failed to fetch last activity",{error:s.message,userId:t.user.id,timestamp:new Date().toISOString()}),s;return r||null},enabled:!!t?.user?.id,staleTime:2*60*1e3,gcTime:5*60*1e3,retry:2})}function Ae(){const{session:t}=L(),{showToast:r}=se(),{success:s,error:i}=Z(),a=_e();return Oe({mutationFn:async p=>{if(!t?.user?.id)throw new Error("User not authenticated");if(!p||p.trim().length===0)throw new Error("ID d'activité invalide");return await Ue(p,t.user.id),p},onSuccess:p=>{s(),r({type:"success",title:"Activité supprimée",message:"L'activité a été supprimée avec succès",duration:3e3}),a.invalidateQueries({queryKey:["activities","daily",t?.user?.id]}),a.invalidateQueries({queryKey:["activities","recent",t?.user?.id]}),a.invalidateQueries({queryKey:["activities","stats",t?.user?.id]}),_.info("ACTIVITIES_HOOK","Activity deleted successfully",{activityId:p,userId:t?.user?.id,timestamp:new Date().toISOString()})},onError:p=>{i(),r({type:"error",title:"Erreur de suppression",message:p instanceof Error?p.message:"Impossible de supprimer l'activité",duration:4e3}),_.error("ACTIVITIES_HOOK","Failed to delete activity",{error:p instanceof Error?p.message:"Unknown error",userId:t?.user?.id,timestamp:new Date().toISOString()})}})}function Te(){const{session:t}=L();return K({queryKey:["activities","has-history",t?.user?.id],queryFn:async()=>{if(!t?.user?.id)return!1;const{data:r,error:s}=await H.from("activities").select("id").eq("user_id",t.user.id).limit(1);return s?(_.error("ACTIVITIES_REPO","Failed to check activity history",{error:s.message,userId:t.user.id,timestamp:new Date().toISOString()}),!1):(r?.length||0)>0},enabled:!!t?.user?.id,staleTime:5*60*1e3,retry:1})}function Y(t){switch(t){case"last7Days":return 3;case"last30Days":return 8;case"last3Months":return 20;case"last6Months":return 35;case"last1Year":return 60;default:return 8}}function at(t){switch(t){case"last7Days":return 1e3*60*60*12;case"last30Days":return 1e3*60*60*72;case"last3Months":return 1e3*60*60*168;case"last6Months":return 1e3*60*60*336;case"last1Year":return 1e3*60*60*720;default:return 1e3*60*60*12}}function nt(t){switch(t){case"last7Days":return 7*24*60*60*1e3;case"last30Days":return 14*24*60*60*1e3;case"last3Months":return 30*24*60*60*1e3;case"last6Months":return 60*24*60*60*1e3;case"last1Year":return 90*24*60*60*1e3;default:return 7*24*60*60*1e3}}function De(t){if(!t)return 1/0;const r=typeof t=="string"?new Date(t):t;return Ke(new Date,r)}function ze(t){if(!t)return 1/0;const r=typeof t=="string"?new Date(t):t;return Xe(new Date,r)}function ae(t){if(!t)return"jamais";const r=typeof t=="string"?new Date(t):t,s=De(r);return ze(r)<1?"il y a quelques instants":s===0?`aujourd'hui à ${M(r,"HH:mm")}`:s===1?`hier à ${M(r,"HH:mm")}`:s<=6?`il y a ${s} jours`:M(r,"dd MMM yyyy",{locale:G})}function ot(t,r){const s=De(r?.timestamp||null),i=(t?.activitiesCount||0)>0,a=t?.activitiesCount||0,p=t?.totalCalories||0;let x="none",o="";return r?s===0&&i?a===1?(x="low",o=`Dernière activité: ${ae(r.timestamp)}`):(x="none",o=`${a} activités aujourd'hui - Excellent rythme !`):s===0&&!i?ze(r.timestamp)<6?(x="low",o=`Dernière activité: ${ae(r.timestamp)}`):(x="medium",o=`Dernière activité: ${ae(r.timestamp)}`):s===1?(x="medium",o="Dernière activité: hier - Reprenez votre rythme aujourd'hui !"):s<=3?(x="high",o=`Cela fait ${s} jours sans activité - Il est temps de bouger !`):s<=7?(x="high",o=`${s} jours d'inactivité - Votre corps a besoin de mouvement !`):(x="critical",o=`Plus de ${s>14?"2 semaines":`${s} jours`} sans activité - Recommencez en douceur !`):(x="critical",o="Vous n'avez pas encore enregistré d'activité. Commencez votre voyage énergétique !"),{daysSinceLastActivity:s,hasActivitiesThisWeek:s<=7,hasActivitiesToday:i,totalActivitiesToday:a,totalCaloriesToday:p,lastActivityDate:r?new Date(r.timestamp):null,lastActivityType:r?.type||null,urgencyLevel:x,contextMessage:o}}function lt(t){const{urgencyLevel:r,daysSinceLastActivity:s,hasActivitiesToday:i,totalActivitiesToday:a,contextMessage:p,lastActivityType:x}=t;return r==="critical"&&s===1/0?{title:"Commencez votre voyage énergétique",subtitle:p,buttonText:"Enregistrer ma première activité",encouragement:"Chaque grand voyage commence par un premier pas"}:r==="critical"&&s>7?{title:"Reprenez le contrôle de votre énergie",subtitle:p,buttonText:"Reprendre en douceur",encouragement:"Il n'est jamais trop tard pour recommencer"}:r==="high"&&s>=2?{title:"Votre corps attend du mouvement",subtitle:p,buttonText:"Forger mon énergie maintenant",encouragement:"Brisez la routine sédentaire avec une session aujourd'hui"}:r==="medium"&&s===1?{title:"Maintenez votre dynamique",subtitle:"Dernière activité: hier - Ne perdez pas votre élan !",buttonText:"Continuer ma progression",encouragement:"La régularité est la clé du succès"}:i&&a===1?{title:"Excellente session aujourd'hui !",subtitle:`Dernière activité: ${x||"enregistrée"} - Ajoutez-en une autre ?`,buttonText:"Ajouter une session",encouragement:"Doublez votre impact énergétique aujourd'hui"}:i&&a>=2?{title:"Journée énergétique exceptionnelle !",subtitle:`${a} activités aujourd'hui - Performance remarquable`,buttonText:"Ajouter une activité",encouragement:"Vous êtes sur une lancée formidable !"}:r==="low"&&s===0?{title:"Gardez votre élan du jour",subtitle:p,buttonText:"Enregistrer une activité",encouragement:"Profitez de votre dynamique actuelle"}:r==="medium"&&s===0?{title:"Forgez votre énergie aujourd'hui",subtitle:p,buttonText:"Enregistrer une activité",encouragement:"Il est encore temps de bouger aujourd'hui"}:{title:"Forgez votre énergie",subtitle:"Enregistrez votre prochaine session d'activité",buttonText:"Enregistrer une activité",encouragement:"Chaque mouvement compte pour votre bien-être"}}function ct(t){const{urgencyLevel:r,daysSinceLastActivity:s,totalActivitiesToday:i}=t;switch(r){case"critical":return{priority:"critical",color:"#EF4444",icon:"AlertTriangle",animation:"pulse",particleCount:8};case"high":return{priority:"high",color:"#F59E0B",icon:"Zap",animation:"pulse",particleCount:6};case"medium":return{priority:"medium",color:"#06B6D4",icon:"Activity",animation:"breathing",particleCount:4};case"low":return{priority:"low",color:"#3B82F6",icon:"TrendingUp",animation:"breathing",particleCount:2};case"none":default:return{priority:"none",color:"#22C55E",icon:"Target",animation:"none",particleCount:0}}}function dt(t){const r=[];return t?.totalCalories>0&&r.push(`${t.totalCalories} kcal brûlées`),t?.totalDuration>0&&r.push(`${t.totalDuration} min actives`),t?.activitiesCount>0&&r.push(`${t.activitiesCount} activité${t.activitiesCount>1?"s":""}`),r}const xt=({todayStats:t,profile:r})=>{const s=me(),{click:i}=Z(),a=Q(),{data:p}=it(),x=T.useMemo(()=>ot(t||null,p),[t,p]),o=T.useMemo(()=>lt(x),[x]),n=T.useMemo(()=>ct(x),[x]),u=dt(t),d=(t?.activitiesCount||0)>0,m=()=>{i(),s("/activity/input")},v=()=>{i(),s("/activity#insights")},l={background:`
      radial-gradient(circle at 30% 20%, color-mix(in srgb, #3B82F6 12%, transparent) 0%, transparent 60%),
      radial-gradient(circle at 70% 80%, color-mix(in srgb, #3B82F6 8%, transparent) 0%, transparent 50%),
      var(--glass-opacity)
    `,borderColor:"color-mix(in srgb, #3B82F6 25%, transparent)","--glow-color":"color-mix(in srgb, #3B82F6 30%, transparent)"},g=a.mode==="low"||a.mode==="medium",j=g?"div":D.div;return e.jsx("div",{className:"dynamic-activity-cta activity-capture-enter","data-performance-mode":g,children:e.jsxs(F,{className:"p-6 md:p-8 pb-8 md:pb-10 text-center relative overflow-hidden cursor-pointer activity-card-base",onClick:m,interactive:!0,style:l,children:[a.enableRotations&&e.jsx("div",{className:"training-hero-corners","aria-hidden":"true",children:[0,1,2,3].map(b=>e.jsx(j,{className:"corner-particle",style:{position:"absolute",width:"12px",height:"12px",borderRadius:"2px",background:"linear-gradient(135deg, #3B82F6, rgba(96, 165, 250, 0.8))",boxShadow:"0 0 20px #3B82F6",top:b<2?"12px":"auto",bottom:b>=2?"12px":"auto",left:b%2===0?"12px":"auto",right:b%2===1?"12px":"auto",willChange:g?"auto":"transform, opacity"},...!g&&{initial:{rotate:b%2===0?45:-45},animate:{scale:[1,1.2,1],opacity:[.6,.9,.6],rotate:b%2===0?[45,55,45]:[-45,-55,-45]},transition:{duration:3.5,repeat:1/0,delay:b*.25,ease:[.45,.05,.55,.95]}}},b))}),(n.priority==="high"||n.priority==="critical")&&a.enableGlows&&e.jsx("div",{className:"absolute inset-0 rounded-inherit pointer-events-none urgent-forge-glow-css",style:{background:"radial-gradient(circle at center, color-mix(in srgb, #3B82F6 8%, transparent) 0%, transparent 70%)",filter:"blur(20px)",transform:"scale(1.2)",zIndex:-1}}),e.jsxs("div",{className:"relative z-10 space-y-4 md:space-y-6",children:[e.jsxs(j,{className:`w-28 h-28 mx-auto rounded-full flex items-center justify-center relative ${n.animation==="pulse"&&a.enablePulseEffects?"icon-pulse-css":n.animation==="breathing"&&a.enablePulseEffects?"icon-breathing-css":""}`,style:{background:`
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.3) 0%, transparent 60%),
                radial-gradient(circle at 70% 70%, color-mix(in srgb, #3B82F6 35%, transparent) 0%, transparent 50%),
                linear-gradient(135deg, color-mix(in srgb, #3B82F6 55%, transparent), color-mix(in srgb, #60A5FA 45%, transparent))
              `,border:"3px solid color-mix(in srgb, #3B82F6 70%, transparent)",boxShadow:`
                0 0 40px color-mix(in srgb, #3B82F6 60%, transparent),
                0 0 80px color-mix(in srgb, #3B82F6 40%, transparent),
                inset 0 3px 0 rgba(255,255,255,0.4)
              `,willChange:g?"auto":"transform"},...!g&&{animate:{scale:[1,1.05,1],boxShadow:["0 0 40px rgba(59, 130, 246, 0.6), 0 0 80px rgba(59, 130, 246, 0.4)","0 0 45px rgba(59, 130, 246, 0.65), 0 0 90px rgba(59, 130, 246, 0.45)","0 0 40px rgba(59, 130, 246, 0.6), 0 0 80px rgba(59, 130, 246, 0.4)"]},transition:{duration:3,repeat:1/0,ease:[.45,.05,.55,.95]}},children:[e.jsx(h,{Icon:c[n.icon],size:n.priority==="high"||n.priority==="critical"?56:48,color:"rgba(255, 255, 255, 0.95)",variant:"pure"}),!g&&a.enableAnimations&&e.jsx(D.div,{className:"absolute inset-0 rounded-full border-3",style:{borderColor:"color-mix(in srgb, #3B82F6 70%, transparent)",willChange:"transform, opacity"},animate:{scale:[1,1.5,1.5],opacity:[.7,0,0]},transition:{duration:2.5,repeat:1/0,ease:"easeOut"}}),a.enableParticles&&!g&&[...Array(6)].map((b,C)=>{const y=C*360/6,f=60,N=Math.cos(y*Math.PI/180)*f,w=Math.sin(y*Math.PI/180)*f;return e.jsx("div",{className:`absolute w-2 h-2 rounded-full dynamic-particle-css dynamic-particle-css--${C+1}`,style:{background:"#3B82F6",boxShadow:"0 0 12px color-mix(in srgb, #3B82F6 70%, transparent)","--particle-x":`${N*.4}px`,"--particle-y":`${w*.4}px`,"--particle-x-end":`${N}px`,"--particle-y-end":`${w}px`}},C)})]}),e.jsxs("div",{className:"space-y-2 md:space-y-3",children:[e.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white",children:o.title}),e.jsx("p",{className:"text-white/80 text-base md:text-lg leading-relaxed max-w-md mx-auto",children:o.subtitle}),o.encouragement&&e.jsx("p",{className:"text-white/60 text-sm italic",children:o.encouragement})]}),e.jsxs("div",{className:"flex flex-col gap-4 items-center",children:[e.jsxs("button",{onClick:m,className:`dynamic-cta-button-3d dynamic-cta-button-3d-high min-h-[64px] w-full sm:w-auto ${n.animation==="breathing"&&a.enableAnimations?"btn-breathing-css":""}`,style:{"--btn-color-light":"#60A5FA","--btn-color-base":"#3B82F6","--btn-color-dark":"#2563EB","--btn-shadow":"rgba(59, 130, 246, 0.6)","--btn-glow":"rgba(59, 130, 246, 0.8)"},children:[a.enableShimmers&&e.jsx("div",{className:"dynamic-cta-shimmer"}),e.jsxs("div",{children:[e.jsx(h,{Icon:c[n.icon],size:24,color:"white",variant:"pure"}),e.jsx("span",{children:o.buttonText})]})]}),d&&e.jsx("button",{onClick:v,className:"px-6 py-4 rounded-full font-medium text-white/90 transition-all duration-200 min-h-[64px]",style:{background:"color-mix(in srgb, #3B82F6 8%, transparent)",border:"1px solid color-mix(in srgb, #3B82F6 20%, transparent)",backdropFilter:"blur(12px) saturate(130%)"},onMouseEnter:b=>{a.mode!=="low"&&(b.currentTarget.style.background="color-mix(in srgb, #3B82F6 12%, transparent)",b.currentTarget.style.borderColor="color-mix(in srgb, #3B82F6 30%, transparent)",b.currentTarget.style.transform="translateY(-1px) scale(1.02)")},onMouseLeave:b=>{b.currentTarget.style.background="color-mix(in srgb, #3B82F6 8%, transparent)",b.currentTarget.style.borderColor="color-mix(in srgb, #3B82F6 20%, transparent)",b.currentTarget.style.transform="translateY(0) scale(1)"},children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(h,{Icon:c.Zap,size:20,color:"white",variant:"pure"}),e.jsx("span",{children:"Voir mes Insights"})]})})]}),u.length>0&&e.jsx("div",{className:"flex flex-wrap items-center justify-center gap-3 text-sm",children:u.map((b,C)=>e.jsx("div",{className:"px-3 py-1.5 rounded-full metric-badge-enter",style:{background:"color-mix(in srgb, #3B82F6 15%, transparent)",border:"1px solid color-mix(in srgb, #3B82F6 25%, transparent)",color:"#3B82F6",backdropFilter:"blur(8px) saturate(120%)",animationDelay:`${C*.1}s`},children:e.jsx("span",{className:"font-medium",children:b})},C))})]})]})})},$e=T.memo(({todayStats:t})=>{const{data:r=[]}=Se(1),s=r[0];return e.jsxs("div",{className:"daily-stats-grid",children:[e.jsxs(F,{className:"daily-stat-card daily-stat-card-primary",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"daily-stat-icon-container daily-stat-icon-primary",children:e.jsx(h,{Icon:c.Zap,size:28,style:{color:"#3B82F6"}})}),e.jsx("h3",{className:"daily-stat-title",children:"Énergie Brûlée Aujourd'hui"}),e.jsx("p",{className:"daily-stat-subtitle",children:"Calories du jour"})]}),e.jsx("div",{className:"daily-stat-value",children:t?.totalCalories||0}),e.jsx("div",{className:"daily-stat-label",children:"kcal forgées"})]}),e.jsxs(F,{className:"daily-stat-card daily-stat-card-secondary",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"daily-stat-icon-container daily-stat-icon-secondary",children:e.jsx(h,{Icon:c.Activity,size:28,className:"text-cyan-400"})}),e.jsx("h3",{className:"daily-stat-title",children:"Activités d'Aujourd'hui"}),e.jsx("p",{className:"daily-stat-subtitle",children:"Mouvements forgés"})]}),e.jsx("div",{className:"daily-stat-value",children:t?.activitiesCount||0}),e.jsx("div",{className:"daily-stat-label",children:"Sessions du jour"})]}),e.jsxs(F,{className:"daily-stat-card daily-stat-card-accent",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"daily-stat-icon-container daily-stat-icon-accent",children:e.jsx(h,{Icon:c.Clock,size:28,className:"text-purple-400"})}),e.jsx("h3",{className:"daily-stat-title",children:"Dernière Activité"}),e.jsx("p",{className:"daily-stat-subtitle",children:"Historique des forges"})]}),s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"daily-stat-value text-lg",children:s.type}),e.jsxs("div",{className:"daily-stat-label",children:[M(new Date(s.timestamp),"dd MMM à HH:mm",{locale:G})," • ",s.duration_min," min"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"daily-stat-value",children:"--:--"}),e.jsx("div",{className:"daily-stat-label",children:"Aucune activité"})]})]})]})});$e.displayName="DailyStatsGrid";function de(t){const r=["musculation","crossfit","bodyweight","weight","force","strength"];return t.filter(s=>r.some(i=>s.type.toLowerCase().includes(i))).reduce((s,i)=>s+i.duration_min,0)}function mt(t,r,s=[]){const i=r?.objective,a=r?.activity_level;switch(i){case"muscle_gain":{const p=de(s),x=be(a),o=p/x*100;return o<50?{status:"low",color:"#A855F7",message:"Volume de force insuffisant",recommendation:"Ajoutez des exercices de musculation pour stimuler la croissance",priority:"high",mainMetricLabel:"Volume de Force",subMetricLabel:"Minutes de musculation",currentValue:p,targetValue:x,unit:"min",icon:"Dumbbell",progressPercentage:o}:o>=50&&o<100?{status:"optimal",color:"#A855F7",message:"Bon volume d'entraînement",recommendation:"Continuez pour atteindre votre volume optimal de force",priority:"medium",mainMetricLabel:"Volume de Force",subMetricLabel:"Minutes de musculation",currentValue:p,targetValue:x,unit:"min",icon:"Dumbbell",progressPercentage:o}:{status:"high",color:"#A855F7",message:"Objectif de force atteint !",recommendation:"Excellent volume d'entraînement, maintenez cette intensité",priority:"low",mainMetricLabel:"Volume de Force",subMetricLabel:"Minutes de musculation",currentValue:p,targetValue:x,unit:"min",icon:"Dumbbell",progressPercentage:o}}case"fat_loss":{const p=t?.totalCalories||0,x=ne(a,"fat_loss"),o=p/x*100;return o<50?{status:"low",color:"#EF4444",message:"Déficit énergétique insuffisant",recommendation:"Augmentez le cardio et la musculation pour brûler plus de calories",priority:"high",mainMetricLabel:"Énergie Brûlée",subMetricLabel:"Calories de perte",currentValue:p,targetValue:x,unit:"kcal",icon:"Fire",progressPercentage:o}:o>=50&&o<100?{status:"optimal",color:"#EF4444",message:"Bon déficit énergétique",recommendation:"Continuez ce rythme pour optimiser la perte de graisse",priority:"medium",mainMetricLabel:"Énergie Brûlée",subMetricLabel:"Calories de perte",currentValue:p,targetValue:x,unit:"kcal",icon:"Fire",progressPercentage:o}:{status:"high",color:"#EF4444",message:"Objectif de perte atteint !",recommendation:"Excellent déficit énergétique, vous êtes sur la bonne voie",priority:"low",mainMetricLabel:"Énergie Brûlée",subMetricLabel:"Calories de perte",currentValue:p,targetValue:x,unit:"kcal",icon:"Fire",progressPercentage:o}}case"recomp":{const p=t?.totalCalories||0,x=de(s),o=ne(a,"recomp"),n=be(a)*.7,u=Math.min(100,p/o*100),d=Math.min(100,x/n*100),m=u*.6+d*.4;return m<50?{status:"low",color:"#F59E0B",message:"Équilibre énergétique insuffisant",recommendation:"Combinez cardio et musculation pour une recomposition optimale",priority:"high",mainMetricLabel:"Équilibre Énergétique",subMetricLabel:"Calories & Force",currentValue:p,targetValue:o,unit:"kcal",icon:"GitCompare",progressPercentage:m}:m>=50&&m<100?{status:"optimal",color:"#F59E0B",message:"Bon équilibre énergétique",recommendation:"Maintenez ce mix cardio-force pour la recomposition",priority:"medium",mainMetricLabel:"Équilibre Énergétique",subMetricLabel:"Calories & Force",currentValue:p,targetValue:o,unit:"kcal",icon:"GitCompare",progressPercentage:m}:{status:"high",color:"#F59E0B",message:"Équilibre optimal atteint !",recommendation:"Parfait équilibre pour la recomposition corporelle",priority:"low",mainMetricLabel:"Équilibre Énergétique",subMetricLabel:"Calories & Force",currentValue:p,targetValue:o,unit:"kcal",icon:"GitCompare",progressPercentage:m}}default:{const p=t?.totalCalories||0,x=ne(a,"maintenance"),o=p/x*100;return o<50?{status:"low",color:"#3B82F6",message:"Énergie faiblement forgée",recommendation:"Ajoutez des activités pour atteindre votre objectif",priority:"high",mainMetricLabel:"Énergie Quotidienne",subMetricLabel:"Calories forgées",currentValue:p,targetValue:x,unit:"kcal",icon:"Zap",progressPercentage:o}:o>=50&&o<100?{status:"optimal",color:"#3B82F6",message:"Bonne progression énergétique",recommendation:"Continuez pour atteindre votre objectif quotidien",priority:"medium",mainMetricLabel:"Énergie Quotidienne",subMetricLabel:"Calories forgées",currentValue:p,targetValue:x,unit:"kcal",icon:"Zap",progressPercentage:o}:{status:"high",color:"#3B82F6",message:"Objectif énergétique atteint !",recommendation:"Excellente journée active, maintenez ce rythme",priority:"low",mainMetricLabel:"Énergie Quotidienne",subMetricLabel:"Calories forgées",currentValue:p,targetValue:x,unit:"kcal",icon:"Zap",progressPercentage:o}}}}function ne(t,r){let s=300;switch(t){case"athlete":s=500;break;case"active":s=400;break;case"moderate":s=350;break;case"light":s=250;break;case"sedentary":s=200;break}switch(r){case"fat_loss":return s+100;case"recomp":return s+50;case"maintenance":return s;default:return s}}function be(t){switch(t){case"athlete":return 40;case"active":return 30;case"moderate":return 25;case"light":return 20;case"sedentary":return 15;default:return 25}}const ut=({todayStats:t,profile:r,todayActivities:s=[]})=>{const i=mt(t,r,s);return e.jsxs(F,{className:"calorie-progress-card",style:{"--recommendation-color":i.color},children:[e.jsxs("div",{className:"calorie-progress-header",children:[e.jsx("div",{className:"calorie-progress-icon",children:e.jsx(h,{Icon:c[i.icon],size:36,style:{color:i.color}})}),e.jsxs("div",{className:"calorie-progress-info",children:[e.jsxs("h3",{className:"calorie-progress-title",children:[i.mainMetricLabel," Aujourd'hui"]}),e.jsxs("p",{className:"calorie-progress-subtitle",children:["Progression vers votre objectif ",i.subMetricLabel.toLowerCase()," du jour"]})]}),e.jsxs("div",{className:"calorie-progress-percentage",children:[e.jsxs("div",{className:"calorie-progress-percentage-value",children:[Math.round(i.progressPercentage),"%"]}),e.jsx("div",{className:"calorie-progress-percentage-label",children:"Complété"})]})]}),e.jsx("div",{className:"calorie-progress-message",children:e.jsxs("div",{className:"calorie-progress-message-header",children:[e.jsx(h,{Icon:i.priority==="high"?c.AlertCircle:i.priority==="medium"?c.Info:c.Check,size:16,style:{color:i.color},className:"mt-0.5"}),e.jsxs("div",{className:"calorie-progress-message-content",children:[e.jsx("p",{className:"calorie-progress-message-title",style:{color:i.color},children:i.message}),e.jsx("p",{className:"calorie-progress-message-description",children:i.recommendation})]})]})}),e.jsx("div",{className:"calorie-progress-bar-container",children:e.jsx("div",{className:"calorie-progress-bar-fill",style:{width:`${Math.min(100,i.progressPercentage)}%`,background:`linear-gradient(90deg, ${i.color}, color-mix(in srgb, ${i.color} 80%, white))`},children:e.jsx("div",{className:"calorie-progress-bar-shimmer"})})}),e.jsxs("div",{className:"calorie-progress-values",children:[e.jsxs("span",{children:[i.currentValue," ",i.unit]}),e.jsxs("span",{children:[i.targetValue," ",i.unit]})]}),e.jsxs("div",{className:"calorie-progress-objective",children:["Objectif d'aujourd'hui : ",i.subMetricLabel.toLowerCase(),r?.objective&&` • Cible: ${r.objective==="fat_loss"?"Perte de graisse":r.objective==="muscle_gain"?"Prise de muscle":r.objective==="recomp"?"Recomposition":"Maintenance"}`]}),r?.objective==="recomp"&&e.jsxs("div",{className:"calorie-progress-details-grid",children:[e.jsxs("div",{className:"calorie-progress-detail-card",style:{background:"color-mix(in srgb, #EF4444 8%, transparent)",border:"1px solid color-mix(in srgb, #EF4444 15%, transparent)"},children:[e.jsx("div",{className:"calorie-progress-detail-value text-red-400",children:t?.totalCalories||0}),e.jsx("div",{className:"calorie-progress-detail-label text-red-300",children:"Calories"})]}),e.jsxs("div",{className:"calorie-progress-detail-card",style:{background:"color-mix(in srgb, #A855F7 8%, transparent)",border:"1px solid color-mix(in srgb, #A855F7 15%, transparent)"},children:[e.jsx("div",{className:"calorie-progress-detail-value text-purple-400",children:de(s)}),e.jsx("div",{className:"calorie-progress-detail-label text-purple-300",children:"Min Force"})]})]})]})},pt=({todayStats:t,profile:r})=>{const s=[{color:"#3B82F6",name:"Durée Totale",value:`${t?.totalDuration||0} min`,icon:"Clock"},{color:"#06B6D4",name:"Intensité Moy.",value:t?.averageIntensity||"Aucune",icon:"Zap"},{color:"#8B5CF6",name:"Type Principal",value:t?.mostFrequentType||"Aucun",icon:"Target"},{color:"#10B981",name:"Activités",value:`${t?.activitiesCount||0}`,icon:"Activity"}];return e.jsxs(F,{className:"activity-summary-card",children:[e.jsxs("div",{className:"activity-summary-header",children:[e.jsx("div",{className:"activity-summary-icon activity-icon-primary activity-icon-container-md",children:e.jsx(h,{Icon:c.BarChart3,size:20,style:{color:"var(--color-activity-primary)"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"activity-summary-title",children:"Résumé d'Aujourd'hui"}),e.jsx("p",{className:"activity-summary-subtitle",children:"Aperçu de vos activités du jour"})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:s.map((i,a)=>e.jsxs("div",{className:"activity-stat-card text-center rounded-xl activity-metric-enter",style:{background:`color-mix(in srgb, ${i.color} 8%, transparent)`,border:`1px solid color-mix(in srgb, ${i.color} 20%, transparent)`,animationDelay:`${.5+a*.1}s`},children:[e.jsx("div",{className:"flex items-center justify-center gap-1 mb-2",children:e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{background:`color-mix(in srgb, ${i.color} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${i.color} 25%, transparent)`},children:e.jsx(h,{Icon:c[i.icon],size:12,style:{color:i.color}})})}),e.jsx("div",{className:"text-lg font-bold",style:{color:i.color},children:i.value}),e.jsx("div",{className:"text-sm font-medium",style:{color:i.color},children:i.name})]},i.name))}),(t?.activitiesCount||0)>0&&e.jsxs("div",{className:"mt-4 p-4 rounded-xl",style:{background:"color-mix(in srgb, var(--brand-accent) 6%, transparent)",border:"1px solid color-mix(in srgb, var(--brand-accent) 15%, transparent)"},children:[e.jsxs("h4",{className:"text-cyan-300 font-medium text-sm mb-2 flex items-center gap-2",children:[e.jsx(h,{Icon:c.Info,size:12,style:{color:"var(--brand-accent)"}}),"Optimisations Forge"]}),e.jsxs("div",{className:"activity-summary-content space-y-1",children:[e.jsx("p",{children:"• Excellente diversité d'activités aujourd'hui"}),e.jsx("p",{children:"• Maintenez ce rythme pour optimiser votre forme"}),r?.objective==="fat_loss"&&e.jsx("p",{children:"• Activités cardio recommandées pour votre objectif"})]})]})]})};function ht(t){const r=t.toLowerCase();return r.includes("course")||r.includes("running")||r.includes("marche")||r.includes("walk")||r.includes("velo")||r.includes("bike")||r.includes("natation")||r.includes("swim")?"Activity":r.includes("musculation")||r.includes("weight")?"Dumbbell":r.includes("yoga")?"Smile":r.includes("football")||r.includes("sport")?"Target":"Zap"}function ee(t){switch(t){case"low":return"#22C55E";case"medium":return"#F59E0B";case"high":return"#EF4444";case"very_high":return"#DC2626";default:return"#3B82F6"}}const gt=({todayActivities:t=[],todayStats:r,hasAnyActivityHistory:s=!1,onActivityClick:i,deletingActivityId:a,onDeleteActivity:p})=>{const x=o=>{p&&p(o)};return e.jsxs(F,{className:"recent-activities-card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"activity-summary-icon activity-icon-primary activity-icon-container-md",children:e.jsx(h,{Icon:c.History,size:20,style:{color:"var(--color-activity-primary)"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"activity-summary-title",children:"Dernières Activités"}),e.jsx("p",{className:"activity-summary-subtitle",children:"Historique de vos dernières sessions"})]})]}),t.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-blue-500/20 flex items-center justify-center",children:e.jsx(h,{Icon:c.Activity,size:32,className:"text-blue-400"})}),e.jsx("p",{className:"text-white/70 text-sm mb-2",children:"Aucune activité enregistrée."}),e.jsx("p",{className:"text-white/50 text-xs",children:"Commencez votre voyage énergétique en enregistrant votre première activité !"})]}):e.jsx("div",{className:"recent-activities-list",children:t.map((o,n)=>e.jsx("div",{className:"group relative",children:e.jsx("div",{className:"recent-activity-item activity-item-enter",style:{animationDelay:`${n*.1}s`},onClick:()=>i?.(o),children:e.jsxs("div",{className:"recent-activity-item-header",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:`
                          radial-gradient(circle at 30% 30%, rgba(255,255,255,0.12) 0%, transparent 60%),
                          linear-gradient(135deg, color-mix(in srgb, ${ee(o.intensity)} 25%, transparent), color-mix(in srgb, ${ee(o.intensity)} 15%, transparent))
                        `,border:`1px solid color-mix(in srgb, ${ee(o.intensity)} 30%, transparent)`,boxShadow:`0 0 12px color-mix(in srgb, ${ee(o.intensity)} 20%, transparent)`},children:e.jsx(h,{Icon:c[ht(o.type)],size:16,style:{color:ee(o.intensity)}})}),e.jsxs("div",{children:[e.jsx("div",{className:"recent-activity-item-type",children:o.type}),e.jsxs("div",{className:"recent-activity-item-time",children:[o.duration_min," min • ",M(new Date(o.timestamp),"dd MMM HH:mm",{locale:G})]})]})]}),e.jsxs("div",{className:"recent-activity-item-stats",children:[e.jsxs("div",{className:"recent-activity-item-stat",children:[e.jsxs("div",{className:"text-white font-bold text-lg",children:[o.calories_est," kcal"]}),e.jsx("div",{className:"text-white/60 text-xs",children:"Brûlées"})]}),p&&e.jsx("button",{onClick:u=>{u.stopPropagation(),x(o.id)},disabled:a===o.id,className:"opacity-0 group-hover:opacity-100 transition-opacity duration-200 p-2 rounded-full",style:{background:"rgba(239, 68, 68, 0.15)",border:"1px solid rgba(239, 68, 68, 0.3)"},title:"Supprimer cette activité",children:a===o.id?e.jsx(h,{Icon:c.Loader2,size:14,className:"text-red-400 animate-spin"}):e.jsx(h,{Icon:c.Trash2,size:14,className:"text-red-400"})})]})]})})},o.id))})]})},bt=[{zone:1,label:"Z1 Récupération",color:"#22C55E",range:"50-60%"},{zone:2,label:"Z2 Endurance",color:"#3B82F6",range:"60-70%"},{zone:3,label:"Z3 Tempo",color:"#F59E0B",range:"70-80%"},{zone:4,label:"Z4 Seuil",color:"#EF4444",range:"80-90%"},{zone:5,label:"Z5 VO2max",color:"#DC2626",range:"90-100%"}];function vt({metrics:t,className:r=""}){const s=!!(t.hr_zone1_minutes||t.hr_zone2_minutes||t.hr_zone3_minutes||t.hr_zone4_minutes||t.hr_zone5_minutes),i=(t.hr_zone1_minutes||0)+(t.hr_zone2_minutes||0)+(t.hr_zone3_minutes||0)+(t.hr_zone4_minutes||0)+(t.hr_zone5_minutes||0),a=p=>!p||i===0?0:p/i*100;return e.jsxs(F,{className:`p-6 ${r}`,style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #EF4444 8%, transparent) 0%, transparent 60%),
          linear-gradient(145deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%),
          var(--glass-opacity)
        `,borderColor:"color-mix(in srgb, #EF4444 20%, transparent)"},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
              radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
              linear-gradient(135deg, color-mix(in srgb, #EF4444 30%, transparent), color-mix(in srgb, #EF4444 20%, transparent))
            `,border:"2px solid color-mix(in srgb, #EF4444 40%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #EF4444 30%, transparent)"},children:e.jsx(h,{Icon:c.Heart,size:20,style:{color:"#EF4444"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Métriques Cardiaques"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Données en temps réel"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[t.hr_avg&&e.jsxs(D.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-red-400",children:t.hr_avg}),e.jsx("div",{className:"text-white/60 text-xs mt-1",children:"FC Moyenne"})]}),t.hr_max&&e.jsxs(D.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-red-500",children:t.hr_max}),e.jsx("div",{className:"text-white/60 text-xs mt-1",children:"FC Max"})]}),t.hr_min&&e.jsxs(D.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-400",children:t.hr_min}),e.jsx("div",{className:"text-white/60 text-xs mt-1",children:"FC Min"})]}),t.hr_recovery_1min&&e.jsxs(D.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-400",children:t.hr_recovery_1min}),e.jsx("div",{className:"text-white/60 text-xs mt-1",children:"Récup. 1min"})]})]}),s&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-white/80 mb-3",children:"Distribution des Zones"}),bt.map(({zone:p,label:x,color:o,range:n})=>{const u=p===1?t.hr_zone1_minutes:p===2?t.hr_zone2_minutes:p===3?t.hr_zone3_minutes:p===4?t.hr_zone4_minutes:t.hr_zone5_minutes;if(!u)return null;const d=a(u);return e.jsxs(D.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*p},className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:o}}),e.jsx("span",{className:"text-white/80",children:x}),e.jsx("span",{className:"text-white/40",children:n})]}),e.jsxs("span",{className:"text-white/60",children:[u," min"]})]}),e.jsx("div",{className:"relative h-2 bg-white/5 rounded-full overflow-hidden",children:e.jsx(D.div,{initial:{width:0},animate:{width:`${d}%`},transition:{duration:.8,delay:.2+.1*p},className:"absolute top-0 left-0 h-full rounded-full",style:{backgroundColor:o,boxShadow:`0 0 12px ${o}40`}})})]},p)})]}),t.hr_avg&&e.jsx(D.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"mt-4 pt-4 border-t border-white/10",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{Icon:c.Check,size:14,style:{color:"#22C55E"}}),e.jsx("span",{className:"text-xs text-white/60",children:"Données enrichies par wearable"})]})})]})}const yt=t=>t?t>=80?"#22C55E":t>=60?"#3B82F6":t>=40?"#F59E0B":"#EF4444":"#6B7280",ft=t=>t?t>=80?"Excellente":t>=60?"Bonne":t>=40?"Modérée":"Faible":"Indisponible",jt=t=>t?t>=80?"Votre corps est prêt pour un entraînement intense":t>=60?"Vous pouvez vous entraîner normalement":t>=40?"Privilégiez un entraînement léger aujourd'hui":"Accordez-vous une journée de repos ou récupération active":"Connectez un objet pour obtenir votre score";function Nt({metrics:t,className:r=""}){const s=yt(t.recovery_score),i=ft(t.recovery_score),a=jt(t.recovery_score),p=({value:x,max:o,size:n=120,strokeWidth:u=8})=>{const d=(n-u)/2,m=2*Math.PI*d,v=x/o*m,l=n/2;return e.jsxs("svg",{width:n,height:n,className:"transform -rotate-90",children:[e.jsx("circle",{cx:l,cy:l,r:d,fill:"none",stroke:"rgba(255, 255, 255, 0.1)",strokeWidth:u}),e.jsx(D.circle,{cx:l,cy:l,r:d,fill:"none",stroke:s,strokeWidth:u,strokeLinecap:"round",initial:{strokeDasharray:`0 ${m}`},animate:{strokeDasharray:`${v} ${m}`},transition:{duration:1,ease:"easeOut"},style:{filter:`drop-shadow(0 0 8px ${s}40)`}})]})};return e.jsxs(F,{className:`p-6 ${r}`,style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, ${s} 8%, transparent) 0%, transparent 60%),
          linear-gradient(145deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%),
          var(--glass-opacity)
        `,borderColor:`color-mix(in srgb, ${s} 20%, transparent)`},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
              radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
              linear-gradient(135deg, color-mix(in srgb, ${s} 30%, transparent), color-mix(in srgb, ${s} 20%, transparent))
            `,border:`2px solid color-mix(in srgb, ${s} 40%, transparent)`,boxShadow:`0 0 20px color-mix(in srgb, ${s} 30%, transparent)`},children:e.jsx(h,{Icon:c.Battery,size:20,style:{color:s}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Score de Récupération"}),e.jsx("p",{className:"text-white/60 text-sm",children:"État de préparation"})]})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center mb-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx(p,{value:t.recovery_score||0,max:100}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[e.jsx(D.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.3,type:"spring"},className:"text-4xl font-bold",style:{color:s},children:t.recovery_score||"--"}),e.jsx("div",{className:"text-white/40 text-xs mt-1",children:"sur 100"})]})]}),e.jsxs(D.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},className:"text-center mt-4",children:[e.jsx("div",{className:"text-lg font-semibold mb-1",style:{color:s},children:i}),e.jsx("div",{className:"text-sm text-white/70 max-w-xs",children:a})]})]}),e.jsxs("div",{className:"space-y-3",children:[t.hrv_pre_activity&&e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{Icon:c.Activity,size:14,style:{color:"#3B82F6"}}),e.jsx("span",{className:"text-sm text-white/80",children:"HRV Pré-activité"})]}),e.jsxs("span",{className:"text-sm font-semibold text-white",children:[t.hrv_pre_activity.toFixed(1)," ms"]})]}),t.hrv_avg_overnight&&e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{Icon:c.Moon,size:14,style:{color:"#8B5CF6"}}),e.jsx("span",{className:"text-sm text-white/80",children:"HRV Nuit"})]}),e.jsxs("span",{className:"text-sm font-semibold text-white",children:[t.hrv_avg_overnight.toFixed(1)," ms"]})]}),t.sleep_quality_score&&e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{Icon:c.Moon,size:14,style:{color:"#A855F7"}}),e.jsx("span",{className:"text-sm text-white/80",children:"Qualité Sommeil"})]}),e.jsxs("span",{className:"text-sm font-semibold text-white",children:[t.sleep_quality_score.toFixed(0),"%"]})]}),t.sleep_duration_hours&&e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{Icon:c.Clock,size:14,style:{color:"#06B6D4"}}),e.jsx("span",{className:"text-sm text-white/80",children:"Durée Sommeil"})]}),e.jsxs("span",{className:"text-sm font-semibold text-white",children:[t.sleep_duration_hours.toFixed(1),"h"]})]}),t.stress_level_pre&&e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{Icon:c.AlertCircle,size:14,style:{color:"#F59E0B"}}),e.jsx("span",{className:"text-sm text-white/80",children:"Stress Pré-activité"})]}),e.jsxs("span",{className:"text-sm font-semibold text-white",children:[t.stress_level_pre.toFixed(0),"%"]})]}),t.body_battery_pre&&e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{Icon:c.Zap,size:14,style:{color:"#22C55E"}}),e.jsx("span",{className:"text-sm text-white/80",children:"Body Battery"})]}),e.jsxs("span",{className:"text-sm font-semibold text-white",children:[t.body_battery_pre.toFixed(0),"%"]})]})]}),t.recovery_score&&e.jsx(D.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"mt-4 pt-4 border-t border-white/10",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{Icon:c.Check,size:14,style:{color:"#22C55E"}}),e.jsx("span",{className:"text-xs text-white/60",children:"Données de récupération analysées"})]})})]})}const wt=t=>t?t>=55?"Excellent":t>=45?"Bon":t>=35?"Moyen":"À améliorer":"",_t=t=>t?t>=55?"#22C55E":t>=45?"#3B82F6":t>=35?"#F59E0B":"#EF4444":"#6B7280";function Ct({metrics:t,activityType:r,className:s=""}){const i=_t(t.vo2max_estimated),a=wt(t.vo2max_estimated),p=o=>o?o>=1e3?`${(o/1e3).toFixed(2)} km`:`${o.toFixed(0)} m`:"--",x=({icon:o,label:n,value:u,unit:d,color:m="#3B82F6",delay:v=0})=>e.jsxs(D.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:v,type:"spring",stiffness:200},className:"flex items-center justify-between p-3 rounded-lg bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{Icon:o,size:14,style:{color:m}}),e.jsx("span",{className:"text-sm text-white/80",children:n})]}),e.jsxs("span",{className:"text-sm font-semibold text-white",children:[u,d&&e.jsx("span",{className:"text-white/60 ml-1",children:d})]})]});return e.jsxs(F,{className:`p-6 ${s}`,style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #3B82F6 8%, transparent) 0%, transparent 60%),
          linear-gradient(145deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%),
          var(--glass-opacity)
        `,borderColor:"color-mix(in srgb, #3B82F6 20%, transparent)"},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
              radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
              linear-gradient(135deg, color-mix(in srgb, #3B82F6 30%, transparent), color-mix(in srgb, #3B82F6 20%, transparent))
            `,border:"2px solid color-mix(in srgb, #3B82F6 40%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #3B82F6 30%, transparent)"},children:e.jsx(h,{Icon:c.TrendingUp,size:20,style:{color:"#3B82F6"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Métriques de Performance"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Données enrichies"})]})]}),t.vo2max_estimated&&e.jsx(D.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-6 p-4 rounded-xl",style:{background:`linear-gradient(135deg, color-mix(in srgb, ${i} 15%, transparent), color-mix(in srgb, ${i} 5%, transparent))`,border:`1px solid color-mix(in srgb, ${i} 30%, transparent)`},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"VO2max Estimé"}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold",style:{color:i},children:t.vo2max_estimated.toFixed(1)}),e.jsx("span",{className:"text-sm text-white/60",children:"ml/kg/min"})]}),e.jsx("div",{className:"text-xs font-medium mt-1",style:{color:i},children:a})]}),e.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center",style:{background:`radial-gradient(circle, color-mix(in srgb, ${i} 20%, transparent), transparent)`,border:`2px solid color-mix(in srgb, ${i} 40%, transparent)`},children:e.jsx(h,{Icon:c.Zap,size:24,style:{color:i}})})]})}),e.jsxs("div",{className:"space-y-2 mb-4",children:[t.distance_meters&&e.jsx(x,{icon:c.MapPin,label:"Distance",value:p(t.distance_meters),color:"#10B981",delay:.1}),t.avg_pace&&e.jsx(x,{icon:c.Timer,label:"Allure Moyenne",value:t.avg_pace,unit:"/km",color:"#3B82F6",delay:.15}),t.avg_speed_kmh&&e.jsx(x,{icon:c.Gauge,label:"Vitesse Moyenne",value:t.avg_speed_kmh.toFixed(1),unit:"km/h",color:"#06B6D4",delay:.2}),t.elevation_gain_meters&&e.jsx(x,{icon:c.TrendingUp,label:"Dénivelé Positif",value:t.elevation_gain_meters.toFixed(0),unit:"m",color:"#F59E0B",delay:.25})]}),(t.avg_cadence_rpm||t.avg_power_watts)&&e.jsxs("div",{className:"space-y-2 mb-4",children:[t.avg_cadence_rpm&&e.jsx(x,{icon:c.Activity,label:r==="vélo"?"Cadence Moyenne":"Fréquence de Pas",value:t.avg_cadence_rpm.toFixed(0),unit:r==="vélo"?"rpm":"spm",color:"#8B5CF6",delay:.3}),t.avg_power_watts&&e.jsx(x,{icon:c.Zap,label:"Puissance Moyenne",value:t.avg_power_watts.toFixed(0),unit:"W",color:"#EF4444",delay:.35})]}),(t.training_load_score||t.efficiency_score)&&e.jsxs("div",{className:"space-y-2",children:[t.training_load_score&&e.jsx(x,{icon:c.Activity,label:"Charge d'Entraînement",value:t.training_load_score.toFixed(0),unit:"TRIMP",color:"#F59E0B",delay:.4}),t.efficiency_score&&e.jsx(x,{icon:c.Target,label:"Score d'Efficience",value:t.efficiency_score.toFixed(1),unit:"/100",color:"#22C55E",delay:.45})]}),e.jsx(D.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"mt-4 pt-4 border-t border-white/10",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{Icon:c.Check,size:14,style:{color:"#22C55E"}}),e.jsx("span",{className:"text-xs text-white/60",children:"Métriques avancées enrichies par wearable"})]})})]})}function Ft({hasWearableData:t,dataCompletenessScore:r,deviceName:s,className:i=""}){if(!t)return null;const a=r||0,p=a>=80?"#22C55E":a>=50?"#3B82F6":"#F59E0B";return e.jsxs(D.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{type:"spring",stiffness:200},className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium ${i}`,style:{background:`linear-gradient(135deg, color-mix(in srgb, ${p} 20%, transparent), color-mix(in srgb, ${p} 10%, transparent))`,border:`1px solid color-mix(in srgb, ${p} 30%, transparent)`,boxShadow:`0 0 12px color-mix(in srgb, ${p} 20%, transparent)`},children:[e.jsx(h,{Icon:c.Watch,size:12,style:{color:p}}),e.jsx("span",{style:{color:p},children:"Enrichi par wearable"}),s&&e.jsxs("span",{className:"text-white/60",children:["• ",s]}),r&&e.jsxs("span",{className:"text-white/60",children:["• ",Math.round(a),"%"]})]})}function kt({activities:t,className:r=""}){const s=T.useMemo(()=>{if(!t||t.length===0)return null;const i=t.filter(d=>d.wearable_device_id);if(i.length===0)return null;const a=i[0],p=i.filter(d=>d.hr_avg).reduce((d,m)=>d+(m.hr_avg||0),0)/i.length||null,x=Math.max(...i.map(d=>d.hr_max||0))||null,o={zone1:i.reduce((d,m)=>d+(m.hr_zone1_minutes||0),0),zone2:i.reduce((d,m)=>d+(m.hr_zone2_minutes||0),0),zone3:i.reduce((d,m)=>d+(m.hr_zone3_minutes||0),0),zone4:i.reduce((d,m)=>d+(m.hr_zone4_minutes||0),0),zone5:i.reduce((d,m)=>d+(m.hr_zone5_minutes||0),0)},n=i.reduce((d,m)=>d+(m.distance_meters||0),0)||null,u=i.reduce((d,m)=>d+(m.training_load_score||0),0)||null;return{heartRate:{hr_avg:p?Math.round(p):null,hr_max:x||null,hr_min:a.hr_min,hr_resting_pre:a.hr_resting_pre,hr_recovery_1min:a.hr_recovery_1min,hr_zone1_minutes:o.zone1||null,hr_zone2_minutes:o.zone2||null,hr_zone3_minutes:o.zone3||null,hr_zone4_minutes:o.zone4||null,hr_zone5_minutes:o.zone5||null},recovery:{recovery_score:a.recovery_score,hrv_pre_activity:a.hrv_pre_activity,hrv_avg_overnight:a.hrv_avg_overnight,sleep_quality_score:a.sleep_quality_score,sleep_duration_hours:a.sleep_duration_hours,stress_level_pre:a.stress_level_pre,body_battery_pre:a.body_battery_pre,fatigue_index:a.fatigue_index},performance:{vo2max_estimated:a.vo2max_estimated,training_load_score:u,efficiency_score:a.efficiency_score,distance_meters:n,avg_pace:a.avg_pace,avg_speed_kmh:a.avg_speed_kmh,elevation_gain_meters:i.reduce((d,m)=>d+(m.elevation_gain_meters||0),0)||null,avg_cadence_rpm:a.avg_cadence_rpm,avg_power_watts:a.avg_power_watts},hasData:!0,activityType:a.type,dataCompletenessScore:a.data_completeness_score}},[t]);return s?e.jsxs(D.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:`space-y-6 ${r}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Métriques Enrichies"}),e.jsx("p",{className:"text-white/60 text-sm mt-1",children:"Données biométriques provenant de vos objets connectés"})]}),e.jsx(Ft,{hasWearableData:s.hasData,dataCompletenessScore:s.dataCompletenessScore})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(Nt,{metrics:s.recovery}),e.jsx(vt,{metrics:s.heartRate})]}),e.jsx(Ct,{metrics:s.performance,activityType:s.activityType}),e.jsx(D.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"p-4 rounded-xl",style:{background:"linear-gradient(135deg, color-mix(in srgb, #3B82F6 10%, transparent), color-mix(in srgb, #3B82F6 5%, transparent))",border:"1px solid color-mix(in srgb, #3B82F6 20%, transparent)"},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5",children:e.jsx(h,{Icon:c.Info,size:16,style:{color:"#3B82F6"}})}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-sm text-blue-200",children:"Ces métriques sont automatiquement synchronisées depuis vos objets connectés. Plus vous portez votre montre, plus les données sont précises et les insights personnalisés."})})]})})]}):null}const It=()=>{const{profile:t,session:r}=L(),{showToast:s}=se(),{success:i,error:a}=Z(),{data:p,isLoading:x,error:o,activities:n}=rt(),{data:u=[],isLoading:d}=Se(10),m=Ae(),{data:v=!1}=K({queryKey:["activities","has-history",r?.user?.id],queryFn:async()=>{if(!r?.user?.id)return!1;const{supabase:j}=await Ge(async()=>{const{supabase:y}=await import("./page-fridge-Cp-W9isk.js").then(f=>f.k);return{supabase:y}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])),{data:b,error:C}=await j.from("activities").select("id").eq("user_id",r.user.id).limit(1);return C?(_.error("ACTIVITY_DAILY_TAB","Failed to check activity history",{error:C.message,userId:r.user.id,timestamp:new Date().toISOString()}),!1):(b?.length||0)>0},enabled:!!r?.user?.id,staleTime:5*60*1e3,retry:1});T.useEffect(()=>{o&&(_.error("ACTIVITY_DAILY_TAB","Failed to load activity stats",{error:o instanceof Error?o.message:"Unknown error",userId:r?.user?.id,timestamp:new Date().toISOString()}),a(),s({type:"error",title:"Erreur de Chargement",message:"Impossible de charger vos activités. Vérifiez votre connexion.",duration:4e3}))},[o,r?.user?.id,a,s]);const l=j=>{_.info("ACTIVITY_DAILY_TAB","Activity clicked for details",{activityId:j.id,activityType:j.type,userId:r?.user?.id,timestamp:new Date().toISOString()}),s({type:"info",title:"Détail d'Activité",message:`${j.type} - ${j.duration_min} min - ${j.calories_est} kcal`,duration:3e3})},g=j=>{_.info("ACTIVITY_DAILY_TAB","Delete activity requested",{activityId:j,userId:r?.user?.id,timestamp:new Date().toISOString()}),m.mutate(j)};return x?e.jsxs("div",{className:"space-y-6",children:[e.jsx(ge,{profile:t,forgeContext:"activity"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-32 bg-white/5 rounded-xl animate-pulse"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"h-24 bg-white/5 rounded-xl animate-pulse"}),e.jsx("div",{className:"h-24 bg-white/5 rounded-xl animate-pulse"}),e.jsx("div",{className:"h-24 bg-white/5 rounded-xl animate-pulse"})]}),e.jsx("div",{className:"h-40 bg-white/5 rounded-xl animate-pulse"})]})]}):e.jsxs(D.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"space-y-6",children:[e.jsx(ge,{profile:t,forgeContext:"activity"}),e.jsx(xt,{todayStats:p,profile:t}),e.jsx($e,{todayStats:p}),e.jsx(ut,{todayStats:p,profile:t,todayActivities:n}),e.jsx(pt,{todayStats:p,profile:t}),e.jsx(gt,{todayActivities:u,todayStats:p,hasAnyActivityHistory:v,deletingActivityId:m.isPending?"deleting":void 0,onActivityClick:l,onDeleteActivity:g}),n&&n.some(j=>j.wearable_device_id)&&e.jsx(kt,{activities:n,className:"mt-6"})]})},Me=()=>{const t=Le()==="reduced";return e.jsxs("div",{className:"space-y-6 analysis-loading-container",children:[e.jsx(D.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:t?.1:.6},children:e.jsxs(F,{className:"p-8 text-center relative overflow-visible",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-activity-primary) 15%, transparent) 0%, transparent 60%),
              radial-gradient(circle at 70% 80%, color-mix(in srgb, var(--color-activity-secondary) 12%, transparent) 0%, transparent 50%),
              radial-gradient(circle at 50% 50%, color-mix(in srgb, var(--color-activity-accent) 8%, transparent) 0%, transparent 70%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, var(--color-activity-primary) 30%, transparent)",boxShadow:`
              0 16px 48px rgba(0, 0, 0, 0.3),
              0 0 40px color-mix(in srgb, var(--color-activity-primary) 20%, transparent),
              0 0 80px color-mix(in srgb, var(--color-activity-secondary) 15%, transparent),
              inset 0 2px 0 rgba(255, 255, 255, 0.2)
            `,backdropFilter:"blur(24px) saturate(160%)"},children:[e.jsx("div",{className:"absolute inset-0 rounded-inherit pointer-events-none",style:{background:"radial-gradient(circle at center, color-mix(in srgb, var(--color-activity-primary) 8%, transparent) 0%, transparent 70%)",filter:"blur(20px)",transform:"scale(1.2)",zIndex:-1,animation:t?"none":"forge-glow 4s ease-in-out infinite"}}),e.jsxs("div",{className:"relative z-10 space-y-6 flex flex-col items-center",children:[e.jsxs(D.div,{className:"w-24 h-24 rounded-full flex items-center justify-center relative",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.25) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, var(--color-activity-primary) 45%, transparent), color-mix(in srgb, var(--color-activity-secondary) 35%, transparent))
                `,border:"3px solid color-mix(in srgb, var(--color-activity-primary) 70%, transparent)",boxShadow:`
                  0 0 60px color-mix(in srgb, var(--color-activity-primary) 60%, transparent),
                  0 0 120px color-mix(in srgb, var(--color-activity-primary) 40%, transparent),
                  inset 0 3px 0 rgba(255,255,255,0.4)
                `,display:"flex",alignItems:"center",justifyContent:"center"},animate:t?{}:{scale:[1,1.05,1],boxShadow:["0 0 60px color-mix(in srgb, var(--color-activity-primary) 60%, transparent), 0 0 120px color-mix(in srgb, var(--color-activity-primary) 40%, transparent)","0 0 80px color-mix(in srgb, var(--color-activity-primary) 80%, transparent), 0 0 160px color-mix(in srgb, var(--color-activity-primary) 50%, transparent)","0 0 60px color-mix(in srgb, var(--color-activity-primary) 60%, transparent), 0 0 120px color-mix(in srgb, var(--color-activity-primary) 40%, transparent)"]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},children:[e.jsx(D.div,{className:"flex items-center justify-center",animate:t?{}:{rotate:360},transition:{duration:4,repeat:1/0,ease:"linear"},children:e.jsx(h,{Icon:c.Zap,size:36,className:"text-white",style:{filter:"drop-shadow(0 0 12px rgba(255,255,255,0.8))",display:"block"}})}),!t&&[...Array(6)].map((r,s)=>e.jsx("div",{className:"absolute w-3 h-3 rounded-full",style:{background:"var(--color-activity-secondary)",left:`${15+s*15}%`,top:`${15+s%3*25}%`,boxShadow:"0 0 12px color-mix(in srgb, var(--color-activity-secondary) 80%, transparent)",animation:`ai-particle-orbit 6s ease-in-out infinite ${s*.5}s`}},s))]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-white mb-3",children:"Analyse Énergétique Avancée"}),e.jsx("p",{className:"text-white/80 text-lg leading-relaxed max-w-md mx-auto",children:"Analyse de vos patterns d'activité pour générer des insights personnalisés"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[{phase:"Analyse des Patterns",icon:"BarChart3",color:"var(--color-activity-primary)"},{phase:"Génération d'Insights",icon:"TrendingUp",color:"var(--color-activity-secondary)"},{phase:"Recommandations Personnalisées",icon:"Target",color:"var(--color-activity-accent)"}].map((r,s)=>e.jsxs(D.div,{className:"p-4 rounded-xl text-center",style:{background:`color-mix(in srgb, ${r.color} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${r.color} 20%, transparent)`,backdropFilter:"blur(8px) saturate(120%)"},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:t?.1:.5,delay:t?0:.2+s*.1},children:[e.jsx(D.div,{className:"w-12 h-12 mx-auto mb-3 rounded-full flex items-center justify-center",style:{background:`color-mix(in srgb, ${r.color} 20%, transparent)`,border:`1px solid color-mix(in srgb, ${r.color} 30%, transparent)`},animate:t?{}:{scale:[1,1.1,1],boxShadow:[`0 0 16px color-mix(in srgb, ${r.color} 40%, transparent)`,`0 0 24px color-mix(in srgb, ${r.color} 60%, transparent)`,`0 0 16px color-mix(in srgb, ${r.color} 40%, transparent)`]},transition:{duration:2,repeat:1/0,delay:s*.3,ease:"easeInOut"},children:e.jsx(h,{Icon:c[r.icon],size:20,style:{color:r.color}})}),e.jsx("div",{className:"text-white font-medium text-sm",children:r.phase})]},r.phase))}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-white/80 font-medium",children:"Analyse en cours..."}),e.jsx("span",{className:"text-white/60",children:"Forge Énergétique"})]}),e.jsx("div",{className:"w-full bg-white/10 rounded-full h-2 overflow-hidden",children:e.jsx(D.div,{className:"h-full rounded-full relative overflow-hidden",style:{background:`
                      linear-gradient(90deg,
                        var(--color-activity-primary),
                        var(--color-activity-secondary),
                        var(--color-activity-accent)
                      )
                    `,boxShadow:"0 0 16px color-mix(in srgb, var(--color-activity-primary) 60%, transparent)"},initial:{width:0},animate:{width:"100%"},transition:{duration:t?.1:8,repeat:1/0,ease:"easeInOut"},children:!t&&e.jsx("div",{className:"absolute inset-0 rounded-full",style:{background:`linear-gradient(90deg,
                          transparent 0%,
                          rgba(255,255,255,0.6) 50%,
                          transparent 100%
                        )`,animation:"progressShimmer 2s ease-in-out infinite"}})})})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(D.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:t?.1:.6,delay:t?0:.3},children:e.jsxs(F,{className:"p-6 h-80",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"color-mix(in srgb, var(--color-activity-primary) 20%, transparent)"},children:e.jsx(h,{Icon:c.BarChart3,size:16,style:{color:"var(--color-activity-primary)"}})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"h-4 bg-white/10 rounded w-40 skeleton-glass"}),e.jsx("div",{className:"h-3 bg-white/5 rounded w-32"})]})]}),e.jsxs("div",{className:"relative h-48 flex items-center justify-center",children:[e.jsx(D.div,{className:"w-32 h-32 rounded-full border-8 border-transparent relative",style:{background:`conic-gradient(from 0deg,
                    var(--color-activity-primary) 0% 40%,
                    var(--color-activity-secondary) 40% 70%,
                    var(--color-activity-accent) 70% 100%
                  )`,mask:"radial-gradient(circle at center, transparent 40%, black 42%)",WebkitMask:"radial-gradient(circle at center, transparent 40%, black 42%)"},animate:t?{}:{rotate:360},transition:{duration:8,repeat:1/0,ease:"linear"},children:e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-r from-transparent via-white/20 to-transparent opacity-30"})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-white font-bold text-lg",children:"Activités"}),e.jsx("div",{className:"text-white/60 text-sm",children:"Analyse..."})]})})]})]})}),e.jsx(D.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:t?.1:.6,delay:t?0:.4},children:e.jsxs(F,{className:"p-6 h-80",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"color-mix(in srgb, var(--color-activity-secondary) 20%, transparent)"},children:e.jsx(h,{Icon:c.LineChart,size:16,style:{color:"var(--color-activity-secondary)"}})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"h-4 bg-white/10 rounded w-36 skeleton-glass"}),e.jsx("div",{className:"h-3 bg-white/5 rounded w-28"})]})]}),e.jsx("div",{className:"relative h-48 rounded-xl bg-white/5 border border-white/10 overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 flex items-end justify-around p-4",children:Array.from({length:7}).map((r,s)=>e.jsx(D.div,{className:"rounded-t",style:{width:"12px",height:`${30+Math.random()*60}%`,background:"color-mix(in srgb, var(--color-activity-secondary) 30%, transparent)"},initial:{height:0},animate:{height:`${30+Math.random()*60}%`},transition:{duration:t?.1:1.5,delay:t?0:s*.1,repeat:1/0,repeatType:"reverse",ease:"easeInOut"}},s))})})]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Array.from({length:4}).map((r,s)=>e.jsx(D.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:t?.1:.5,delay:t?0:.5+s*.1},children:e.jsx(F,{className:"p-5",style:{background:`
                  radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-activity-secondary) 6%, transparent) 0%, transparent 60%),
                  var(--glass-opacity)
                `,borderColor:"color-mix(in srgb, var(--color-activity-secondary) 15%, transparent)"},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(D.div,{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{background:"color-mix(in srgb, var(--color-activity-primary) 20%, transparent)"},animate:t?{}:{scale:[1,1.1,1],opacity:[.7,1,.7]},transition:{duration:2,repeat:1/0,delay:s*.2,ease:"easeInOut"},children:e.jsx(h,{Icon:[c.TrendingUp,c.Target,c.BarChart3,c.Zap][s],size:14,style:{color:"var(--color-activity-primary)"}})}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-white/10 rounded skeleton-glass",style:{width:`${60+Math.random()*30}%`}}),e.jsx("div",{className:"h-3 bg-white/5 rounded skeleton-glass",style:{width:`${80+Math.random()*15}%`}}),e.jsx("div",{className:"h-3 bg-white/5 rounded skeleton-glass",style:{width:`${40+Math.random()*40}%`}})]})]})})},s))}),!t&&e.jsx(D.div,{className:"relative h-16 overflow-hidden",initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:.8},children:e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center",children:[Array.from({length:12}).map((r,s)=>e.jsx("div",{className:"absolute w-2 h-2 rounded-full",style:{background:"linear-gradient(135deg, var(--color-activity-primary), var(--color-activity-secondary))",left:`${5+s*8}%`,top:`${40+s%3*20}%`,boxShadow:"0 0 8px color-mix(in srgb, var(--color-activity-primary) 60%, transparent)",display:"block",margin:"0 auto"}},s)),e.jsx("svg",{className:"absolute inset-0 w-full h-full pointer-events-none opacity-30",children:Array.from({length:4}).map((r,s)=>e.jsx(D.path,{d:`M ${10+s*25} 50 Q ${25+s*25} 20 ${40+s*25} 50`,stroke:"var(--color-activity-primary)",strokeWidth:"1",fill:"none",strokeDasharray:"2 2",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:3,repeat:1/0,delay:s*.5,ease:"easeInOut"}},s))})]})}),e.jsx(D.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:t?.1:.6,delay:t?0:1},children:e.jsx(F,{className:"p-6 text-center",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-activity-secondary) 8%, transparent) 0%, transparent 60%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, var(--color-activity-secondary) 20%, transparent)"},children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx(h,{Icon:c.Info,size:16,style:{color:"var(--color-activity-secondary)"}}),e.jsxs("p",{className:"text-white/70 text-sm",children:["Analyse de vos "," ",e.jsx("span",{className:"font-semibold text-white",children:"patterns énergétiques"})," "," en cours pour générer des recommandations sur mesure..."]})]})})}),e.jsx("style",{children:`
        @keyframes forge-glow {
          0%, 100% {
            opacity: 0.6;
            transform: scale(1.1);
          }
          50% {
            opacity: 0.9;
            transform: scale(1.3);
          }
        }

        @keyframes ai-particle-orbit {
          0%, 100% {
            transform: translateY(0px) translateX(0px) scale(1);
            opacity: 0.6;
          }
          25% {
            transform: translateY(-12px) translateX(8px) scale(1.3);
            opacity: 1;
          }
          50% {
            transform: translateY(-16px) translateX(-4px) scale(1.4);
            opacity: 1;
          }
          75% {
            transform: translateY(-8px) translateX(-8px) scale(1.2);
            opacity: 0.8;
          }
        }

        @keyframes ai-data-flow {
          0%, 100% {
            transform: translateY(0px) translateX(0px) scale(1);
            opacity: 0.6;
          }
          25% {
            transform: translateY(-8px) translateX(4px) scale(1.2);
            opacity: 0.9;
          }
          50% {
            transform: translateY(-12px) translateX(-2px) scale(1.3);
            opacity: 1;
          }
          75% {
            transform: translateY(-8px) translateX(-4px) scale(1.1);
            opacity: 0.8;
          }
        }

        /* Support pour reduced motion */
        @media (prefers-reduced-motion: reduce) {
          .forge-glow,
          .ai-particle-orbit,
          .ai-data-flow {
            animation: none !important;
          }

          .forge-glow {
            opacity: 0.7 !important;
            transform: scale(1.2) !important;
          }

          .ai-particle-orbit {
            opacity: 0.8 !important;
            transform: translateY(-10px) scale(1.2) !important;
          }

          .ai-data-flow {
            opacity: 0.7 !important;
            transform: translateY(-6px) scale(1.1) !important;
          }
        }

        /* Optimisations mobile */
        @media (max-width: 768px) {
          .analysis-loading-container {
            padding: 0.5rem;
          }

          .forge-glow {
            animation-duration: 5s;
          }

          .ai-particle-orbit {
            animation-duration: 8s;
          }

          .ai-data-flow {
            animation-duration: 6s;
          }
        }
      `})]})};function Bt(t){switch(t){case"week":return"7 jours";case"month":return"30 jours";case"quarter":return"90 jours";default:return"30 jours"}}function Et(t){return{TrendingUp:"TrendingUp",Target:"Target",Zap:"Zap",Activity:"Activity",BarChart3:"BarChart3",Clock:"Clock",Heart:"Heart",Lightbulb:"Lightbulb",Check:"Check",AlertCircle:"AlertCircle",Info:"Info"}[t]||"Info"}const ve=({insights:t,summary:r,period:s,apiPeriod:i})=>!t||t.length===0?null:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
              radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
              linear-gradient(135deg, color-mix(in srgb, #F59E0B 30%, transparent), color-mix(in srgb, #F59E0B 20%, transparent))
            `,border:"2px solid color-mix(in srgb, #F59E0B 40%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(h,{Icon:c.Lightbulb,size:20,style:{color:"#F59E0B"}})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-white font-bold text-xl",children:"Insights Énergétiques"}),e.jsxs("p",{className:"text-orange-200 text-sm",children:["Analyses et conseils sur ",Bt(s)]})]})]}),e.jsx(F,{className:"p-6",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #10B981 8%, transparent) 0%, transparent 60%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, #10B981 20%, transparent)"},children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400 mb-1",children:r.total_activities}),e.jsx("div",{className:"text-green-300 text-sm font-medium",children:"Activités"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Total"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400 mb-1",children:r.total_calories}),e.jsx("div",{className:"text-blue-300 text-sm font-medium",children:"Calories"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Brûlées"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-cyan-400 mb-1",children:r.total_duration}),e.jsx("div",{className:"text-cyan-300 text-sm font-medium",children:"Minutes"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Actives"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-400 mb-1",children:r.consistency_score}),e.jsx("div",{className:"text-purple-300 text-sm font-medium",children:"Régularité"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Score"})]})]})}),e.jsx("div",{className:"space-y-4",children:t.map((a,p)=>e.jsx(D.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:p*.1},children:e.jsx(F,{className:"p-5",style:{background:`
                  radial-gradient(circle at 30% 20%, color-mix(in srgb, ${a.color} 8%, transparent) 0%, transparent 60%),
                  var(--glass-opacity)
                `,borderColor:`color-mix(in srgb, ${a.color} 20%, transparent)`,boxShadow:a.priority==="high"?`
                  0 8px 32px rgba(0, 0, 0, 0.2),
                  0 0 20px color-mix(in srgb, ${a.color} 15%, transparent)
                `:void 0},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`color-mix(in srgb, ${a.color} 20%, transparent)`,border:`1px solid color-mix(in srgb, ${a.color} 30%, transparent)`},children:e.jsx(h,{Icon:c[Et(a.icon)],size:14,style:{color:a.color}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h4",{className:"text-white font-medium text-sm flex items-center gap-2",children:[a.title,a.priority==="high"&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-400 animate-pulse"})]}),a.confidence&&e.jsxs("span",{className:"text-xs text-white/50",children:[Math.round(a.confidence*100),"% confiance"]})]}),e.jsx("p",{className:"text-white/80 text-sm leading-relaxed mb-3",children:a.content}),a.actionable&&a.action&&e.jsxs("div",{className:"mt-3 p-3 rounded-lg",style:{background:`color-mix(in srgb, ${a.color} 6%, transparent)`,border:`1px solid color-mix(in srgb, ${a.color} 15%, transparent)`},children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{Icon:c.Target,size:12,style:{color:a.color}}),e.jsx("span",{className:"text-sm font-medium",style:{color:a.color},children:"Action suggérée :"})]}),e.jsx("p",{className:"text-xs mt-1 text-white/70",children:a.action})]})]})]})})},p))}),e.jsx(F,{className:"p-6 text-center",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-activity-secondary) 8%, transparent) 0%, transparent 60%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, var(--color-activity-secondary) 20%, transparent)"},children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx(h,{Icon:c.Info,size:16,style:{color:"var(--color-activity-secondary)"}}),e.jsx("p",{className:"text-white/70 text-sm",children:"Continuez à enregistrer vos activités pour des insights encore plus précis et personnalisés"})]})})]});function St(t){switch(t){case"week":return"7 jours";case"month":return"30 jours";case"quarter":return"90 jours";default:return"30 jours"}}const ye=({globalStats:t,period:r,apiPeriod:s})=>{const i=Q();if(!t)return e.jsx(F,{className:"p-6",style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #6B7280 8%, transparent) 0%, transparent 60%),
          var(--glass-opacity)
        `,borderColor:"color-mix(in srgb, #6B7280 20%, transparent)"},children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #F59E0B 20%, transparent), color-mix(in srgb, #F59E0B 10%, transparent))",border:"1px solid color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(h,{Icon:c.BarChart3,size:32,style:{color:"#F59E0B"}})}),e.jsx("p",{className:"text-white/70 text-sm",children:"Aucune donnée disponible pour cette période"})]})});const a=St(r);return e.jsx($,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:i.transitionDuration},fallback:e.jsx("div",{children:e.jsxs(F,{className:"p-6",style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #F59E0B 12%, transparent) 0%, transparent 60%),
          radial-gradient(circle at 70% 80%, color-mix(in srgb, #F59E0B 8%, transparent) 0%, transparent 50%),
          var(--glass-opacity)
        `,borderColor:"color-mix(in srgb, #F59E0B 25%, transparent)",boxShadow:`
          0 12px 40px rgba(0, 0, 0, 0.25),
          0 0 30px color-mix(in srgb, #F59E0B 15%, transparent),
          inset 0 2px 0 rgba(255, 255, 255, 0.15)
        `},children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-white font-semibold flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #F59E0B 35%, transparent), color-mix(in srgb, #F59E0B 25%, transparent))
                `,border:"2px solid color-mix(in srgb, #F59E0B 50%, transparent)",boxShadow:"0 0 30px color-mix(in srgb, #F59E0B 40%, transparent)"},children:e.jsx(h,{Icon:c.BarChart3,size:24,style:{color:"#F59E0B"},variant:"pure"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-xl",children:["Forge Énergétique - ",a]}),e.jsx("div",{className:"text-white/60 text-sm font-normal mt-0.5",children:"Vos métriques de performance"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-400"}),e.jsx("span",{className:"text-orange-300 text-sm font-medium",children:"Période Active"})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4"}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 rounded-xl bg-white/5 border border-white/10",children:[e.jsx("div",{className:"text-lg font-bold text-white mb-1",children:t.avg_daily_calories}),e.jsx("div",{className:"text-white/70 text-sm",children:"Calories/jour"})]}),e.jsxs("div",{className:"text-center p-4 rounded-xl bg-white/5 border border-white/10",children:[e.jsx("div",{className:"text-lg font-bold text-white mb-1 capitalize",children:t.most_frequent_type||"Aucun"}),e.jsx("div",{className:"text-white/70 text-sm",children:"Type Principal"})]}),e.jsxs("div",{className:"text-center p-4 rounded-xl bg-white/5 border border-white/10",children:[e.jsx("div",{className:"text-lg font-bold text-white mb-1 capitalize",children:t.avg_intensity==="low"?"Faible":t.avg_intensity==="medium"?"Modérée":t.avg_intensity==="high"?"Intense":t.avg_intensity==="very_high"?"Très Intense":"Modérée"}),e.jsx("div",{className:"text-white/70 text-sm",children:"Intensité Moy."})]})]})]})}),children:e.jsxs(F,{className:"p-6",style:{background:`
          radial-gradient(circle at 30% 20%, color-mix(in srgb, #F59E0B 12%, transparent) 0%, transparent 60%),
          radial-gradient(circle at 70% 80%, color-mix(in srgb, #F59E0B 8%, transparent) 0%, transparent 50%),
          var(--glass-opacity)
        `,borderColor:"color-mix(in srgb, #F59E0B 25%, transparent)",boxShadow:`
          0 12px 40px rgba(0, 0, 0, 0.25),
          0 0 30px color-mix(in srgb, #F59E0B 15%, transparent),
          inset 0 2px 0 rgba(255, 255, 255, 0.15)
        `},children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-white font-semibold flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #F59E0B 35%, transparent), color-mix(in srgb, #F59E0B 25%, transparent))
                `,border:"2px solid color-mix(in srgb, #F59E0B 50%, transparent)",boxShadow:"0 0 30px color-mix(in srgb, #F59E0B 40%, transparent)"},children:e.jsx(h,{Icon:c.BarChart3,size:24,style:{color:"#F59E0B"},variant:"pure"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-xl",children:["Forge Énergétique - ",a]}),e.jsx("div",{className:"text-white/60 text-sm font-normal mt-0.5",children:"Vos métriques de performance"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-400"}),e.jsx("span",{className:"text-orange-300 text-sm font-medium",children:"Période Active"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs($,{className:"text-center p-4 rounded-xl",style:{background:"color-mix(in srgb, #3B82F6 10%, transparent)",border:"1px solid color-mix(in srgb, #3B82F6 20%, transparent)"},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:i.transitionDuration,delay:i.staggerDelay},fallback:e.jsxs("div",{className:"text-center p-4 rounded-xl",style:{background:"color-mix(in srgb, #3B82F6 10%, transparent)",border:"1px solid color-mix(in srgb, #3B82F6 20%, transparent)"},children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400 mb-1",children:t.total_activities}),e.jsx("div",{className:"text-blue-300 text-sm font-medium",children:"Activités"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Enregistrées"})]}),children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400 mb-1",children:t.total_activities}),e.jsx("div",{className:"text-blue-300 text-sm font-medium",children:"Activités"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Enregistrées"})]}),e.jsxs($,{className:"text-center p-4 rounded-xl",style:{background:"color-mix(in srgb, #EF4444 10%, transparent)",border:"1px solid color-mix(in srgb, #EF4444 20%, transparent)"},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:i.transitionDuration,delay:i.staggerDelay*2},fallback:e.jsxs("div",{className:"text-center p-4 rounded-xl",style:{background:"color-mix(in srgb, #EF4444 10%, transparent)",border:"1px solid color-mix(in srgb, #EF4444 20%, transparent)"},children:[e.jsx("div",{className:"text-2xl font-bold text-red-400 mb-1",children:t.total_calories}),e.jsx("div",{className:"text-red-300 text-sm font-medium",children:"Calories"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Brûlées"})]}),children:[e.jsx("div",{className:"text-2xl font-bold text-red-400 mb-1",children:t.total_calories}),e.jsx("div",{className:"text-red-300 text-sm font-medium",children:"Calories"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Brûlées"})]}),e.jsxs($,{className:"text-center p-4 rounded-xl",style:{background:"color-mix(in srgb, #10B981 10%, transparent)",border:"1px solid color-mix(in srgb, #10B981 20%, transparent)"},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:i.transitionDuration,delay:i.staggerDelay*3},fallback:e.jsxs("div",{className:"text-center p-4 rounded-xl",style:{background:"color-mix(in srgb, #10B981 10%, transparent)",border:"1px solid color-mix(in srgb, #10B981 20%, transparent)"},children:[e.jsx("div",{className:"text-2xl font-bold text-green-400 mb-1",children:t.total_duration}),e.jsx("div",{className:"text-green-300 text-sm font-medium",children:"Minutes"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Actives"})]}),children:[e.jsx("div",{className:"text-2xl font-bold text-green-400 mb-1",children:t.total_duration}),e.jsx("div",{className:"text-green-300 text-sm font-medium",children:"Minutes"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Actives"})]}),e.jsxs($,{className:"text-center p-4 rounded-xl",style:{background:"color-mix(in srgb, #8B5CF6 10%, transparent)",border:"1px solid color-mix(in srgb, #8B5CF6 20%, transparent)"},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:i.transitionDuration,delay:i.staggerDelay*4},fallback:e.jsxs("div",{className:"text-center p-4 rounded-xl",style:{background:"color-mix(in srgb, #8B5CF6 10%, transparent)",border:"1px solid color-mix(in srgb, #8B5CF6 20%, transparent)"},children:[e.jsx("div",{className:"text-2xl font-bold text-purple-400 mb-1",children:t.consistency_score}),e.jsx("div",{className:"text-purple-300 text-sm font-medium",children:"Régularité"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Score"})]}),children:[e.jsx("div",{className:"text-2xl font-bold text-purple-400 mb-1",children:t.consistency_score}),e.jsx("div",{className:"text-purple-300 text-sm font-medium",children:"Régularité"}),e.jsx("div",{className:"text-white/50 text-xs mt-1",children:"Score"})]})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 rounded-xl bg-white/5 border border-white/10",children:[e.jsx("div",{className:"text-lg font-bold text-white mb-1",children:t.avg_daily_calories}),e.jsx("div",{className:"text-white/70 text-sm",children:"Calories/jour"})]}),e.jsxs("div",{className:"text-center p-4 rounded-xl bg-white/5 border border-white/10",children:[e.jsx("div",{className:"text-lg font-bold text-white mb-1 capitalize",children:t.most_frequent_type||"Aucun"}),e.jsx("div",{className:"text-white/70 text-sm",children:"Type Principal"})]}),e.jsxs("div",{className:"text-center p-4 rounded-xl bg-white/5 border border-white/10",children:[e.jsx("div",{className:"text-lg font-bold text-white mb-1 capitalize",children:t.avg_intensity==="low"?"Faible":t.avg_intensity==="medium"?"Modérée":t.avg_intensity==="high"?"Intense":t.avg_intensity==="very_high"?"Très Intense":"Modérée"}),e.jsx("div",{className:"text-white/70 text-sm",children:"Intensité Moy."})]})]})]})})};function oe(t){switch(t){case"week":return"7 derniers jours";case"month":return"30 derniers jours";case"quarter":return"90 derniers jours";default:return""}}function le(t){switch(t){case"week":return"Semaine";case"month":return"Mois";case"quarter":return"Trimestre";default:return""}}const X=({selectedPeriod:t,onPeriodChange:r,currentActivities:s,periodThresholds:i,accentColor:a="#10B981"})=>{const{click:p}=Z();T.useEffect(()=>{_.info("PROGRESSION_PERIOD_SELECTOR_DIAGNOSTIC","Component state debug",{selectedPeriod:t,currentActivities:s,periodThresholds:i,componentRenderTime:new Date().toISOString(),propsReceived:{selectedPeriod:t,currentActivities:s,periodThresholds:i},timestamp:new Date().toISOString()})},[t,s,i]);const x=[{value:"week",label:le("week"),fullLabel:oe("week"),icon:c.Calendar,threshold:i.week},{value:"month",label:le("month"),fullLabel:oe("month"),icon:c.CalendarDays,threshold:i.month},{value:"quarter",label:le("quarter"),fullLabel:oe("quarter"),icon:c.CalendarRange,threshold:i.quarter}],o=n=>{const u=s>=n;return _.debug("PROGRESSION_PERIOD_SELECTOR_DIAGNOSTIC","Period availability check",{currentActivities:s,threshold:n,available:u,calculation:`${s} >= ${n} = ${u}`,timestamp:new Date().toISOString()}),u};return e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"inline-flex gap-2 p-1 rounded-lg",style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",backdropFilter:"blur(10px)"},children:x.map(n=>{const u=o(n.threshold),d=t===n.value;return _.debug("PROGRESSION_PERIOD_SELECTOR_DIAGNOSTIC","Period button render state",{periodValue:n.value,periodLabel:n.label,periodThreshold:n.threshold,currentActivities:s,isAvailable:u,isSelected:d,willShowLock:!u,willBeDisabled:!u,calculation:`${s} >= ${n.threshold} = ${u}`,renderTime:new Date().toISOString(),timestamp:new Date().toISOString()}),_.debug("PROGRESSION_PERIOD_SELECTOR","Period button state",{periodValue:n.value,periodThreshold:n.threshold,isAvailable:u,isSelected:d,currentActivities:s,timestamp:new Date().toISOString()}),e.jsx("button",{onClick:()=>{u?(p(),r(n.value),_.info("PROGRESSION_PERIOD_SELECTOR_DIAGNOSTIC","Period changed",{newPeriod:n.value,wasAvailable:u,currentActivities:s,threshold:n.threshold,timestamp:new Date().toISOString()})):_.warn("PROGRESSION_PERIOD_SELECTOR_DIAGNOSTIC","Attempted to select unavailable period",{period:n.value,currentActivities:s,requiredActivities:n.threshold,missingActivities:n.threshold-s,timestamp:new Date().toISOString()})},disabled:!u,className:"px-6 py-2.5 rounded-lg text-sm font-medium transition-all duration-200",style:{background:d?`${a}33`:"transparent",color:d?a:u?"rgba(255, 255, 255, 0.7)":"rgba(255, 255, 255, 0.4)",border:d?`1px solid ${a}66`:"1px solid transparent",boxShadow:d?`0 0 20px ${a}4D`:"none",opacity:u?1:.5,cursor:u?"pointer":"not-allowed"},children:n.value==="week"?"7 jours":n.value==="month"?"30 jours":"90 jours"},n.value)})})})};class At{async analyzeHRPerformanceCorrelation(r,s=30){try{const i=new Date;i.setDate(i.getDate()-s);const{data:a,error:p}=await H.from("activities").select("hr_avg, avg_pace, avg_power_watts, avg_cadence_rpm, efficiency_score").eq("user_id",r).gte("timestamp",i.toISOString()).not("hr_avg","is",null).order("timestamp",{ascending:!0});if(p)throw p;if(!a||a.length===0)return null;const x=a.filter(y=>y.hr_avg&&y.efficiency_score);if(x.length<5)return null;const o=x.reduce((y,f)=>y+(f.hr_avg||0),0)/x.length,n=this.calculateAverage(x.map(y=>y.avg_pace)),u=this.calculateAverage(x.map(y=>y.avg_power_watts)),d=this.calculateAverage(x.map(y=>y.avg_cadence_rpm)),m=x.reduce((y,f)=>y+(f.efficiency_score||0),0)/x.length,v=x.slice(-10),l=x.slice(0,10),g=v.reduce((y,f)=>y+(f.efficiency_score||0),0)/v.length,j=l.reduce((y,f)=>y+(f.efficiency_score||0),0)/l.length;let b;const C=g-j;return C>5?b="improving":C<-5?b="declining":b="stable",{avgHeartRate:o,avgPace:n,avgPower:u,avgCadence:d,efficiency:m,trend:b}}catch(i){throw _.error("BIOMETRIC_ANALYSIS","Failed to analyze HR/Performance correlation",{error:i,userId:r}),i}}async detectOvertraining(r){try{const s=new Date;s.setDate(s.getDate()-7);const i=new Date;i.setDate(i.getDate()-30);const{data:a,error:p}=await H.from("activities").select("hrv_pre_activity, recovery_score, hr_resting_pre, sleep_quality_score, stress_level_pre, training_load_score").eq("user_id",r).gte("timestamp",s.toISOString()).not("hrv_pre_activity","is",null),{data:x,error:o}=await H.from("activities").select("hrv_pre_activity, recovery_score, hr_resting_pre").eq("user_id",r).gte("timestamp",i.toISOString()).lt("timestamp",s.toISOString()).not("hrv_pre_activity","is",null);if(p||o)throw p||o;if(!a||a.length===0)return{severity:"none",indicators:["Données insuffisantes pour analyser le surentraînement"],hrvTrend:"stable",recommendations:["Connectez un objet pour suivre votre récupération"],score:0};const n=[];let u=0;const d=a.reduce((w,k)=>w+(k.hrv_pre_activity||0),0)/a.length,m=x&&x.length>0?x.reduce((w,k)=>w+(k.hrv_pre_activity||0),0)/x.length:d,v=(d-m)/m*100;let l;v<-10?(n.push("HRV en baisse significative (-"+Math.abs(v).toFixed(1)+"%)"),u+=30,l="declining"):v>10?l="improving":l="stable";const g=a.reduce((w,k)=>w+(k.recovery_score||0),0)/a.length;g<50&&(n.push("Score de récupération faible ("+g.toFixed(0)+"%)"),u+=25);const j=a.reduce((w,k)=>w+(k.hr_resting_pre||0),0)/a.length,b=x&&x.length>0?x.reduce((w,k)=>w+(k.hr_resting_pre||0),0)/x.length:j;j>b+5&&(n.push("Fréquence cardiaque au repos élevée (+"+(j-b).toFixed(0)+" bpm)"),u+=20);const C=a.reduce((w,k)=>w+(k.sleep_quality_score||0),0)/a.length;C>0&&C<60&&(n.push("Qualité de sommeil dégradée ("+C.toFixed(0)+"%)"),u+=15);const y=a.reduce((w,k)=>w+(k.stress_level_pre||0),0)/a.length;y>70&&(n.push("Niveau de stress élevé ("+y.toFixed(0)+"%)"),u+=10);let f;const N=[];return u>=60?(f="high",N.push("Repos complet recommandé pendant 3-5 jours"),N.push("Consultez un professionnel de santé si les symptômes persistent"),N.push("Évitez tout entraînement intense")):u>=40?(f="moderate",N.push("Réduisez l'intensité d'entraînement de 50%"),N.push("Privilégiez la récupération active (marche, yoga, étirements)"),N.push("Assurez-vous de dormir 8h+ par nuit")):u>=20?(f="low",N.push("Intégrez une journée de repos supplémentaire cette semaine"),N.push("Surveillez votre récupération de près"),N.push("Évitez d'augmenter votre charge d'entraînement")):(f="none",N.push("Votre récupération est bonne, continuez ainsi"),N.push("Maintenez une progression progressive")),n.length===0&&n.push("Aucun signe de surentraînement détecté"),{severity:f,indicators:n,hrvTrend:l,recommendations:N,score:u}}catch(s){throw _.error("BIOMETRIC_ANALYSIS","Failed to detect overtraining",{error:s,userId:r}),s}}async findOptimalTrainingWindows(r,s=60){try{const i=new Date;i.setDate(i.getDate()-s);const{data:a,error:p}=await H.from("activities").select("timestamp, efficiency_score, recovery_score, avg_power_watts, avg_pace").eq("user_id",r).gte("timestamp",i.toISOString()).not("efficiency_score","is",null);if(p)throw p;if(!a||a.length<10)return[];const x={morning:{performances:[],recoveries:[],count:0},afternoon:{performances:[],recoveries:[],count:0},evening:{performances:[],recoveries:[],count:0}};a.forEach(n=>{const u=new Date(n.timestamp).getHours();let d;u>=5&&u<12?d="morning":u>=12&&u<18?d="afternoon":d="evening",x[d].performances.push(n.efficiency_score||0),x[d].recoveries.push(n.recovery_score||0),x[d].count++});const o=[];for(const[n,u]of Object.entries(x)){if(u.count<3)continue;const d=u.performances.reduce((g,j)=>g+j,0)/u.performances.length,m=u.recoveries.reduce((g,j)=>g+j,0)/u.recoveries.length,v=Math.min(u.count/10,1);let l="";d>75&&m>70?l="Fenêtre optimale pour entraînements intensifs":d>60?l="Bon moment pour entraînements modérés":l="Privilégier récupération active ou repos",o.push({timeOfDay:n,avgPerformance:d,avgRecovery:m,recommendation:l,confidence:v})}return o.sort((n,u)=>u.avgPerformance-n.avgPerformance)}catch(i){throw _.error("BIOMETRIC_ANALYSIS","Failed to find optimal training windows",{error:i,userId:r}),i}}calculateAverage(r){const s=r.filter(i=>i!=null);if(s.length!==0)return s.reduce((i,a)=>i+a,0)/s.length}}const ce=new At,Tt=({period:t})=>{const{profile:r}=L(),[s,i]=T.useState(null),[a,p]=T.useState(null),[x,o]=T.useState([]),[n,u]=T.useState([]),[d,m]=T.useState(!0),v=t==="week"?7:t==="month"?30:90;if(T.useEffect(()=>{(async()=>{if(r?.id)try{m(!0),_.info("BIOMETRIC_INSIGHTS","Fetching biometric insights",{userId:r.id,period:t});const[f,N,w,k]=await Promise.all([ce.analyzeHRPerformanceCorrelation(r.id,v),ce.detectOvertraining(r.id),ce.findOptimalTrainingWindows(r.id,v*2),Promise.resolve([])]);i(f),p(N),o(w),u(k),_.info("BIOMETRIC_INSIGHTS","Biometric insights fetched successfully",{hasCorrelation:!!f,overtrainingSeverity:N?.severity,windowsCount:w?.length})}catch(f){_.error("BIOMETRIC_INSIGHTS","Failed to fetch biometric insights",{error:f})}finally{m(!1)}})()},[r?.id,v,t]),d)return e.jsx("div",{className:"space-y-4",children:[1,2,3].map(y=>e.jsx("div",{className:"h-48 rounded-2xl animate-pulse",style:{background:"linear-gradient(145deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02))"}},y))});if(!(s||a&&a.severity!=="none"||x.length>0))return e.jsxs(F,{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #F59E0B 20%, transparent), color-mix(in srgb, #F59E0B 10%, transparent))",border:"1px solid color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(h,{Icon:c.Activity,size:32,style:{color:"#F59E0B"}})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Insights Biométriques"}),e.jsx("p",{className:"text-white/70 text-base max-w-md mx-auto leading-relaxed",children:"Connectez un objet et enregistrez des activités avec données biométriques pour débloquer des analyses avancées de corrélation FC/Performance, détection de surentraînement et fenêtres optimales."})]});const g={none:{primary:"#22C55E",secondary:"#10B981"},low:{primary:"#F59E0B",secondary:"#D97706"},moderate:{primary:"#F97316",secondary:"#EA580C"},high:{primary:"#EF4444",secondary:"#DC2626"}},j={improving:{primary:"#22C55E",secondary:"#10B981",icon:c.TrendingUp},stable:{primary:"#3B82F6",secondary:"#2563EB",icon:c.Minus},declining:{primary:"#EF4444",secondary:"#DC2626",icon:c.TrendingDown}},b={morning:"Matin",afternoon:"Après-midi",evening:"Soir"},C={morning:c.Sunrise,afternoon:c.Sun,evening:c.Moon};return e.jsxs("div",{className:"space-y-6",children:[s&&e.jsxs(F,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`linear-gradient(135deg, color-mix(in srgb, ${j[s.trend].primary} 25%, transparent), color-mix(in srgb, ${j[s.trend].secondary} 15%, transparent))`,border:`1px solid color-mix(in srgb, ${j[s.trend].primary} 35%, transparent)`,boxShadow:`0 0 20px color-mix(in srgb, ${j[s.trend].primary} 20%, transparent)`},children:e.jsx(h,{Icon:c.Activity,size:24,style:{color:j[s.trend].primary}})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Corrélation FC / Performance"}),e.jsxs("div",{className:"px-3 py-1 rounded-full text-xs font-semibold flex items-center gap-1.5",style:{background:`color-mix(in srgb, ${j[s.trend].primary} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${j[s.trend].primary} 25%, transparent)`,color:j[s.trend].primary},children:[e.jsx(h,{Icon:j[s.trend].icon,size:12}),s.trend==="improving"&&"En amélioration",s.trend==="stable"&&"Stable",s.trend==="declining"&&"En baisse"]})]}),e.jsxs("p",{className:"text-white/70 text-sm",children:["Analyse de l'efficacité cardiovasculaire sur les ",v," derniers jours"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-xl",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(h,{Icon:c.Heart,size:14,style:{color:"#EF4444"}}),e.jsx("span",{className:"text-white/60 text-xs font-medium",children:"Fréquence Cardiaque Moyenne"})]}),e.jsxs("p",{className:"text-2xl font-bold text-white",children:[s.avgHeartRate.toFixed(0)," bpm"]})]}),e.jsxs("div",{className:"p-4 rounded-xl",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(h,{Icon:c.Target,size:14,style:{color:"#3B82F6"}}),e.jsx("span",{className:"text-white/60 text-xs font-medium",children:"Score d'Efficacité"})]}),e.jsxs("p",{className:"text-2xl font-bold text-white",children:[s.efficiency.toFixed(0),"%"]})]}),s.avgPace&&e.jsxs("div",{className:"p-4 rounded-xl",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(h,{Icon:c.Zap,size:14,style:{color:"#F59E0B"}}),e.jsx("span",{className:"text-white/60 text-xs font-medium",children:"Allure Moyenne"})]}),e.jsxs("p",{className:"text-2xl font-bold text-white",children:[s.avgPace.toFixed(1)," min/km"]})]}),s.avgPower&&e.jsxs("div",{className:"p-4 rounded-xl",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(h,{Icon:c.Zap,size:14,style:{color:"#8B5CF6"}}),e.jsx("span",{className:"text-white/60 text-xs font-medium",children:"Puissance Moyenne"})]}),e.jsxs("p",{className:"text-2xl font-bold text-white",children:[s.avgPower.toFixed(0)," W"]})]})]})]}),a&&a.severity!=="none"&&e.jsxs(F,{className:"p-6",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, ${g[a.severity].primary} 12%, transparent) 0%, transparent 60%),
              var(--glass-opacity)
            `,borderColor:`color-mix(in srgb, ${g[a.severity].primary} 30%, transparent)`,boxShadow:`0 0 24px color-mix(in srgb, ${g[a.severity].primary} 15%, transparent)`},children:[e.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`linear-gradient(135deg, color-mix(in srgb, ${g[a.severity].primary} 25%, transparent), color-mix(in srgb, ${g[a.severity].secondary} 15%, transparent))`,border:`1px solid color-mix(in srgb, ${g[a.severity].primary} 35%, transparent)`,boxShadow:`0 0 20px color-mix(in srgb, ${g[a.severity].primary} 25%, transparent)`},children:e.jsx(h,{Icon:c.AlertTriangle,size:24,style:{color:g[a.severity].primary}})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Détection Surentraînement"}),e.jsxs("div",{className:"px-3 py-1 rounded-full text-xs font-semibold",style:{background:`color-mix(in srgb, ${g[a.severity].primary} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${g[a.severity].primary} 25%, transparent)`,color:g[a.severity].primary},children:[a.severity==="low"&&"Vigilance",a.severity==="moderate"&&"Attention",a.severity==="high"&&"Alerte"]})]}),e.jsxs("p",{className:"text-white/70 text-sm",children:["Score de risque: ",a.score,"/100"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white font-semibold text-sm mb-3 flex items-center gap-2",children:[e.jsx(h,{Icon:c.AlertCircle,size:14}),"Indicateurs détectés"]}),e.jsx("div",{className:"space-y-2",children:a.indicators.map((y,f)=>e.jsxs("div",{className:"flex items-start gap-2 p-3 rounded-lg",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsx("div",{className:"w-1 h-1 rounded-full mt-2",style:{background:g[a.severity].primary}}),e.jsx("span",{className:"text-white/80 text-sm",children:y})]},f))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white font-semibold text-sm mb-3 flex items-center gap-2",children:[e.jsx(h,{Icon:c.Lightbulb,size:14}),"Recommandations"]}),e.jsx("div",{className:"space-y-2",children:a.recommendations.map((y,f)=>e.jsxs("div",{className:"flex items-start gap-2 p-3 rounded-lg",style:{background:`color-mix(in srgb, ${g[a.severity].primary} 8%, transparent)`,border:`1px solid color-mix(in srgb, ${g[a.severity].primary} 15%, transparent)`},children:[e.jsx(h,{Icon:c.Check,size:14,style:{color:g[a.severity].primary,marginTop:2}}),e.jsx("span",{className:"text-white/90 text-sm",children:y})]},f))})]})]})]}),x.length>0&&e.jsxs(F,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:"linear-gradient(135deg, color-mix(in srgb, #8B5CF6 25%, transparent), color-mix(in srgb, #8B5CF6 15%, transparent))",border:"1px solid color-mix(in srgb, #8B5CF6 35%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #8B5CF6 20%, transparent)"},children:e.jsx(h,{Icon:c.Clock,size:24,style:{color:"#8B5CF6"}})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Fenêtres Optimales d'Entraînement"}),e.jsxs("p",{className:"text-white/70 text-sm",children:["Basé sur ",v*2," jours d'analyse de vos performances"]})]})]}),e.jsx("div",{className:"space-y-3",children:x.map((y,f)=>e.jsxs("div",{className:"p-4 rounded-xl",style:{background:f===0?"linear-gradient(135deg, color-mix(in srgb, #8B5CF6 12%, transparent), color-mix(in srgb, #8B5CF6 5%, transparent))":"rgba(255,255,255,0.05)",border:f===0?"1px solid color-mix(in srgb, #8B5CF6 25%, transparent)":"1px solid rgba(255,255,255,0.08)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(h,{Icon:C[y.timeOfDay],size:20,style:{color:"#8B5CF6"}}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-semibold text-base",children:b[y.timeOfDay]}),f===0&&e.jsx("span",{className:"text-purple-300 text-xs font-medium",children:"Meilleur créneau"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-white/50 text-xs",children:"Confiance"}),e.jsxs("p",{className:"text-white font-bold text-sm",children:[(y.confidence*100).toFixed(0),"%"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white/50 text-xs mb-1",children:"Performance"}),e.jsxs("p",{className:"text-white font-semibold",children:[y.avgPerformance.toFixed(0),"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/50 text-xs mb-1",children:"Récupération"}),e.jsxs("p",{className:"text-white font-semibold",children:[y.avgRecovery.toFixed(0),"%"]})]})]}),e.jsx("p",{className:"text-white/80 text-sm",children:y.recommendation})]},f))})]}),n.length>0&&e.jsxs(F,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:"linear-gradient(135deg, color-mix(in srgb, #10B981 25%, transparent), color-mix(in srgb, #10B981 15%, transparent))",border:"1px solid color-mix(in srgb, #10B981 35%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #10B981 20%, transparent)"},children:e.jsx(h,{Icon:c.Target,size:24,style:{color:"#10B981"}})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Recommandations basées sur vos Objectifs"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Insights personnalisés pour atteindre vos objectifs"})]})]}),e.jsx("div",{className:"space-y-4",children:n.map(y=>{const f=y.goal,N=f.deadline?Math.ceil((new Date(f.deadline).getTime()-new Date().getTime())/(1e3*60*60*24)):null,w=N&&N<=14&&y.progress_percentage<70,k=!y.on_track&&y.progress_percentage<100;return!w&&!k?null:e.jsxs("div",{className:"p-4 rounded-xl",style:{background:w?"linear-gradient(135deg, color-mix(in srgb, #F59E0B 12%, transparent), color-mix(in srgb, #F59E0B 5%, transparent))":"linear-gradient(135deg, color-mix(in srgb, #3B82F6 12%, transparent), color-mix(in srgb, #3B82F6 5%, transparent))",border:w?"1px solid color-mix(in srgb, #F59E0B 25%, transparent)":"1px solid color-mix(in srgb, #3B82F6 25%, transparent)"},children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx(h,{Icon:w?c.AlertTriangle:c.Info,size:20,style:{color:w?"#F59E0B":"#3B82F6",marginTop:2}}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-white font-semibold text-base mb-1",children:f.title}),e.jsx("p",{className:"text-white/80 text-sm leading-relaxed",children:w?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Action urgente :"})," Il vous reste ",N," jours pour atteindre cet objectif. Vous êtes à ",y.progress_percentage.toFixed(0),"% de complétion.",f.goal_type==="volume"&&" Augmentez votre fréquence d'entraînement de 20% cette semaine.",f.goal_type==="distance"&&" Privilégiez des séances plus longues pour maximiser la distance parcourue.",f.goal_type==="endurance"&&" Intégrez 2 séances d'interval training haute intensité cette semaine."]}):k?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Ajustez votre stratégie :"})," Vous êtes légèrement en retard sur cet objectif. Basé sur vos performances biométriques, ",s&&s.trend==="improving"?"vous êtes en phase d'amélioration. Maintenez le cap avec une progression constante.":"assurez-vous de bien récupérer entre les séances pour optimiser vos performances."]}):null}),y.estimated_completion_date&&N&&N>0&&e.jsxs("p",{className:"text-white/60 text-xs mt-2",children:["Estimation d'achèvement: ",new Date(y.estimated_completion_date).toLocaleDateString("fr-FR",{day:"numeric",month:"long"})]})]})]}),x.length>0&&w&&e.jsxs("div",{className:"mt-3 p-3 rounded-lg",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsx("p",{className:"text-white/70 text-xs mb-1",children:"💡 Fenêtre optimale recommandée"}),e.jsxs("p",{className:"text-white text-sm font-medium",children:[x[0].timeOfDay==="morning"&&"Matin",x[0].timeOfDay==="afternoon"&&"Après-midi",x[0].timeOfDay==="evening"&&"Soir"," ","pour maximiser vos performances et atteindre votre objectif plus rapidement"]})]})]},f.id)})})]})]})},fe={week:"last7Days",month:"last30Days",quarter:"last3Months"},Dt=()=>{const{profile:t}=L(),{showToast:r}=se(),{click:s}=Z(),{showModal:i}=Fe(),a=ie(y=>y.selectedPeriod),p=ie(y=>y.setSelectedPeriod),x=fe[a],[o,n]=T.useState(0),{data:u=!1}=Te(),{data:d,isLoading:m,error:v}=Ee(x),l=Ce(({currentLocation:y,nextLocation:f})=>{const N=m&&y.pathname!==f.pathname;return N&&(_.info("ACTIVITY_INSIGHTS_TAB","Navigation blocked during analysis loading",{currentPath:y.pathname,nextPath:f.pathname,isLoading:m,timestamp:new Date().toISOString()}),i({title:"Attention ! Analyse d'insights en cours",message:"Voulez-vous vraiment quitter l'analyse ? Les insights pourraient être perdus et devront être régénérés.",processName:"Analyse d'Insights",onConfirm:()=>{_.info("ACTIVITY_INSIGHTS_TAB","User confirmed exit during analysis",{currentPath:y.pathname,nextPath:f.pathname,timestamp:new Date().toISOString()}),l.proceed?.()},onCancel:()=>{_.info("ACTIVITY_INSIGHTS_TAB","User cancelled exit during analysis",{currentPath:y.pathname,nextPath:f.pathname,timestamp:new Date().toISOString()}),l.reset?.()}})),N});T.useEffect(()=>{d?.current_activities!==void 0&&n(d.current_activities)},[d?.current_activities]),T.useEffect(()=>{v&&(_.error("ACTIVITY_INSIGHTS_TAB","Erreur lors de la génération des insights",{error:v instanceof Error?v.message:"Unknown error",selectedPeriod:a,timestamp:new Date().toISOString()}),r({type:"error",title:"Erreur d'analyse",message:"Impossible de générer les insights. Veuillez réessayer.",duration:4e3}))},[v,a,r]);const g=y=>{s(),p(y),_.info("ACTIVITY_INSIGHTS_TAB","Period changed by user",{newPeriod:y,apiPeriod:fe[y],timestamp:new Date().toISOString()})},j={week:Y("last7Days"),month:Y("last30Days"),quarter:Y("last3Months")},b=d?.fallback,C=d?.cached;return u?d?.insufficient_data?e.jsxs("div",{className:"space-y-6",children:[e.jsx(X,{selectedPeriod:a,onPeriodChange:g,currentActivities:o,periodThresholds:j,accentColor:"#F59E0B"}),e.jsxs(F,{className:"p-8 text-center",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #F59E0B 15%, transparent) 0%, transparent 60%),
              radial-gradient(circle at 70% 80%, color-mix(in srgb, #EF4444 12%, transparent) 0%, transparent 50%),
              linear-gradient(145deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, #F59E0B 30%, transparent)",boxShadow:`
              0 12px 40px rgba(0, 0, 0, 0.25),
              0 0 30px color-mix(in srgb, #F59E0B 20%, transparent),
              inset 0 2px 0 rgba(255, 255, 255, 0.15)
            `},children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6",children:[e.jsx("div",{className:"w-20 h-20 rounded-full flex items-center justify-center breathing-icon",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #F59E0B 30%, transparent), color-mix(in srgb, #F59E0B 20%, transparent))
                `,border:"2px solid color-mix(in srgb, #F59E0B 40%, transparent)",boxShadow:"0 0 30px color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(h,{Icon:c.AlertCircle,size:40,style:{color:"#F59E0B"}})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-2xl font-bold text-white",children:"Insights en Construction"}),e.jsx("p",{className:"text-white/70 text-base",children:"Plus d'activités nécessaires"})]})]}),e.jsxs("div",{className:"space-y-4 max-w-lg mx-auto",children:[e.jsxs("p",{className:"text-white/80 text-lg leading-relaxed",children:["Vous avez ",e.jsx("strong",{className:"text-orange-300",children:d.current_activities})," activité",d.current_activities>1?"s":""," enregistrée",d.current_activities>1?"s":"","."]}),e.jsxs("p",{className:"text-white/70 text-base leading-relaxed",children:["Il vous faut au moins ",e.jsx("strong",{className:"text-orange-300",children:d.required_activities})," activités pour générer des insights personnalisés sur cette période."]}),e.jsxs("div",{className:"mt-6 p-4 rounded-xl",style:{background:"color-mix(in srgb, #3B82F6 8%, transparent)",border:"1px solid color-mix(in srgb, #3B82F6 20%, transparent)"},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(h,{Icon:c.Zap,size:16,style:{color:"#3B82F6"}}),e.jsx("span",{className:"text-blue-300 font-semibold text-sm",children:"Passez à l'action !"})]}),e.jsxs("p",{className:"text-blue-200 text-sm leading-relaxed",children:["Enregistrez ",d.required_activities-d.current_activities," activité",d.required_activities-d.current_activities>1?"s":""," supplémentaire",d.required_activities-d.current_activities>1?"s":"","pour débloquer vos insights personnalisés et découvrir des recommandations sur mesure."]})]})]})]})]}):b&&d?e.jsxs("div",{className:"space-y-6",children:[e.jsx(X,{selectedPeriod:a,onPeriodChange:g,currentActivities:o,periodThresholds:j,accentColor:"#F59E0B"}),e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"text-amber-800 text-sm",children:"Analyse détaillée temporairement indisponible. Voici un résumé basique de vos activités."})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(ye,{globalStats:d?.summary,period:a,apiPeriod:x}),e.jsx(ve,{insights:d?.insights||[],summary:d?.summary,period:a,apiPeriod:x})]})]}):e.jsxs(D.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"space-y-6",children:[e.jsx(X,{selectedPeriod:a,onPeriodChange:g,currentActivities:o,periodThresholds:j,accentColor:"#F59E0B"}),C&&e.jsx(F,{className:"p-4",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #22C55E 8%, transparent) 0%, transparent 60%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, #22C55E 25%, transparent)",boxShadow:"0 0 16px color-mix(in srgb, #22C55E 15%, transparent)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"color-mix(in srgb, #22C55E 15%, transparent)",border:"1px solid color-mix(in srgb, #22C55E 25%, transparent)"},children:e.jsx(h,{Icon:c.Check,size:14,style:{color:"#22C55E"}})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-green-300 font-medium text-sm",children:"Données mises en cache"}),e.jsxs("p",{className:"text-green-200 text-xs mt-0.5",children:["Dernière analyse: ",d.cache_age_hours,"h • Économie de coûts IA"]})]})]})}),m?e.jsx(Me,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(ye,{globalStats:d?.summary,period:a,apiPeriod:x}),e.jsx(Tt,{period:a}),e.jsx(ve,{insights:d?.insights||[],summary:d?.summary,period:a,apiPeriod:x}),d&&(!d.insights||d.insights.length===0)&&e.jsxs(F,{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-6 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #F59E0B 20%, transparent), color-mix(in srgb, #F59E0B 10%, transparent))",border:"1px solid color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(h,{Icon:c.Info,size:32,style:{color:"#F59E0B"}})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Aucun Insight Généré"}),e.jsx("p",{className:"text-white/70 text-base mb-6 max-w-md mx-auto leading-relaxed",children:"Aucun insight n'a été généré pour cette période. Continuez à enregistrer vos activités pour enrichir l'analyse et débloquer des insights personnalisés."}),e.jsx("div",{className:"text-orange-300 text-sm",children:"Enregistrez plus d'activités pour des insights détaillés"})]})]})]}):e.jsx("div",{className:"space-y-6",children:e.jsxs(F,{className:"p-8 text-center",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #F59E0B 15%, transparent) 0%, transparent 60%),
              radial-gradient(circle at 70% 80%, color-mix(in srgb, #D97706 12%, transparent) 0%, transparent 50%),
              linear-gradient(145deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, #F59E0B 30%, transparent)",boxShadow:`
              0 12px 40px rgba(0, 0, 0, 0.25),
              0 0 30px color-mix(in srgb, #F59E0B 20%, transparent),
              inset 0 2px 0 rgba(255, 255, 255, 0.15)
            `},children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6",children:[e.jsx("div",{className:"w-20 h-20 rounded-full flex items-center justify-center",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #F59E0B 30%, transparent), color-mix(in srgb, #F59E0B 20%, transparent))
                `,border:"2px solid color-mix(in srgb, #F59E0B 40%, transparent)",boxShadow:"0 0 30px color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(h,{Icon:c.Lightbulb,size:40,style:{color:"#F59E0B"}})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-2xl font-bold text-white",children:"Forge d'Insights Vierge"}),e.jsx("p",{className:"text-white/70 text-base",children:"Vos conseils personnalisés vous attendent"})]})]}),e.jsxs("p",{className:"text-white/70 text-base max-w-lg mx-auto leading-relaxed",children:["Enregistrez au moins ",j.week," activités pour débloquer vos conseils personnalisés et découvrir des insights IA sur votre progression énergétique."]})]})})};function zt(t){switch(t){case"week":return"7 jours";case"month":return"30 jours";case"quarter":return"90 jours";default:return"30 jours"}}const je=({data:t,profile:r,period:s,apiPeriod:i})=>{const a=Q();if(!t||!t.activity_types||t.activity_types.length===0)return e.jsx("div",{className:"chart-enter-right",children:e.jsx(F,{className:"p-6",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-activity-primary) 8%, transparent) 0%, transparent 60%),
              radial-gradient(circle at 70% 80%, color-mix(in srgb, var(--color-activity-secondary) 6%, transparent) 0%, transparent 50%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, var(--color-activity-primary) 25%, transparent)",boxShadow:`
              0 8px 32px rgba(0, 0, 0, 0.2),
              0 0 20px color-mix(in srgb, var(--color-activity-primary) 10%, transparent),
              inset 0 1px 0 rgba(255, 255, 255, 0.12)
            `},children:e.jsxs("div",{className:"flex items-center justify-center gap-3 p-8",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #10B981 30%, transparent), color-mix(in srgb, #10B981 20%, transparent))
                `,border:"2px solid color-mix(in srgb, #10B981 40%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #10B981 30%, transparent)"},children:e.jsx(h,{Icon:c.BarChart3,size:20,style:{color:"#10B981"}})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-white font-bold text-xl mb-2",children:"Distribution Énergétique"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Données insuffisantes pour l'analyse"})]})]})})});const x=(()=>{if(!t?.activity_types||t.activity_types.length===0)return 0;const n=Math.min(100,t.activity_types.length/5*100),u=(t.intensity_levels||[]).reduce((d,m)=>{const l=Math.abs(m.percentage-25);return d+(25-Math.min(25,l))},0);return Math.round((n+u)/2)})(),o=x>=80?"#22C55E":x>=60?"#F59E0B":"#EF4444";return e.jsx("div",{className:"chart-enter-right",children:e.jsxs(F,{className:"p-6",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-activity-primary) 8%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, var(--color-activity-secondary) 6%, transparent) 0%, transparent 50%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, var(--color-activity-primary) 25%, transparent)",boxShadow:`
            0 8px 32px rgba(0, 0, 0, 0.2),
            0 0 20px color-mix(in srgb, var(--color-activity-primary) 10%, transparent),
            inset 0 1px 0 rgba(255, 255, 255, 0.12)
          `},children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #10B981 30%, transparent), color-mix(in srgb, #10B981 20%, transparent))
                `,border:"2px solid color-mix(in srgb, #10B981 40%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #10B981 30%, transparent)"},children:e.jsx(h,{Icon:c.BarChart3,size:20,style:{color:"#10B981"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-bold text-xl",children:"Distribution Énergétique"}),e.jsxs("p",{className:"text-white/70 text-sm",children:["Répartition de vos activités sur ",zt(s)]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:o,boxShadow:`0 0 8px color-mix(in srgb, ${o} 60%, transparent)`}}),e.jsx("span",{className:"text-white font-bold text-lg",children:x})]}),e.jsx("div",{className:"text-white/60 text-xs",children:"Score Équilibre"})]})]}),t.activity_types&&t.activity_types.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h4",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[e.jsx(h,{Icon:c.Target,size:16,style:{color:"#10B981"}}),"Types d'Activités"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:t.activity_types.slice(0,a.mode==="low"?3:a.mode==="medium"?5:t.activity_types.length).map((n,u)=>e.jsxs($,{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${n.color} 8%, transparent)`,border:`1px solid color-mix(in srgb, ${n.color} 20%, transparent)`},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:a.transitionDuration,delay:u*a.staggerDelay},fallback:e.jsxs("div",{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${n.color} 8%, transparent)`,border:`1px solid color-mix(in srgb, ${n.color} 20%, transparent)`},children:[e.jsx("div",{className:"flex items-center justify-center gap-1 mb-2",children:e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{background:`color-mix(in srgb, ${n.color} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${n.color} 25%, transparent)`},children:e.jsx(h,{Icon:c.Activity,size:12,style:{color:n.color}})})}),e.jsxs("div",{className:"text-lg font-bold",style:{color:n.color},children:[n.percentage,"%"]}),e.jsx("div",{className:"text-sm font-medium text-white",children:n.name}),e.jsxs("div",{className:"text-xs text-white/60 mt-1",children:[n.total_minutes," min • ",n.total_calories," kcal"]})]}),children:[e.jsx("div",{className:"flex items-center justify-center gap-1 mb-2",children:e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{background:`color-mix(in srgb, ${n.color} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${n.color} 25%, transparent)`},children:e.jsx(h,{Icon:c.Activity,size:12,style:{color:n.color}})})}),e.jsxs("div",{className:"text-lg font-bold",style:{color:n.color},children:[n.percentage,"%"]}),e.jsx("div",{className:"text-sm font-medium text-white",children:n.name}),e.jsxs("div",{className:"text-xs text-white/60 mt-1",children:[n.total_minutes," min • ",n.total_calories," kcal"]})]},n.name))})]}),t?.intensity_levels&&t.intensity_levels.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h4",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[e.jsx(h,{Icon:c.Zap,size:16,style:{color:"#10B981"}}),"Niveaux d'Intensité"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:t.intensity_levels.map((n,u)=>e.jsxs($,{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${n.color} 8%, transparent)`,border:`1px solid color-mix(in srgb, ${n.color} 20%, transparent)`},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:a.transitionDuration,delay:u*a.staggerDelay},fallback:e.jsxs("div",{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${n.color} 8%, transparent)`,border:`1px solid color-mix(in srgb, ${n.color} 20%, transparent)`},children:[e.jsxs("div",{className:"text-xl font-bold",style:{color:n.color},children:[n.percentage,"%"]}),e.jsx("div",{className:"text-sm font-medium text-white",children:n.level}),e.jsxs("div",{className:"text-xs text-white/60 mt-1",children:[n.sessions_count," sessions"]})]}),children:[e.jsxs("div",{className:"text-xl font-bold",style:{color:n.color},children:[n.percentage,"%"]}),e.jsx("div",{className:"text-sm font-medium text-white",children:n.level}),e.jsxs("div",{className:"text-xs text-white/60 mt-1",children:[n.sessions_count," sessions"]})]},n.level))})]}),t?.time_patterns&&t.time_patterns.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[e.jsx(h,{Icon:c.Clock,size:16,style:{color:"#10B981"}}),"Patterns Temporels"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:t.time_patterns.map((n,u)=>e.jsxs($,{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${n.color} 8%, transparent)`,border:`1px solid color-mix(in srgb, ${n.color} 20%, transparent)`},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:a.transitionDuration,delay:u*a.staggerDelay},fallback:e.jsxs("div",{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${n.color} 8%, transparent)`,border:`1px solid color-mix(in srgb, ${n.color} 20%, transparent)`},children:[e.jsx("div",{className:"text-lg font-bold",style:{color:n.color},children:n.activity_count}),e.jsx("div",{className:"text-sm font-medium text-white",children:n.period}),e.jsxs("div",{className:"text-xs text-white/60 mt-1",children:[n.avg_calories," kcal moy."]})]}),children:[e.jsx("div",{className:"text-lg font-bold",style:{color:n.color},children:n.activity_count}),e.jsx("div",{className:"text-sm font-medium text-white",children:n.period}),e.jsxs("div",{className:"text-xs text-white/60 mt-1",children:[n.avg_calories," kcal moy."]})]},n.period))})]}),e.jsx("div",{className:"mt-6 p-4 rounded-xl",style:{background:`color-mix(in srgb, ${o} 6%, transparent)`,border:`1px solid color-mix(in srgb, ${o} 18%, transparent)`,backdropFilter:"blur(8px) saturate(120%)"},children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(h,{Icon:x>=80?c.Check:x>=60?c.Info:c.AlertCircle,size:14,style:{color:o},className:"mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",style:{color:o},children:x>=80?"Excellent équilibre énergétique":x>=60?"Bon équilibre, quelques ajustements possibles":"Équilibre à améliorer"}),e.jsx("p",{className:"text-xs mt-1",style:{color:`${o}CC`},children:x>=80?"Continuez cette diversité d'activités":x>=60?"Variez davantage vos types d'activités":"Essayez d'intégrer plus de variété dans vos entraînements"})]})]})})]})})};function $t(t){switch(t){case"week":return"7 jours";case"month":return"30 jours";case"quarter":return"90 jours";default:return"30 jours"}}function Mt(t){switch(t){case"week":return 7;case"month":return 30;case"quarter":return 90;default:return 30}}function te(t,r){const s={excellent:"#22C55E",high:"#3B82F6",medium:"#F59E0B",low:"#EF4444",none:"rgba(255, 255, 255, 0.05)"},i=s[t]||s.none;if(t==="none")return i;const a=Math.max(.3,r);return`${i}${Math.round(a*255).toString(16).padStart(2,"0")}`}const Ne=({activities:t,period:r,apiPeriod:s})=>{const i=Q(),a=t||[],p=()=>{const n=new Date;let u=Mt(r);i.mode==="low"?u=Math.min(u,14):i.mode==="medium"&&(u=Math.min(u,30));const d=new Date(n);d.setDate(n.getDate()-u+1);const m=[];for(let w=0;w<u;w++){const k=new Date(d);k.setDate(d.getDate()+w);const z=k.toISOString().split("T")[0],O=a.filter(S=>S.timestamp.startsWith(z)),R=O.reduce((S,P)=>S+(P.calories_est||0),0),A=O.reduce((S,P)=>S+(P.duration_min||0),0),B=O.length;let I="none",E=0;B>0&&(R>=500||A>=60?(I="excellent",E=1):R>=300||A>=40?(I="high",E=.8):R>=150||A>=20?(I="medium",E=.6):(I="low",E=.4)),m.push({date:z,dayName:M(k,"EEEE",{locale:G}),dayNumber:k.getDate(),monthName:M(k,"MMMM",{locale:G}),status:I,intensity:E,calories:R,activitiesCount:B,duration:A})}const v=[];let l=[];m.forEach((w,k)=>{const z=new Date(w.date).getDay(),O=z===0?6:z-1;(l.length===7||k===0&&O>0)&&l.length>0&&(v.push(l),l=[]),l.push(w),k===m.length-1&&v.push(l)});const g=m.filter(w=>w.status==="excellent").length,j=m.filter(w=>w.activitiesCount>0).length,b=Math.round(j/m.length*100),C=Math.round(g/m.length*100),y=Math.round(m.reduce((w,k)=>w+k.calories,0)/m.length),f=Math.round(m.reduce((w,k)=>w+k.duration,0)/m.length);return{weeks:v,stats:{excellentDays:g,activityRate:b,excellenceRate:C,avgCaloriesPerDay:y,avgDurationPerDay:f}}},{weeks:x,stats:o}=p();return e.jsx("div",{className:"heatmap-enter",children:e.jsxs(F,{className:"p-6",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-activity-secondary) 8%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, var(--color-activity-accent) 6%, transparent) 0%, transparent 50%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, var(--color-activity-secondary) 25%, transparent)",boxShadow:`
            0 8px 32px rgba(0, 0, 0, 0.2),
            0 0 20px color-mix(in srgb, var(--color-activity-secondary) 10%, transparent),
            inset 0 1px 0 rgba(255, 255, 255, 0.12)
          `},children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #10B981 30%, transparent), color-mix(in srgb, #10B981 20%, transparent))
                `,border:"2px solid color-mix(in srgb, #10B981 40%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #10B981 30%, transparent)"},children:e.jsx(h,{Icon:c.Calendar,size:20,style:{color:"#10B981"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-bold text-xl",children:"Activité Énergétique"}),e.jsxs("p",{className:"text-white/70 text-sm",children:["Votre régularité sur ",$t(r)]})]})]}),e.jsxs("div",{className:"text-right space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-400"}),e.jsxs("span",{className:"text-green-300 text-sm font-medium",children:[o.excellentDays," jours excellents"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:"var(--color-activity-secondary)"}}),e.jsxs("span",{className:"text-white/70 text-sm font-medium",children:[o.activityRate,"% d'activité"]})]})]})]}),e.jsxs("div",{className:"space-y-3 heatmap-grid-container overflow-x-auto",children:[e.jsx("div",{className:"grid grid-cols-7 gap-2 mb-2",children:["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"].map(n=>e.jsx("div",{className:"text-center text-white/60 text-xs font-medium py-1",children:n},n))}),e.jsx("div",{className:"space-y-2",children:x.map((n,u)=>e.jsx("div",{className:"grid grid-cols-7 gap-2",children:n.map((d,m)=>e.jsxs($,{className:"aspect-square rounded-lg border cursor-pointer group relative overflow-hidden min-w-0",style:{backgroundColor:te(d.status,d.intensity),borderColor:d.status!=="none"?`color-mix(in srgb, ${te(d.status,1)} 40%, transparent)`:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(4px) saturate(120%)"},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:i.transitionDuration,delay:(u*7+m)*i.staggerDelay},whileHover:i.mode!=="low"?{scale:1.1,zIndex:10,transition:{duration:.2}}:void 0,title:`${d.dayName} ${d.dayNumber} ${d.monthName} - ${d.calories} kcal (${d.activitiesCount} activités, ${d.duration} min)`,fallback:e.jsxs("div",{className:"aspect-square rounded-lg border cursor-pointer group relative overflow-hidden min-w-0",style:{backgroundColor:te(d.status,d.intensity),borderColor:d.status!=="none"?`color-mix(in srgb, ${te(d.status,1)} 40%, transparent)`:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(4px) saturate(120%)"},title:`${d.dayName} ${d.dayNumber} ${d.monthName} - ${d.calories} kcal (${d.activitiesCount} activités, ${d.duration} min)`,children:[e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center p-0.5",children:[e.jsx("div",{className:"text-white text-xs font-bold leading-none",children:d.dayNumber}),d.activitiesCount>0&&e.jsx("div",{className:"text-white/80 text-xxs leading-none mt-0.5",children:d.activitiesCount})]}),i.mode!=="low"&&e.jsx("div",{className:"absolute inset-0 rounded-lg opacity-0 group-hover:opacity-30 transition-opacity duration-200",style:{background:"linear-gradient(135deg, rgba(255,255,255,0.3) 0%, transparent 50%, rgba(255,255,255,0.1) 100%)"}})]}),children:[e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center p-0.5",children:[e.jsx("div",{className:"text-white text-xs font-bold leading-none",children:d.dayNumber}),d.activitiesCount>0&&e.jsx("div",{className:"text-white/80 text-xxs leading-none mt-0.5",children:d.activitiesCount})]}),i.mode!=="low"&&e.jsx("div",{className:"absolute inset-0 rounded-lg opacity-0 group-hover:opacity-30 transition-opacity duration-200",style:{background:"linear-gradient(135deg, rgba(255,255,255,0.3) 0%, transparent 50%, rgba(255,255,255,0.1) 100%)"}})]},d.date))},u))})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-white/10 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 sm:gap-4",children:[e.jsx("span",{className:"text-white/60 text-sm",children:"Moins actif"}),e.jsx("div",{className:"flex items-center gap-1",children:[.2,.4,.6,.8,1].map((n,u)=>e.jsx("div",{className:"w-3 h-3 rounded border border-white/20",style:{backgroundColor:te("excellent",n)}},u))}),e.jsx("span",{className:"text-white/60 text-sm",children:"Plus actif"})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-3 sm:gap-4 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-400"}),e.jsx("span",{className:"text-green-300",children:"Excellent"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-400"}),e.jsx("span",{className:"text-blue-300",children:"Élevé"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-400"}),e.jsx("span",{className:"text-orange-300",children:"Modéré"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-400"}),e.jsx("span",{className:"text-red-300",children:"Faible"})]})]})]}),e.jsxs("div",{className:"mt-6 p-4 rounded-xl bg-cyan-500/10 border border-cyan-400/20 overflow-hidden",children:[e.jsxs("h4",{className:"text-cyan-300 font-medium text-sm mb-3 flex items-center gap-2",children:[e.jsx(h,{Icon:c.Info,size:12}),"Analyse des Patterns"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm",children:[e.jsx("div",{children:e.jsxs("span",{className:"text-white/80",children:[e.jsxs("strong",{children:[o.excellenceRate,"%"]})," de jours avec activité excellente"]})}),e.jsx("div",{children:e.jsxs("span",{className:"text-white/80",children:[e.jsx("strong",{children:o.avgCaloriesPerDay})," kcal brûlées en moyenne par jour"]})}),e.jsx("div",{children:e.jsxs("span",{className:"text-white/80",children:[e.jsxs("strong",{children:[o.activityRate,"%"]})," de jours avec activité enregistrée"]})}),e.jsx("div",{children:e.jsxs("span",{className:"text-white/80",children:[e.jsx("strong",{children:o.avgDurationPerDay})," min d'activité moyenne par jour"]})})]})]})]})})},Pt=({userId:t,period:r})=>{const s=Q(),[i,a]=T.useState([]),[p,x]=T.useState(!0),o=r==="week"?7:r==="month"?30:90;if(T.useEffect(()=>{(async()=>{try{x(!0);const B=new Date;B.setDate(B.getDate()-o);const{data:I,error:E}=await H.from("activities").select("timestamp, calories_est").eq("user_id",t).gte("timestamp",B.toISOString()).not("calories_est","is",null).order("timestamp",{ascending:!0});if(E)throw E;if(I&&I.length>0){const S=new Map;I.forEach(J=>{const q=new Date(J.timestamp).toISOString().split("T")[0];S.has(q)||S.set(q,{date:q,calories:0,activitiesCount:0});const W=S.get(q);W.calories+=J.calories_est||0,W.activitiesCount+=1});const P=Array.from(S.values()).sort((J,q)=>J.date.localeCompare(q.date));a(P)}_.debug("CALORIE_EVOLUTION_CHART","Data fetched successfully",{count:I?.length})}catch(B){_.error("CALORIE_EVOLUTION_CHART","Failed to fetch calorie data",{error:B})}finally{x(!1)}})()},[t,o]),p)return e.jsx("div",{className:"h-80 rounded-2xl animate-pulse",style:{background:"rgba(255,255,255,0.05)"}});if(i.length===0)return e.jsxs(F,{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #F59E0B 20%, transparent), color-mix(in srgb, #F59E0B 10%, transparent))",border:"1px solid color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(h,{Icon:c.Flame,size:32,style:{color:"#F59E0B"}})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Évolution des Calories"}),e.jsx("p",{className:"text-white/70 text-base max-w-md mx-auto",children:"Aucune donnée de calories disponible pour cette période."})]});const n=i.reduce((A,B)=>A+B.calories,0),u=n/i.length,d=Math.max(...i.map(A=>A.calories)),m=Math.min(...i.map(A=>A.calories)),v=i.slice(0,Math.floor(i.length/2)),l=i.slice(Math.floor(i.length/2)),g=v.reduce((A,B)=>A+B.calories,0)/v.length,j=l.reduce((A,B)=>A+B.calories,0)/l.length,b=j>g?"improving":j<g?"declining":"stable",C=(j-g)/g*100,y=b==="improving"?"#22C55E":b==="declining"?"#EF4444":"#06B6D4",f=b==="improving"?c.TrendingUp:b==="declining"?c.TrendingDown:c.Minus,N=d-m,w=Math.max(N*.2,10),k=Math.max(0,m-w),z=d+w,O=Math.max(z-k,1),R=i.slice(0,s.maxDataPoints);return e.jsx($,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:s.transitionDuration},fallback:e.jsx("div",{children:e.jsxs(F,{className:"p-6",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #F59E0B 12%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, #EF4444 8%, transparent) 0%, transparent 50%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, #F59E0B 25%, transparent)",boxShadow:`
            0 12px 40px rgba(0, 0, 0, 0.25),
            0 0 30px color-mix(in srgb, #F59E0B 15%, transparent),
            inset 0 2px 0 rgba(255, 255, 255, 0.15)
          `,backdropFilter:"blur(20px) saturate(160%)"},children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #F59E0B 35%, transparent), color-mix(in srgb, #EF4444 25%, transparent))
                `,border:"2px solid color-mix(in srgb, #F59E0B 50%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(h,{Icon:c.Flame,size:24,style:{color:"#F59E0B"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Évolution des Calories"}),e.jsxs("p",{className:"text-white/80 text-sm",children:[i.length," jours • Tendance ",b==="improving"?"à la hausse":b==="declining"?"à la baisse":"stable"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"px-3 py-1.5 rounded-full mb-2",style:{background:`color-mix(in srgb, ${y} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${y} 25%, transparent)`},children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(h,{Icon:f,size:12,style:{color:y}}),e.jsxs("span",{className:"text-sm font-medium",style:{color:y},children:[b==="improving"?"+":b==="declining"?"":"±",C.toFixed(1),"%"]})]})}),e.jsx("p",{className:"text-2xl font-bold text-white",children:u.toFixed(0)}),e.jsx("p",{className:"text-white/60 text-xs",children:"kcal moy./jour"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"p-3 rounded-xl",style:{background:"color-mix(in srgb, #22C55E 10%, transparent)",border:"1px solid color-mix(in srgb, #22C55E 20%, transparent)"},children:[e.jsx("div",{className:"text-2xl font-bold text-green-400 mb-1",children:d.toFixed(0)}),e.jsx("div",{className:"text-green-300 text-sm font-medium",children:"Maximum"})]}),e.jsxs("div",{className:"p-3 rounded-xl",style:{background:"color-mix(in srgb, #F59E0B 10%, transparent)",border:"1px solid color-mix(in srgb, #F59E0B 20%, transparent)"},children:[e.jsx("div",{className:"text-2xl font-bold text-orange-400 mb-1",children:n.toFixed(0)}),e.jsx("div",{className:"text-orange-300 text-sm font-medium",children:"Total"})]}),e.jsxs("div",{className:"p-3 rounded-xl",style:{background:"color-mix(in srgb, #8B5CF6 10%, transparent)",border:"1px solid color-mix(in srgb, #8B5CF6 20%, transparent)"},children:[e.jsx("div",{className:"text-2xl font-bold text-purple-400 mb-1",children:m.toFixed(0)}),e.jsx("div",{className:"text-purple-300 text-sm font-medium",children:"Minimum"})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white font-semibold mb-3 flex items-center gap-2",children:[e.jsx(h,{Icon:c.BarChart3,size:16,className:"text-orange-400"}),"Calories Brûlées par Jour"]}),e.jsx("div",{className:"relative h-48 bg-white/5 rounded-xl p-4 overflow-hidden",children:e.jsx("div",{className:"relative h-full flex items-end justify-between gap-1",children:R.map((A,B)=>{const I=O>0?(A.calories-k)/O*100:0,E=Math.max(I,5),S=A.calories===d;return e.jsxs($,{className:"flex-1 group cursor-pointer relative",initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},transition:{duration:s.transitionDuration,delay:B*s.staggerDelay},fallback:e.jsxs("div",{className:"flex-1 group cursor-pointer relative",children:[e.jsx("div",{className:`w-full rounded-t-md transition-all duration-200 ${s.mode!=="low"?"group-hover:opacity-100":""}`,style:{height:`${E}%`,minHeight:"8px",background:S?"linear-gradient(to top, #EF4444, #F59E0B)":"linear-gradient(to top, #F59E0B, #FBBF24)",opacity:S?1:.8,boxShadow:S?"0 0 12px rgba(245, 158, 11, 0.6)":"none"}}),s.mode!=="low"&&e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-black/90 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-10",children:[e.jsx("div",{className:"font-semibold",children:M(re(A.date),"dd MMM",{locale:G})}),e.jsxs("div",{children:[A.calories.toFixed(0)," kcal"]}),e.jsxs("div",{className:"text-white/70",children:[A.activitiesCount," activité",A.activitiesCount>1?"s":""]})]})]}),children:[e.jsx("div",{className:`w-full rounded-t-md transition-all duration-200 ${s.mode!=="low"?"group-hover:opacity-100":""}`,style:{height:`${E}%`,minHeight:"8px",background:S?"linear-gradient(to top, #EF4444, #F59E0B)":"linear-gradient(to top, #F59E0B, #FBBF24)",opacity:S?1:.8,boxShadow:S?"0 0 12px rgba(245, 158, 11, 0.6)":"none"}}),s.mode!=="low"&&e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-black/90 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-10",children:[e.jsx("div",{className:"font-semibold",children:M(re(A.date),"dd MMM",{locale:G})}),e.jsxs("div",{children:[A.calories.toFixed(0)," kcal"]}),e.jsxs("div",{className:"text-white/70",children:[A.activitiesCount," activité",A.activitiesCount>1?"s":""]})]})]},A.date)})})})]}),e.jsx("div",{className:"mt-6 p-4 rounded-xl",style:{background:`color-mix(in srgb, ${y} 6%, transparent)`,border:`1px solid color-mix(in srgb, ${y} 18%, transparent)`,backdropFilter:"blur(8px) saturate(120%)"},children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(h,{Icon:b==="improving"?c.TrendingUp:b==="declining"?c.TrendingDown:c.Info,size:14,style:{color:y},className:"mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",style:{color:y},children:b==="improving"?"Dépense énergétique en hausse":b==="declining"?"Dépense énergétique en baisse":"Dépense énergétique stable"}),e.jsx("p",{className:"text-xs mt-1",style:{color:`${y}CC`},children:b==="improving"?"Excellente progression ! Continuez sur cette lancée.":b==="declining"?"Pensez à intensifier ou augmenter la fréquence de vos entraînements.":"Maintenez votre rythme actuel pour des résultats réguliers."})]})]})})]})}),children:e.jsxs(F,{className:"p-6",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #F59E0B 12%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, #EF4444 8%, transparent) 0%, transparent 50%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, #F59E0B 25%, transparent)",boxShadow:`
            0 12px 40px rgba(0, 0, 0, 0.25),
            0 0 30px color-mix(in srgb, #F59E0B 15%, transparent),
            inset 0 2px 0 rgba(255, 255, 255, 0.15)
          `,backdropFilter:"blur(20px) saturate(160%)"},children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #F59E0B 35%, transparent), color-mix(in srgb, #EF4444 25%, transparent))
                `,border:"2px solid color-mix(in srgb, #F59E0B 50%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(h,{Icon:c.Flame,size:24,style:{color:"#F59E0B"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Évolution des Calories"}),e.jsxs("p",{className:"text-white/80 text-sm",children:[R.length," jours • Tendance ",b==="improving"?"à la hausse":b==="declining"?"à la baisse":"stable"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"px-3 py-1.5 rounded-full mb-2",style:{background:`color-mix(in srgb, ${y} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${y} 25%, transparent)`},children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(h,{Icon:f,size:12,style:{color:y}}),e.jsxs("span",{className:"text-sm font-medium",style:{color:y},children:[b==="improving"?"+":b==="declining"?"":"±",C.toFixed(1),"%"]})]})}),e.jsx("p",{className:"text-2xl font-bold text-white",children:u.toFixed(0)}),e.jsx("p",{className:"text-white/60 text-xs",children:"kcal moy./jour"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"p-3 rounded-xl",style:{background:"color-mix(in srgb, #22C55E 10%, transparent)",border:"1px solid color-mix(in srgb, #22C55E 20%, transparent)"},children:[e.jsx("div",{className:"text-2xl font-bold text-green-400 mb-1",children:d.toFixed(0)}),e.jsx("div",{className:"text-green-300 text-sm font-medium",children:"Maximum"})]}),e.jsxs("div",{className:"p-3 rounded-xl",style:{background:"color-mix(in srgb, #F59E0B 10%, transparent)",border:"1px solid color-mix(in srgb, #F59E0B 20%, transparent)"},children:[e.jsx("div",{className:"text-2xl font-bold text-orange-400 mb-1",children:n.toFixed(0)}),e.jsx("div",{className:"text-orange-300 text-sm font-medium",children:"Total"})]}),e.jsxs("div",{className:"p-3 rounded-xl",style:{background:"color-mix(in srgb, #8B5CF6 10%, transparent)",border:"1px solid color-mix(in srgb, #8B5CF6 20%, transparent)"},children:[e.jsx("div",{className:"text-2xl font-bold text-purple-400 mb-1",children:m.toFixed(0)}),e.jsx("div",{className:"text-purple-300 text-sm font-medium",children:"Minimum"})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white font-semibold mb-3 flex items-center gap-2",children:[e.jsx(h,{Icon:c.BarChart3,size:16,className:"text-orange-400"}),"Calories Brûlées par Jour"]}),e.jsx("div",{className:"relative h-48 bg-white/5 rounded-xl p-4 overflow-hidden",children:e.jsx("div",{className:"relative h-full flex items-end justify-between gap-1",children:R.map((A,B)=>{const I=O>0?(A.calories-k)/O*100:0,E=Math.max(I,5),S=A.calories===d;return e.jsxs($,{className:"flex-1 group cursor-pointer relative",initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},transition:{duration:s.transitionDuration,delay:B*s.staggerDelay},fallback:e.jsxs("div",{className:"flex-1 group cursor-pointer relative",children:[e.jsx("div",{className:`w-full rounded-t-md transition-all duration-200 ${s.mode!=="low"?"group-hover:opacity-100":""}`,style:{height:`${E}%`,minHeight:"8px",background:S?"linear-gradient(to top, #EF4444, #F59E0B)":"linear-gradient(to top, #F59E0B, #FBBF24)",opacity:S?1:.8,boxShadow:S?"0 0 12px rgba(245, 158, 11, 0.6)":"none"}}),s.mode!=="low"&&e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-black/90 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-10",children:[e.jsx("div",{className:"font-semibold",children:M(re(A.date),"dd MMM",{locale:G})}),e.jsxs("div",{children:[A.calories.toFixed(0)," kcal"]}),e.jsxs("div",{className:"text-white/70",children:[A.activitiesCount," activité",A.activitiesCount>1?"s":""]})]})]}),children:[e.jsx("div",{className:`w-full rounded-t-md transition-all duration-200 ${s.mode!=="low"?"group-hover:opacity-100":""}`,style:{height:`${E}%`,minHeight:"8px",background:S?"linear-gradient(to top, #EF4444, #F59E0B)":"linear-gradient(to top, #F59E0B, #FBBF24)",opacity:S?1:.8,boxShadow:S?"0 0 12px rgba(245, 158, 11, 0.6)":"none"}}),s.mode!=="low"&&e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-black/90 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-10",children:[e.jsx("div",{className:"font-semibold",children:M(re(A.date),"dd MMM",{locale:G})}),e.jsxs("div",{children:[A.calories.toFixed(0)," kcal"]}),e.jsxs("div",{className:"text-white/70",children:[A.activitiesCount," activité",A.activitiesCount>1?"s":""]})]})]},A.date)})})})]}),e.jsx("div",{className:"mt-6 p-4 rounded-xl",style:{background:`color-mix(in srgb, ${y} 6%, transparent)`,border:`1px solid color-mix(in srgb, ${y} 18%, transparent)`,backdropFilter:"blur(8px) saturate(120%)"},children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(h,{Icon:b==="improving"?c.TrendingUp:b==="declining"?c.TrendingDown:c.Info,size:14,style:{color:y},className:"mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",style:{color:y},children:b==="improving"?"Dépense énergétique en hausse":b==="declining"?"Dépense énergétique en baisse":"Dépense énergétique stable"}),e.jsx("p",{className:"text-xs mt-1",style:{color:`${y}CC`},children:b==="improving"?"Excellente progression ! Continuez sur cette lancée.":b==="declining"?"Pensez à intensifier ou augmenter la fréquence de vos entraînements.":"Maintenez votre rythme actuel pour des résultats réguliers."})]})]})})]})})},Ot=({userId:t,period:r})=>{const s=Q(),[i,a]=T.useState([]),[p,x]=T.useState(!0),o=r==="week"?7:r==="month"?30:90,n=[{name:"Lun",number:1,color:"#3B82F6"},{name:"Mar",number:2,color:"#8B5CF6"},{name:"Mer",number:3,color:"#10B981"},{name:"Jeu",number:4,color:"#F59E0B"},{name:"Ven",number:5,color:"#EF4444"},{name:"Sam",number:6,color:"#EC4899"},{name:"Dim",number:0,color:"#06B6D4"}];if(T.useEffect(()=>{(async()=>{try{x(!0);const g=new Date;g.setDate(g.getDate()-o);const{data:j,error:b}=await H.from("activities").select("timestamp, calories_est, duration_min").eq("user_id",t).gte("timestamp",g.toISOString()).order("timestamp",{ascending:!0});if(b)throw b;if(j&&j.length>0){const C=new Map;n.forEach(f=>{C.set(f.number,{day:f.name,dayNumber:f.number,activitiesCount:0,totalCalories:0,totalDuration:0,color:f.color})}),j.forEach(f=>{const N=new Date(f.timestamp).getDay(),w=C.get(N);w.activitiesCount+=1,w.totalCalories+=f.calories_est||0,w.totalDuration+=f.duration_min||0});const y=Array.from(C.values()).sort((f,N)=>f.dayNumber===0?1:N.dayNumber===0?-1:f.dayNumber-N.dayNumber);a(y)}_.debug("WEEKLY_DISTRIBUTION_CHART","Data fetched successfully",{count:j?.length})}catch(g){_.error("WEEKLY_DISTRIBUTION_CHART","Failed to fetch weekly data",{error:g})}finally{x(!1)}})()},[t,o]),p)return e.jsx("div",{className:"h-96 rounded-2xl animate-pulse",style:{background:"rgba(255,255,255,0.05)"}});if(i.length===0)return e.jsxs(F,{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #3B82F6 20%, transparent), color-mix(in srgb, #3B82F6 10%, transparent))",border:"1px solid color-mix(in srgb, #3B82F6 30%, transparent)"},children:e.jsx(h,{Icon:c.Calendar,size:32,style:{color:"#3B82F6"}})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Distribution Hebdomadaire"}),e.jsx("p",{className:"text-white/70 text-base max-w-md mx-auto",children:"Aucune activité disponible pour cette période."})]});const u=Math.max(...i.map(l=>l.activitiesCount)),d=i.reduce((l,g)=>l+g.activitiesCount,0),m=i.reduce((l,g)=>g.activitiesCount>l.activitiesCount?g:l),v=i.reduce((l,g)=>g.activitiesCount>0&&g.activitiesCount<l.activitiesCount?g:l,i[0]);return e.jsx($,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:s.transitionDuration},fallback:e.jsx("div",{children:e.jsxs(F,{className:"p-6",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #3B82F6 12%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, #8B5CF6 8%, transparent) 0%, transparent 50%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, #3B82F6 25%, transparent)",boxShadow:`
            0 12px 40px rgba(0, 0, 0, 0.25),
            0 0 30px color-mix(in srgb, #3B82F6 15%, transparent),
            inset 0 2px 0 rgba(255, 255, 255, 0.15)
          `,backdropFilter:"blur(20px) saturate(160%)"},children:[e.jsx("div",{className:"flex items-start justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #3B82F6 35%, transparent), color-mix(in srgb, #8B5CF6 25%, transparent))
                `,border:"2px solid color-mix(in srgb, #3B82F6 50%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #3B82F6 30%, transparent)"},children:e.jsx(h,{Icon:c.Calendar,size:24,style:{color:"#3B82F6"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Distribution Hebdomadaire"}),e.jsxs("p",{className:"text-white/80 text-sm",children:["Répartition de vos ",d," activités par jour de semaine"]})]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[e.jsx(h,{Icon:c.BarChart3,size:16,className:"text-blue-400"}),"Nombre d'Activités par Jour"]}),e.jsx("div",{className:"space-y-3",children:i.map((l,g)=>{const j=u>0?l.activitiesCount/u*100:0,b=l.day===m.day;return e.jsxs($,{className:"relative",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:s.transitionDuration,delay:g*s.staggerDelay},fallback:e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-16 text-right",children:e.jsx("span",{className:"text-sm font-semibold text-white/80",children:l.day})}),e.jsx("div",{className:"flex-1 relative h-10 rounded-xl overflow-hidden",style:{background:"rgba(255, 255, 255, 0.03)"},children:e.jsx("div",{className:"absolute inset-y-0 left-0 rounded-xl flex items-center justify-end pr-3",style:{width:`${Math.max(j,5)}%`,background:`linear-gradient(to right, ${l.color}40, ${l.color})`,border:`1px solid ${l.color}60`,boxShadow:b?`0 0 16px ${l.color}80`:"none"},children:e.jsx("span",{className:"text-white font-bold text-sm",children:l.activitiesCount})})}),e.jsx("div",{className:"w-24 text-left",children:e.jsxs("div",{className:"text-xs text-white/60",children:[l.totalCalories.toFixed(0)," kcal"]})})]}),b&&e.jsx("div",{className:"absolute -right-2 top-1/2 transform -translate-y-1/2",children:e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{background:`${l.color}40`,border:`2px solid ${l.color}`,boxShadow:`0 0 12px ${l.color}80`},children:e.jsx(h,{Icon:c.Zap,size:12,style:{color:l.color}})})})]}),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-16 text-right",children:e.jsx("span",{className:"text-sm font-semibold text-white/80",children:l.day})}),e.jsx("div",{className:"flex-1 relative h-10 rounded-xl overflow-hidden",style:{background:"rgba(255, 255, 255, 0.03)"},children:e.jsx($,{className:"absolute inset-y-0 left-0 rounded-xl flex items-center justify-end pr-3",style:{background:`linear-gradient(to right, ${l.color}40, ${l.color})`,border:`1px solid ${l.color}60`,boxShadow:b?`0 0 16px ${l.color}80`:"none"},initial:{width:0},animate:{width:`${Math.max(j,5)}%`},transition:{duration:s.transitionDuration,delay:g*s.staggerDelay},fallback:e.jsx("div",{className:"absolute inset-y-0 left-0 rounded-xl flex items-center justify-end pr-3",style:{width:`${Math.max(j,5)}%`,background:`linear-gradient(to right, ${l.color}40, ${l.color})`,border:`1px solid ${l.color}60`,boxShadow:b?`0 0 16px ${l.color}80`:"none"},children:e.jsx("span",{className:"text-white font-bold text-sm",children:l.activitiesCount})}),children:e.jsx("span",{className:"text-white font-bold text-sm",children:l.activitiesCount})})}),e.jsx("div",{className:"w-24 text-left",children:e.jsxs("div",{className:"text-xs text-white/60",children:[l.totalCalories.toFixed(0)," kcal"]})})]}),b&&s.enableComplexEffects&&e.jsx("div",{className:"absolute -right-2 top-1/2 transform -translate-y-1/2",children:e.jsx($,{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{background:`${l.color}40`,border:`2px solid ${l.color}`,boxShadow:`0 0 12px ${l.color}80`},initial:{scale:0},animate:{scale:1},transition:{delay:s.staggerDelay*8,type:"spring"},fallback:e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{background:`${l.color}40`,border:`2px solid ${l.color}`,boxShadow:`0 0 12px ${l.color}80`},children:e.jsx(h,{Icon:c.Zap,size:12,style:{color:l.color}})}),children:e.jsx(h,{Icon:c.Zap,size:12,style:{color:l.color}})})})]},l.day)})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 rounded-xl",style:{background:`color-mix(in srgb, ${m.color} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${m.color} 20%, transparent)`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(h,{Icon:c.TrendingUp,size:14,style:{color:m.color}}),e.jsx("span",{className:"text-xs font-medium",style:{color:m.color},children:"Jour le + actif"})]}),e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:m.day}),e.jsxs("div",{className:"text-sm text-white/70",children:[m.activitiesCount," activité",m.activitiesCount>1?"s":""]})]}),e.jsxs("div",{className:"p-4 rounded-xl",style:{background:"color-mix(in srgb, #8B5CF6 10%, transparent)",border:"1px solid color-mix(in srgb, #8B5CF6 20%, transparent)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(h,{Icon:c.BarChart3,size:14,style:{color:"#8B5CF6"}}),e.jsx("span",{className:"text-xs font-medium text-purple-300",children:"Moyenne/jour"})]}),e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:(d/7).toFixed(1)}),e.jsx("div",{className:"text-sm text-white/70",children:"activités"})]})]}),e.jsx("div",{className:"p-4 rounded-xl",style:{background:"color-mix(in srgb, #3B82F6 6%, transparent)",border:"1px solid color-mix(in srgb, #3B82F6 18%, transparent)",backdropFilter:"blur(8px) saturate(120%)"},children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(h,{Icon:c.Info,size:14,style:{color:"#3B82F6"},className:"mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-300",children:"Pattern hebdomadaire identifié"}),e.jsx("p",{className:"text-xs mt-1 text-blue-200",children:m.activitiesCount>d/7*1.5?`Pic d'activité le ${m.day}. Excellente régularité !`:v.activitiesCount===0?`Jour de repos le ${v.day}. Pensez à répartir vos efforts.`:"Distribution équilibrée tout au long de la semaine."})]})]})})]})}),children:e.jsxs(F,{className:"p-6",style:{background:`
            radial-gradient(circle at 30% 20%, color-mix(in srgb, #3B82F6 12%, transparent) 0%, transparent 60%),
            radial-gradient(circle at 70% 80%, color-mix(in srgb, #8B5CF6 8%, transparent) 0%, transparent 50%),
            var(--glass-opacity)
          `,borderColor:"color-mix(in srgb, #3B82F6 25%, transparent)",boxShadow:`
            0 12px 40px rgba(0, 0, 0, 0.25),
            0 0 30px color-mix(in srgb, #3B82F6 15%, transparent),
            inset 0 2px 0 rgba(255, 255, 255, 0.15)
          `,backdropFilter:"blur(20px) saturate(160%)"},children:[e.jsx("div",{className:"flex items-start justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #3B82F6 35%, transparent), color-mix(in srgb, #8B5CF6 25%, transparent))
                `,border:"2px solid color-mix(in srgb, #3B82F6 50%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #3B82F6 30%, transparent)"},children:e.jsx(h,{Icon:c.Calendar,size:24,style:{color:"#3B82F6"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Distribution Hebdomadaire"}),e.jsxs("p",{className:"text-white/80 text-sm",children:["Répartition de vos ",d," activités par jour de semaine"]})]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[e.jsx(h,{Icon:c.BarChart3,size:16,className:"text-blue-400"}),"Nombre d'Activités par Jour"]}),e.jsx("div",{className:"space-y-3",children:i.map((l,g)=>{const j=u>0?l.activitiesCount/u*100:0,b=l.day===m.day;return e.jsxs($,{className:"relative",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:s.transitionDuration,delay:g*s.staggerDelay},fallback:e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-16 text-right",children:e.jsx("span",{className:"text-sm font-semibold text-white/80",children:l.day})}),e.jsx("div",{className:"flex-1 relative h-10 rounded-xl overflow-hidden",style:{background:"rgba(255, 255, 255, 0.03)"},children:e.jsx("div",{className:"absolute inset-y-0 left-0 rounded-xl flex items-center justify-end pr-3",style:{width:`${Math.max(j,5)}%`,background:`linear-gradient(to right, ${l.color}40, ${l.color})`,border:`1px solid ${l.color}60`,boxShadow:b?`0 0 16px ${l.color}80`:"none"},children:e.jsx("span",{className:"text-white font-bold text-sm",children:l.activitiesCount})})}),e.jsx("div",{className:"w-24 text-left",children:e.jsxs("div",{className:"text-xs text-white/60",children:[l.totalCalories.toFixed(0)," kcal"]})})]}),b&&e.jsx("div",{className:"absolute -right-2 top-1/2 transform -translate-y-1/2",children:e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{background:`${l.color}40`,border:`2px solid ${l.color}`,boxShadow:`0 0 12px ${l.color}80`},children:e.jsx(h,{Icon:c.Zap,size:12,style:{color:l.color}})})})]}),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-16 text-right",children:e.jsx("span",{className:"text-sm font-semibold text-white/80",children:l.day})}),e.jsx("div",{className:"flex-1 relative h-10 rounded-xl overflow-hidden",style:{background:"rgba(255, 255, 255, 0.03)"},children:e.jsx($,{className:"absolute inset-y-0 left-0 rounded-xl flex items-center justify-end pr-3",style:{background:`linear-gradient(to right, ${l.color}40, ${l.color})`,border:`1px solid ${l.color}60`,boxShadow:b?`0 0 16px ${l.color}80`:"none"},initial:{width:0},animate:{width:`${Math.max(j,5)}%`},transition:{duration:s.transitionDuration,delay:g*s.staggerDelay},fallback:e.jsx("div",{className:"absolute inset-y-0 left-0 rounded-xl flex items-center justify-end pr-3",style:{width:`${Math.max(j,5)}%`,background:`linear-gradient(to right, ${l.color}40, ${l.color})`,border:`1px solid ${l.color}60`,boxShadow:b?`0 0 16px ${l.color}80`:"none"},children:e.jsx("span",{className:"text-white font-bold text-sm",children:l.activitiesCount})}),children:e.jsx("span",{className:"text-white font-bold text-sm",children:l.activitiesCount})})}),e.jsx("div",{className:"w-24 text-left",children:e.jsxs("div",{className:"text-xs text-white/60",children:[l.totalCalories.toFixed(0)," kcal"]})})]}),b&&s.enableComplexEffects&&e.jsx("div",{className:"absolute -right-2 top-1/2 transform -translate-y-1/2",children:e.jsx($,{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{background:`${l.color}40`,border:`2px solid ${l.color}`,boxShadow:`0 0 12px ${l.color}80`},initial:{scale:0},animate:{scale:1},transition:{delay:s.staggerDelay*8,type:"spring"},fallback:e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{background:`${l.color}40`,border:`2px solid ${l.color}`,boxShadow:`0 0 12px ${l.color}80`},children:e.jsx(h,{Icon:c.Zap,size:12,style:{color:l.color}})}),children:e.jsx(h,{Icon:c.Zap,size:12,style:{color:l.color}})})})]},l.day)})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 rounded-xl",style:{background:`color-mix(in srgb, ${m.color} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${m.color} 20%, transparent)`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(h,{Icon:c.TrendingUp,size:14,style:{color:m.color}}),e.jsx("span",{className:"text-xs font-medium",style:{color:m.color},children:"Jour le + actif"})]}),e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:m.day}),e.jsxs("div",{className:"text-sm text-white/70",children:[m.activitiesCount," activité",m.activitiesCount>1?"s":""]})]}),e.jsxs("div",{className:"p-4 rounded-xl",style:{background:"color-mix(in srgb, #8B5CF6 10%, transparent)",border:"1px solid color-mix(in srgb, #8B5CF6 20%, transparent)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(h,{Icon:c.BarChart3,size:14,style:{color:"#8B5CF6"}}),e.jsx("span",{className:"text-xs font-medium text-purple-300",children:"Moyenne/jour"})]}),e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:(d/7).toFixed(1)}),e.jsx("div",{className:"text-sm text-white/70",children:"activités"})]})]}),e.jsx("div",{className:"p-4 rounded-xl",style:{background:"color-mix(in srgb, #3B82F6 6%, transparent)",border:"1px solid color-mix(in srgb, #3B82F6 18%, transparent)",backdropFilter:"blur(8px) saturate(120%)"},children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(h,{Icon:c.Info,size:14,style:{color:"#3B82F6"},className:"mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-300",children:"Pattern hebdomadaire identifié"}),e.jsx("p",{className:"text-xs mt-1 text-blue-200",children:m.activitiesCount>d/7*1.5?`Pic d'activité le ${m.day}. Excellente régularité !`:v.activitiesCount===0?`Jour de repos le ${v.day}. Pensez à répartir vos efforts.`:"Distribution équilibrée tout au long de la semaine."})]})]})})]})})},qt=({userId:t,period:r})=>{const[s,i]=T.useState([]),[a,p]=T.useState(!0),x=r==="week"?7:r==="month"?30:90;if(T.useEffect(()=>{(async()=>{try{p(!0);const E=new Date;E.setDate(E.getDate()-x);const{data:S,error:P}=await H.from("activities").select("timestamp, vo2max_estimated").eq("user_id",t).gte("timestamp",E.toISOString()).not("vo2max_estimated","is",null).order("timestamp",{ascending:!0});if(P)throw P;if(S&&S.length>0){const J=S.map(q=>({date:new Date(q.timestamp).toLocaleDateString("fr-FR",{day:"2-digit",month:"short"}),vo2max:q.vo2max_estimated}));i(J)}_.info("VO2MAX_CHART","Data fetched successfully",{count:S?.length})}catch(E){_.error("VO2MAX_CHART","Failed to fetch VO2max data",{error:E})}finally{p(!1)}})()},[t,x]),a)return e.jsx("div",{className:"h-80 rounded-2xl animate-pulse",style:{background:"rgba(255,255,255,0.05)"}});if(s.length===0)return e.jsxs(F,{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #10B981 20%, transparent), color-mix(in srgb, #10B981 10%, transparent))",border:"1px solid color-mix(in srgb, #10B981 30%, transparent)"},children:e.jsx(h,{Icon:c.TrendingUp,size:32,style:{color:"#10B981"}})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Évolution VO2max"}),e.jsx("p",{className:"text-white/70 text-base max-w-md mx-auto",children:"Aucune donnée VO2max disponible pour cette période. Utilisez un objet connecté pour mesurer votre VO2max."})]});const o=Math.min(...s.map(I=>I.vo2max)),n=Math.max(...s.map(I=>I.vo2max)),u=s.reduce((I,E)=>I+E.vo2max,0)/s.length,d=s[s.length-1].vo2max,m=s[0].vo2max,v=d-m,l=v/m*100,j=(n-o)*.2,b=o-j,y=n+j-b,f=800,N=400,w={top:20,right:20,bottom:40,left:60},k=f-w.left-w.right,z=N-w.top-w.bottom,O=k/(s.length-1||1),R=s.map((I,E)=>{const S=w.left+E*O,P=w.top+z-(I.vo2max-b)/y*z;return`${S},${P}`}).join(" "),A=`M ${R.split(" ").join(" L ")}`,B="vo2max-gradient";return e.jsxs(F,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:"linear-gradient(135deg, color-mix(in srgb, #3B82F6 25%, transparent), color-mix(in srgb, #3B82F6 15%, transparent))",border:"1px solid color-mix(in srgb, #3B82F6 35%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #3B82F6 20%, transparent)"},children:e.jsx(h,{Icon:c.Activity,size:24,style:{color:"#10B981"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Évolution VO2max"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Capacité cardiovasculaire maximale"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-white/50 text-xs mb-1",children:"Actuel"}),e.jsx("p",{className:"text-3xl font-bold text-white",children:d.toFixed(1)}),e.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-semibold mt-1",style:{background:v>=0?"color-mix(in srgb, #22C55E 15%, transparent)":"color-mix(in srgb, #EF4444 15%, transparent)",border:v>=0?"1px solid color-mix(in srgb, #22C55E 25%, transparent)":"1px solid color-mix(in srgb, #EF4444 25%, transparent)",color:v>=0?"#22C55E":"#EF4444"},children:[e.jsx(h,{Icon:v>=0?c.TrendingUp:c.TrendingDown,size:10}),v>=0?"+":"",l.toFixed(1),"%"]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"p-3 rounded-lg",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsx("p",{className:"text-white/50 text-xs mb-1",children:"Minimum"}),e.jsx("p",{className:"text-white font-bold text-lg",children:o.toFixed(1)})]}),e.jsxs("div",{className:"p-3 rounded-lg",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsx("p",{className:"text-white/50 text-xs mb-1",children:"Moyenne"}),e.jsx("p",{className:"text-white font-bold text-lg",children:u.toFixed(1)})]}),e.jsxs("div",{className:"p-3 rounded-lg",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsx("p",{className:"text-white/50 text-xs mb-1",children:"Maximum"}),e.jsx("p",{className:"text-white font-bold text-lg",children:n.toFixed(1)})]})]}),e.jsx("div",{className:"relative",style:{width:"100%",height:"300px"},children:e.jsxs("svg",{viewBox:`0 0 ${f} ${N}`,style:{width:"100%",height:"100%"},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:B,x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",style:{stopColor:"#3B82F6",stopOpacity:.4}}),e.jsx("stop",{offset:"100%",style:{stopColor:"#3B82F6",stopOpacity:.05}})]})}),e.jsx("path",{d:`${A} L ${w.left+k},${w.top+z} L ${w.left},${w.top+z} Z`,fill:`url(#${B})`}),e.jsx("polyline",{points:R,fill:"none",stroke:"#3B82F6",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),s.map((I,E)=>{const S=w.left+E*O,P=w.top+z-(I.vo2max-b)/y*z;return e.jsxs("g",{children:[e.jsx("circle",{cx:S,cy:P,r:"5",fill:"#3B82F6",stroke:"rgba(255,255,255,0.3)",strokeWidth:"2"}),e.jsx("text",{x:S,y:w.top+z+25,textAnchor:"middle",fill:"rgba(255,255,255,0.5)",fontSize:"12",children:I.date})]},E)}),[0,.25,.5,.75,1].map(I=>{const E=w.top+z*(1-I),S=b+y*I;return e.jsxs("g",{children:[e.jsx("line",{x1:w.left,y1:E,x2:w.left+k,y2:E,stroke:"rgba(255,255,255,0.1)",strokeWidth:"1",strokeDasharray:"4,4"}),e.jsx("text",{x:w.left-10,y:E+4,textAnchor:"end",fill:"rgba(255,255,255,0.5)",fontSize:"12",children:S.toFixed(0)})]},I)})]})}),e.jsxs("div",{className:"mt-6 p-4 rounded-xl",style:{background:"rgba(59, 130, 246, 0.08)",border:"1px solid rgba(59, 130, 246, 0.2)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(h,{Icon:c.Info,size:14,style:{color:"#3B82F6"}}),e.jsx("span",{className:"text-blue-300 font-semibold text-sm",children:"Interprétation"})]}),e.jsx("p",{className:"text-blue-200 text-sm leading-relaxed",children:d>=50?"Excellente capacité aérobie ! Maintenez ce niveau avec des entraînements variés.":d>=40?"Bonne capacité cardiovasculaire. Continuez à progresser avec des séances d'endurance.":"Marge de progression importante. Augmentez progressivement votre volume d'entraînement cardio."})]})]})},Rt=({userId:t,period:r})=>{const[s,i]=T.useState([]),[a,p]=T.useState(!0),x=r==="week"?7:r==="month"?30:90;if(T.useEffect(()=>{(async()=>{try{p(!0);const v=new Date;v.setDate(v.getDate()-x);const{data:l,error:g}=await H.from("activities").select("timestamp, hr_zone1_minutes, hr_zone2_minutes, hr_zone3_minutes, hr_zone4_minutes, hr_zone5_minutes").eq("user_id",t).gte("timestamp",v.toISOString()).not("hr_zone1_minutes","is",null).order("timestamp",{ascending:!0});if(g)throw g;if(l&&l.length>0){const j=new Map;l.forEach(C=>{const y=new Date(C.timestamp).toLocaleDateString("fr-FR",{day:"2-digit",month:"short"});j.has(y)||j.set(y,{date:y,z1:0,z2:0,z3:0,z4:0,z5:0});const f=j.get(y);f.z1+=C.hr_zone1_minutes||0,f.z2+=C.hr_zone2_minutes||0,f.z3+=C.hr_zone3_minutes||0,f.z4+=C.hr_zone4_minutes||0,f.z5+=C.hr_zone5_minutes||0});const b=Array.from(j.values());i(b)}_.info("HR_ZONES_HEATMAP","Data fetched successfully",{count:l?.length})}catch(v){_.error("HR_ZONES_HEATMAP","Failed to fetch HR zones data",{error:v})}finally{p(!1)}})()},[t,x]),a)return e.jsx("div",{className:"h-96 rounded-2xl animate-pulse",style:{background:"rgba(255,255,255,0.05)"}});if(s.length===0)return e.jsxs(F,{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #10B981 20%, transparent), color-mix(in srgb, #10B981 10%, transparent))",border:"1px solid color-mix(in srgb, #10B981 30%, transparent)"},children:e.jsx(h,{Icon:c.Heart,size:32,style:{color:"#10B981"}})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Heatmap Zones FC"}),e.jsx("p",{className:"text-white/70 text-base max-w-md mx-auto",children:"Aucune donnée de zones de fréquence cardiaque disponible. Utilisez un objet connecté pour suivre vos zones FC."})]});const o=[{key:"z1",label:"Z1 Récupération",color:"#22C55E",lightColor:"#86EFAC"},{key:"z2",label:"Z2 Endurance",color:"#3B82F6",lightColor:"#93C5FD"},{key:"z3",label:"Z3 Tempo",color:"#F59E0B",lightColor:"#FCD34D"},{key:"z4",label:"Z4 Seuil",color:"#F97316",lightColor:"#FDBA74"},{key:"z5",label:"Z5 Max",color:"#EF4444",lightColor:"#FCA5A5"}],n=Math.max(...s.flatMap(m=>[m.z1,m.z2,m.z3,m.z4,m.z5])),u=s.reduce((m,v)=>m+v.z1+v.z2+v.z3+v.z4+v.z5,0),d={z1:s.reduce((m,v)=>m+v.z1,0)/u*100,z2:s.reduce((m,v)=>m+v.z2,0)/u*100,z3:s.reduce((m,v)=>m+v.z3,0)/u*100,z4:s.reduce((m,v)=>m+v.z4,0)/u*100,z5:s.reduce((m,v)=>m+v.z5,0)/u*100};return e.jsxs(F,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:"linear-gradient(135deg, color-mix(in srgb, #EF4444 25%, transparent), color-mix(in srgb, #EF4444 15%, transparent))",border:"1px solid color-mix(in srgb, #EF4444 35%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #EF4444 20%, transparent)"},children:e.jsx(h,{Icon:c.Heart,size:24,style:{color:"#10B981"}})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Heatmap Zones FC"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Distribution du temps par zone de fréquence cardiaque"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-white/70 text-sm font-medium",children:"Distribution globale"}),e.jsxs("span",{className:"text-white/50 text-xs",children:[u.toFixed(0)," min total"]})]}),e.jsx("div",{className:"flex gap-1 h-3 rounded-full overflow-hidden",children:o.map(m=>{const v=d[m.key];return v===0?null:e.jsx("div",{style:{width:`${v}%`,background:m.color},title:`${m.label}: ${v.toFixed(1)}%`},m.key)})})]}),e.jsx("div",{className:"grid grid-cols-5 gap-3 mb-6",children:o.map(m=>{const v=d[m.key];return e.jsxs("div",{className:"p-3 rounded-lg",style:{background:`color-mix(in srgb, ${m.color} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${m.color} 20%, transparent)`},children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:m.color}}),e.jsx("span",{className:"text-xs font-semibold",style:{color:m.lightColor},children:m.label})]}),e.jsxs("p",{className:"text-lg font-bold text-white",children:[v.toFixed(0),"%"]})]},m.key)})}),e.jsx("div",{className:"rounded-xl p-4 overflow-x-auto",style:{background:"rgba(255,255,255,0.03)"},children:e.jsxs("div",{className:"min-w-max",children:[e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("div",{className:"w-20 flex-shrink-0"}),o.map(m=>e.jsx("div",{className:"w-16 text-center",children:e.jsx("span",{className:"text-xs font-semibold",style:{color:m.lightColor},children:m.key.toUpperCase()})},m.key))]}),s.slice(-14).map((m,v)=>e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("div",{className:"w-20 flex-shrink-0 flex items-center",children:e.jsx("span",{className:"text-xs text-white/50",children:m.date})}),o.map(l=>{const g=m[l.key],j=g/n,b=Math.max(.1,j);return e.jsx("div",{className:"w-16 h-10 rounded flex items-center justify-center transition-all duration-200 hover:scale-105",style:{background:`color-mix(in srgb, ${l.color} ${b*100}%, transparent)`,border:g>0?`1px solid color-mix(in srgb, ${l.color} 30%, transparent)`:"1px solid rgba(255,255,255,0.05)"},title:`${m.date} - ${l.label}: ${g}min`,children:g>0&&e.jsx("span",{className:"text-xs font-semibold text-white",children:g.toFixed(0)})},l.key)})]},v))]})}),e.jsxs("div",{className:"mt-6 p-4 rounded-xl",style:{background:"rgba(239, 68, 68, 0.08)",border:"1px solid rgba(239, 68, 68, 0.2)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(h,{Icon:c.Info,size:14,style:{color:"#EF4444"}}),e.jsx("span",{className:"text-red-300 font-semibold text-sm",children:"Analyse"})]}),e.jsx("p",{className:"text-red-200 text-sm leading-relaxed",children:d.z1+d.z2>60?"Excellent équilibre ! Vous passez la majorité du temps en zones d'endurance fondamentale.":d.z4+d.z5>30?"Attention : beaucoup de temps en zones intenses. Assurez-vous de suffisamment récupérer.":"Distribution équilibrée. Variez vos séances pour optimiser les adaptations cardiovasculaires."})]})]})},Vt=({userId:t,period:r})=>{const[s,i]=T.useState([]),[a,p]=T.useState(!0),x=r==="week"?7:r==="month"?30:90;if(T.useEffect(()=>{(async()=>{try{p(!0);const I=new Date;I.setDate(I.getDate()-x);const{data:E,error:S}=await H.from("activities").select("timestamp, training_load_score").eq("user_id",t).gte("timestamp",I.toISOString()).not("training_load_score","is",null).order("timestamp",{ascending:!0});if(S)throw S;if(E&&E.length>0){let q=0,W=0;const ue=[];E.forEach(pe=>{const he=pe.training_load_score||0;q=q+(he-q)/42,W=W+(he-W)/7;const Pe=q-W;ue.push({date:new Date(pe.timestamp).toLocaleDateString("fr-FR",{day:"2-digit",month:"short"}),fitness:q,fatigue:W,form:Pe})}),i(ue)}_.info("FITNESS_FATIGUE_CHART","Data computed successfully",{count:E?.length})}catch(I){_.error("FITNESS_FATIGUE_CHART","Failed to compute fitness/fatigue",{error:I})}finally{p(!1)}})()},[t,x]),a)return e.jsx("div",{className:"h-96 rounded-2xl animate-pulse",style:{background:"rgba(255,255,255,0.05)"}});if(s.length===0)return e.jsxs(F,{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #10B981 20%, transparent), color-mix(in srgb, #10B981 10%, transparent))",border:"1px solid color-mix(in srgb, #10B981 30%, transparent)"},children:e.jsx(h,{Icon:c.TrendingUp,size:32,style:{color:"#10B981"}})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Fitness / Fatigue"}),e.jsx("p",{className:"text-white/70 text-base max-w-md mx-auto",children:"Aucune donnée de charge d'entraînement disponible. Utilisez un objet connecté pour calculer automatiquement votre TRIMP."})]});const o=s[s.length-1],n=o.form;let u;n>10?u={label:"Forme Optimale",color:"#22C55E",advice:"Condition idéale pour une performance maximale. C'est le moment d'un objectif ambitieux !"}:n>0?u={label:"Forme Fraîche",color:"#3B82F6",advice:"Bonne forme générale. Maintenez l'équilibre entre entraînement et récupération."}:n>-10?u={label:"Forme Neutre",color:"#F59E0B",advice:"Équilibre précaire. Ajustez la charge selon vos sensations."}:n>-20?u={label:"Fatigue Modérée",color:"#F97316",advice:"Phase de fatigue accumulée. Privilégiez la récupération et réduisez l'intensité."}:u={label:"Fatigue Élevée",color:"#EF4444",advice:"Attention au surentraînement ! Repos obligatoire. Consultez un professionnel si persistant."};const d=Math.min(...s.flatMap(B=>[B.fitness,B.fatigue,B.form])),m=Math.max(...s.flatMap(B=>[B.fitness,B.fatigue,B.form])),l=(m-d)*.2,g=d-l,b=m+l-g,C=800,y=400,f={top:20,right:20,bottom:40,left:60},N=C-f.left-f.right,w=y-f.top-f.bottom,k=N/(s.length-1||1),z=B=>B.map((I,E)=>{const S=f.left+E*k,P=f.top+w-(I-g)/b*w;return E===0?`M ${S},${P}`:`L ${S},${P}`}).join(" "),O=z(s.map(B=>B.fitness)),R=z(s.map(B=>B.fatigue)),A=z(s.map(B=>B.form));return e.jsxs(F,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`linear-gradient(135deg, color-mix(in srgb, ${u.color} 25%, transparent), color-mix(in srgb, ${u.color} 15%, transparent))`,border:`1px solid color-mix(in srgb, ${u.color} 35%, transparent)`,boxShadow:`0 0 20px color-mix(in srgb, ${u.color} 20%, transparent)`},children:e.jsx(h,{Icon:c.TrendingUp,size:24,style:{color:u.color}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"Courbe Fitness / Fatigue"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Modèle de charge d'entraînement (CTL/ATL/TSB)"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"px-3 py-1 rounded-full text-xs font-semibold mb-2",style:{background:`color-mix(in srgb, ${u.color} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${u.color} 25%, transparent)`,color:u.color},children:u.label}),e.jsx("p",{className:"text-2xl font-bold text-white",children:n.toFixed(1)})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"p-3 rounded-lg",style:{background:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.2)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:"#3B82F6"}}),e.jsx("p",{className:"text-blue-300 text-xs font-medium",children:"Fitness (CTL)"})]}),e.jsx("p",{className:"text-white font-bold text-lg",children:o.fitness.toFixed(1)})]}),e.jsxs("div",{className:"p-3 rounded-lg",style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.2)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:"#EF4444"}}),e.jsx("p",{className:"text-red-300 text-xs font-medium",children:"Fatigue (ATL)"})]}),e.jsx("p",{className:"text-white font-bold text-lg",children:o.fatigue.toFixed(1)})]}),e.jsxs("div",{className:"p-3 rounded-lg",style:{background:`color-mix(in srgb, ${u.color} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${u.color} 20%, transparent)`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:u.color}}),e.jsx("p",{className:"text-xs font-medium",style:{color:u.color},children:"Forme (TSB)"})]}),e.jsx("p",{className:"text-white font-bold text-lg",children:o.form.toFixed(1)})]})]}),e.jsx("div",{className:"relative",style:{width:"100%",height:"300px"},children:e.jsxs("svg",{viewBox:`0 0 ${C} ${y}`,style:{width:"100%",height:"100%"},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"fitness-gradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",style:{stopColor:"#3B82F6",stopOpacity:.2}}),e.jsx("stop",{offset:"100%",style:{stopColor:"#3B82F6",stopOpacity:.02}})]}),e.jsxs("linearGradient",{id:"fatigue-gradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",style:{stopColor:"#EF4444",stopOpacity:.2}}),e.jsx("stop",{offset:"100%",style:{stopColor:"#EF4444",stopOpacity:.02}})]})]}),[0,.25,.5,.75,1].map(B=>{const I=f.top+w*(1-B),E=g+b*B;return e.jsxs("g",{children:[e.jsx("line",{x1:f.left,y1:I,x2:f.left+N,y2:I,stroke:"rgba(255,255,255,0.1)",strokeWidth:"1",strokeDasharray:"4,4"}),e.jsx("text",{x:f.left-10,y:I+4,textAnchor:"end",fill:"rgba(255,255,255,0.5)",fontSize:"12",children:E.toFixed(0)})]},B)}),e.jsx("path",{d:O,fill:"none",stroke:"#3B82F6",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:R,fill:"none",stroke:"#EF4444",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:A,fill:"none",stroke:u.color,strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"6,4"}),s.filter((B,I)=>I%Math.max(1,Math.floor(s.length/8))===0).map((B,I)=>{const E=I*Math.max(1,Math.floor(s.length/8)),S=f.left+E*k;return e.jsx("text",{x:S,y:f.top+w+25,textAnchor:"middle",fill:"rgba(255,255,255,0.5)",fontSize:"12",children:B.date},E)})]})}),e.jsxs("div",{className:"mt-6 p-4 rounded-xl",style:{background:`color-mix(in srgb, ${u.color} 8%, transparent)`,border:`1px solid color-mix(in srgb, ${u.color} 20%, transparent)`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(h,{Icon:c.Lightbulb,size:14,style:{color:u.color}}),e.jsx("span",{className:"font-semibold text-sm",style:{color:u.color},children:"Conseil"})]}),e.jsx("p",{className:"text-sm leading-relaxed",style:{color:u.color},children:u.advice})]})]})},Lt=()=>{const t=me(),{profile:r}=L(),[s,i]=T.useState([]),[a,p]=T.useState(!0),[x,o]=T.useState(!1);T.useEffect(()=>{(async()=>{if(r?.id)try{p(!0);const g=[];i(g),_.info("CONNECTED_GOALS","Goals progress fetched",{count:g.length})}catch(g){_.error("CONNECTED_GOALS","Failed to fetch goals progress",{error:g})}finally{p(!1)}})()},[r?.id]);const n=async()=>{if(r?.id)try{o(!0),i([]),_.info("CONNECTED_GOALS","All goals recalculated successfully")}catch(l){_.error("CONNECTED_GOALS","Failed to recalculate goals",{error:l})}finally{o(!1)}};if(a)return e.jsx("div",{className:"space-y-4",children:[1,2].map(l=>e.jsx("div",{className:"h-32 rounded-2xl animate-pulse",style:{background:"rgba(255,255,255,0.05)"}},l))});if(s.length===0)return e.jsxs(F,{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #10B981 20%, transparent), color-mix(in srgb, #10B981 10%, transparent))",border:"1px solid color-mix(in srgb, #10B981 30%, transparent)"},children:e.jsx(h,{Icon:c.Target,size:32,style:{color:"#10B981"}})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Objectifs Connectés"}),e.jsx("p",{className:"text-white/70 text-base max-w-md mx-auto leading-relaxed mb-6",children:"Créez des objectifs et ils se synchroniseront automatiquement avec vos activités et métriques biométriques pour suivre votre progression en temps réel."}),e.jsx("button",{onClick:()=>{_.info("CONNECTED_GOALS","User clicked Connect Device button",{from:"activity_progression_tab",destination:"/settings?tab=appareils",timestamp:new Date().toISOString()}),t("/settings?tab=appareils")},className:"px-6 py-3 rounded-xl font-semibold text-white transition-all hover:scale-105 active:scale-95",style:{background:"linear-gradient(135deg, #22C55E, #16A34A)",boxShadow:"0 4px 12px rgba(34, 197, 94, 0.3)"},children:"Connecter un Objet"})]});const u=l=>{switch(l){case"volume":return c.Clock;case"distance":return c.MapPin;case"endurance":return c.Activity;case"strength":return c.Zap;case"frequency":return c.Calendar;case"vo2max":return c.Heart;default:return c.Target}},d=(l,g)=>l>=100?{primary:"#22C55E",secondary:"#10B981"}:g?{primary:"#3B82F6",secondary:"#2563EB"}:{primary:"#F59E0B",secondary:"#D97706"},m=(l,g)=>{if(g==="km"||g==="kilometers")return`${l.toFixed(1)} km`;if(g==="minutes"||g==="min"){const j=Math.floor(l/60),b=Math.round(l%60);return j>0?`${j}h ${b}min`:`${b}min`}return g==="sessions"?`${Math.round(l)} séances`:g==="vo2max"?`${l.toFixed(1)} ml/kg/min`:`${l.toFixed(1)} ${g}`},v=l=>{if(!l)return"";const g=new Date(l),j=new Date,b=Math.ceil((g.getTime()-j.getTime())/(1e3*60*60*24));return b<0?"Échéance dépassée":b===0?"Aujourd'hui":b===1?"Demain":b<=7?`${b} jours`:g.toLocaleDateString("fr-FR",{day:"numeric",month:"short"})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, color-mix(in srgb, #8B5CF6 25%, transparent), color-mix(in srgb, #8B5CF6 15%, transparent))",border:"1px solid color-mix(in srgb, #8B5CF6 35%, transparent)"},children:e.jsx(h,{Icon:c.Target,size:20,style:{color:"#10B981"}})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Objectifs Connectés"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Synchronisés avec vos activités"})]})]}),e.jsxs("button",{onClick:n,disabled:x,className:"px-4 py-2 rounded-lg font-medium text-white/80 hover:text-white transition-all flex items-center gap-2",style:{background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsx(h,{Icon:c.RefreshCw,size:16,className:x?"animate-spin":""}),x?"Synchronisation...":"Recalculer"]})]}),e.jsx("div",{className:"space-y-4",children:s.map(l=>{const g=l.goal,j=d(l.progress_percentage,l.on_track),b=u(g.goal_type);return e.jsxs(F,{className:"p-6",style:{background:l.progress_percentage>=100?"radial-gradient(circle at 30% 20%, color-mix(in srgb, #22C55E 12%, transparent) 0%, transparent 60%), var(--glass-opacity)":void 0},children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[e.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`linear-gradient(135deg, color-mix(in srgb, ${j.primary} 25%, transparent), color-mix(in srgb, ${j.secondary} 15%, transparent))`,border:`1px solid color-mix(in srgb, ${j.primary} 35%, transparent)`,boxShadow:`0 0 20px color-mix(in srgb, ${j.primary} 20%, transparent)`},children:e.jsx(h,{Icon:b,size:24,style:{color:j.primary}})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:g.title}),l.progress_percentage>=100&&e.jsx("div",{className:"px-2 py-0.5 rounded-full text-xs font-semibold",style:{background:"color-mix(in srgb, #22C55E 15%, transparent)",border:"1px solid color-mix(in srgb, #22C55E 25%, transparent)",color:"#22C55E"},children:"Complété"}),!l.on_track&&l.progress_percentage<100&&e.jsx("div",{className:"px-2 py-0.5 rounded-full text-xs font-semibold",style:{background:"color-mix(in srgb, #F59E0B 15%, transparent)",border:"1px solid color-mix(in srgb, #F59E0B 25%, transparent)",color:"#F59E0B"},children:"Retard"})]}),g.discipline&&e.jsx("p",{className:"text-white/50 text-sm",children:g.discipline}),g.deadline&&e.jsxs("p",{className:"text-white/50 text-xs mt-1",children:["Échéance: ",v(g.deadline)]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-3xl font-bold text-white",children:[l.progress_percentage.toFixed(0),"%"]}),e.jsx("p",{className:"text-white/50 text-xs",children:"progression"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"relative h-3 rounded-full overflow-hidden",style:{background:"rgba(255,255,255,0.1)"},children:e.jsx("div",{className:"absolute inset-y-0 left-0 rounded-full transition-all duration-500",style:{width:`${Math.min(l.progress_percentage,100)}%`,background:`linear-gradient(90deg, ${j.primary}, ${j.secondary})`,boxShadow:`0 0 12px ${j.primary}`}})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 rounded-lg",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsx("p",{className:"text-white/50 text-xs mb-1",children:"Actuel"}),e.jsx("p",{className:"text-white font-semibold",children:m(g.current_value,g.unit)})]}),e.jsxs("div",{className:"p-3 rounded-lg",style:{background:"rgba(255,255,255,0.05)"},children:[e.jsx("p",{className:"text-white/50 text-xs mb-1",children:"Objectif"}),e.jsx("p",{className:"text-white font-semibold",children:m(g.target_value,g.unit)})]})]}),l.remaining>0&&e.jsxs("div",{className:"p-3 rounded-lg",style:{background:"rgba(255,255,255,0.03)"},children:[e.jsxs("p",{className:"text-white/70 text-sm",children:["Encore ",m(l.remaining,g.unit)," pour atteindre l'objectif"]}),l.estimated_completion_date&&e.jsxs("p",{className:"text-white/50 text-xs mt-1",children:["Estimation: ",new Date(l.estimated_completion_date).toLocaleDateString("fr-FR",{day:"numeric",month:"long"})]})]})]})]},g.id)})})]})},xe={week:"last7Days",month:"last30Days",quarter:"last3Months"};function we(t,r){_.debug("ACTIVITY_PROGRESS_TAB_DIAGNOSTIC","Calculating default period",{hasActivityHistory:t,currentActivities:r,weekThreshold:Y("last7Days"),monthThreshold:Y("last30Days"),quarterThreshold:Y("last3Months"),calculationTime:new Date().toISOString(),timestamp:new Date().toISOString()});const s=Y("last7Days");_.debug("ACTIVITY_PROGRESS_TAB_DIAGNOSTIC","Threshold checks",{currentActivities:r,weekThreshold:s,weekAvailable:r>=s,timestamp:new Date().toISOString()});let i="week";return!t||r<s?(i="week",_.debug("ACTIVITY_PROGRESS_TAB_DIAGNOSTIC","Default period: week (insufficient data or no history)",{hasActivityHistory:t,currentActivities:r,weekThreshold:s,timestamp:new Date().toISOString()})):(i="week",_.debug("ACTIVITY_PROGRESS_TAB_DIAGNOSTIC","Default period: week (prioritized to avoid auto API calls)",{currentActivities:r,weekThreshold:s,reasoning:"always_prioritize_week_to_avoid_costly_auto_calls",timestamp:new Date().toISOString()})),_.debug("ACTIVITY_PROGRESS_TAB_DIAGNOSTIC","Default period calculated",{defaultPeriod:i,reasoning:"always_week_to_prevent_auto_expensive_calls",finalDecision:i,calculationComplete:!0,costOptimization:"prevents_automatic_30day_90day_api_calls",timestamp:new Date().toISOString()}),i}function Ht(t,r){const s=xe[t],i=Y(s);return r>=i}const Gt=()=>{const{profile:t}=L(),{showToast:r}=se(),{click:s}=Z(),{showModal:i}=Fe(),{data:a=!1}=Te(),[p,x]=T.useState(0),o=ie(N=>N.selectedPeriod),n=ie(N=>N.setSelectedPeriod),[u,d]=T.useState(!1),m=xe[o],{data:v,isLoading:l,error:g}=Ee(m),j=Ce(({currentLocation:N,nextLocation:w})=>{const k=l&&N.pathname!==w.pathname;return k&&(_.debug("ACTIVITY_PROGRESS_TAB","Navigation blocked during analysis loading",{currentPath:N.pathname,nextPath:w.pathname,isLoading:l,timestamp:new Date().toISOString()}),i({title:"Attention ! Analyse de progression en cours",message:"Voulez-vous vraiment quitter l'analyse de progression ? Les données d'analyse pourraient être perdues et devront être régénérées.",processName:"Analyse de Progression",onConfirm:()=>{_.info("ACTIVITY_PROGRESS_TAB","User confirmed exit during analysis",{currentPath:N.pathname,nextPath:w.pathname,timestamp:new Date().toISOString()}),j.proceed?.()},onCancel:()=>{_.info("ACTIVITY_PROGRESS_TAB","User cancelled exit during analysis",{currentPath:N.pathname,nextPath:w.pathname,timestamp:new Date().toISOString()}),j.reset?.()}})),k}),b=v?.fallback,C=v?.cached;T.useEffect(()=>{if(v?.current_activities!==void 0)if(_.debug("ACTIVITY_PROGRESS_TAB","Activities count updated from insights data",{previousCount:p,newCount:v.current_activities,selectedPeriod:o,userHasSelectedPeriod:u,cacheStatus:v.cached?"cached":"fresh",willRespectUserChoice:u,timestamp:new Date().toISOString()}),x(v.current_activities),u){const N=Ht(o,v.current_activities);if(_.debug("ACTIVITY_PROGRESS_TAB","Checking user-selected period validity",{selectedPeriod:o,activitiesCount:v.current_activities,isCurrentPeriodValid:N,userHasSelectedPeriod:u,willRespectUserChoice:!0,timestamp:new Date().toISOString()}),!N){const w=we(a,v.current_activities);_.warn("ACTIVITY_PROGRESS_TAB","User-selected period no longer valid, falling back",{invalidPeriod:o,fallbackPeriod:w,activitiesCount:v.current_activities,reason:"user_selected_period_became_invalid",timestamp:new Date().toISOString()}),n(w),d(!1),r({type:"info",title:"Période ajustée",message:`Période changée vers ${w==="week"?"7 jours":w==="month"?"30 jours":"90 jours"} (données insuffisantes pour la période précédente)`,duration:4e3})}}else{const N=we(a,v.current_activities);_.debug("ACTIVITY_PROGRESS_TAB","Auto-calculating period (no user selection)",{currentSelectedPeriod:o,newDefaultPeriod:N,activitiesCount:v.current_activities,willAutoSwitch:N!==o&&!u,timestamp:new Date().toISOString()}),N!==o&&!u&&(_.debug("ACTIVITY_PROGRESS_TAB","Auto-switching to calculated period",{from:o,to:N,reason:"automatic_calculation_respecting_no_user_selection",timestamp:new Date().toISOString()}),n(N))}},[v?.current_activities,u,o,a]),T.useEffect(()=>{g&&(_.error("ACTIVITY_PROGRESS_TAB","Erreur lors de la génération des insights",{error:g instanceof Error?g.message:"Unknown error",selectedPeriod:o,timestamp:new Date().toISOString()}),r({type:"error",title:"Erreur d'analyse",message:"Impossible de générer les insights. Veuillez réessayer.",duration:4e3}))},[g,o,r]);const y=N=>{s(),d(!0),n(N),_.debug("ACTIVITY_PROGRESS_TAB_DIAGNOSTIC","Period changed by user",{newPeriod:N,apiPeriod:xe[N],userAction:!0,manualSelection:!0,userHasSelectedPeriod:!0,timestamp:new Date().toISOString()})},f={week:Y("last7Days"),month:Y("last30Days"),quarter:Y("last3Months")};return a?v?.insufficient_data?e.jsxs("div",{className:"space-y-6",children:[e.jsx(X,{selectedPeriod:o,onPeriodChange:y,currentActivities:p,periodThresholds:f,accentColor:"#10B981"}),e.jsxs(F,{className:"p-8 text-center",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #F59E0B 15%, transparent) 0%, transparent 60%),
              radial-gradient(circle at 70% 80%, color-mix(in srgb, #EF4444 12%, transparent) 0%, transparent 50%),
              linear-gradient(145deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, #F59E0B 30%, transparent)",boxShadow:`
              0 12px 40px rgba(0, 0, 0, 0.25),
              0 0 30px color-mix(in srgb, #F59E0B 20%, transparent),
              inset 0 2px 0 rgba(255, 255, 255, 0.15)
            `},children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6",children:[e.jsx("div",{className:"w-20 h-20 rounded-full flex items-center justify-center breathing-icon",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #F59E0B 30%, transparent), color-mix(in srgb, #F59E0B 20%, transparent))
                `,border:"2px solid color-mix(in srgb, #F59E0B 40%, transparent)",boxShadow:"0 0 30px color-mix(in srgb, #F59E0B 30%, transparent)"},children:e.jsx(h,{Icon:c.AlertCircle,size:40,style:{color:"#F59E0B"}})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-2xl font-bold text-white",children:"Forge en Construction"}),e.jsx("p",{className:"text-white/70 text-base",children:"Plus d'activités nécessaires"})]})]}),e.jsxs("div",{className:"space-y-4 max-w-lg mx-auto",children:[e.jsxs("p",{className:"text-white/80 text-lg leading-relaxed",children:["Vous avez ",e.jsx("strong",{className:"text-orange-300",children:v.current_activities})," activité",v.current_activities>1?"s":""," enregistrée",v.current_activities>1?"s":"","."]}),e.jsxs("p",{className:"text-white/70 text-base leading-relaxed",children:["Il vous faut au moins ",e.jsx("strong",{className:"text-orange-300",children:v.required_activities})," activités pour générer des insights personnalisés sur cette période."]}),e.jsxs("div",{className:"mt-6 p-4 rounded-xl",style:{background:"color-mix(in srgb, #3B82F6 8%, transparent)",border:"1px solid color-mix(in srgb, #3B82F6 20%, transparent)"},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(h,{Icon:c.Zap,size:16,style:{color:"#3B82F6"}}),e.jsx("span",{className:"text-blue-300 font-semibold text-sm",children:"Passez à l'action !"})]}),e.jsxs("p",{className:"text-blue-200 text-sm leading-relaxed",children:["Enregistrez ",v.required_activities-v.current_activities," activité",v.required_activities-v.current_activities>1?"s":""," supplémentaire",v.required_activities-v.current_activities>1?"s":"","pour débloquer vos insights personnalisés et découvrir des recommandations sur mesure."]})]})]})]})]}):b&&v?e.jsxs("div",{className:"space-y-6",children:[e.jsx(X,{selectedPeriod:o,onPeriodChange:y,currentActivities:p,periodThresholds:f,accentColor:"#10B981"}),e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"text-amber-800 text-sm",children:"⚠️ Analyse détaillée temporairement indisponible. Voici les visualisations de base."})}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(je,{data:v?.distribution,period:o,apiPeriod:m}),e.jsx(Ne,{activities:v?.activities||[],period:o,apiPeriod:m})]})})]}):e.jsxs(D.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"space-y-6",children:[e.jsx(X,{selectedPeriod:o,onPeriodChange:y,currentActivities:p,periodThresholds:f,accentColor:"#10B981"}),C&&e.jsx(F,{className:"p-4",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #22C55E 8%, transparent) 0%, transparent 60%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, #22C55E 25%, transparent)",boxShadow:"0 0 16px color-mix(in srgb, #22C55E 15%, transparent)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"color-mix(in srgb, #22C55E 15%, transparent)",border:"1px solid color-mix(in srgb, #22C55E 25%, transparent)"},children:e.jsx(h,{Icon:c.Check,size:14,style:{color:"#22C55E"}})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-green-300 font-medium text-sm",children:"Données mises en cache"}),e.jsxs("p",{className:"text-green-200 text-xs mt-0.5",children:["Dernière analyse: ",v.cache_age_hours,"h • Économie de coûts IA"]})]})]})}),l?e.jsx(Me,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(F,{className:"p-6",style:{background:`
                radial-gradient(circle at 30% 20%, color-mix(in srgb, #10B981 8%, transparent) 0%, transparent 60%),
                var(--glass-opacity)
              `,borderColor:"color-mix(in srgb, #10B981 20%, transparent)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
                    radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                    linear-gradient(135deg, color-mix(in srgb, #10B981 30%, transparent), color-mix(in srgb, #10B981 20%, transparent))
                  `,border:"2px solid color-mix(in srgb, #10B981 40%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #10B981 30%, transparent)"},children:e.jsx(h,{Icon:c.BarChart3,size:20,style:{color:"#10B981"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Visualisez votre évolution énergétique"}),e.jsx("p",{className:"text-green-200 text-sm",children:"Graphiques et tendances de vos activités sur la période sélectionnée"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(je,{data:v?.distribution,period:o,apiPeriod:m}),e.jsx(Ne,{activities:v?.activities||[],period:o,apiPeriod:m})]}),t?.id&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(Pt,{userId:t.id,period:o}),e.jsx(Ot,{userId:t.id,period:o})]}),t?.id&&e.jsx("div",{className:"space-y-6",children:e.jsx(Lt,{})}),t?.id&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(qt,{userId:t.id,period:o}),e.jsx(Rt,{userId:t.id,period:o}),e.jsx(Vt,{userId:t.id,period:o})]}),e.jsx(F,{className:"p-6 text-center",style:{background:`
                radial-gradient(circle at 30% 20%, color-mix(in srgb, #F59E0B 8%, transparent) 0%, transparent 60%),
                var(--glass-opacity)
              `,borderColor:"color-mix(in srgb, #F59E0B 20%, transparent)"},children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx(h,{Icon:c.Lightbulb,size:16,style:{color:"#F59E0B"}}),e.jsxs("p",{className:"text-white/70 text-sm",children:["Consultez l'onglet ",e.jsx("strong",{className:"text-orange-300",children:"Insights"})," pour des conseils personnalisés basés sur ces données"]})]})})]})]}):e.jsx("div",{className:"space-y-6",children:e.jsxs(F,{className:"p-8 text-center",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #10B981 15%, transparent) 0%, transparent 60%),
              radial-gradient(circle at 70% 80%, color-mix(in srgb, #10B981 12%, transparent) 0%, transparent 50%),
              linear-gradient(145deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, #10B981 30%, transparent)",boxShadow:`
              0 12px 40px rgba(0, 0, 0, 0.25),
              0 0 30px color-mix(in srgb, #10B981 20%, transparent),
              inset 0 2px 0 rgba(255, 255, 255, 0.15)
            `},children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6",children:[e.jsx("div",{className:"w-20 h-20 rounded-full flex items-center justify-center",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #10B981 30%, transparent), color-mix(in srgb, #10B981 20%, transparent))
                `,border:"2px solid color-mix(in srgb, #10B981 40%, transparent)",boxShadow:"0 0 30px color-mix(in srgb, #10B981 30%, transparent)"},children:e.jsx(h,{Icon:c.Activity,size:40,style:{color:"#10B981"}})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-2xl font-bold text-white",children:"Progression Vierge"}),e.jsx("p",{className:"text-white/70 text-base",children:"Vos données de progression vous attendent"})]})]}),e.jsxs("p",{className:"text-white/70 text-base max-w-lg mx-auto leading-relaxed",children:["Enregistrez au moins ",f.week," activités pour débloquer vos conseils personnalisés et découvrir des insights sur votre progression énergétique."]})]})})},Yt=({activity:t,onClose:r,onDelete:s})=>{const{click:i}=Z(),a=n=>{n.target===n.currentTarget&&(i(),r())},p=()=>{s&&(s(t.id),r())},x=V(t.intensity),o=ke(t.type);return qe.createPortal(e.jsx(Be,{children:e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",style:{background:"rgba(0, 0, 0, 0.8)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)"},onClick:a,role:"dialog","aria-modal":"true","aria-labelledby":"activity-detail-title",children:e.jsx(D.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{type:"spring",stiffness:300,damping:30},className:"w-full max-w-lg",onClick:n=>n.stopPropagation(),children:e.jsxs(F,{className:"p-6",style:{background:`
                radial-gradient(circle at 30% 20%, color-mix(in srgb, ${x} 12%, transparent) 0%, transparent 60%),
                radial-gradient(circle at 70% 80%, color-mix(in srgb, ${x} 8%, transparent) 0%, transparent 50%),
                linear-gradient(145deg, rgba(255,255,255,0.15), rgba(255,255,255,0.10)),
                rgba(11, 14, 23, 0.95)
              `,borderColor:`color-mix(in srgb, ${x} 30%, transparent)`,boxShadow:`
                0 25px 80px rgba(0, 0, 0, 0.6),
                0 0 60px color-mix(in srgb, ${x} 30%, transparent),
                inset 0 3px 0 rgba(255, 255, 255, 0.3),
                inset 0 -3px 0 rgba(0, 0, 0, 0.2)
              `,backdropFilter:"blur(32px) saturate(180%)",WebkitBackdropFilter:"blur(32px) saturate(180%)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center",style:{background:`
                      radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, transparent 60%),
                      linear-gradient(135deg, color-mix(in srgb, ${x} 40%, transparent), color-mix(in srgb, ${x} 30%, transparent))
                    `,border:`3px solid color-mix(in srgb, ${x} 60%, transparent)`,boxShadow:`0 0 30px color-mix(in srgb, ${x} 50%, transparent)`},children:e.jsx(h,{Icon:c[o],size:28,style:{color:x},variant:"pure"})}),e.jsxs("div",{children:[e.jsx("h2",{id:"activity-detail-title",className:"text-2xl font-bold text-white mb-1",children:t.type}),e.jsx("p",{className:"text-white/70 text-sm",children:M(new Date(t.timestamp),"EEEE dd MMMM yyyy à HH:mm",{locale:G})})]})]}),e.jsx("button",{onClick:r,className:"p-2 rounded-full transition-all duration-200",style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)"},"aria-label":"Fermer le détail",children:e.jsx(h,{Icon:c.X,size:18,className:"text-white/80"})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${x} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${x} 20%, transparent)`},children:[e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:t.duration_min}),e.jsx("div",{className:"text-white/70 text-sm",children:"Minutes"})]}),e.jsxs("div",{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${x} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${x} 20%, transparent)`},children:[e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:t.calories_est}),e.jsx("div",{className:"text-white/70 text-sm",children:"Calories"})]}),e.jsxs("div",{className:"text-center p-4 rounded-xl",style:{background:`color-mix(in srgb, ${x} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${x} 20%, transparent)`},children:[e.jsx("div",{className:"text-lg font-bold text-white mb-1",children:Ie(t.intensity)}),e.jsx("div",{className:"text-white/70 text-sm",children:"Intensité"})]})]}),t.notes&&e.jsxs("div",{className:"mb-6 p-4 rounded-xl",style:{background:`color-mix(in srgb, ${x} 6%, transparent)`,border:`1px solid color-mix(in srgb, ${x} 15%, transparent)`},children:[e.jsxs("h4",{className:"text-white font-medium mb-2 flex items-center gap-2",children:[e.jsx(h,{Icon:c.FileText,size:14,style:{color:x}}),"Notes"]}),e.jsx("p",{className:"text-white/80 text-sm leading-relaxed",children:t.notes})]}),e.jsxs("div",{className:"mb-6 p-4 rounded-xl bg-white/5 border border-white/10",children:[e.jsxs("h4",{className:"text-white font-medium mb-3 flex items-center gap-2",children:[e.jsx(h,{Icon:c.Info,size:14,className:"text-white/70"}),"Informations Techniques"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-white/60",children:"ID :"}),e.jsxs("div",{className:"text-white/80 font-mono text-xs mt-1",children:[t.id.substring(0,8),"..."]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-white/60",children:"Créé le :"}),e.jsx("div",{className:"text-white/80 text-xs mt-1",children:M(new Date(t.created_at),"dd/MM/yyyy HH:mm")})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[s&&e.jsx("button",{onClick:p,className:"flex-1 px-4 py-3 rounded-full font-semibold",style:{background:`linear-gradient(135deg, 
                      color-mix(in srgb, #EF4444 80%, transparent), 
                      color-mix(in srgb, #F59E0B 60%, transparent)
                    )`,border:"2px solid color-mix(in srgb, #EF4444 60%, transparent)",boxShadow:`
                      0 12px 40px color-mix(in srgb, #EF4444 40%, transparent),
                      0 0 60px color-mix(in srgb, #EF4444 30%, transparent),
                      inset 0 3px 0 rgba(255,255,255,0.4)
                    `,backdropFilter:"blur(20px) saturate(160%)",color:"#fff"},children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(h,{Icon:c.Trash2,size:16,className:"text-white"}),e.jsx("span",{children:"Supprimer"})]})}),e.jsx("button",{onClick:r,className:"flex-1 px-4 py-3 rounded-full font-semibold",style:{background:`linear-gradient(135deg, 
                    color-mix(in srgb, #6B7280 80%, transparent), 
                    color-mix(in srgb, #9CA3AF 60%, transparent)
                  )`,border:"2px solid color-mix(in srgb, #6B7280 60%, transparent)",boxShadow:`
                    0 8px 32px color-mix(in srgb, #6B7280 30%, transparent),
                    inset 0 2px 0 rgba(255,255,255,0.3)
                  `,backdropFilter:"blur(16px) saturate(140%)",color:"#fff"},children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(h,{Icon:c.X,size:16,className:"text-white"}),e.jsx("span",{children:"Fermer"})]})})]})]})})})}),document.body)},Ut=()=>{const{profile:t}=L(),{click:r,success:s,error:i}=Z(),{showToast:a}=se();_e();const p=t?.userId,[x,o]=Re.useState(null),{data:n,isLoading:u,error:d}=tt(100),m=Ae();T.useEffect(()=>{d&&(_.error("ACTIVITY_HISTORY_TAB","Failed to load activity history",{error:d instanceof Error?d.message:"Unknown error",userId:p,timestamp:new Date().toISOString()}),i(),a({type:"error",title:"Erreur de Chargement",message:"Impossible de charger votre historique d'activités.",duration:4e3}))},[d,p,i,a]);const v=T.useMemo(()=>n?n.reduce((b,C)=>{const y=M(new Date(C.timestamp),"yyyy-MM-dd");return b[y]||(b[y]=[]),b[y].push(C),b},{}):{},[n]),l=b=>{const C=new Date(b);return Qe(C)?"Aujourd'hui":et(C)?"Hier":M(C,"EEEE dd MMMM",{locale:G})},g=b=>{r(),o(b),_.info("ACTIVITY_HISTORY_TAB","Activity detail opened",{activityId:b.id,activityType:b.type,userId:p,timestamp:new Date().toISOString()})},j=b=>{_.info("ACTIVITY_HISTORY_TAB","Delete activity requested from history",{activityId:b,userId:p,timestamp:new Date().toISOString()}),m.mutate(b)};return u?e.jsx("div",{className:"space-y-6",children:[...Array(5)].map((b,C)=>e.jsx(F,{className:"p-6",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-white/10 rounded-full"}),e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx("div",{className:"h-4 bg-white/10 rounded w-1/3"}),e.jsx("div",{className:"h-3 bg-white/5 rounded w-1/2"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-16 bg-white/5 rounded-xl"}),e.jsx("div",{className:"h-16 bg-white/5 rounded-xl"})]})]})},C))}):!n||n.length===0?e.jsx("div",{className:"space-y-6",children:e.jsxs(F,{className:"p-8 text-center",style:{background:`
              radial-gradient(circle at 30% 20%, color-mix(in srgb, #8B5CF6 12%, transparent) 0%, transparent 60%),
              radial-gradient(circle at 70% 80%, color-mix(in srgb, #A855F7 8%, transparent) 0%, transparent 50%),
              var(--glass-opacity)
            `,borderColor:"color-mix(in srgb, #8B5CF6 25%, transparent)",boxShadow:`
              0 12px 40px rgba(0, 0, 0, 0.25),
              0 0 30px color-mix(in srgb, #8B5CF6 15%, transparent),
              inset 0 2px 0 rgba(255, 255, 255, 0.15)
            `},children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6",children:[e.jsx("div",{className:"w-20 h-20 rounded-full flex items-center justify-center",style:{background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                  linear-gradient(135deg, color-mix(in srgb, #8B5CF6 30%, transparent), color-mix(in srgb, #8B5CF6 20%, transparent))
                `,border:"2px solid color-mix(in srgb, #8B5CF6 40%, transparent)",boxShadow:"0 0 30px color-mix(in srgb, #8B5CF6 30%, transparent)"},children:e.jsx(h,{Icon:c.History,size:40,style:{color:"#8B5CF6"}})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-2xl font-bold text-white",children:"Forge Énergétique Vierge"}),e.jsx("p",{className:"text-white/70 text-base",children:"Votre historique d'activités vous attend"})]})]}),e.jsx("p",{className:"text-white/70 text-base max-w-lg mx-auto leading-relaxed",children:"Aucune activité enregistrée pour le moment. Commencez à enregistrer vos activités pour construire votre historique énergétique et suivre votre progression."})]})}):e.jsxs(e.Fragment,{children:[e.jsx(D.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"space-y-6 w-full",children:Object.entries(v).map(([b,C])=>{const y=C.reduce((N,w)=>N+w.calories_est,0),f=C.reduce((N,w)=>N+w.duration_min,0);return e.jsx("div",{className:"activity-group-enter",children:e.jsxs(F,{className:"p-6",style:{background:`
                    radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-activity-primary) 8%, transparent) 0%, transparent 60%),
                    var(--glass-opacity)
                  `,borderColor:"color-mix(in srgb, var(--color-activity-primary) 20%, transparent)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
                          radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15) 0%, transparent 60%),
                          linear-gradient(135deg, color-mix(in srgb, #8B5CF6 30%, transparent), color-mix(in srgb, #8B5CF6 20%, transparent))
                        `,border:"2px solid color-mix(in srgb, #8B5CF6 40%, transparent)",boxShadow:"0 0 20px color-mix(in srgb, #8B5CF6 30%, transparent)"},children:e.jsx(h,{Icon:c.Calendar,size:18,style:{color:"#8B5CF6"}})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-bold text-xl",children:l(b)}),e.jsx("p",{className:"text-blue-200 text-sm",children:"Forge énergétique de la journée"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-white font-bold text-lg",children:[y," kcal"]}),e.jsxs("div",{className:"text-white/60 text-sm",children:[C.length," activité",C.length>1?"s":""," • ",f," min"]})]})]}),e.jsx("div",{className:"space-y-3",children:C.map((N,w)=>e.jsx("div",{className:"group relative",children:e.jsx("div",{className:"p-5 rounded-xl cursor-pointer transition-all duration-200 hover:scale-[1.02] activity-item-enter",style:{background:`color-mix(in srgb, ${V(N.intensity)} 4%, transparent)`,border:`1px solid color-mix(in srgb, ${V(N.intensity)} 12%, transparent)`,backdropFilter:"blur(8px) saturate(120%)",animationDelay:`${w*.1}s`},onMouseEnter:k=>{k.currentTarget.style.background=`color-mix(in srgb, ${V(N.intensity)} 8%, transparent)`,k.currentTarget.style.borderColor=`color-mix(in srgb, ${V(N.intensity)} 20%, transparent)`,k.currentTarget.style.boxShadow=`0 4px 16px color-mix(in srgb, ${V(N.intensity)} 15%, transparent)`},onMouseLeave:k=>{k.currentTarget.style.background=`color-mix(in srgb, ${V(N.intensity)} 4%, transparent)`,k.currentTarget.style.borderColor=`color-mix(in srgb, ${V(N.intensity)} 12%, transparent)`,k.currentTarget.style.boxShadow="none"},onClick:()=>g(N),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center",style:{background:`
                                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.12) 0%, transparent 60%),
                                  linear-gradient(135deg, color-mix(in srgb, ${V(N.intensity)} 25%, transparent), color-mix(in srgb, ${V(N.intensity)} 15%, transparent))
                                `,border:`1px solid color-mix(in srgb, ${V(N.intensity)} 30%, transparent)`,boxShadow:`0 0 12px color-mix(in srgb, ${V(N.intensity)} 20%, transparent)`},children:e.jsx(h,{Icon:c[ke(N.type)],size:18,style:{color:V(N.intensity)}})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-semibold text-lg",children:N.type}),e.jsxs("div",{className:"text-white/70 text-sm",children:[Ie(N.intensity)," • ",M(new Date(N.timestamp),"HH:mm")]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-white font-bold text-lg",children:[N.duration_min," min"]}),e.jsxs("div",{className:"text-white/60 text-sm",children:[N.calories_est," kcal"]})]}),e.jsx("button",{onClick:k=>{k.stopPropagation(),j(N.id)},disabled:m.isPending,className:"opacity-0 group-hover:opacity-100 transition-opacity duration-200 p-2 rounded-full",style:{background:"rgba(239, 68, 68, 0.15)",border:"1px solid rgba(239, 68, 68, 0.3)"},title:"Supprimer cette activité",children:m.isPending?e.jsx(h,{Icon:c.Loader2,size:14,className:"text-red-400 animate-spin"}):e.jsx(h,{Icon:c.Trash2,size:14,className:"text-red-400"})})]})]})})},N.id))})]})},b)})}),e.jsx(Be,{children:x&&e.jsx(Yt,{activity:x,onClose:()=>o(null),onDelete:j})})]})};function Zt(t){switch(t){case"daily":return{icon:"Activity",title:"Tracker",subtitle:"Suivez votre activité physique quotidienne",circuit:"activity",color:"#3B82F6"};case"insights":return{icon:"BarChart3",title:"Insights",subtitle:"Analyses avancées de vos performances",circuit:"activity",color:"#F59E0B"};case"progression":return{icon:"TrendingUp",title:"Progression",subtitle:"Évolution de vos performances physiques",circuit:"activity",color:"#10B981"};case"history":return{icon:"History",title:"Historique",subtitle:"Toutes vos séances et activités enregistrées",circuit:"activity",color:"#8B5CF6"};default:return{icon:"Activity",title:"Activité Physique",subtitle:"Suivez et analysez vos performances",circuit:"activity",color:"#3B82F6"}}}const as=()=>{const t=Ve();me();const{showFeedback:r}=Z(),s=T.useMemo(()=>{const p=t.hash.replace("#","");return(p?decodeURIComponent(p):"")||"daily"},[t.hash]),i=Zt(s),a=p=>{_.info("Activity tab changed",{tab:p})};return e.jsxs(D.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"space-y-6",children:[e.jsx(He,{icon:i.icon,title:i.title,subtitle:i.subtitle,circuit:i.circuit,iconColor:i.color}),e.jsxs(U,{defaultValue:"daily",className:"w-full",onValueChange:a,forgeContext:"activity",children:[e.jsxs(U.List,{children:[e.jsx(U.Trigger,{value:"daily",icon:"Activity",children:"Tracker"}),e.jsx(U.Trigger,{value:"insights",icon:"BarChart3",children:"Insights"}),e.jsx(U.Trigger,{value:"progression",icon:"TrendingUp",children:"Progression"}),e.jsx(U.Trigger,{value:"history",icon:"History",children:"Historique"})]}),e.jsx(U.Panel,{value:"daily",className:"mt-6",children:e.jsx(It,{})}),e.jsx(U.Panel,{value:"insights",className:"mt-6",children:e.jsx(Dt,{})}),e.jsx(U.Panel,{value:"progression",className:"mt-6",children:e.jsx(Gt,{})}),e.jsx(U.Panel,{value:"history",className:"mt-6",children:e.jsx(Ut,{})})]})]})};export{as as default};
