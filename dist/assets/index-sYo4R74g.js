const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Home-7rKTwsqc.js","assets/vendor-DX97-qL9.js","assets/utils-CUtLAp28.js","assets/supabase-C_rF2iqf.js","assets/page-fridge-scan-ZLPWYd6x.js","assets/stores-DcNfcD_j.js","assets/page-fridge-BvAjnJpI.js","assets/ui-components-DWjWyKd7.js","assets/motion-DLE-fuXv.js","assets/ui-components-BfdLI5ID.css","assets/date-utils-sCOX3Ksr.js","assets/page-fridge-scan-DAz6gEg3.css","assets/Profile-1IXM_tiF.js","assets/useScrollMemory-C8VkSb5_.js","assets/page-profile-Bm2vJ3_O.js","assets/forms-BNC8g0IA.js","assets/ActivityPage-DlXHk3NN.js","assets/ActivityUtils-B02xsDYH.js","assets/ActivityUtils-D7PHTcg4.css","assets/FastingPage-nWci1V9W.js","assets/FastingTipsCard-8yThwNr9.js","assets/MealsPage-DrG7xwQu.js","assets/ScanExitConfirmationModal-DP8K-vvG.js","assets/MealScanFlowPage-VnnHAbya.js","assets/MealScanFlowPage-D1lXSlqb.css","assets/FridgePage-nTt68L6X.js","assets/TrainingPage-eY2VZxGO.js","assets/UnderConstructionCard-S84izt9v.js","assets/SettingsPage-CmE1fBy0.js","assets/SettingsPage--eX8c2e1.css","assets/NotificationsPage-DkpguJNp.js","assets/BodyScanPage-xGF91KXt.js","assets/AvatarPage-DMr8ET41.js","assets/Avatar3DViewer-ChhNpHs3.js","assets/normalizeSkinTone-gBHfMnNZ.js","assets/BodyScan-Dya8-Qjv.js","assets/BodyScanProgressHeader-C9OstcTU.js","assets/BodyScanProgressHeader-CArGgCyz.css","assets/BodyScanCelebrationWithHeader-ByrlqeVo.js","assets/BodyScanReviewWithHeader-B91STXgt.js","assets/ActivityInputPage-B_JdkKrS.js","assets/ActivityInputPage-BrlLrD1Y.css","assets/FastingInputPage-kHorXwsk.js","assets/FridgeScanPage-Bm6pkHli.js","assets/VitalPage-6JAqj2pR.js","assets/DevCachePage-B7kfahNY.js","assets/LogoGalleryPage-BE2BFIHB.js"])))=>i.map(i=>d[i]);
var pe=Object.defineProperty;var me=(r,t,i)=>t in r?pe(r,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[t]=i;var F=(r,t,i)=>me(r,typeof t!="symbol"?t+"":t,i);import{w as q,_}from"./page-fridge-scan-ZLPWYd6x.js";import{R as C,r as l,j as e,u as $,cK as V,cL as he,cM as ge,cN as fe,cO as be,cP as xe,cQ as ve,cR as ye,cS as we}from"./vendor-DX97-qL9.js";import{L as Se,T as Z,S as O,I as T,d as je,B as Ee,M as Ae,g as Ne,e as G,n as Ce,f as _e,u as ne,h as ke,U as Ie,i as Te,F as Pe,j as Oe,D as De,k as Le,G as te}from"./ui-components-DWjWyKd7.js";import{j as W,h as Re,Z as Fe,c as ze,a as Ue,k as ae,b as X}from"./stores-DcNfcD_j.js";import{l as d,u as H,f as Me,a as Be,h as $e,t as We,b as He,s as R,d as Ge}from"./page-fridge-BvAjnJpI.js";import{a as Ve}from"./utils-CUtLAp28.js";import{m as L,u as Ye,A as J}from"./motion-DLE-fuXv.js";import"./supabase-C_rF2iqf.js";import"./date-utils-sCOX3Ksr.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function i(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(n){if(n.ep)return;n.ep=!0;const a=i(n);fetch(n.href,a)}})();function qe(){const[r,t]=C.useState(!1),[i,s]=C.useState(!1),[n,a]=C.useState(null),[u,g]=C.useState(null);return l.useEffect(()=>{if(!("serviceWorker"in navigator)){d.info("PWA_UPDATE","Service Worker not supported",{userAgent:navigator.userAgent.substring(0,100),timestamp:new Date().toISOString()});return}const h=c=>{const b=c.waiting;b&&(g(b),t(!0),a({version:"Nouvelle version",features:["Améliorations de performance","Nouvelles fonctionnalités","Corrections de bugs"],isRequired:!1}),d.info("PWA_UPDATE","Service Worker update detected",{swState:b.state,timestamp:new Date().toISOString()}))},p=()=>{d.info("PWA_UPDATE","Service Worker controller changed",{timestamp:new Date().toISOString()}),window.location.reload()};return navigator.serviceWorker.getRegistration().then(c=>{c&&(c.addEventListener("updatefound",()=>{const b=c.installing;b&&b.addEventListener("statechange",()=>{b.state==="installed"&&navigator.serviceWorker.controller&&h(c)})}),c.waiting&&h(c))}),navigator.serviceWorker.addEventListener("controllerchange",p),navigator.serviceWorker.addEventListener("message",c=>{try{const b=typeof c.data=="string"?JSON.parse(c.data):c.data;b&&b.type==="UPDATE_AVAILABLE"&&(t(!0),a(b.updateInfo||null),d.info("PWA_UPDATE","Update message received from Service Worker",{updateInfo:b.updateInfo,timestamp:new Date().toISOString()}))}catch(b){d.warn("PWA_UPDATE","Failed to parse service worker message",{error:b instanceof Error?b.message:"Unknown error",timestamp:new Date().toISOString()})}}),()=>{navigator.serviceWorker.removeEventListener("controllerchange",p)}},[]),{isUpdateAvailable:r,isUpdating:i,updateInfo:n,applyUpdate:async()=>{if(!u){d.warn("PWA_UPDATE","No waiting Service Worker available for update",{timestamp:new Date().toISOString()});return}s(!0);try{d.info("PWA_UPDATE","Applying Service Worker update",{swState:u.state,timestamp:new Date().toISOString()}),u.postMessage({type:"SKIP_WAITING"})}catch(h){d.error("PWA_UPDATE","Failed to apply update",{error:h instanceof Error?h.message:"Unknown error",timestamp:new Date().toISOString()}),s(!1)}},dismissUpdate:()=>{t(!1),a(null),g(null),d.info("PWA_UPDATE","Update notification dismissed",{timestamp:new Date().toISOString()})},checkForUpdates:()=>{"serviceWorker"in navigator&&navigator.serviceWorker.getRegistration().then(h=>{h&&(d.info("PWA_UPDATE","Manually checking for updates",{timestamp:new Date().toISOString()}),h.update())})}}}const Ke=()=>{const{activeOverlayId:r,close:t}=W(),{isOpen:i,close:s}=Re();l.useEffect(()=>{const n=a=>{if(a.key==="Escape"){if(i){d.debug("ESCAPE_KEY","Closing chat drawer"),s(),a.preventDefault(),a.stopPropagation();return}if(r!=="none"){d.debug("ESCAPE_KEY","Closing overlay",{overlayId:r}),t(),a.preventDefault(),a.stopPropagation();return}}};return document.addEventListener("keydown",n,{capture:!0}),()=>{document.removeEventListener("keydown",n,{capture:!0})}},[r,i,t,s])},A=({title:r="Initialisation de TwinForge",subtitle:t="Préparation de votre espace de forge..."})=>e.jsx("div",{className:"flex items-center justify-center min-h-[400px] bg-transparent",children:e.jsx(Se,{variant:"default",title:r,subtitle:t,showProgressBar:!1})}),Qe=()=>{const r=$(),{click:t,headerClick:i}=H(),[s,n]=C.useState(!1),a=f=>{f.preventDefault(),d.trace("HEADER","Logo click triggered"),r("/",{replace:!0})},u=()=>{d.trace("HEADER","Logo pointer down"),i()},g=()=>{n(!0)},m=()=>{n(!1)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden lg:block",children:e.jsx("button",{onClick:a,onPointerDown:u,onMouseEnter:g,onMouseLeave:m,className:"focus-ring rounded-lg transition-colors cursor-pointer flex items-center justify-center h-full","aria-label":"Retour au tableau de bord",onKeyDown:f=>{(f.key==="Enter"||f.key===" ")&&(f.preventDefault(),a(f))},children:e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(L.div,{className:"relative transition-all duration-300 ease-out",animate:s?{scale:1.05}:{scale:1},transition:{duration:.2,ease:[.25,.1,.25,1]},children:e.jsx(Z,{variant:"desktop",isHovered:s})})})})}),e.jsx("div",{className:"lg:hidden",children:e.jsx("button",{onClick:a,onPointerDown:u,onMouseEnter:g,onMouseLeave:m,className:"focus-ring rounded-lg transition-colors cursor-pointer flex items-center justify-center","aria-label":"Retour au tableau de bord",onKeyDown:f=>{(f.key==="Enter"||f.key===" ")&&(f.preventDefault(),a(f))},children:e.jsx(L.div,{className:"relative",animate:s?{scale:1.05}:{scale:1},transition:{duration:.2,ease:[.25,.1,.25,1]},children:e.jsx(Z,{variant:"mobile",isHovered:s})})})})]})},U=[{key:"navigation",title:"Navigation Principale",actions:[{id:"home",label:"Tableau de Bord",subtitle:"Vue d'ensemble TwinForge",icon:"Home",route:"/",color:"#F7931E",available:!0,description:"Retourner au tableau de bord principal"}]},{key:"alimentation",title:"Alimentation",actions:[{id:"scan-meal",label:"Scanner de Repas",subtitle:"Analysez vos repas",icon:"Camera",route:"/meals/scan",color:"#10B981",available:!0,description:"Analyser un repas avec précision"},{id:"generate-recipe",label:"Générateur de Recettes",subtitle:"Recettes personnalisées",icon:"ChefHat",route:"/fridge#recipes",color:"#EC4899",available:!0,description:"Générer des recettes personnalisées"},{id:"generate-meal-plan",label:"Générateur de Plans",subtitle:"Plan alimentaire hebdo",icon:"Calendar",route:"/fridge#plan",color:"#8B5CF6",available:!0,description:"Générer un plan de repas personnalisé"},{id:"generate-shopping-list",label:"Générateur de Courses",subtitle:"Liste optimisée",icon:"ShoppingCart",route:"/fridge#courses",color:"#F59E0B",available:!0,description:"Créer une liste de courses optimisée"},{id:"scan-fridge",label:"Scanner de Frigo",subtitle:"Inventaire intelligent",icon:"Scan",route:"/fridge/scan",color:"#06B6D4",available:!0,description:"Scanner votre frigo pour créer un inventaire"}]},{key:"activite",title:"Activité",actions:[{id:"coach-training",label:"Coach Training",subtitle:"Live Training",icon:"Dumbbell",route:"/training",color:"#F97316",available:!0,description:"Accéder à la pipeline de training avec coaching en direct"},{id:"track-activity",label:"Tracker d'Activité",subtitle:"Enregistrez vos séances",icon:"Activity",route:"/activity/input",color:"#3B82F6",available:!0,description:"Enregistrer une nouvelle séance d'activité"}]},{key:"sante",title:"Santé",actions:[{id:"start-fasting",label:"Tracker de Jeûne",subtitle:"Gérez vos sessions",icon:"Timer",route:"/fasting/input",color:"#F59E0B",available:!0,description:"Commencer une période de jeûne"},{id:"forge-vitale",label:"Forge Vitale",subtitle:"Bientôt disponible",icon:"Heart",color:"#EF4444",available:!1,comingSoon:!0,description:"Suivi de santé complet (bientôt disponible)"}]},{key:"avatar-twin",title:"TwinForge Avatar",actions:[{id:"avatar-scan",label:"Mon Avatar en 3D",subtitle:"Créez votre jumeau numérique",icon:"Scan",route:"/body-scan",color:"#D946EF",available:!0,description:"Scanner et créer votre avatar 3D personnalisé"}]}];function re(r){const t=(r||"#999999").replace("#",""),i=parseInt(t.length===3?t.split("").map(u=>u+u).join(""):t,16),s=i>>16&255,n=i>>8&255,a=i&255;return[s,n,a]}function M(r,t){return r.find(i=>i.key===t)||{title:"",actions:[]}}const se=({isOpen:r})=>{const t=$(),i=Ye(),{click:s,success:n}=H(),{close:a}=W(),u=M(U,"alimentation"),g=M(U,"activite"),m=M(U,"sante"),f=M(U,"navigation"),w=M(U,"avatar-twin"),h=f.actions.find(o=>["home","dashboard","root"].includes(o.id)||/accueil|home|cœur|coeur|coeur de la forge|forge/i.test(o.label))||null,p=(o,k=!1,y)=>{if(!o?.available||o?.comingSoon){d.warn("CENTRAL_ACTIONS","Action not available",{actionId:o?.id,comingSoon:o?.comingSoon});return}d.info("CENTRAL_ACTIONS","Action clicked",{actionId:o.id,actionLabel:o.label,route:o.route,hasEvent:!!y}),o.id==="home"?$e():k?We(o.color):He(o.color),a(),o.route?(d.info("CENTRAL_ACTIONS","Navigating to route",{actionId:o.id,actionLabel:o.label,route:o.route,timestamp:new Date().toISOString()}),setTimeout(()=>{d.info("CENTRAL_ACTIONS","Executing navigation",{route:o.route}),t(o.route)},100)):typeof o.onClick=="function"&&o.onClick()};C.useEffect(()=>{r?Me():Be()},[r]),C.useEffect(()=>{if(!r)return;const o=v=>{if(v.target.closest('button[role="menuitem"]'))return;const j=document.querySelectorAll(".central-action-button, .user-panel-toggle"),D=document.querySelector(".central-actions-menu");let S=!1;j.forEach(I=>{I.contains(v.target)&&(S=!0)}),!S&&D&&!D.contains(v.target)&&a()},k=v=>{v.key==="Escape"&&a()},y=setTimeout(()=>{document.addEventListener("mousedown",o),document.addEventListener("keydown",k)},150);return()=>{clearTimeout(y),document.removeEventListener("mousedown",o),document.removeEventListener("keydown",k)}},[r,a]);const c=i?{duration:.2,ease:[.25,.1,.25,1]}:{type:"spring",stiffness:280,damping:22,mass:.9},b=({action:o,index:k})=>{const[y,v,x]=re(o.color||"#18E3FF"),j=o.comingSoon||!o.available;return e.jsxs(L.button,{onClick:D=>p(o,!1,D),disabled:j,className:"glass-card rounded-xl px-2 py-1.5 flex items-center gap-1.5 w-full relative",style:{background:"var(--glass-opacity-base)",border:`1px solid rgba(${y}, ${v}, ${x}, 0.24)`,boxShadow:"inset 0 1px 0 rgba(255,255,255,0.12), 0 4px 14px rgba(0,0,0,0.18)",opacity:j?.5:1,cursor:j?"not-allowed":"pointer"},initial:{opacity:0,y:10},animate:{opacity:j?.5:1,y:0},transition:{...c,delay:i?0:k*.05},whileHover:i||j?{}:{y:-1,scale:1.02},whileTap:i||j?{}:{scale:.98},role:"menuitem","aria-label":o.description||o.label,"aria-disabled":j,children:[e.jsx("div",{className:"w-6 h-6 rounded-lg flex items-center justify-center flex-shrink-0",style:{background:`linear-gradient(135deg, rgba(${y}, ${v}, ${x}, 0.3), rgba(${y}, ${v}, ${x}, 0.18))`,border:`1px solid rgba(${y}, ${v}, ${x}, 0.4)`,borderRadius:"0.5rem",overflow:"hidden"},children:e.jsx(O,{Icon:T[o.icon],size:13,style:{color:o.color}})}),e.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[e.jsx("div",{className:"text-[11px] font-semibold text-white leading-tight break-words",children:o.label}),o.subtitle&&e.jsx("div",{className:"text-[9px] text-white/65 leading-tight mt-0.5 break-words",children:o.subtitle})]}),j&&e.jsx("div",{className:"absolute -top-1 -right-1 px-1.5 py-0.5 rounded-full text-[8px] font-bold",style:{background:"linear-gradient(135deg, rgba(251, 146, 60, 0.9), rgba(251, 113, 133, 0.9))",color:"white",boxShadow:"0 2px 8px rgba(251, 146, 60, 0.4)"},children:"SOON"})]},o.id)},E=window.innerWidth<768,P=window.innerWidth>=768&&window.innerWidth<1024,N={initial:{opacity:0,scale:.88,y:-32},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:-24}};return e.jsx(J,{children:r&&e.jsx(L.div,{className:"central-actions-menu fixed",style:{zIndex:Fe.CENTRAL_MENU,transformOrigin:"top center",overflow:"visible",...E?{top:"80px",left:"8px",right:"8px",width:"auto",maxHeight:"calc(100vh - 96px - var(--new-bottom-bar-height) - var(--new-bottom-bar-bottom-offset))"}:P?{top:"80px",left:"16px",right:"16px",width:"auto",maxWidth:"calc(100vw - 32px)",maxHeight:"calc(100vh - 120px - var(--new-bottom-bar-height) - var(--new-bottom-bar-bottom-offset))"}:{top:"80px",right:"24px",left:"auto",width:"400px",maxHeight:"calc(100vh - 120px)"}},initial:N.initial,animate:N.animate,exit:N.exit,transition:c,role:"dialog","aria-label":"Actions rapides","aria-modal":"true",children:e.jsx("div",{className:"rounded-3xl overflow-hidden relative central-actions-panel liquid-glass-premium max-h-[inherit]",style:{padding:12,isolation:"isolate"},children:e.jsxs("div",{className:"central-actions-scroll-container",style:{maxHeight:"inherit",overflowY:"auto",overflowX:"hidden"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2.5 px-1.5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{"aria-hidden":!0,className:"h-1.5 w-10 rounded-full bg-white/40"}),e.jsx("span",{className:"text-white/80 text-xs font-semibold tracking-wider uppercase",children:"Outils du Forgeron"})]}),h&&e.jsxs("button",{onClick:o=>p(h,!1,o),className:"glass-card rounded-full px-2.5 py-1 flex items-center gap-1.5",style:{background:`
                      radial-gradient(circle at 30% 30%, rgba(255,255,255,0.18) 0%, transparent 60%),
                      radial-gradient(circle at 70% 70%, rgba(247, 147, 30, 0.15) 0%, transparent 65%),
                      var(--liquid-pill-bg)
                    `,border:"1px solid rgba(247, 147, 30, 0.35)",boxShadow:`
                      0 2px 8px rgba(247, 147, 30, 0.15),
                      0 0 16px rgba(247, 147, 30, 0.08),
                      inset 0 1px 0 rgba(255, 255, 255, 0.15)
                    `},children:[e.jsx(O,{Icon:T.Home,size:13,style:{color:"#FDC830",filter:"drop-shadow(0 0 4px rgba(253, 200, 48, 0.5))"}}),e.jsx("span",{className:"text-[10px] font-semibold",style:{color:"rgba(255, 255, 255, 0.95)",textShadow:"0 1px 2px rgba(0, 0, 0, 0.2)"},children:"Dashboard"})]})]}),u.actions.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"px-1.5 mb-1.5",children:e.jsx("h3",{className:"text-white/70 text-[11px] uppercase tracking-wider font-bold",children:"Alimentation"})}),e.jsx("div",{className:"grid grid-cols-2 gap-1.5",children:u.actions.map((o,k)=>e.jsx(b,{action:o,index:k},o.id))})]}),g.actions.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"px-1.5 mb-1.5",children:e.jsx("h3",{className:"text-white/70 text-[11px] uppercase tracking-wider font-bold",children:"Activité"})}),e.jsx("div",{className:"grid grid-cols-2 gap-1.5",children:g.actions.map((o,k)=>e.jsx(b,{action:o,index:k},o.id))})]}),m.actions.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"px-1.5 mb-1.5",children:e.jsx("h3",{className:"text-white/70 text-[11px] uppercase tracking-wider font-bold",children:"Santé"})}),e.jsx("div",{className:"grid grid-cols-2 gap-1.5",children:m.actions.map((o,k)=>e.jsx(b,{action:o,index:k},o.id))})]}),w.actions.length>0&&e.jsx("div",{className:"mt-4 pt-3 border-t border-white/10",children:w.actions.map((o,k)=>{const[y,v,x]=re(o.color||"#D946EF");return e.jsxs(L.button,{onClick:j=>p(o,!0,j),className:"glass-card rounded-2xl px-4 py-3 flex items-center gap-3 w-full relative avatar-twin-button",style:{background:`
                          radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.18) 0%, transparent 60%),
                          radial-gradient(circle at 70% 70%, rgba(${y}, ${v}, ${x}, 0.2) 0%, transparent 65%),
                          var(--liquid-pill-bg)
                        `,border:`1px solid rgba(${y}, ${v}, ${x}, 0.4)`,boxShadow:`
                          0 4px 16px rgba(${y}, ${v}, ${x}, 0.25),
                          0 0 24px rgba(${y}, ${v}, ${x}, 0.15),
                          inset 0 1px 0 rgba(255, 255, 255, 0.2)
                        `},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{...c,delay:i?0:.3},whileHover:i?{}:{y:-2,scale:1.02},whileTap:i?{}:{scale:.98},role:"menuitem","aria-label":o.description||o.label,children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0",style:{background:`linear-gradient(135deg, rgba(${y}, ${v}, ${x}, 0.4), rgba(${y}, ${v}, ${x}, 0.25))`,border:`1px solid rgba(${y}, ${v}, ${x}, 0.5)`,boxShadow:`0 0 12px rgba(${y}, ${v}, ${x}, 0.3)`},children:e.jsx(O,{Icon:T[o.icon],size:20,style:{color:o.color,filter:`drop-shadow(0 0 6px rgba(${y}, ${v}, ${x}, 0.6))`}})}),e.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[e.jsx("div",{className:"text-[13px] font-bold text-white leading-tight",children:o.label}),e.jsx("div",{className:"text-[10px] text-white/75 leading-tight mt-0.5",children:o.subtitle})]}),e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0",style:{background:`rgba(${y}, ${v}, ${x}, 0.2)`,border:`1px solid rgba(${y}, ${v}, ${x}, 0.4)`},children:e.jsx(O,{Icon:T.ChevronRight,size:12,style:{color:o.color}})})]},o.id)})})]})})})})},oe=C.memo(()=>{const{setDrawer:r}=je(),{click:t}=H(),{isOpen:i,toggle:s}=W(),n=i("centralMenu");return e.jsxs(e.Fragment,{children:[e.jsx("header",{className:`
          header-liquid-glass h-[64px] z-9997-important will-change-transform-important position-fixed-important transform-gpu-important isolation-isolate-important contain-layout-style-paint-important
          fixed top-2 left-4 right-4 z-[9999]
          rounded-glass-lg
          backdrop-blur-xl
          transition-all duration-300
        `,style:{left:"24px",right:"24px",top:"8px",borderRadius:"20px",overflow:"hidden",backfaceVisibility:"hidden",WebkitBackfaceVisibility:"hidden",WebkitTransformStyle:"preserve-3d",transformStyle:"preserve-3d",WebkitPerspective:"1000px",perspective:"1000px"},role:"banner","aria-label":"TwinForge Pont de Commandement",children:e.jsxs("div",{className:"w-full h-full flex items-center justify-between gap-2 px-4 md:px-6",children:[e.jsxs("div",{className:"flex items-center gap-1 md:gap-3",children:[e.jsx(Ee,{}),e.jsx(Qe,{})]}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[e.jsxs(L.button,{type:"button",className:"user-panel-toggle relative central-action-button",style:{width:"48px",height:"48px",borderRadius:"50%",position:"relative",overflow:"visible",padding:0,alignItems:"center",justifyContent:"center",display:"flex",background:n?"radial-gradient(circle at 30% 30%, rgba(247, 147, 30, 0.45) 0%, transparent 60%), linear-gradient(135deg, rgba(247, 147, 30, 0.35), rgba(255, 107, 53, 0.3))":"radial-gradient(circle at 30% 30%, rgba(247, 147, 30, 0.25) 0%, transparent 60%), linear-gradient(135deg, rgba(247, 147, 30, 0.2), rgba(255, 107, 53, 0.15))",border:n?"2px solid rgba(247, 147, 30, 0.6)":"2px solid rgba(247, 147, 30, 0.35)",backdropFilter:"blur(16px) saturate(150%)",WebkitBackdropFilter:"blur(16px) saturate(150%)",boxShadow:n?"0 0 0 1px rgba(255, 255, 255, 0.15) inset, 0 4px 32px rgba(247, 147, 30, 0.5), 0 2px 16px rgba(0, 0, 0, 0.25)":"0 0 0 1px rgba(255, 255, 255, 0.08) inset, 0 4px 24px rgba(247, 147, 30, 0.25), 0 2px 12px rgba(0, 0, 0, 0.2)",transition:"transform 280ms cubic-bezier(0.25, 0.1, 0.25, 1), background 180ms cubic-bezier(0.16, 1, 0.3, 1), box-shadow 180ms cubic-bezier(0.16, 1, 0.3, 1), border-color 180ms cubic-bezier(0.16, 1, 0.3, 1)",transform:"translateZ(0)",willChange:"transform, filter",cursor:"pointer"},"aria-label":"Ouvrir les outils du forgeron","aria-expanded":n,"aria-haspopup":"menu",onPointerDown:()=>t(),onClick:()=>s("centralMenu"),onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),t(),s("centralMenu"))},whileHover:{scale:1.08},whileTap:{scale:.95},children:[[0,1,2,3].map(a=>e.jsx(L.div,{style:{position:"absolute",width:"6px",height:"6px",borderRadius:"1.5px",background:"linear-gradient(135deg, #F7931E, rgba(255, 255, 255, 0.9))",boxShadow:"0 0 16px #F7931E",top:a<2?"2px":"auto",bottom:a>=2?"2px":"auto",left:a%2===0?"2px":"auto",right:a%2===1?"2px":"auto",zIndex:2},initial:{rotate:a%2===0?45:-45},animate:{scale:n?[1,1.4,1]:[1,1.2,1],opacity:n?[.7,1,.7]:[.5,.8,.5],rotate:a%2===0?[45,60,45]:[-45,-60,-45]},transition:{duration:3,repeat:1/0,delay:a*.2,ease:[.4,0,.2,1]}},a)),e.jsx(O,{Icon:T.Zap,size:22,style:{color:n?"#F7931E":"#FF9F40",filter:n?"drop-shadow(0 0 14px rgba(247, 147, 30, 0.9))":"drop-shadow(0 0 10px rgba(255, 159, 64, 0.6))"},"aria-hidden":"true"}),e.jsx(L.div,{className:"absolute inset-0 rounded-full",style:{background:"radial-gradient(circle at center, rgba(247, 147, 30, 0.25) 0%, transparent 70%)",filter:"blur(10px)",zIndex:-1,pointerEvents:"none"},animate:n?{scale:[1,1.4,1.3],opacity:[.7,1,.8]}:{scale:[1,1.15,1],opacity:[.4,.6,.4]},transition:{duration:2.5,repeat:1/0,ease:"easeInOut"},"aria-hidden":"true"})]}),e.jsx(L.button,{type:"button",className:"user-panel-toggle relative",style:{width:"48px",height:"48px",borderRadius:"50%",position:"relative",overflow:"visible",padding:0,display:"flex",alignItems:"center",justifyContent:"center",background:`
                  radial-gradient(circle at 30% 30%, rgba(255,255,255,0.18) 0%, transparent 50%),
                  rgba(255, 255, 255, 0.10)
                `,border:"1px solid rgba(255,255,255,0.2)",backdropFilter:"blur(16px) saturate(140%)",WebkitBackdropFilter:"blur(16px) saturate(140%)",boxShadow:`
                  0 8px 24px rgba(0, 0, 0, 0.25),
                  0 2px 12px rgba(0, 0, 0, 0.18),
                  inset 0 1px 0 rgba(255, 255, 255, 0.12)
                `,transition:"transform 280ms cubic-bezier(0.25, 0.1, 0.25, 1), background 180ms cubic-bezier(0.16, 1, 0.3, 1), box-shadow 180ms cubic-bezier(0.16, 1, 0.3, 1), border-color 180ms cubic-bezier(0.16, 1, 0.3, 1)",transform:"translateZ(0)",willChange:"transform, filter",cursor:"pointer"},onMouseEnter:a=>{window.matchMedia("(hover: hover)").matches&&(a.currentTarget.style.background=`
                    radial-gradient(circle at 30% 30%, rgba(255,255,255,0.25) 0%, transparent 60%),
                    rgba(255, 255, 255, 0.10)
                  `,a.currentTarget.style.borderColor="rgba(255,255,255,0.3)",a.currentTarget.style.boxShadow=`
                    0 8px 24px rgba(0, 0, 0, 0.25),
                    0 2px 12px rgba(0, 0, 0, 0.18),
                    inset 0 1px 0 rgba(255, 255, 255, 0.12),
                    0 0 20px rgba(255,255,255,0.15),
                    0 4px 16px rgba(0,0,0,0.2)
                  `)},onMouseLeave:a=>{window.matchMedia("(hover: hover)").matches&&(a.currentTarget.style.background=`
                    radial-gradient(circle at 30% 30%, rgba(255,255,255,0.18) 0%, transparent 50%),
                    rgba(255, 255, 255, 0.10)
                  `,a.currentTarget.style.borderColor="rgba(255,255,255,0.2)",a.currentTarget.style.boxShadow=`
                    0 8px 24px rgba(0, 0, 0, 0.25),
                    0 2px 12px rgba(0, 0, 0, 0.18),
                    inset 0 1px 0 rgba(255, 255, 255, 0.12)
                  `)},"aria-label":"Ouvrir le menu de navigation principal","aria-expanded":"false","aria-haspopup":"menu",onPointerDown:()=>t(),onClick:()=>r(!0),onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),t(),r(!0))},whileHover:{scale:1.08},whileTap:{scale:.95},children:e.jsx(O,{Icon:T.Menu,size:20,style:{color:"rgba(255,255,255,0.9)",filter:"drop-shadow(0 0 8px rgba(247, 147, 30, 0.3))"},"aria-hidden":"true"})})]})]})}),e.jsx(Ae,{}),e.jsx(se,{isOpen:n,onClose:()=>{}})]})});oe.displayName="Header";const le=C.memo(({to:r,icon:t,label:i,subtitle:s,actionLabel:n,isPrimary:a=!1,isTwin:u=!1,isForge:g=!1,isActive:m,circuitColor:f,tabs:w,subItems:h,isExpanded:p,onToggleExpand:c})=>{const b=V(),E=T[t],P=f||Ne(r),{sidebarClick:N}=H(),o=h&&h.length>0,k=x=>{d.trace("SIDEBAR","NavItem click captured",{to:r,label:i,isActive:m}),d.trace("SIDEBAR","NavItem click triggered",{to:r,label:i,currentPath:window.location.pathname}),o&&(x.preventDefault(),c&&(c(),N()))},y=o&&h.some(x=>{const j=x.to.split("#")[0],D=x.to.split("#")[1],S=b.pathname,I=b.hash.replace("#","")||"daily";return S===j&&(!D||I===D)});b.pathname;let v="sidebar-item";return a?v="sidebar-item sidebar-item--primary":u?v="sidebar-item sidebar-item--twin":g&&(v="sidebar-item sidebar-item--forge"),e.jsxs("div",{className:"relative sidebar-nav-item-container",children:[e.jsxs(G,{to:r,className:`
          ${v}
          ${o?"sidebar-item--with-submenu":""}
          group focus-ring
          ${m||y?"text-white shadow-sm":"text-white/70 hover:text-white"}
        `,onClick:k,onPointerDown:x=>{d.trace("SIDEBAR","NavItem pointer down",{to:r,label:i})},onMouseDown:x=>{d.trace("SIDEBAR","NavItem mouse down",{to:r,label:i})},"aria-current":m?"page":void 0,"aria-expanded":o?p:void 0,"aria-label":`${i} - ${s}`,role:a?"link":"menuitem",style:{"--item-circuit-color":P},children:[e.jsx("div",{className:`sidebar-item-icon-container ${m?"sidebar-item-icon-container--active":""}`,children:e.jsx(O,{Icon:E,size:a?22:u?20:18,className:`sidebar-item-icon ${m||y?"":"opacity-80 group-hover:opacity-100"}`,color:m||y?P:void 0,style:m||y?{color:P,filter:`drop-shadow(0 0 8px ${P}60)`}:void 0})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:`sidebar-item-label font-medium ${a?"text-base":u?"text-sm":"text-xs"} truncate ${m||y?"text-white":"text-white/82"}`,children:i}),e.jsx("div",{className:`sidebar-item-subtitle text-xxs truncate ${a?"mt-0.5":"mt-0"} ${m||y?"text-white/70":"text-white/50"}`,children:s})]}),g&&n&&!o&&e.jsx("div",{className:`sidebar-item-action-badge ${m?"sidebar-item-action-badge--active":""}`,children:n})]}),o&&e.jsx("div",{className:`sidebar-submenu ${p?"sidebar-submenu--expanded":""}`,role:"group","aria-label":`Sous-menu ${i}`,children:e.jsx("div",{className:"sidebar-submenu-inner",children:h.map(x=>{const j=T[x.icon],D=x.to.split("#")[0],S=x.to.split("#")[1],I=b.pathname,z=b.hash.replace("#","")||"daily",Y=I===D&&(!S||z===S),ee=x.isPrimarySubMenu&&I===D;return e.jsxs(G,{to:x.to,className:`
                    sidebar-submenu-item
                    ${x.isPrimarySubMenu?"sidebar-submenu-item--primary":"sidebar-submenu-item--secondary"}
                    ${Y||ee?"sidebar-submenu-item--active":""}
                    focus-ring
                  `,onClick:()=>N(),"aria-current":Y?"page":void 0,style:{"--item-circuit-color":x.color||P},children:[e.jsx("div",{className:`sidebar-submenu-item-icon-container ${Y||ee?"sidebar-submenu-item-icon-container--active":""}`,children:e.jsx(O,{Icon:j,size:x.isPrimarySubMenu?16:14,className:"sidebar-submenu-item-icon"})}),e.jsx("span",{className:"sidebar-submenu-item-label",children:x.label})]},x.to)})})})]})});le.displayName="NavItem";const Ze=({title:r,type:t,children:i,isLastCategory:s})=>{const n=t==="forge-category",a=r==="Alimentation"||r==="Activité"||r==="Santé";return e.jsxs("div",{className:`space-y-1 ${n?"mt-4":""}`,children:[r&&e.jsxs(e.Fragment,{children:[a&&e.jsx("div",{className:"sidebar-category-separator"}),e.jsx("h3",{className:`sidebar-section-title ${Je(r,t)}`,role:"heading","aria-level":"3",children:r})]}),e.jsx("div",{className:"space-y-1",children:i})]})};function Je(r,t){if(t==="forge-category")return"sidebar-section--forge-category";switch(r){case"Rituels du Forgeron":return"sidebar-section--daily-tracking";case"Ateliers du Forgeron":return"sidebar-section--forge-tools";case"Mon Profil":return"sidebar-section--profile";default:return""}}const ce=C.memo(({className:r=""})=>{const t=V(),i=$(),s=l.useCallback(h=>t.pathname===h,[t.pathname]),[n,a]=l.useState({}),[u,g]=l.useState(null),m=Ce(),f=l.useCallback(async()=>{try{await R.auth.signOut(),i("/")}catch(h){console.error("Logout error:",h)}},[i]);C.useEffect(()=>{const h=t.pathname;let p=null;const c={};m.forEach(b=>{b.items.forEach(E=>{E.subItems&&E.subItems.length>0&&(E.subItems.some(N=>{const o=N.to.split("#")[0];return h===o})?(c[E.to]=!0,p=E.to):c[E.to]=!1)})}),a(c),g(p)},[t.pathname]),C.useEffect(()=>{d.trace("SIDEBAR","Component rendered",{currentPath:t.pathname})},[t.pathname]);const w=l.useCallback(h=>{a(p=>{if(p[h])return{...p,[h]:!1};const b={};return Object.keys(p).forEach(E=>{b[E]=!1}),b[h]=!0,g(h),b})},[]);return e.jsx("aside",{className:`hidden lg:flex flex-col ${r}
        sticky top-[88px] left-0
        h-[calc(100dvh-104px)]
        w-full
        sidebar-glass-enhanced rounded-2xl visionos-grid
      `,role:"complementary","aria-label":"Main navigation",children:e.jsxs("div",{className:"sidebar-content space-y-2 flex-1 pt-2",children:[m.map((h,p)=>e.jsxs(C.Fragment,{children:[e.jsx(Ze,{title:h.title,type:h.type,isLastCategory:p===m.length-1&&h.type==="forge-category",children:h.items.map(c=>e.jsx(le,{to:c.to,icon:c.icon,label:c.label,subtitle:c.subtitle,actionLabel:c.actionLabel,isPrimary:c.isPrimary,isTwin:c.isTwin,isForge:c.isForge,isActive:s(c.to),circuitColor:c.circuitColor,tabs:c.tabs,subItems:c.subItems,isExpanded:n[c.to],onToggleExpand:()=>w(c.to)},c.to))}),h.type==="primary"&&e.jsx("div",{className:"sidebar-primary-separator","aria-hidden":"true"})]},h.title||h.type)),e.jsxs("div",{className:"mt-4 pt-2",children:[e.jsx("div",{className:"sidebar-category-separator mb-3"}),e.jsx("h3",{className:"sidebar-section-title text-white/50 text-xs uppercase tracking-wider font-semibold mb-1 px-1",children:"Compte"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs(G,{to:"/profile",className:`
                sidebar-item group focus-ring
                ${s("/profile")?"text-white shadow-sm":"text-white/70 hover:text-white"}
              `,style:{"--item-circuit-color":"#18E3FF"},children:[e.jsx("div",{className:`sidebar-item-icon-container ${s("/profile")?"sidebar-item-icon-container--active":""}`,children:e.jsx(O,{Icon:T.User,size:18,className:`sidebar-item-icon ${s("/profile")?"":"opacity-80 group-hover:opacity-100"}`,style:s("/profile")?{color:"#18E3FF",filter:"drop-shadow(0 0 8px rgba(24, 227, 255, 0.6))"}:void 0})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:`sidebar-item-label font-medium text-xs truncate ${s("/profile")?"text-white":"text-white/82"}`,children:"Mon Profil"}),e.jsx("div",{className:`sidebar-item-subtitle text-xxs truncate mt-0 ${s("/profile")?"text-white/70":"text-white/50"}`,children:"Infos personnelles"})]})]}),e.jsxs(G,{to:"/settings",className:`
                sidebar-item group focus-ring
                ${s("/settings")?"text-white shadow-sm":"text-white/70 hover:text-white"}
              `,style:{"--item-circuit-color":"#7A5AF8"},children:[e.jsx("div",{className:`sidebar-item-icon-container ${s("/settings")?"sidebar-item-icon-container--active":""}`,children:e.jsx(O,{Icon:T.Settings,size:18,className:`sidebar-item-icon ${s("/settings")?"":"opacity-80 group-hover:opacity-100"}`,style:s("/settings")?{color:"#7A5AF8",filter:"drop-shadow(0 0 8px rgba(122, 90, 248, 0.6))"}:void 0})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:`sidebar-item-label font-medium text-xs truncate ${s("/settings")?"text-white":"text-white/82"}`,children:"Paramètres"}),e.jsx("div",{className:`sidebar-item-subtitle text-xxs truncate mt-0 ${s("/settings")?"text-white/70":"text-white/50"}`,children:"Configuration"})]})]})]}),e.jsx("div",{className:"sidebar-category-separator my-2"}),e.jsxs("button",{onClick:f,className:"sidebar-item group focus-ring text-white/70 hover:text-white w-full",style:{"--item-circuit-color":"#EF4444"},children:[e.jsx("div",{className:"sidebar-item-icon-container",children:e.jsx(O,{Icon:T.LogOut,size:18,className:"sidebar-item-icon opacity-80 group-hover:opacity-100",style:{color:"#EF4444"}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"sidebar-item-label font-medium text-xs truncate text-white/82",children:"Déconnexion"}),e.jsx("div",{className:"sidebar-item-subtitle text-xxs truncate mt-0 text-white/50",children:"Se déconnecter"})]})]})]})]})})});ce.displayName="Sidebar";const Xe=[{id:"meal-scan",label:"Repas",icon:"Utensils",route:"/meals",color:"#10B981"},{id:"fridge-scan",label:"Frigo",icon:"Refrigerator",route:"/fridge",color:"#EC4899"},{id:"activity",label:"Activité",icon:"Activity",route:"/activity",color:"#3B82F6"},{id:"fasting",label:"Jeûne",icon:"Timer",route:"/fasting",color:"#F59E0B"},{id:"training",label:"Coaching",icon:"Dumbbell",route:"/training",color:"#06B6D4"},{id:"twin",label:"Twin",icon:"User",route:"/avatar",color:"#8B5CF6"}];function et({button:r,active:t,onClick:i,hasUnread:s,unreadCount:n}){const a=()=>{Ge(r.color,t),i()};return e.jsxs(L.button,{onClick:a,className:"new-bottom-bar-button",style:{"--button-color":r.color,"--button-active":t?"1":"0"},whileHover:{scale:1.05},whileTap:{scale:.95},"aria-current":t?"page":void 0,"aria-label":`Aller à ${r.label}`,children:[e.jsx("div",{className:`new-bottom-bar-icon-container ${t?"new-bottom-bar-icon-container--active":""}`,children:e.jsx(O,{Icon:T[r.icon],size:20,style:{color:t?r.color:"rgba(255, 255, 255, 0.5)"}})}),e.jsx("div",{className:`new-bottom-bar-label ${t?"new-bottom-bar-label--active":""}`,children:r.label})]})}const tt=()=>{const{pathname:r}=V(),t=$(),{close:i}=W(),s=a=>{a.route&&(t(a.route),i())},n=a=>a.route?r.startsWith(a.route):!1;return e.jsx(e.Fragment,{children:e.jsx("nav",{className:"new-mobile-bottom-bar","aria-label":"Navigation principale mobile",style:{position:"fixed",bottom:"var(--new-bottom-bar-bottom-offset)",left:"8px",right:"8px",zIndex:9996},children:e.jsx("div",{className:"new-mobile-bottom-bar-container",children:e.jsx("div",{className:"new-mobile-bottom-bar-buttons",children:Xe.map(a=>e.jsx(et,{button:a,active:n(a),onClick:()=>s(a)},a.id))})})})})},de=l.createContext(null),at=()=>{const r=l.useContext(de);return r||{chatButtonRef:{current:null}}},rt=({children:r})=>{const t=l.useRef(null);return e.jsx(de.Provider,{value:{chatButtonRef:t},children:r})};function it(){const{isInstallable:r,isInstalled:t}=_e(),{isUpdateAvailable:i,updateInfo:s,applyUpdate:n,dismissUpdate:a}=qe(),{showToast:u}=ne(),g=V(),{isAnyOpen:m,isOpen:f,close:w}=W(),h=f("centralMenu"),{chatButtonRef:p}=at();Ke(),C.useEffect(()=>{const v=m();if(v){const x=document.body.style.overflow,j=document.body.style.position,D=document.body.style.width,S=document.body.style.height;return document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%",document.body.style.height="100%",d.debug("OVERLAY_BODY_LOCK","Body scroll locked",{anyOverlayOpen:v,timestamp:new Date().toISOString()}),()=>{document.body.style.overflow=x,document.body.style.position=j,document.body.style.width=D,document.body.style.height=S,d.debug("OVERLAY_BODY_UNLOCK","Body scroll unlocked",{timestamp:new Date().toISOString()})}}},[m]),C.useEffect(()=>{const x=setTimeout(()=>{try{window.scrollTo({top:0,behavior:"smooth"});const j=document.getElementById("main-content");j&&j.scrollTo({top:0,behavior:"smooth"}),document.querySelectorAll("[data-scroll-container]").forEach(S=>S.scrollTo({top:0,behavior:"smooth"}))}catch{}},100);return d.debug("APP_NAVIGATION","Smooth scroll to top on route change",{newPath:g.pathname,previousScrollY:window.scrollY,pwa:{isInstallable:r,isInstalled:t,isUpdateAvailable:i},timestamp:new Date().toISOString()}),()=>clearTimeout(x)},[g.pathname]),C.useEffect(()=>{if(g.pathname.includes("/meals/scan")){const v=setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"});const x=document.getElementById("main-content");x&&x.scrollTo({top:0,behavior:"smooth"})},50);return()=>clearTimeout(v)}},[g.pathname,g.hash]);const{isGenerating:c,isGeneratingDetailedRecipes:b,cancelDetailedRecipeGeneration:E}=ze(),{isOpen:P,showModal:N,hideModal:o}=Ue(),k=g.pathname.startsWith("/body-scan")||g.pathname.startsWith("/avatar"),y=g.pathname.startsWith("/body-scan")||g.pathname.startsWith("/avatar");return l.useEffect(()=>{const v=j=>{if(c||b)return j.preventDefault(),j.returnValue="",N({title:c?"Génération de plan en cours":"Génération de recettes en cours",message:c?"Votre plan alimentaire est en cours de génération. Êtes-vous sûr de vouloir quitter ?":"Les recettes détaillées sont en cours de génération. Êtes-vous sûr de vouloir quitter ?",processName:c?"Génération de Plan Alimentaire":"Génération de Recettes Détaillées",onConfirm:()=>{c&&ae(),b&&E(),o(),window.location.reload()},onCancel:o}),""},x=j=>{(c||b)&&(j.preventDefault(),window.history.pushState(null,"",window.location.href),N({title:c?"Génération de plan en cours":"Génération de recettes en cours",message:c?"Votre plan alimentaire est en cours de génération. Êtes-vous sûr de vouloir quitter ?":"Les recettes détaillées sont en cours de génération. Êtes-vous sûr de vouloir quitter ?",processName:c?"Génération de Plan Alimentaire":"Génération de Recettes Détaillées",onConfirm:()=>{c&&ae(),b&&E(),o(),window.history.back()},onCancel:o}))};return(c||b)&&(window.addEventListener("beforeunload",v),window.addEventListener("popstate",x),window.history.pushState(null,"",window.location.href)),()=>{window.removeEventListener("beforeunload",v),window.removeEventListener("popstate",x)}},[c,b,N,o,E]),e.jsxs("div",{className:"min-h-screen flex flex-col z-auto-important will-change-auto-important position-static-important transform-none-important filter-none-important perspective-none-important contain-none-important isolation-auto-important overflow-visible-important",style:{position:"relative",zIndex:0},children:[e.jsx(oe,{}),e.jsxs("div",{className:"flex-1 flex min-w-0 position-static-important overflow-visible-important transform-none-important filter-none-important perspective-none-important contain-none-important isolation-auto-important z-auto-important",children:[e.jsx("div",{className:"hidden lg:flex lg:flex-col lg:w-[240px] xl:w-[260px] shrink-0 ml-6 mr-3 pt-20",children:e.jsx(ce,{})}),e.jsx("main",{id:"main-content",className:`flex-1 min-w-0 px-4 py-4 md:px-6 lg:px-6 xl:px-8 md:pb-4 pt-20 pb-32 ${k?"body-scan-page":""}`,style:{position:"relative",overflow:"visible",minHeight:"100dvh",WebkitOverflowScrolling:"touch",scrollBehavior:"smooth"},role:"main","aria-label":"Contenu principal de l'application",children:e.jsx("div",{className:Ve("w-full min-w-0",{"mx-auto":!y}),children:e.jsx(l.Suspense,{fallback:e.jsx(A,{}),children:e.jsx(he,{})})})})]}),r&&!t&&e.jsx(ke,{variant:"floating",onInstallSuccess:()=>u({type:"success",title:"TwinForge installé !",message:"L'application est maintenant disponible sur votre écran d'accueil",duration:4e3})}),e.jsx(Ie,{isVisible:i,onUpdate:async()=>{try{await n(),u({type:"success",title:"Mise à jour appliquée",message:"TwinForge redémarre avec la nouvelle version",duration:4e3})}catch(v){d.error("PWA_UPDATE","Failed to apply update",{error:v instanceof Error?v.message:"Unknown error",timestamp:new Date().toISOString()}),u({type:"error",title:"Erreur de mise à jour",message:"Impossible d'appliquer la mise à jour. Réessayez plus tard.",duration:4e3})}},onDismiss:a,updateInfo:s}),e.jsx(tt,{}),e.jsx(Te,{}),e.jsx(se,{isOpen:h,onClose:w}),e.jsx(Pe,{ref:p}),e.jsx(Oe,{chatButtonRef:p})]})}function nt(){return e.jsx(rt,{children:e.jsx(it,{})})}function K(){}function st({storage:r,key:t="REACT_QUERY_OFFLINE_CACHE",throttleTime:i=1e3,serialize:s=JSON.stringify,deserialize:n=JSON.parse,retry:a}){if(r){const u=g=>{try{r.setItem(t,s(g));return}catch(m){return m}};return{persistClient:ot(g=>{let m=g,f=u(m),w=0;for(;f&&m;)w++,m=a?.({persistedClient:m,error:f,errorCount:w}),m&&(f=u(m))},i),restoreClient:()=>{const g=r.getItem(t);if(g)return n(g)},removeClient:()=>{r.removeItem(t)}}}return{persistClient:K,restoreClient:K,removeClient:K}}function ot(r,t=100){let i=null,s;return function(...n){s=n,i===null&&(i=ge.setTimeout(()=>{r(...s),i=null},t))}}const lt=({children:r})=>(C.useEffect(()=>{},[]),e.jsx(e.Fragment,{children:r}));class ct extends C.Component{constructor(){super(...arguments);F(this,"state",{hasError:!1})}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(i,s){if(/Loading chunk [\d]+ failed/i.test(String(i?.message))){d.debug("Chunk loading failed, auto-retrying:",i);return}d.error("React error boundary caught error:",i,s)}render(){return this.state.hasError?this.props.fallback??e.jsx("div",{className:"p-6 text-sm text-red-300 bg-red-900/20 rounded-xl",children:"Une erreur est survenue. Recharge la page ou réessaie."}):this.props.children}}const dt=l.createContext(null);function ut({children:r}){const[t,i]=l.useState(new Map),s=l.useCallback(p=>p.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9\s]/g,"").trim(),[]),n=l.useCallback(p=>{const c=s(p);return t.get(c)||null},[t,s]),a=l.useCallback((p,c)=>{const b=s(p);i(E=>{const P=new Map(E),N=P.get(b),o={exerciseName:N?.exerciseName||p,queueId:c.queueId||N?.queueId||"",status:c.status||N?.status||"queued",imageUrl:c.imageUrl||N?.imageUrl,illustrationId:c.illustrationId||N?.illustrationId,timestamp:c.timestamp||N?.timestamp||Date.now()};return P.set(b,o),d.debug("ILLUSTRATION_CACHE","Updated cache",{exerciseName:p,status:o.status,hasImageUrl:!!o.imageUrl}),P})},[s]),u=l.useCallback(p=>{const c=s(p);i(b=>{const E=new Map(b);return E.delete(c),d.debug("ILLUSTRATION_CACHE","Removed from cache",{exerciseName:p}),E})},[s]),g=l.useCallback(p=>{const c=n(p);return c?.status==="queued"||c?.status==="generating"},[n]),m=l.useCallback(()=>new Map(t),[t]),f=l.useCallback(()=>{i(new Map),d.info("ILLUSTRATION_CACHE","Cache cleared")},[]),w=l.useCallback(()=>{const p={total:t.size,queued:0,generating:0,completed:0,failed:0};return t.forEach(c=>{switch(c.status){case"queued":p.queued++;break;case"generating":p.generating++;break;case"completed":p.completed++;break;case"failed":p.failed++;break}}),p},[t]),h={getCachedIllustration:n,setCachedIllustration:a,removeCachedIllustration:u,isGenerating:g,getAllCached:m,clearCache:f,getStats:w};return e.jsx(dt.Provider,{value:h,children:r})}class pt{constructor(){F(this,"capabilities");F(this,"config");F(this,"performanceObserver",null);F(this,"frameRateHistory",[]);F(this,"lastFrameTime",performance.now());F(this,"rafId",null);this.capabilities=this.detectCapabilities(),this.config=this.generateConfig(),this.startMonitoring()}detectCapabilities(){const t=this.detectMobile(),i="ontouchstart"in window||navigator.maxTouchPoints>0,s=window.matchMedia("(prefers-reduced-motion: reduce)").matches,n=this.detectGPU(),a=navigator.deviceMemory||this.estimateRAM(),u=navigator.hardwareConcurrency||2,g=this.detectNetworkSpeed(),m=this.detectBatteryLevel(),f=this.detectLowPowerMode();return{performanceLevel:this.calculatePerformanceLevel(n,a,u,t),gpuAvailable:n,ram:a,cores:u,isMobile:t,hasTouch:i,prefersReducedMotion:s,networkSpeed:g,batteryLevel:m,isLowPowerMode:f}}detectMobile(){const t=navigator.userAgent,i=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t),s=window.innerWidth<768;return i||s}detectGPU(){try{const t=document.createElement("canvas"),i=t.getContext("webgl")||t.getContext("experimental-webgl");if(!i)return!1;const s=i.getExtension("WEBGL_debug_renderer_info");if(s){const n=i.getParameter(s.UNMASKED_RENDERER_WEBGL);return!/Mali|Adreno [34]|PowerVR|VideoCore/i.test(n)}return!0}catch{return!1}}estimateRAM(){return this.detectMobile()?4:8}detectNetworkSpeed(){const t=navigator.connection||navigator.mozConnection||navigator.webkitConnection;if(!t)return"medium";const i=t.effectiveType;return i==="slow-2g"||i==="2g"?"slow":i==="3g"?"medium":"fast"}detectBatteryLevel(){}detectLowPowerMode(){return!1}calculatePerformanceLevel(t,i,s,n){let a=0;return t&&(a+=3),i>=8?a+=3:i>=4?a+=2:a+=1,s>=8?a+=3:s>=4?a+=2:a+=1,n||(a+=2),a>=11?"high":a>=7?"medium":"low"}generateConfig(){const t=this.capabilities.performanceLevel,i=this.capabilities.isMobile;return this.capabilities.prefersReducedMotion?{glassBlur:6,animationDuration:150,enableShimmer:!1,enablePulse:!1,enableGlow:!1,maxAnimations:2,useFramerMotion:!1,virtualizeThreshold:20}:t==="high"&&!i?{glassBlur:16,animationDuration:300,enableShimmer:!0,enablePulse:!0,enableGlow:!0,maxAnimations:8,useFramerMotion:!0,virtualizeThreshold:50}:t==="medium"||t==="high"&&i?{glassBlur:12,animationDuration:250,enableShimmer:!1,enablePulse:!0,enableGlow:!0,maxAnimations:4,useFramerMotion:!1,virtualizeThreshold:30}:{glassBlur:6,animationDuration:200,enableShimmer:!1,enablePulse:!1,enableGlow:!1,maxAnimations:2,useFramerMotion:!1,virtualizeThreshold:15}}startMonitoring(){if(this.monitorFrameRate(),"PerformanceObserver"in window)try{this.performanceObserver=new PerformanceObserver(t=>{for(const i of t.getEntries())i.duration>50&&(console.warn("[DeviceCapability] Long task detected:",i.duration,"ms"),this.degradePerformanceIfNeeded())}),this.performanceObserver.observe({entryTypes:["longtask"]})}catch{}"getBattery"in navigator&&navigator.getBattery().then(t=>{t.addEventListener("levelchange",()=>{t.level<.2&&this.enableLowPowerMode()})}),document.addEventListener("visibilitychange",()=>{document.hidden?this.pauseMonitoring():this.resumeMonitoring()})}monitorFrameRate(){const t=()=>{const i=performance.now(),n=1e3/(i-this.lastFrameTime);this.frameRateHistory.push(n),this.frameRateHistory.length>60&&this.frameRateHistory.shift(),this.frameRateHistory.reduce((u,g)=>u+g,0)/this.frameRateHistory.length<55&&this.frameRateHistory.length>=60&&this.degradePerformanceIfNeeded(),this.lastFrameTime=i,this.rafId=requestAnimationFrame(t)};this.rafId=requestAnimationFrame(t)}degradePerformanceIfNeeded(){const t=this.capabilities.performanceLevel;t==="high"?(this.capabilities.performanceLevel="medium",this.config=this.generateConfig(),this.applyConfigToDOM(),console.warn("[DeviceCapability] Degraded to medium performance")):t==="medium"&&(this.capabilities.performanceLevel="low",this.config=this.generateConfig(),this.applyConfigToDOM(),console.warn("[DeviceCapability] Degraded to low performance"))}enableLowPowerMode(){this.capabilities.isLowPowerMode=!0,this.capabilities.performanceLevel="low",this.config=this.generateConfig(),this.applyConfigToDOM(),console.info("[DeviceCapability] Low power mode enabled")}applyConfigToDOM(){document.documentElement.style.setProperty("--glass-blur-adaptive",`${this.config.glassBlur}px`),document.documentElement.style.setProperty("--animation-duration-adaptive",`${this.config.animationDuration}ms`),document.documentElement.classList.remove("perf-high","perf-medium","perf-low"),document.documentElement.classList.add(`perf-${this.capabilities.performanceLevel}`),this.config.enableShimmer||document.documentElement.classList.add("disable-shimmer"),this.config.enablePulse||document.documentElement.classList.add("disable-pulse"),this.config.enableGlow||document.documentElement.classList.add("disable-glow")}pauseMonitoring(){this.rafId!==null&&(cancelAnimationFrame(this.rafId),this.rafId=null)}resumeMonitoring(){this.rafId===null&&(this.lastFrameTime=performance.now(),this.monitorFrameRate())}getCapabilities(){return{...this.capabilities}}getConfig(){return{...this.config}}shouldUseFramerMotion(){return this.config.useFramerMotion}shouldVirtualize(t){return t>this.config.virtualizeThreshold}getGlassBlur(){return this.config.glassBlur}getAnimationDuration(){return this.config.animationDuration}canUseEffect(t){switch(t){case"shimmer":return this.config.enableShimmer;case"pulse":return this.config.enablePulse;case"glow":return this.config.enableGlow;default:return!1}}destroy(){this.pauseMonitoring(),this.performanceObserver&&this.performanceObserver.disconnect()}}const B=new pt;function mt(){return l.useEffect(()=>{const r=B.getConfig(),t=B.getCapabilities();return document.documentElement.style.setProperty("--glass-blur-adaptive",`${r.glassBlur}px`),document.documentElement.style.setProperty("--animation-duration-adaptive",`${r.animationDuration}ms`),document.documentElement.classList.remove("perf-high","perf-medium","perf-low"),document.documentElement.classList.add(`perf-${t.performanceLevel}`),t.isMobile&&document.documentElement.classList.add("is-mobile"),r.enableShimmer||document.documentElement.classList.add("disable-shimmer"),r.enablePulse||document.documentElement.classList.add("disable-pulse"),r.enableGlow||document.documentElement.classList.add("disable-glow"),()=>{B.destroy()}},[]),{capabilities:B.getCapabilities(),config:B.getConfig()}}class ht{constructor(){F(this,"syncInterval",null);F(this,"syncInProgress",new Set)}async performAutoSync(t){try{d.info("WEARABLE_AUTO_SYNC","Starting automatic sync",{userId:t});const s=(await q.getConnectedDevices(t)).filter(a=>a.connected&&!a.revoked);if(s.length===0)return d.info("WEARABLE_AUTO_SYNC","No active devices to sync",{userId:t}),[];const n=[];for(const a of s){if(this.syncInProgress.has(a.id)){d.info("WEARABLE_AUTO_SYNC","Sync already in progress for device",{deviceId:a.id});continue}try{this.syncInProgress.add(a.id);const u=a.last_sync?new Date(a.last_sync):null,g=new Date,m=u?(g.getTime()-u.getTime())/(1e3*60*60):1/0;if(m<1){d.info("WEARABLE_AUTO_SYNC","Device synced recently, skipping",{deviceId:a.id,hoursSinceSync:m}),this.syncInProgress.delete(a.id);continue}d.info("WEARABLE_AUTO_SYNC","Triggering sync for device",{deviceId:a.id,provider:a.provider,hoursSinceSync:m}),await q.triggerSync(a.id);const{data:f,error:w}=await R.from("activities").select("id").eq("user_id",t).eq("wearable_device_id",a.id).gte("created_at",u?.toISOString()||new Date(0).toISOString());if(w)throw w;n.push({success:!0,deviceId:a.id,activitiesImported:f?.length||0,lastSyncTime:g.toISOString()}),d.info("WEARABLE_AUTO_SYNC","Sync completed successfully",{deviceId:a.id,activitiesImported:f?.length||0})}catch(u){d.error("WEARABLE_AUTO_SYNC","Sync failed for device",{deviceId:a.id,error:u}),n.push({success:!1,deviceId:a.id,activitiesImported:0,lastSyncTime:new Date().toISOString(),error:u instanceof Error?u.message:"Unknown error"})}finally{this.syncInProgress.delete(a.id)}}return n}catch(i){throw d.error("WEARABLE_AUTO_SYNC","Auto sync failed",{error:i,userId:t}),i}}startAutoSync(t,i=60){this.syncInterval&&(d.warn("WEARABLE_AUTO_SYNC","Auto sync already running, clearing previous interval"),this.stopAutoSync()),d.info("WEARABLE_AUTO_SYNC","Starting auto sync scheduler",{userId:t,intervalMinutes:i}),this.performAutoSync(t).catch(s=>{d.error("WEARABLE_AUTO_SYNC","Initial auto sync failed",{error:s})}),this.syncInterval=setInterval(()=>{this.performAutoSync(t).catch(s=>{d.error("WEARABLE_AUTO_SYNC","Scheduled auto sync failed",{error:s})})},i*60*1e3)}stopAutoSync(){this.syncInterval&&(clearInterval(this.syncInterval),this.syncInterval=null,d.info("WEARABLE_AUTO_SYNC","Auto sync scheduler stopped"))}async checkForNewActivities(t,i){try{const n=(await q.getConnectedDevices(t)).find(m=>m.id===i);if(!n)throw new Error("Device not found");const a=n.last_sync?new Date(n.last_sync):new Date(0),{data:u,error:g}=await R.from("activities").select("id").eq("user_id",t).eq("wearable_device_id",i).gte("timestamp",a.toISOString());if(g)throw g;return u?.length||0}catch(s){throw d.error("WEARABLE_AUTO_SYNC","Failed to check for new activities",{error:s,userId:t,deviceId:i}),s}}async intelligentDataFusion(t,i,s){try{d.info("WEARABLE_AUTO_SYNC","Starting intelligent data fusion",{userId:t,manualActivityId:i,wearableActivityId:s});const{data:n,error:a}=await R.from("activities").select("*").eq("id",i).maybeSingle(),{data:u,error:g}=await R.from("activities").select("*").eq("id",s).maybeSingle();if(a||g)throw a||g;if(!n||!u)throw new Error("Activity not found");const m={...n},f=["hr_avg","hr_max","hr_min","hr_zone1_minutes","hr_zone2_minutes","hr_zone3_minutes","hr_zone4_minutes","hr_zone5_minutes","hrv_avg","hrv_rmssd","vo2max_est","distance_km","pace_avg","speed_avg","elevation_gain","cadence_avg","power_avg","calories_measured","recovery_score","training_effect","trimp_score"];f.forEach(p=>{u[p]!==null&&u[p]!==void 0&&(m[p]=u[p])});const{error:w}=await R.from("activities").update(m).eq("id",i);if(w)throw w;const{error:h}=await R.from("activities").delete().eq("id",s);if(h)throw h;d.info("WEARABLE_AUTO_SYNC","Data fusion completed successfully",{manualActivityId:i,wearableActivityId:s,fusedFields:f.filter(p=>m[p]!==null).length})}catch(n){throw d.error("WEARABLE_AUTO_SYNC","Data fusion failed",{error:n,userId:t,manualActivityId:i,wearableActivityId:s}),n}}}const Q=new ht;function gt(r,t={}){const{enabled:i=!0,intervalMinutes:s=60}=t,{showToast:n}=ne(),a=C.useRef(n);C.useEffect(()=>{a.current=n},[n]),l.useEffect(()=>{if(!r||!i){d.info("AUTO_SYNC_HOOK","Auto sync not enabled",{userId:r,enabled:i});return}d.info("AUTO_SYNC_HOOK","Initializing auto sync",{userId:r,intervalMinutes:s}),Q.startAutoSync(r,s);const g=setInterval(async()=>{try{const f=(await Q.performAutoSync(r)).filter(h=>h.success),w=f.reduce((h,p)=>h+p.activitiesImported,0);w>0&&(a.current({type:"success",title:"Synchronisation réussie",message:`${w} nouvelle${w>1?"s":""} activité${w>1?"s":""} importée${w>1?"s":""}`,duration:5e3}),d.info("AUTO_SYNC_HOOK","Auto sync completed with new activities",{userId:r,totalActivities:w,devicesCount:f.length}))}catch(m){d.error("AUTO_SYNC_HOOK","Auto sync failed",{error:m,userId:r})}},s*60*1e3);return()=>{Q.stopAutoSync(),clearInterval(g),d.info("AUTO_SYNC_HOOK","Auto sync stopped",{userId:r})}},[r,i,s])}const ue=new fe({defaultOptions:{queries:{staleTime:10*60*1e3,gcTime:24*60*60*1e3,retry:1,refetchOnWindowFocus:!1,refetchOnMount:r=>{const t=r.queryKey;return!!(t.includes("meals-today")||t.includes("meals-week")||t.includes("meals-recent")||t.includes("daily-ai-summary"))},refetchOnReconnect:!1},mutations:{retry:1}}}),ft=st({storage:window.localStorage,key:"twinforge-react-query-cache",serialize:JSON.stringify,deserialize:r=>{try{const t=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d{3})?Z?$/,s=JSON.parse(r,(n,a)=>{if(typeof a=="string"&&t.test(a)){const u=new Date(a);return isNaN(u.getTime())?a:u}return a});return s&&s.queries&&s.queries.forEach(n=>{n.state&&((n.state.dataUpdatedAt===null||n.state.dataUpdatedAt===void 0)&&(n.state.dataUpdatedAt=0),(n.state.fetchedAt===null||n.state.fetchedAt===void 0)&&(n.state.fetchedAt=0),typeof n.state.dataUpdatedAt=="number"&&isNaN(n.state.dataUpdatedAt)&&(n.state.dataUpdatedAt=0),typeof n.state.fetchedAt=="number"&&isNaN(n.state.fetchedAt)&&(n.state.fetchedAt=0))}),s}catch(t){return d.error("REACT_QUERY_PERSISTENCE","Failed to deserialize cache",{error:t instanceof Error?t.message:"Unknown error",timestamp:new Date().toISOString()}),null}}});let ie=!1;const bt=async()=>{if(!ie)try{d.info("REACT_QUERY_PERSISTENCE","Initializing cache persistence",{persisterKey:"twinforge-react-query-cache",storage:"localStorage",timestamp:new Date().toISOString()}),await xe({queryClient:ue,persister:ft,maxAge:24*60*60*1e3,hydrateOptions:{defaultOptions:{queries:{staleTime:10*60*1e3}}},dehydrateOptions:{shouldDehydrateQuery:r=>{const t=r.queryKey;return t.includes("fasting")?!1:t.includes("insights")||t.includes("progression")||t.includes("trend-analysis")||t.includes("daily-summary")?!0:!(t.includes("daily")&&!t.includes("summary")||t.includes("profile"))}}}),ie=!0,d.info("REACT_QUERY_PERSISTENCE","Cache persistence initialized successfully",{cacheSize:Object.keys(localStorage).filter(r=>r.startsWith("twinforge-react-query")).length,timestamp:new Date().toISOString()})}catch(r){d.error("REACT_QUERY_PERSISTENCE","Failed to initialize cache persistence",{error:r instanceof Error?r.message:"Unknown error",timestamp:new Date().toISOString()})}};function xt({children:r}){return mt(),e.jsx(e.Fragment,{children:r})}function vt({children:r}){const{profile:t}=X();return gt(t?.id||null,{enabled:!0,intervalMinutes:60}),e.jsx(e.Fragment,{children:r})}function yt({children:r}){return C.useEffect(()=>{bt()},[]),e.jsx(ct,{children:e.jsx(be,{client:ue,children:e.jsx(lt,{children:e.jsx(De,{children:e.jsx(ut,{children:e.jsx(Le,{children:e.jsx(xt,{children:e.jsx(vt,{children:r})})})})})})})})}const wt=({onSuccess:r})=>{const[t,i]=l.useState(!1),[s,n]=l.useState(""),[a,u]=l.useState(""),[g,m]=l.useState(""),[f,w]=l.useState(!1),[h,p]=l.useState(!1),[c,b]=l.useState(null),{setSession:E,fetchProfile:P}=X(),{formSubmit:N,error:o,click:k,success:y}=H(),v=$(),x=async()=>{p(!0),b(null),k();try{d.info("AUTH","Starting Google OAuth flow",{timestamp:new Date().toISOString()});const{data:S,error:I}=await R.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/`,queryParams:{access_type:"offline",prompt:"consent"}}});if(I)throw I;d.info("AUTH","Google OAuth redirect initiated",{timestamp:new Date().toISOString()})}catch(S){d.error("AUTH","Google authentication error",{error:S.message,timestamp:new Date().toISOString()}),o(),b(S.message||"Erreur lors de la connexion avec Google"),p(!1)}},j=async S=>{S.preventDefault(),w(!0),b(null),N();try{if(t){const{data:I,error:z}=await R.auth.signUp({email:s,password:a,options:{data:{display_name:g}}});if(z)throw z;I.session?(d.info("AUTH","User signed up successfully",{userId:I.session.user.id}),E(I.session),await P(),y(),setTimeout(()=>{v("/",{replace:!0})},500),r?.()):b("Veuillez vérifier votre email pour confirmer votre compte")}else{const{data:I,error:z}=await R.auth.signInWithPassword({email:s,password:a});if(z)throw z;d.info("AUTH","User signed in successfully",{userId:I.session.user.id}),E(I.session),await P(),y(),setTimeout(()=>{v("/",{replace:!0})},500),r?.()}}catch(I){d.error("AUTH","Authentication error",{error:I.message}),o(),b(I.message||"Erreur lors de l'authentification")}finally{w(!1)}},D=()=>{k(),i(!t),b(null)};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-twinforge-visionos relative overflow-hidden",style:{position:"relative",zIndex:1,isolation:"isolate",background:`
          radial-gradient(circle at 20% 30%, rgba(24, 227, 255, 0.08) 0%, transparent 50%),
          radial-gradient(circle at 80% 70%, rgba(255, 107, 53, 0.06) 0%, transparent 50%),
          radial-gradient(circle at 50% 50%, rgba(61, 19, 179, 0.04) 0%, transparent 60%),
          linear-gradient(180deg, #0B0E17 0%, #0F1219 50%, #0B0E17 100%)
        `},children:[e.jsxs("div",{className:"cosmic-forge-particles",style:{opacity:.8},children:[e.jsx("div",{className:"forge-particle forge-particle--1"}),e.jsx("div",{className:"forge-particle forge-particle--2"}),e.jsx("div",{className:"forge-particle forge-particle--3"}),e.jsx("div",{className:"forge-particle forge-particle--4"}),e.jsx("div",{className:"forge-particle forge-particle--5",style:{position:"absolute",top:"15%",left:"25%",width:"3px",height:"3px",background:"radial-gradient(circle, rgba(24, 227, 255, 0.8), transparent)",borderRadius:"50%",animation:"floatParticle 8s ease-in-out infinite",animationDelay:"1s"}}),e.jsx("div",{className:"forge-particle forge-particle--6",style:{position:"absolute",top:"75%",right:"20%",width:"4px",height:"4px",background:"radial-gradient(circle, rgba(255, 107, 53, 0.6), transparent)",borderRadius:"50%",animation:"floatParticle 10s ease-in-out infinite",animationDelay:"2s"}})]}),e.jsx("div",{className:"w-full max-w-md mx-auto px-4 auth-form-wrapper",style:{position:"relative",zIndex:100,isolation:"isolate",transform:"translateZ(0)",pointerEvents:"auto"},children:e.jsx(L.div,{initial:{opacity:0,y:30,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.8,ease:"easeOut"},style:{position:"relative",zIndex:101,isolation:"isolate",transform:"translateZ(0)",pointerEvents:"auto"},children:e.jsxs(te,{className:"p-6 relative w-full auth-form-card",style:{position:"relative",zIndex:102,isolation:"isolate",transform:"translateZ(0)",pointerEvents:"auto",background:`
                radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--color-plasma-cyan) 14%, transparent) 0%, transparent 60%),
                radial-gradient(circle at 70% 80%, rgba(255, 107, 53, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, rgba(61, 19, 179, 0.06) 0%, transparent 70%),
                rgba(255, 255, 255, 0.06)
              `,borderColor:"color-mix(in srgb, var(--color-plasma-cyan) 30%, transparent)",boxShadow:`
                0 24px 64px rgba(0, 0, 0, 0.5),
                0 0 48px color-mix(in srgb, var(--color-plasma-cyan) 20%, transparent),
                0 0 96px color-mix(in srgb, var(--color-plasma-cyan) 12%, transparent),
                0 0 120px rgba(255, 107, 53, 0.08),
                inset 0 2px 0 rgba(255, 255, 255, 0.25),
                inset 0 -2px 0 rgba(0, 0, 0, 0.15)
              `,backdropFilter:"blur(32px) saturate(180%)"},children:[e.jsx(L.div,{className:"flex justify-center mb-6",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},style:{position:"relative",zIndex:103,pointerEvents:"auto"},children:e.jsx("div",{className:"transform scale-110",style:{filter:"drop-shadow(0 0 16px color-mix(in srgb, var(--color-plasma-cyan) 25%, transparent)) drop-shadow(0 0 8px rgba(255, 255, 255, 0.1))"},children:e.jsx(Z,{variant:"desktop",isHovered:!1})})}),e.jsxs("div",{style:{position:"relative",zIndex:103,pointerEvents:"auto"},children:[e.jsx("h1",{className:"text-xl font-bold text-white mb-2 text-center",children:t?"Rejoindre TwinForge":"Connexion TwinForge"}),e.jsx("p",{className:"text-white/70 text-sm text-center mb-4",children:t?"Créez votre Forge Spatiale":"Accédez à votre Forge Spatiale"})]}),e.jsx("form",{onSubmit:j,className:"auth-form-interactive",style:{position:"relative",zIndex:104,isolation:"isolate",transform:"translateZ(0)",pointerEvents:"auto"},children:e.jsxs(L.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.4},style:{position:"relative",zIndex:105,pointerEvents:"auto"},children:[e.jsx(J,{mode:"wait",children:t&&e.jsxs(L.div,{className:"mb-4",initial:{opacity:0,height:0,y:-10},animate:{opacity:1,height:"auto",y:0},exit:{opacity:0,height:0,y:-10},transition:{duration:.3},style:{position:"relative",zIndex:106,pointerEvents:"auto"},children:[e.jsx("label",{htmlFor:"displayName",className:"block text-white/90 text-sm font-medium mb-1",children:"Nom d'affichage"}),e.jsx("input",{id:"displayName",type:"text",value:g,onChange:S=>m(S.target.value),className:"glass-input w-full auth-input",placeholder:"Votre nom dans la forge",required:t,style:{position:"relative",zIndex:107,pointerEvents:"auto",cursor:"text",userSelect:"auto",WebkitUserSelect:"auto"}})]},"displayName")}),e.jsxs("div",{className:"mb-4",style:{position:"relative",zIndex:106,pointerEvents:"auto"},children:[e.jsx("label",{htmlFor:"email",className:"block text-white/90 text-sm font-medium mb-1",children:"Adresse email"}),e.jsx("input",{id:"email",type:"email",value:s,onChange:S=>n(S.target.value),className:"glass-input w-full auth-input",placeholder:"votre@email.com",required:!0,style:{position:"relative",zIndex:107,pointerEvents:"auto",cursor:"text",userSelect:"auto",WebkitUserSelect:"auto"}})]}),e.jsxs("div",{className:"mb-4",style:{position:"relative",zIndex:106,pointerEvents:"auto"},children:[e.jsx("label",{htmlFor:"password",className:"block text-white/90 text-sm font-medium mb-1",children:"Mot de passe"}),e.jsx("input",{id:"password",type:"password",value:a,onChange:S=>u(S.target.value),className:"glass-input w-full auth-input",placeholder:"Votre mot de passe sécurisé",required:!0,minLength:6,style:{position:"relative",zIndex:107,pointerEvents:"auto",cursor:"text",userSelect:"auto",WebkitUserSelect:"auto"}})]}),e.jsx(J,{children:c&&e.jsx(L.div,{className:"mb-4",initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.3},style:{position:"relative",zIndex:106,pointerEvents:"auto"},children:e.jsx(te,{className:"p-3",style:{background:"rgba(239, 68, 68, 0.15)",borderColor:"rgba(239, 68, 68, 0.4)",backdropFilter:"blur(12px) saturate(130%)",boxShadow:"0 0 20px rgba(239, 68, 68, 0.3)",position:"relative",zIndex:107,pointerEvents:"auto"},children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(O,{Icon:T.AlertTriangle,size:14,className:"text-red-300 mt-0.5"}),e.jsx("p",{className:"text-red-200 text-sm leading-relaxed",children:c})]})})})}),e.jsx("button",{type:"submit",disabled:f||h,className:"w-full auth-submit-button mb-4",style:{position:"relative",zIndex:106,pointerEvents:"auto",cursor:"pointer",background:`
                      linear-gradient(135deg, 
                        color-mix(in srgb, var(--brand-primary) 80%, transparent), 
                        color-mix(in srgb, var(--color-plasma-cyan) 60%, transparent)
                      )
                    `,backdropFilter:"blur(20px) saturate(160%)",boxShadow:`
                      0 12px 40px color-mix(in srgb, var(--brand-primary) 40%, transparent),
                      0 0 60px color-mix(in srgb, var(--brand-primary) 30%, transparent),
                      0 0 100px color-mix(in srgb, var(--color-plasma-cyan) 20%, transparent),
                      inset 0 3px 0 rgba(255,255,255,0.4)
                    `,border:"2px solid color-mix(in srgb, var(--brand-primary) 60%, transparent)",borderRadius:"999px",padding:"0.75rem 1.5rem",minHeight:"48px",color:"white",fontWeight:"bold",fontSize:"1rem",transition:"all 0.2s ease"},onMouseEnter:S=>{!f&&!h&&(S.currentTarget.style.transform="translateY(-2px) scale(1.02)")},onMouseLeave:S=>{S.currentTarget.style.transform="translateY(0) scale(1)"},children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[f?e.jsx(O,{Icon:T.Loader2,size:18,className:"text-white animate-spin"}):e.jsx(O,{Icon:t?T.UserPlus:T.LogIn,size:18,className:"text-white"}),e.jsx("span",{children:f||h?"Forge en cours...":t?"Créer ma Forge":"Accéder à ma Forge"})]})}),e.jsxs("div",{className:"flex items-center gap-4 my-4",style:{position:"relative",zIndex:106,pointerEvents:"auto"},children:[e.jsx("div",{className:"flex-1 h-px bg-white/20"}),e.jsx("span",{className:"text-white/50 text-sm",children:"ou"}),e.jsx("div",{className:"flex-1 h-px bg-white/20"})]}),e.jsx("button",{type:"button",onClick:x,disabled:h||f,className:"w-full auth-google-button mb-4",style:{position:"relative",zIndex:106,pointerEvents:"auto",cursor:"pointer",background:`
                      linear-gradient(135deg, 
                        rgba(255, 255, 255, 0.95), 
                        rgba(248, 250, 252, 0.9)
                      )
                    `,backdropFilter:"blur(20px) saturate(160%)",boxShadow:`
                      0 8px 32px rgba(0, 0, 0, 0.15),
                      0 0 40px rgba(255, 255, 255, 0.1),
                      inset 0 2px 0 rgba(255,255,255,0.8)
                    `,border:"2px solid rgba(255, 255, 255, 0.3)",borderRadius:"999px",padding:"0.75rem 1.5rem",minHeight:"48px",color:"#1f2937",fontWeight:"600",fontSize:"1rem",transition:"all 0.2s ease"},onMouseEnter:S=>{!f&&!h&&(S.currentTarget.style.transform="translateY(-2px) scale(1.02)")},onMouseLeave:S=>{S.currentTarget.style.transform="translateY(0) scale(1)"},children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[h?e.jsx(O,{Icon:T.Loader2,size:18,style:{color:"#1f2937"},className:"animate-spin"}):e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),e.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),e.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),e.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),e.jsx("span",{children:h?"Redirection...":t?"Créer un compte avec Google":"Se connecter avec Google"})]})}),e.jsx("div",{className:"text-center",style:{position:"relative",zIndex:106,pointerEvents:"auto"},children:e.jsx("button",{type:"button",onClick:D,disabled:f||h,className:"text-white/70 hover:text-white text-sm transition-colors auth-toggle-button",style:{position:"relative",zIndex:107,pointerEvents:"auto",cursor:"pointer",background:"none",border:"none",padding:"0.5rem"},children:t?"Déjà un compte ? Se connecter":"Pas de compte ? Créer un compte"})})]})})]})})})]})},St=l.lazy(()=>_(()=>import("./Home-7rKTwsqc.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]))),jt=l.lazy(()=>_(()=>import("./Profile-1IXM_tiF.js"),__vite__mapDeps([12,1,2,3,4,5,6,7,8,9,10,11,13,14,15]))),Et=l.lazy(()=>_(()=>import("./ActivityPage-DlXHk3NN.js"),__vite__mapDeps([16,1,2,3,4,5,6,7,8,9,10,11,17,18]))),At=l.lazy(()=>_(()=>import("./FastingPage-nWci1V9W.js"),__vite__mapDeps([19,1,2,3,4,5,6,7,8,9,10,11,13,20,14,15]))),Nt=l.lazy(()=>_(()=>import("./MealsPage-DrG7xwQu.js"),__vite__mapDeps([21,1,2,3,4,5,6,7,8,9,10,11,13,22]))),Ct=l.lazy(()=>_(()=>import("./MealScanFlowPage-VnnHAbya.js"),__vite__mapDeps([23,1,2,3,4,5,6,7,8,9,10,11,22,24]))),_t=l.lazy(()=>_(()=>import("./FridgePage-nTt68L6X.js"),__vite__mapDeps([25,1,2,3,4,5,6,7,8,9,10,11]))),kt=l.lazy(()=>_(()=>import("./TrainingPage-eY2VZxGO.js"),__vite__mapDeps([26,1,2,3,4,5,6,7,8,9,10,11,27]))),It=l.lazy(()=>_(()=>import("./SettingsPage-CmE1fBy0.js"),__vite__mapDeps([28,1,2,3,4,5,6,7,8,9,10,11,27,29]))),Tt=l.lazy(()=>_(()=>import("./NotificationsPage-DkpguJNp.js"),__vite__mapDeps([30,1,2,3,4,5,6,7,8,9,10,11,27])));l.lazy(()=>_(()=>import("./BodyScanPage-xGF91KXt.js"),__vite__mapDeps([31,1,2,3,4,5,6,7,8,9,10,11,27])));const Pt=l.lazy(()=>_(()=>import("./AvatarPage-DMr8ET41.js"),__vite__mapDeps([32,1,2,3,4,5,6,7,8,9,10,11,13,33,34]))),Ot=l.lazy(()=>_(()=>import("./BodyScan-Dya8-Qjv.js"),__vite__mapDeps([35,1,2,3,4,5,6,7,8,9,10,11,34,36,37]))),Dt=l.lazy(()=>_(()=>import("./BodyScanCelebrationWithHeader-ByrlqeVo.js"),__vite__mapDeps([38,1,2,3,4,5,6,7,8,9,10,11,36,37]))),Lt=l.lazy(()=>_(()=>import("./BodyScanReviewWithHeader-B91STXgt.js"),__vite__mapDeps([39,1,2,3,4,5,6,7,8,9,10,11,36,37,33,34]))),Rt=l.lazy(()=>_(()=>import("./ActivityInputPage-B_JdkKrS.js"),__vite__mapDeps([40,1,2,3,4,5,6,7,8,9,10,11,17,18,41]))),Ft=l.lazy(()=>_(()=>import("./FastingInputPage-kHorXwsk.js"),__vite__mapDeps([42,1,2,3,4,5,6,7,8,9,10,11,20]))),zt=l.lazy(()=>_(()=>import("./FridgeScanPage-Bm6pkHli.js"),__vite__mapDeps([43,1,2,3,4,5,6,7,8,9,10,11]))),Ut=l.lazy(()=>_(()=>import("./VitalPage-6JAqj2pR.js"),__vite__mapDeps([44,1,2,3,4,5,6,7,8,9,10,11]))),Mt=l.lazy(()=>_(()=>import("./DevCachePage-B7kfahNY.js"),__vite__mapDeps([45,1,2,3,4,5,6,7,8,9,10,11]))),Bt=l.lazy(()=>_(()=>import("./LogoGalleryPage-BE2BFIHB.js"),__vite__mapDeps([46,1,2,3,4,5,6,7,8,9,10,11])));function $t({children:r}){const[t,i]=l.useState(!0),[s,n]=l.useState(!1),[a,u]=l.useState(null),g=l.useRef(!1),{setSession:m,setAuthReady:f}=X();return l.useEffect(()=>{if(g.current)return;g.current=!0,(async()=>{try{d.debug("AUTH","Starting authentication initialization");const{data:{session:p}}=await R.auth.getSession();p?.user?(d.debug("AUTH","Found existing session"),u(p.user),n(!1),m(p),f(!0)):(d.debug("AUTH","No session found, showing auth form"),n(!0),m(null),f(!1))}catch(p){d.error("AUTH","Error during initialization",{error:p}),n(!0),m(null),f(!1)}finally{i(!1)}})();const{data:{subscription:h}}=R.auth.onAuthStateChange((p,c)=>{d.debug("AUTH","Auth state changed",{event:p,hasSession:!!c}),c?.user?(u(c.user),n(!1),m(c),f(!0)):(u(null),n(!0),m(null),f(!1)),i(!1)});return()=>h.unsubscribe()},[]),t?e.jsx(A,{title:"Bienvenue sur TwinForge",subtitle:"Vérification de votre session..."}):s?e.jsx(wt,{onSuccess:()=>window.location.href="/"}):e.jsx(e.Fragment,{children:r})}const Wt=ve([{path:"/",element:e.jsx($t,{children:e.jsx(nt,{})}),children:[{index:!0,element:e.jsx(l.Suspense,{fallback:e.jsx(A,{}),children:e.jsx(St,{})})},{path:"profile",element:e.jsx(l.Suspense,{fallback:e.jsx(A,{}),children:e.jsx(jt,{})})},{path:"meals",element:e.jsx(l.Suspense,{fallback:e.jsx(A,{}),children:e.jsx(Nt,{})})},{path:"meals/scan",element:e.jsx(l.Suspense,{fallback:e.jsx(A,{}),children:e.jsx(Ct,{})})},{path:"activity",element:e.jsx(l.Suspense,{fallback:e.jsx(A,{}),children:e.jsx(Et,{})})},{path:"activity/input",element:e.jsx(l.Suspense,{fallback:e.jsx(A,{}),children:e.jsx(Rt,{})})},{path:"fasting",element:e.jsx(l.Suspense,{fallback:e.jsx(A,{}),children:e.jsx(At,{})})},{path:"fasting/input",element:e.jsx(l.Suspense,{fallback:e.jsx(A,{}),children:e.jsx(Ft,{})})},{path:"fridge",element:e.jsx(l.Suspense,{fallback:e.jsx(A,{}),children:e.jsx(_t,{})})},{path:"fridge/scan",element:e.jsx(l.Suspense,{fallback:e.jsx(A,{}),children:e.jsx(zt,{})})},{path:"training",element:e.jsx(l.Suspense,{fallback:e.jsx(A,{}),children:e.jsx(kt,{})})},{path:"settings",element:e.jsx(l.Suspense,{fallback:e.jsx(A,{}),children:e.jsx(It,{})})},{path:"notifications",element:e.jsx(l.Suspense,{fallback:e.jsx(A,{}),children:e.jsx(Tt,{})})},{path:"avatar",element:e.jsx(l.Suspense,{fallback:e.jsx(A,{}),children:e.jsx(Pt,{})})},{path:"body-scan",element:e.jsx(l.Suspense,{fallback:e.jsx(A,{}),children:e.jsx(Ot,{})})},{path:"body-scan/celebration",element:e.jsx(l.Suspense,{fallback:e.jsx(A,{}),children:e.jsx(Dt,{})})},{path:"body-scan/review",element:e.jsx(l.Suspense,{fallback:e.jsx(A,{}),children:e.jsx(Lt,{})})},{path:"vital",element:e.jsx(l.Suspense,{fallback:e.jsx(A,{}),children:e.jsx(Ut,{})})},{path:"dev/cache",element:e.jsx(l.Suspense,{fallback:e.jsx(A,{}),children:e.jsx(Mt,{})})},{path:"dev/logos",element:e.jsx(l.Suspense,{fallback:e.jsx(A,{}),children:e.jsx(Bt,{})})}]}]),Ht=!1,Gt=e.jsx(yt,{children:e.jsx(we,{router:Wt})});ye(document.getElementById("root")).render(Gt);d.info("APP","React app initialized",{strictMode:Ht,env:"production"});export{ct as E,A as L};
