import{cN as $,u as j,R as g,j as a}from"./vendor-BefW7Bxj.js";import{s as h}from"./stores-Dp3vmZ5-.js";import{u as A,B as N}from"./BodyScanProgressHeader-Cl4niUVu.js";import{K as s,S as x,I as d}from"./ui-components-lrK_WhZu.js";import{u as C,l as b}from"./page-fridge-Cp-W9isk.js";import"./utils-CUtLAp28.js";import"./supabase-pyFrrmXL.js";import"./page-fridge-scan-C62RDC3k.js";import"./motion-BQvLDPOm.js";import"./date-utils-BlBdbPk_.js";const I=()=>{const e=A(),i=$(),l=j(),{successMajor:n,success:u}=C(),{completeProgress:f}=h(),v=g.useRef(!1),c=i.state?.scanResults,m=i.state?.isFaceScan||!1;if(g.useEffect(()=>{if(!v.current){if(!c){l(m?"/avatar#avatar":"/body-scan",{replace:!0});return}n(),f(),v.current=!0,b.info("CELEBRATION","Celebration step mounted with scan results",{hasResults:!!c,confidence:y(c),isFaceScan:m})}},[c,l,n,f,m]),!c)return null;const p=y(c),t=(()=>{const r=o=>e.mode==="high-performance"?0:e.mode==="balanced"?Math.ceil(o/2):o;return p>=.9?{title:"🌟 Scan Absolument Parfait !",subtitle:"Votre morphologie a été capturée avec une précision exceptionnelle",celebrationMessage:"Qualité Légendaire Atteinte",motivationalQuote:"Votre reflet numérique sera d'une fidélité saisissante",color:"#10B981",icon:d.Zap,particleCount:r(12),celebrationLevel:"legendary"}:p>=.7?{title:"✨ Scan Exceptionnel !",subtitle:"Votre avatar sera d'une qualité remarquable",celebrationMessage:"Excellence Morphologique Détectée",motivationalQuote:"Préparez-vous à découvrir votre double numérique parfait",color:"#22C55E",icon:d.Check,particleCount:r(10),celebrationLevel:"exceptional"}:p>=.5?{title:"🎯 Scan de Haute Qualité !",subtitle:"Votre morphologie a été analysée avec précision",celebrationMessage:"Analyse Premium Réussie",motivationalQuote:"Votre avatar 3D sera fidèle à votre silhouette unique",color:"#10B981",icon:d.Target,particleCount:r(8),celebrationLevel:"high"}:p>0?{title:"🚀 Scan Réussi avec Brio !",subtitle:"Votre avatar est prêt avec des optimisations intelligentes",celebrationMessage:"Analyse Avancée Activée",motivationalQuote:"Votre scan a été optimisé avec précision",color:"#F59E0B",icon:d.Zap,particleCount:r(6),celebrationLevel:"optimized"}:{title:"🎉 Avatar 3D Créé !",subtitle:"Votre reflet numérique est prêt à être découvert",celebrationMessage:"Scan Terminé avec Succès",motivationalQuote:"Explorez votre avatar 3D personnalisé",color:"#8B5CF6",icon:d.Eye,particleCount:r(6),celebrationLevel:"complete"}})(),S=()=>{u(),l(m?"/avatar#avatar":"/body-scan/review",{state:{scanResults:c},replace:!1})};return a.jsxs("div",{className:"relative overflow-visible pt-4 pb-6 md:pb-8",children:[e.enableParticleEffects&&a.jsxs("div",{className:"celebration-background-effects absolute inset-0 pointer-events-none overflow-visible",children:[a.jsx("div",{className:"celebration-ambient-glow absolute inset-0 rounded-3xl",style:{background:`radial-gradient(circle at center, ${t.color}15, transparent 70%)`,"--celebration-color":t.color}}),[...Array(t.particleCount)].map((r,o)=>a.jsx("div",{className:`celebration-particle celebration-particle--${o+1} absolute w-3 h-3 rounded-full`,style:{background:`radial-gradient(circle, ${t.color}, ${t.color}80)`,left:`${15+o*8}%`,top:`${20+o%4*15}%`,boxShadow:`0 0 12px ${t.color}80, 0 0 24px ${t.color}40`,"--celebration-color":t.color,"--particle-index":o}},o)),[...Array(6)].map((r,o)=>a.jsx("div",{className:`celebration-ray celebration-ray--${o+1} absolute w-1 h-20 rounded-full`,style:{background:`linear-gradient(180deg, ${t.color}60, transparent)`,left:`${30+o*12}%`,top:"10%",transformOrigin:"bottom center","--celebration-color":t.color}},`ray-${o}`))]}),a.jsxs("div",{className:"celebration-main-content relative text-center py-8 md:py-12 z-10",children:[a.jsxs(s,{className:"relative w-32 h-32 mx-auto mb-8",initial:e.enableInitialAnimations?{scale:0,rotate:-180}:!1,animate:e.enableInitialAnimations?{scale:1,rotate:0}:{scale:1},transition:e.enableFramerMotion?{type:"spring",stiffness:200,damping:15,duration:1.2}:void 0,children:[a.jsx("div",{className:"celebration-icon-outer-glow absolute inset-0 rounded-full",style:{background:`radial-gradient(circle, ${t.color}40, transparent 70%)`,filter:"blur(8px)","--celebration-color":t.color}}),a.jsx("div",{className:"celebration-icon-inner-container absolute inset-8 rounded-full flex items-center justify-center",style:{background:`linear-gradient(135deg, ${t.color}30, ${t.color}60)`,border:`2px solid ${t.color}`,boxShadow:`0 0 60px ${t.color}90, inset 0 4px 0 rgba(255,255,255,0.3)`,"--celebration-color":t.color},children:a.jsx(x,{Icon:t.icon,size:48,color:t.color})}),e.enablePulseAnimations&&[...Array(e.mode==="quality"?3:1)].map((r,o)=>a.jsx("div",{className:`celebration-icon-pulse-ring celebration-icon-pulse-ring--${o+1} absolute inset-0 rounded-full border-2`,style:{borderColor:`${t.color}40`,"--celebration-color":t.color}},`pulse-${o}`))]}),a.jsxs(s,{initial:e.enableInitialAnimations?{opacity:0,y:30}:!1,animate:e.enableInitialAnimations?{opacity:1,y:0}:{opacity:1},transition:e.enableFramerMotion?{delay:.6,duration:.8}:void 0,children:[a.jsx(s,{as:"h3",className:"celebration-title-glow text-4xl md:text-5xl font-bold text-white mb-4",style:{color:t.color},children:t.title}),a.jsx(s,{as:"p",className:"text-xl text-white/90 mb-6 leading-relaxed max-w-2xl mx-auto",initial:e.enableStaggerAnimations?{opacity:0,y:20}:!1,animate:e.enableStaggerAnimations?{opacity:1,y:0}:{opacity:1},transition:e.enableFramerMotion?{delay:.8,duration:.6}:void 0,children:t.subtitle})]})]}),a.jsx(s,{className:"flex justify-center relative z-10 mt-4",initial:e.enableInitialAnimations?{opacity:0,y:40}:!1,animate:e.enableInitialAnimations?{opacity:1,y:0}:{opacity:1},transition:e.enableFramerMotion?{delay:1,duration:.8}:void 0,children:a.jsxs(s,{as:"button",onClick:S,className:"btn-glass--primary px-12 py-6 text-xl font-bold relative overflow-hidden",whileHover:e.enableWhileHover?{scale:1.03}:void 0,whileTap:e.enableWhileTap?{scale:.97}:void 0,style:{background:`linear-gradient(135deg, ${t.color}80, ${t.color}60)`,boxShadow:`0 12px 40px ${t.color}40, 0 0 60px ${t.color}30`,border:`2px solid ${t.color}`,color:"#0B0F1A"},children:[e.enableShimmerEffects&&a.jsx("div",{className:"celebration-cta-shimmer absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent"}),e.enableParticleEffects&&[...Array(4)].map((r,o)=>a.jsx("div",{className:`celebration-cta-sparkle celebration-cta-sparkle--${o+1} absolute w-2 h-2 rounded-full bg-white`,style:{left:`${20+o*20}%`,top:`${30+o%2*40}%`}},o)),a.jsxs("div",{className:"relative flex items-center justify-center gap-4",children:[a.jsx(x,{Icon:d.Eye,size:28,color:"#0B0F1A"}),a.jsx("span",{children:"Mon Avatar 3D"})]})]})}),e.enableParticleEffects&&a.jsx("div",{className:"absolute inset-0 pointer-events-none overflow-visible",children:[...Array(e.mode==="quality"?8:e.mode==="balanced"?4:0)].map((r,o)=>a.jsx("div",{className:`celebration-confetti celebration-confetti--${o+1} absolute w-2 h-6 rounded-full`,style:{background:`linear-gradient(180deg, ${t.color}, ${t.color}60)`,left:`${10+o*10}%`,top:"-10%","--celebration-color":t.color}},`confetti-${o}`))})]})};function y(e){const i=e?.match?.ai_refinement?.ai_confidence;if(typeof i=="number"&&Number.isFinite(i)&&i>0&&i<=1)return b.debug("CELEBRATION","Using AI refinement confidence (highest priority)",{confidence:i,source:"ai_refinement.ai_confidence",clientScanId:e?.clientScanId,serverScanId:e?.serverScanId,philosophy:"ai_refinement_confidence_priority"}),i;const l=[e?.match?.semantic_coherence_score,e?.estimate?.extracted_data?.processing_confidence,e?.insights?.confidence,e?.estimate?.confidence?.vision,e?.semantic?.semantic_confidence,e?.commit?.confidence,e?.blending?.confidence];for(const n of l)if(typeof n=="number"&&Number.isFinite(n)&&n>0&&n<=1)return b.debug("CELEBRATION","Found valid confidence from fallback source",{confidence:n,source:"fallback_hierarchy",clientScanId:e?.clientScanId,serverScanId:e?.serverScanId,philosophy:"fallback_confidence_used"}),n;return b.warn("CELEBRATION","No valid confidence found in scan results (including AI refinement)",{clientScanId:e?.clientScanId,serverScanId:e?.serverScanId,sourcesChecked:[{source:"ai_refinement.ai_confidence",value:i,type:typeof i,isValid:typeof i=="number"&&Number.isFinite(i)&&i>0&&i<=1},...l.map((n,u)=>({index:u,value:n,type:typeof n,isValid:typeof n=="number"&&Number.isFinite(n)&&n>0&&n<=1}))],philosophy:"no_confidence_found_comprehensive_check"}),0}const z=()=>{const{isActive:e,steps:i,currentStep:l,progress:n,message:u,subMessage:f}=h();return a.jsxs("div",{className:"max-w-4xl mx-auto mt-4 space-y-6 pb-4",children:[e&&i.length>0&&a.jsx(N,{steps:i,currentStepId:l,progress:100,message:"Scan Corporel Terminé",subMessage:"Votre avatar 3D est prêt"}),a.jsx(I,{})]})};export{z as default};
