/**
 * Mobile Radical Optimizations - SURGICAL APPROACH
 * PRIORITY: Functionality > Performance > Visual Effects
 * CRITICAL: Preserve header, bottom bar, and icon visibility
 */

/* =========================================
   CRITICAL WHITELIST - PRESERVE THESE ELEMENTS
   Header, Bottom Bar, Navigation Icons MUST work
   ========================================= */

/* PRESERVE: Header - Must stay fixed and visible */
.is-mobile .header-liquid-glass,
.is-mobile .header-liquid-glass *,
.is-mobile .header-liquid-glass .icon-container,
.is-mobile .header-liquid-glass .spatial-icon,
.is-mobile .header-liquid-glass .user-panel-toggle {
  /* Keep essential visual effects */
  backdrop-filter: blur(12px) saturate(130%) !important;
  -webkit-backdrop-filter: blur(12px) saturate(130%) !important;
  /* Keep transforms for fixed positioning */
  transform: translateZ(0) !important;
  -webkit-transform: translateZ(0) !important;
  /* Preserve visibility */
  opacity: 1 !important;
  display: flex !important;
}

/* PRESERVE: Bottom Bar - Must stay fixed and visible */
.is-mobile .new-mobile-bottom-bar,
.is-mobile .new-mobile-bottom-bar *,
.is-mobile .new-mobile-bottom-bar-container,
.is-mobile .new-bottom-bar-icon-container,
.is-mobile .new-bottom-bar-button {
  /* Keep essential visual effects */
  backdrop-filter: blur(12px) saturate(130%) !important;
  -webkit-backdrop-filter: blur(12px) saturate(130%) !important;
  /* Keep transforms for fixed positioning */
  transform: translateZ(0) !important;
  -webkit-transform: translateZ(0) !important;
  /* Preserve visibility */
  opacity: 1 !important;
  display: flex !important;
}

/* PRESERVE: All SpatialIcon components - Must be visible */
.is-mobile .spatial-icon,
.is-mobile .icon-container,
.is-mobile .spatial-icon *,
.is-mobile .icon-container * {
  /* Ensure icons are always visible */
  opacity: 1 !important;
  visibility: visible !important;
  display: flex !important;
  /* Preserve minimal effects for visibility */
  filter: none !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
}

/* PRESERVE: PageHeader icons - Must be visible */
.is-mobile .page-header-title,
.is-mobile .page-header-subtitle,
.is-mobile .breathing-icon,
.is-mobile .breathing-icon * {
  opacity: 1 !important;
  visibility: visible !important;
  display: flex !important;
}

/* =========================================
   MOBILE: DISABLE THREE.JS
   ========================================= */
.is-mobile canvas[data-engine="three.js"],
.is-mobile .Avatar3DViewer,
.is-mobile .FaceViewer3D {
  display: none !important;
  visibility: hidden !important;
}

/* =========================================
   MOBILE: SELECTIVE GLASSMORPHISM
   Remove glass effects EXCEPT for navigation
   ========================================= */
.is-mobile .glass-card:not(.header-liquid-glass):not(.new-mobile-bottom-bar-container),
.is-mobile .glass-card-cta:not(.header-liquid-glass):not(.new-mobile-bottom-bar-container),
.is-mobile .glass-button:not(.glass-orb-button):not(.new-bottom-bar-icon-container),
.is-mobile .btn-glass:not(.glass-orb-button):not(.new-bottom-bar-icon-container) {
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  background: rgba(255, 255, 255, 0.08) !important;
  border: 1px solid rgba(255, 255, 255, 0.12) !important;
}

/* =========================================
   MOBILE: DISABLE ANIMATIONS EXCEPT CRITICAL
   ========================================= */
.is-mobile *:not(.header-liquid-glass):not(.header-liquid-glass *):not(.new-mobile-bottom-bar):not(.new-mobile-bottom-bar *) {
  animation: none !important;
  transition: none !important;
}

/* Keep minimal transitions for navigation */
.is-mobile .header-liquid-glass,
.is-mobile .new-mobile-bottom-bar,
.is-mobile .new-bottom-bar-button,
.is-mobile .new-bottom-bar-icon-container {
  transition: background-color 0.15s ease, border-color 0.15s ease !important;
}

/* =========================================
   MOBILE: DISABLE PARTICLES & DECORATIONS
   ========================================= */
.is-mobile [class*="particle"]:not(.spatial-icon):not(.icon-container),
.is-mobile [class*="spark"],
.is-mobile .breathing-glow:not(.breathing-icon) {
  display: none !important;
  visibility: hidden !important;
}

/* =========================================
   MOBILE: SELECTIVE GPU ACCELERATION
   Only for fixed elements
   ========================================= */
.is-mobile .header-liquid-glass,
.is-mobile .new-mobile-bottom-bar {
  transform: translate3d(0, 0, 0) !important;
  -webkit-transform: translate3d(0, 0, 0) !important;
  backface-visibility: hidden !important;
  -webkit-backface-visibility: hidden !important;
  will-change: transform !important;
}

/* Disable GPU acceleration on everything else */
.is-mobile *:not(.header-liquid-glass):not(.new-mobile-bottom-bar) {
  backface-visibility: visible !important;
  -webkit-backface-visibility: visible !important;
  perspective: none !important;
  -webkit-perspective: none !important;
  transform-style: flat !important;
  -webkit-transform-style: flat !important;
  will-change: auto !important;
}

/* =========================================
   MOBILE: DISABLE SHADOWS EXCEPT NAVIGATION
   ========================================= */
.is-mobile *:not(.header-liquid-glass):not(.new-mobile-bottom-bar-container):not(.new-bottom-bar-icon-container) {
  box-shadow: none !important;
  text-shadow: none !important;
}

/* Keep shadows for navigation */
.is-mobile .header-liquid-glass,
.is-mobile .new-mobile-bottom-bar-container {
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3) !important;
}

/* =========================================
   MOBILE: ENSURE SCROLL WORKS
   ========================================= */
.is-mobile {
  -webkit-overflow-scrolling: touch !important;
  overscroll-behavior: contain !important;
}

.is-mobile #main-content,
.is-mobile [role="main"] {
  overflow-y: auto !important;
  -webkit-overflow-scrolling: touch !important;
  overscroll-behavior-y: auto !important;
}

/* =========================================
   MOBILE: DISABLE HOVER EFFECTS
   ========================================= */
@media (hover: none) and (pointer: coarse) {
  *:not(.header-liquid-glass):not(.new-mobile-bottom-bar) {
    transition: none !important;
  }

  *:hover {
    transform: none !important;
    scale: 1 !important;
  }
}

/* =========================================
   MOBILE: FONT OPTIMIZATION
   ========================================= */
.is-mobile * {
  font-smooth: never !important;
  -webkit-font-smoothing: antialiased !important;
  -moz-osx-font-smoothing: grayscale !important;
  text-rendering: optimizeSpeed !important;
}

/* =========================================
   MOBILE: FORCE INTERACTIVE ELEMENTS VISIBLE
   ========================================= */
.is-mobile button,
.is-mobile a,
.is-mobile input,
.is-mobile textarea {
  cursor: pointer !important;
  -webkit-tap-highlight-color: rgba(24, 227, 255, 0.3) !important;
  opacity: 1 !important;
  visibility: visible !important;
}

/* =========================================
   LOW-END MOBILE: EXTREME MEASURES
   ========================================= */
.is-low-end-mobile * {
  will-change: auto !important;
  contain: none !important;
  isolation: auto !important;
  animation: none !important;
  transition: none !important;
}
