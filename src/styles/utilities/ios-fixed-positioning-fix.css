/**
 * iOS Safari Fixed Positioning Fix
 *
 * Sur iOS Safari, position: fixed peut ne pas fonctionner correctement si:
 * 1. Un élément parent a une transformation CSS
 * 2. Le body a overflow-x: hidden (au lieu de clip)
 * 3. Il manque les propriétés webkit spécifiques
 *
 * Ce fichier garantit que tous les éléments fixed restent fixés.
 */

/* Force hardware acceleration for all fixed elements */
[style*="position: fixed"],
[style*="position:fixed"],
.header-liquid-glass,
.new-mobile-bottom-bar,
.floating-chat-button,
.unified-floating-button {
  /* Force GPU layer */
  transform: translate3d(0, 0, 0);
  -webkit-transform: translate3d(0, 0, 0);

  /* Optimize rendering */
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;

  /* Ensure clickability */
  pointer-events: auto;

  /* Hint to browser for optimization */
  will-change: transform;
}

/* iOS Safari specific fixes */
@supports (-webkit-touch-callout: none) {
  /* This targets iOS Safari specifically */

  body {
    /* Ensure body doesn't interfere with fixed positioning */
    position: relative !important;
    isolation: isolate !important;
  }

  /* Force all fixed elements to stay fixed */
  .header-liquid-glass,
  .new-mobile-bottom-bar,
  .floating-chat-button,
  .unified-floating-button {
    position: fixed !important;
    /* iOS Safari needs explicit z-index for fixed elements */
    z-index: 9990 !important;
  }

  /* Ensure header stays at top */
  .header-liquid-glass {
    z-index: 9999 !important;
  }

  /* Ensure bottom bar stays at bottom */
  .new-mobile-bottom-bar {
    z-index: 9996 !important;
  }

  /* Ensure floating buttons are above content */
  .floating-chat-button,
  .unified-floating-button {
    z-index: 9995 !important;
  }
}

/* Mobile Safari WebKit specific */
@media screen and (-webkit-min-device-pixel-ratio: 0) {
  /* Prevent body transform from affecting fixed children */
  body {
    transform: translate3d(0, 0, 0);
    -webkit-transform: translate3d(0, 0, 0);
  }
}

/* Ensure safe area insets work correctly */
@supports (padding: env(safe-area-inset-bottom)) {
  .header-liquid-glass {
    top: max(6px, env(safe-area-inset-top, 8px)) !important;
  }

  .new-mobile-bottom-bar {
    bottom: max(4px, env(safe-area-inset-bottom, 2px)) !important;
  }
}
